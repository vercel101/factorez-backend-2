{"version":3,"file":"index.js","mappings":"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","sources":["webpack://shoewebsite/./src/controllers/OTP.js","webpack://shoewebsite/./src/controllers/adminController.js","webpack://shoewebsite/./src/controllers/adminDashboard.js","webpack://shoewebsite/./src/controllers/brandController.js","webpack://shoewebsite/./src/controllers/businessController.js","webpack://shoewebsite/./src/controllers/cancelReasonController.js","webpack://shoewebsite/./src/controllers/cartController.js","webpack://shoewebsite/./src/controllers/categoryController.js","webpack://shoewebsite/./src/controllers/colorController.js","webpack://shoewebsite/./src/controllers/couponCodeController.js","webpack://shoewebsite/./src/controllers/customerAddressController.js","webpack://shoewebsite/./src/controllers/customerController.js","webpack://shoewebsite/./src/controllers/dashboardController.js","webpack://shoewebsite/./src/controllers/excelFileController.js","webpack://shoewebsite/./src/controllers/homepageController.js","webpack://shoewebsite/./src/controllers/idGeneratorController.js","webpack://shoewebsite/./src/controllers/imageController.js","webpack://shoewebsite/./src/controllers/invoiceController.js","webpack://shoewebsite/./src/controllers/orderController.js","webpack://shoewebsite/./src/controllers/orderStatusTableController.js","webpack://shoewebsite/./src/controllers/otpController.js","webpack://shoewebsite/./src/controllers/paymentController.js","webpack://shoewebsite/./src/controllers/productController.js","webpack://shoewebsite/./src/controllers/profileController.js","webpack://shoewebsite/./src/controllers/questionController.js","webpack://shoewebsite/./src/controllers/reportController.js","webpack://shoewebsite/./src/controllers/vendorController.js","webpack://shoewebsite/./src/controllers/wishlistController.js","webpack://shoewebsite/./src/middlewares/auth.js","webpack://shoewebsite/./src/middlewares/config.js","webpack://shoewebsite/./src/middlewares/firebase.js","webpack://shoewebsite/./src/middlewares/roleAuth.js","webpack://shoewebsite/./src/models/HomepageModel.js","webpack://shoewebsite/./src/models/adminModel.js","webpack://shoewebsite/./src/models/bankModel.js","webpack://shoewebsite/./src/models/bannerModel.js","webpack://shoewebsite/./src/models/brandModel.js","webpack://shoewebsite/./src/models/businessModel.js","webpack://shoewebsite/./src/models/cancelledReasonModel.js","webpack://shoewebsite/./src/models/cartModel.js","webpack://shoewebsite/./src/models/categoryModel.js","webpack://shoewebsite/./src/models/colorModel.js","webpack://shoewebsite/./src/models/couponCodeModel.js","webpack://shoewebsite/./src/models/customerAddressModel.js","webpack://shoewebsite/./src/models/customerModel.js","webpack://shoewebsite/./src/models/documentModel.js","webpack://shoewebsite/./src/models/invoiceModel.js","webpack://shoewebsite/./src/models/invoiceNoModel.js","webpack://shoewebsite/./src/models/orderModel.js","webpack://shoewebsite/./src/models/orderStatusTableModel.js","webpack://shoewebsite/./src/models/orderedProductModel.js","webpack://shoewebsite/./src/models/otpModel.js","webpack://shoewebsite/./src/models/paymentModel.js","webpack://shoewebsite/./src/models/productModel.js","webpack://shoewebsite/./src/models/questionModel.js","webpack://shoewebsite/./src/models/subcategoryModel.js","webpack://shoewebsite/./src/models/vendorModel.js","webpack://shoewebsite/./src/models/wishlistModel.js","webpack://shoewebsite/./src/routes/adminDashboardRoute.js","webpack://shoewebsite/./src/routes/adminRoutes.js","webpack://shoewebsite/./src/routes/brandRoutes.js","webpack://shoewebsite/./src/routes/businessRoutes.js","webpack://shoewebsite/./src/routes/cartRoutes.js","webpack://shoewebsite/./src/routes/categoryRoutes.js","webpack://shoewebsite/./src/routes/colorRoutes.js","webpack://shoewebsite/./src/routes/couponCodeRoutes.js","webpack://shoewebsite/./src/routes/customerRoutes.js","webpack://shoewebsite/./src/routes/dashboardRoutes.js","webpack://shoewebsite/./src/routes/homepageRoutes.js","webpack://shoewebsite/./src/routes/invoiceRoutes.js","webpack://shoewebsite/./src/routes/orderRoutes.js","webpack://shoewebsite/./src/routes/orderStatusTableRoutes.js","webpack://shoewebsite/./src/routes/otpRoutes.js","webpack://shoewebsite/./src/routes/paymentRoutes.js","webpack://shoewebsite/./src/routes/productRoutes.js","webpack://shoewebsite/./src/routes/profileRoutes.js","webpack://shoewebsite/./src/routes/questionsRoutes.js","webpack://shoewebsite/./src/routes/reportRoutes.js","webpack://shoewebsite/./src/routes/vendorRoutes.js","webpack://shoewebsite/./src/routes/wishlistRoutes.js","webpack://shoewebsite/./src/utils/couponExpireUtil.js","webpack://shoewebsite/./src/utils/dateUtils.js","webpack://shoewebsite/./src/utils/enums.js","webpack://shoewebsite/./src/utils/generatePdf.js","webpack://shoewebsite/./src/utils/getFinancialYear.js","webpack://shoewebsite/./src/utils/percentage.js","webpack://shoewebsite/./src/utils/stateNameAndCode.js","webpack://shoewebsite/./src/utils/utils.js","webpack://shoewebsite/external commonjs \"aws-sdk\"","webpack://shoewebsite/external commonjs \"aws-sdk/lib/maintenance_mode_message\"","webpack://shoewebsite/external commonjs \"axios\"","webpack://shoewebsite/external commonjs \"bcrypt\"","webpack://shoewebsite/external commonjs \"body-parser\"","webpack://shoewebsite/external commonjs \"convert-csv-to-json\"","webpack://shoewebsite/external commonjs \"cors\"","webpack://shoewebsite/external commonjs \"csvtojson\"","webpack://shoewebsite/external commonjs \"dotenv\"","webpack://shoewebsite/external commonjs \"exceljs\"","webpack://shoewebsite/external commonjs \"express\"","webpack://shoewebsite/external commonjs \"express-fileupload\"","webpack://shoewebsite/external commonjs \"firebase/app\"","webpack://shoewebsite/external commonjs \"firebase/storage\"","webpack://shoewebsite/external commonjs \"handlebars\"","webpack://shoewebsite/external commonjs \"jsonwebtoken\"","webpack://shoewebsite/external commonjs \"lodash\"","webpack://shoewebsite/external commonjs \"mongoose\"","webpack://shoewebsite/external commonjs \"puppeteer\"","webpack://shoewebsite/external commonjs \"request\"","webpack://shoewebsite/external commonjs \"slugify\"","webpack://shoewebsite/external commonjs \"twilio\"","webpack://shoewebsite/external node-commonjs \"fs\"","webpack://shoewebsite/external node-commonjs \"path\"","webpack://shoewebsite/webpack/bootstrap","webpack://shoewebsite/./index.js"],"sourcesContent":["const axios = require(\"axios\");\r\nconst _ = require(\"lodash\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst otpModel = require(\"../models/otpModel\");\r\n\r\n// GENERATE RANDOM NUMERIC ID OF GIVEN LENGTH\r\nfunction generateRandomID(length) {\r\n    let id = \"\";\r\n    const digits = \"0123456789\";\r\n\r\n    for (let i = 0; i < length; i++) {\r\n        const randomIndex = Math.floor(Math.random() * digits.length);\r\n        id += digits[randomIndex];\r\n    }\r\n    return id;\r\n}\r\n\r\n// SEND OTP THROUGH KALEYRA SMS API\r\nconst sentOTP = async (req, res) => {\r\n    try {\r\n        let { mobile } = req.body;\r\n        const apiKey = \"A78cd4e6b7179e5439caac3c9f5f75b63\";\r\n        const sid = \"HXIN1777665894IN\";\r\n        const type = \"OTP\";\r\n        const senderId = \"FCTREZ\";\r\n        let to = 917042072054;\r\n        let OTP = generateRandomID(4);\r\n        const otpTemplateId = \"1007482403267557324\";\r\n        // const { to, OTP } = req.body;\r\n        // console.log(\"mobile: \", to);\r\n\r\n        const body = `Your OTP Code for registration on factorez is ${OTP}. Thank you for Signup on FactorEz.com`;\r\n\r\n        const smsData = {\r\n            method: \"POST\",\r\n            url: `https://api.kaleyra.io/v1/${sid}/messages`,\r\n            headers: {\r\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n                \"api-key\": apiKey,\r\n            },\r\n            data: `to=91${mobile}&type=${type}&sender=${senderId}&body=${body}&template_id=${otpTemplateId}`,\r\n        };\r\n\r\n        const response = await axios(smsData);\r\n        // console.log(\"OTP SMS sent successfully!\", response.data);\r\n\r\n        let hashedOTP = await bcrypt.hash(OTP, 10);\r\n        OTP = hashedOTP;\r\n\r\n        // console.log(\"hashed OTP: \", OTP);\r\n\r\n        let otp = new otpModel({ mobile: mobile, otp: OTP });\r\n\r\n        await otp.save();\r\n\r\n        return res.status(200).send({ status: true, message: \"OTP sent successfully\", data: response.data });\r\n    } catch (error) {\r\n        console.log(\"Error sending SMS:\", error.message);\r\n        return res.status(401).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// VERIFY OTP\r\nconst verifyOTP = async (req, res) => {\r\n    try {\r\n        let { mobile, OTP } = req.body;\r\n\r\n        let otpHolder = await otpModel.find({ mobile: mobile });\r\n\r\n        if (!otpHolder.length) {\r\n            return res.status(401).send({ status: false, message: \"You are using an expired OTP\" });\r\n        }\r\n\r\n        let validOTP = otpHolder[otpHolder.length - 1];\r\n\r\n        let validUser = bcrypt.compare(OTP, validOTP.otp);\r\n\r\n        if (validOTP.mobile === mobile && validUser) {\r\n            await otpModel.deleteMany({ mobile: validOTP.mobile });\r\n\r\n            return res.status(200).send({ status: true, message: \"User verified\" });\r\n        } else {\r\n            return res.status(401).send({ status: false, message: \"Authentication failed\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { sentOTP, verifyOTP };\r\n","const adminModel = require(\"../models/adminModel\");\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst { listOfRoleEnums, roleEnums } = require(\"../utils/enums\");\r\nconst { adminSecretKey, tokenSecretKey } = require(\"../middlewares/config\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst documentModel = require(\"../models/documentModel\");\r\nconst bankModel = require(\"../models/bankModel\");\r\nconst brandModel = require(\"../models/brandModel\");\r\nconst { isValid, isValidEmail } = require(\"../utils/utils\");\r\nconst productModel = require(\"../models/productModel\");\r\n\r\nconst addAdmin = async (req, res) => {\r\n    try {\r\n        let { name, email, phone, password, role } = req.body;\r\n\r\n        let admins = await adminModel.find({\r\n            $or: [{ email: email }, { phone: phone }],\r\n        });\r\n        if (admins.length > 0) {\r\n            return res.status(400).send({\r\n                message: \"Email or Password already exists\",\r\n                status: false,\r\n            });\r\n        }\r\n        if (name === \"\") {\r\n            return res.status(400).send({ message: \"Name is required\", status: false });\r\n        }\r\n        if (email === \"\") {\r\n            return res.status(400).send({ message: \"Email is required\", status: false });\r\n        }\r\n        if (phone === \"\") {\r\n            return res.status(400).send({ message: \"Phone number is required\", status: false });\r\n        }\r\n        if (password === \"\") {\r\n            return res.status(400).send({ message: \"Password is required\", status: false });\r\n        }\r\n        if (role === \"\") {\r\n            return res.status(400).send({ message: \"Admin Role is required\", status: false });\r\n        }\r\n        let hashedPassword = await bcrypt.hash(password, 10);\r\n        password = hashedPassword;\r\n        let data = {\r\n            name,\r\n            email: email.toLowerCase(),\r\n            password,\r\n            role,\r\n            phone,\r\n            isDeleted: false,\r\n        };\r\n        let admin = await adminModel.create(data);\r\n        admin.password = undefined;\r\n        admin.isSuperAdmin = undefined;\r\n        return res.status(201).send({ status: true, message: \"Successful\", data: admin });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllAdmin = async (req, res) => {\r\n    let admin = await adminModel.find({ isSuperAdmin: false, isDeleted: false }).select([\"-password\", \"-isSuperAdmin\"]);\r\n    return res.status(200).send({ status: true, message: \"All admins\", data: admin });\r\n};\r\n\r\nconst updateAdminInfo = async (req, res) => {\r\n    try {\r\n        let adminId = req.params.adminid;\r\n        let { phone, password, email, name, role } = req.body;\r\n        let admin = await adminModel.findOne({ _id: adminId, isDeleted: false });\r\n        if (!admin) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (phone) admin.phone = phone;\r\n        if (email) admin.email = email.toLowerCase();\r\n        if (name) admin.name = name;\r\n        if (role) admin.role = role;\r\n        if (password) {\r\n            let hashedPassword = await bcrypt.hash(password, 10);\r\n            admin.password = hashedPassword;\r\n        }\r\n        await admin.save();\r\n        return res.status(202).send({ status: true, message: \"Admin Updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst createSuperAdmin = async (req, res) => {\r\n    try {\r\n        let { name, email, phone, password } = req.body;\r\n        let params = req.params.secretKey;\r\n        if (params === adminSecretKey) {\r\n            let admins = await adminModel.find({\r\n                $or: [{ email: email }, { phone: phone }],\r\n            });\r\n            if (admins.length > 0) {\r\n                return res.status(400).send({\r\n                    message: \"Email or Password already exists\",\r\n                    status: false,\r\n                });\r\n            }\r\n            if (name === \"\") {\r\n                return res.status(400).send({ message: \"Name is required\", status: false });\r\n            }\r\n            if (email === \"\") {\r\n                return res.status(400).send({ message: \"Email is required\", status: false });\r\n            }\r\n            if (phone === \"\") {\r\n                return res.status(400).send({ message: \"Phone number is required\", status: false });\r\n            }\r\n            if (password === \"\") {\r\n                return res.status(400).send({ message: \"Password is required\", status: false });\r\n            }\r\n            let hashedPassword = await bcrypt.hash(password, 10);\r\n            password = hashedPassword;\r\n            let data = {\r\n                name,\r\n                email: email.toLowerCase(),\r\n                password,\r\n                role: [\"ADMIN\"],\r\n                phone,\r\n                isSuperAdmin: true,\r\n                isDeleted: false,\r\n            };\r\n            let superAdmin = await adminModel.create(data);\r\n            superAdmin.password = undefined;\r\n            superAdmin.isSuperAdmin = undefined;\r\n            return res.status(201).send({ status: true, message: \"Successful\", data: superAdmin });\r\n        }\r\n        return res.status(401).send({ status: true, message: \"Invalid signature\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst adminLogin = async (req, res) => {\r\n    try {\r\n        let { email, password } = req.body;\r\n        if (!isValid(email)) {\r\n            return res.status(400).send({ status: false, message: \"Email or USER Id is required\" });\r\n        }\r\n\r\n        if (email.includes(\"@\")) {\r\n            if (!isValidEmail(email)) {\r\n                return res.status(400).send({ status: false, message: \"Invalid email\" });\r\n            }\r\n        }\r\n        if (!isValid(password)) {\r\n            return res.status(400).send({ status: false, message: \"password is required\" });\r\n        }\r\n        // const EmailRegex = /^\\w+([\\.]?\\w+)*@\\w+([\\.]?\\w+)*(\\.\\w{2,3})+$/;\r\n        // const UserIDReges = /^[0-9]{8,14}$/;\r\n        // const PasswordRegex = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{10,20}$/;\r\n\r\n        // if ((!EmailRegex.test(email) && !UserIDReges.test(email)) || !PasswordRegex.test(password)) {\r\n        //     return res.status(400).send({ status: false, message: \"Please provide valid Credentials\" });\r\n        // }\r\n        let user = null;\r\n        if (email.includes(\"@\")) {\r\n            user = await adminModel.findOne({ email: email.toLowerCase(), isDeleted: false });\r\n            if (!user) {\r\n                user = await vendorModel.findOne({ emailId: email.toLowerCase() });\r\n            }\r\n        } else {\r\n            user = await vendorModel.findOne({ vendor_unique_id: email });\r\n        }\r\n        if (!user) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Email id or Username\" });\r\n        }\r\n        bcrypt.compare(password, user.password, function (err, result) {\r\n            if (err) {\r\n                return res.status(400).send({ status: false, message: err.message });\r\n            }\r\n            hasAccess(result);\r\n        });\r\n\r\n        function hasAccess(result) {\r\n            if (result) {\r\n                let date = Date.now();\r\n                let data = {};\r\n                let userFlag = \"isSuperAdmin\" in user;\r\n                if (!userFlag) {\r\n                    if (user.status === \"Pending\" || user.status === \"Inprogress\") {\r\n                        return res.status(401).send({ status: false, message: \"Account is under review\" });\r\n                    }\r\n                    if (user.status === \"Rejected\") {\r\n                        return res.status(401).send({ status: false, message: \"Account has been Rejected, Please contact us.\" });\r\n                    }\r\n                }\r\n                if (!userFlag) {\r\n                    data.name = user.representativeName;\r\n                    data.email = user.emailId;\r\n                    data.userType = \"Seller\";\r\n                    data.role = user.role;\r\n                    data.altMobileNo = user.altMobileNo;\r\n                    data.phone = user.mobileNo;\r\n                    data.photo = user.profileUrl;\r\n                    data.vendorId = user.vendor_unique_id;\r\n                } else {\r\n                    data.name = user.name;\r\n                    data.email = user.email;\r\n                    data.userType = user.isSuperAdmin ? \"Super Admin\" : \"Admin\";\r\n                    data.role = user.role;\r\n                    data.phone = user.phone;\r\n                    data.photo = user.profileUrl;\r\n                    data.vendorId = null;\r\n                }\r\n\r\n                let issueTime = Math.floor(date / 1000);\r\n                let token = jwt.sign(\r\n                    {\r\n                        email: data.email,\r\n                        userId: user._id.toString(),\r\n                        userModel: userFlag ? \"ADMIN\" : \"VENDOR\",\r\n                        iat: issueTime,\r\n                    },\r\n                    tokenSecretKey,\r\n                    { expiresIn: \"12h\" }\r\n                );\r\n                data.token = token;\r\n\r\n                res.setHeader(\"Authorization\", \"Bearer\", token);\r\n                return res.status(200).send({\r\n                    status: false,\r\n                    message: \"Successfully logged in\",\r\n                    data: data,\r\n                });\r\n            } else {\r\n                return res.status(401).send({ status: false, message: \"Incorrect Password\" });\r\n            }\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst getAllSubadminEnums = async (req, res) => {\r\n    try {\r\n        return res.status(200).send({ status: true, message: \"Data Accessed\", data: roleEnums });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst verifyVendor = async (req, res) => {\r\n    try {\r\n        let { vendorMargin, vendorStatus } = req.body;\r\n        let vendorObj = await vendorModel.findById(req.params.vendorId);\r\n        if (vendorStatus === \"Approved\") {\r\n            if (vendorMargin) {\r\n                vendorObj.marginInPercentage = vendorMargin;\r\n            }\r\n            vendorObj.status = vendorStatus;\r\n            vendorObj.actionTakenBy = req.userId;\r\n            await productModel.updateMany({ vendor_id: vendorObj._id }, { $set: { margin: vendorMargin } });\r\n            await vendorObj.save();\r\n        } else if (vendorStatus === \"Rejected\") {\r\n            vendorObj.status = vendorStatus;\r\n            vendorObj.actionTakenBy = req.userId;\r\n            await vendorObj.save();\r\n        } else {\r\n            if (vendorMargin) {\r\n                await productModel.updateMany({ vendor_id: vendorObj._id }, { $set: { margin: vendorMargin } });\r\n                vendorObj.marginInPercentage = vendorMargin;\r\n            }\r\n            await vendorObj.save();\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Vendor Updated\", data: \"Updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst deleteVendor = async (req, res) => {\r\n    try {\r\n        let { vendorId } = req.body;\r\n        if (!vendorId) {\r\n            return res.status(400).send({ status: false, message: \"bad request\" });\r\n        }\r\n        let vendor = await vendorModel.findById(vendorId);\r\n        if (!vendor) {\r\n            return res.status(400).send({ status: false, message: \"vendor not found\" });\r\n        }\r\n        vendor.isDeleted = true;\r\n        await vendor.save();\r\n        return res.status(202).send({ status: true, message: \"vendor deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst changeVendorPassword = async (req, res) => {\r\n    try {\r\n        let { vendorId, newPassword } = req.body;\r\n\r\n        let vendor = await vendorModel.findOne({ _id: vendorId });\r\n        if (!vendor) {\r\n            return res.status(404).send({ status: false, message: \"Vendor Not Found\" });\r\n        }\r\n        if (newPassword === \"\") {\r\n            return res.status(400).send({ message: \"Password is required\", status: false });\r\n        }\r\n        let hashedPassword = await bcrypt.hash(newPassword, 10);\r\n\r\n        vendor.password = hashedPassword;\r\n        await vendor.save();\r\n        return res.status(201).send({ message: \"Password updated\", status: true });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst deleteAdminById = async (req, res) => {\r\n    try {\r\n        let adminId = req.params.adminid;\r\n        let admin = await adminModel.findById(adminId);\r\n        if (!admin) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        admin.isDeleted = true;\r\n        await admin.save();\r\n        return res.status(202).send({ status: true, message: \"Admin Deleted\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addAdmin,\r\n    getAllAdmin,\r\n    createSuperAdmin,\r\n    adminLogin,\r\n    getAllSubadminEnums,\r\n    verifyVendor,\r\n    deleteVendor,\r\n    changeVendorPassword,\r\n    updateAdminInfo,\r\n    deleteAdminById,\r\n};\r\n","const productModel = require(\"../models/productModel\");\nconst customerModel = require(\"../models/customerModel\");\nconst vendorModel = require(\"../models/vendorModel\");\nconst orderModel = require(\"../models/orderModel\");\n\nconst getDateStrToMS = (dateStr) => {\n    dateStr.setHours(0, 0, 0, 0);\n    return dateStr.getTime();\n};\n\nconst getCurrentYear = () => {\n    var date = new Date();\n    var firstMonth = new Date(date.getFullYear(), 0, 1);\n    var lastMonth = new Date(date.getFullYear(), 12, 0);\n    return [firstMonth.getTime(), lastMonth.getTime()];\n};\n\nconst getCurrentMonth = () => {\n    var date = new Date();\n    var firstDay = new Date(date.getFullYear(), date.getMonth(), 1);\n    var lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0);\n    return [firstDay.getTime(), lastDay.getTime()];\n};\n\nconst getCurrentWeek = () => {\n    var curr = new Date();\n    curr.setHours(0, 0, 0, 0);\n    var first = curr.getDate() - curr.getDay();\n    var last = first + 6;\n    var firstDay = new Date(curr.setDate(first));\n    var lastDay = new Date(curr.setDate(last));\n    console.log(firstDay);\n    console.log(lastDay);\n    return [firstDay.getTime(), lastDay.getTime()];\n};\n\nconst getDashboardData = async (req, res) => {\n    try {\n        let products = await productModel.find({ isDeleted: false }).populate(\"vendor_id\");\n        let productCount = 0;\n        let customerCount = 0;\n        let vendorCount = 0;\n        let orderCount = 0;\n        let todayOrderCount = 0;\n        let thisWeakOrderCount = 0;\n        let thisMonthOrderCount = 0;\n        let thisYearOrderCount = 0;\n        let thisYearSale = 0;\n        let thisMonthSale = 0;\n        let thisWeekSale = 0;\n        let overAllSale = 0;\n        let todaySale = 0;\n        for (let x of products) {\n            if (x.vendor_id.isActive === \"Active\") {\n                productCount++;\n            }\n        }\n        let customer = await customerModel.find({ isDeleted: false });\n        customerCount += customer.length;\n        let vendors = await vendorModel.find({ isActive: \"Active\" });\n        vendorCount += vendors.length;\n\n        let todayMS = getDateStrToMS(new Date());\n\n        let orders = await orderModel.find().populate(\"order_status_id\");\n        for (let x of orders) {\n            console.log(x);\n            if (getDateStrToMS(x.order_date) === todayMS) {\n                todayOrderCount++;\n                if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                    todaySale += x.grand_total;\n                }\n            }\n            if (getDateStrToMS(x.order_date) >= getCurrentWeek()[0] && getDateStrToMS(x.order_date) <= getCurrentWeek()[1]) {\n                thisWeakOrderCount++;\n                if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                    thisWeekSale += x.grand_total;\n                }\n            }\n            if (getDateStrToMS(x.order_date) >= getCurrentMonth()[0] && getDateStrToMS(x.order_date) <= getCurrentMonth()[1]) {\n                thisMonthOrderCount++;\n                if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                    thisMonthSale += x.grand_total;\n                }\n            }\n            if (getDateStrToMS(x.order_date) >= getCurrentYear()[0] && getDateStrToMS(x.order_date) <= getCurrentYear()[1]) {\n                thisYearOrderCount++;\n                if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                    thisYearSale += x.grand_total;\n                }\n            }\n            if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                overAllSale += x.grand_total;\n            }\n            orderCount++;\n        }\n\n        let data = {\n            productCount,\n            customerCount,\n            vendorCount,\n            todayOrderCount,\n            thisWeakOrderCount,\n            thisMonthOrderCount,\n            thisYearOrderCount,\n            thisYearSale,\n            thisMonthSale,\n            thisWeekSale,\n            todaySale,\n            overAllSale,\n            overallOrder: orderCount,\n        };\n        return res.status(200).send({ status: true, data: { ...data }, message: \"Dashboard data fetched\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nmodule.exports = { getDashboardData };\n","const brandModel = require(\"../models/brandModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst { uploadFile } = require(\"./imageController\");\r\n// ADD BRAND DETAILS\r\nconst addBrand = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let { brand_name, vendor_id, brandLogo } = data;\r\n        if (!isValid(brand_name)) {\r\n            return res.status(400).send({ status: false, message: \"Brand Name is required\" });\r\n        }\r\n\r\n        let brand = await brandModel.findOne({\r\n            brand_name: brand_name,\r\n        });\r\n        if (brand) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"This category is already exists, please enter a new category\",\r\n            });\r\n        }\r\n        let vendor = await vendorModel.findOne({ vendor_unique_id: vendor_id });\r\n        let logoUrl = null;\r\n        if (req.files) {\r\n            logoUrl = await uploadFile(req.files.brandLogo);\r\n        } else {\r\n            logoUrl = brandLogo;\r\n        }\r\n        let brandData = {\r\n            brand_name: brand_name,\r\n            vendor_id: vendor,\r\n            brandLogo: logoUrl,\r\n        };\r\n\r\n        let newBrand = await brandModel.create(brandData);\r\n        vendor.brand_id.push(newBrand);\r\n        await vendor.save();\r\n\r\n        return res.status(201).send({ status: true, message: \"success\", data: newBrand });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL BRANDS\r\nconst getAllBrands = async (req, res) => {\r\n    try {\r\n        let brands = null;\r\n        if (req.userModel === \"VENDOR\") {\r\n            brands = await brandModel.find({ isDeleted: false, vendor_id: req.userId }).populate(\"vendor_id\");\r\n        } else {\r\n            brands = await brandModel.find({ isDeleted: false }).populate(\"vendor_id\");\r\n        }\r\n        return res.status(200).send({ status: true, data: brands });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllBrandByVendor = async (req, res) => {\r\n    try {\r\n        if (req.userModel === \"VENDOR\") {\r\n            let vendor = await vendorModel.findOne({ vendor_unique_id: req.params.vendorId }).populate(\"brand_id\");\r\n            if (!vendor) {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Vendor Not Found\",\r\n                });\r\n            }\r\n            return res.status(200).send({ status: true, data: vendor.brand_id });\r\n        } else {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Bad Request\",\r\n            });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst verifyBrandById = async (req, res) => {\r\n    try {\r\n        let brandId = req.params.brandId;\r\n        let brandStatus = req.body.brandStatus;\r\n        if (req.userModel === \"Super Admin\" || req.userModel === \"ADMIN\") {\r\n            let brand = await brandModel.findById(brandId);\r\n            if (!brand) {\r\n                return res.status(400).send({ status: false, data: \"Bad request\" });\r\n            }\r\n            brand.brandStatus = brandStatus;\r\n            await brand.save();\r\n            return res.status(202).send({ status: true, data: \"Brand status change successfully\" });\r\n        } else {\r\n            return res.status(400).send({ status: false, data: \"Bad request\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { addBrand, getAllBrands, getAllBrandByVendor, verifyBrandById };\r\n","const businessModel = require(\"../models/businessModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst { uploadFile, uploadImage } = require(\"./imageController\");\r\nconst bannerModel = require(\"../models/bannerModel\");\r\n\r\n// ADD BUSINESS DETAILS\r\nconst addBusinessInfo = async (req, res) => {\r\n    try {\r\n        let { bName, bEmail, bNumber } = req.body;\r\n\r\n        if (!bName || !bEmail || !bNumber) {\r\n            return res.status(400).send({ status: false, message: \"All fields are required\" });\r\n        }\r\n\r\n        let businessData = {\r\n            business_name: bName,\r\n            contactNo: bNumber,\r\n            contactEmail: bEmail,\r\n        };\r\n        console.log(businessData);\r\n        let businessExists = await businessModel.find();\r\n        console.log(businessExists);\r\n        if (businessExists.length > 0) {\r\n            businessExists[0].business_name = bName;\r\n            businessExists[0].contactNo = bNumber;\r\n            businessExists[0].contactEmail = bEmail;\r\n            await businessExists[0].save();\r\n        } else {\r\n            await businessModel.create(businessData);\r\n        }\r\n        return res.status(201).send({ status: true, message: \"Success\", data: \"business\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst addBusinessGST = async (req, res) => {\r\n    try {\r\n        let { gsts } = req.body;\r\n        if (!gsts || gsts.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"Add GST\" });\r\n        }\r\n\r\n        let businessExists = await businessModel.find();\r\n        if (businessExists.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"Add business Name and other fields then add GST\" });\r\n        }\r\n        businessExists[0].gsts = gsts;\r\n        businessExists[0].defaultGST = {};\r\n        await businessExists[0].save();\r\n        return res.status(201).send({ status: true, message: \"GST updated to business\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst addBusinessFiles = async (req, res) => {\r\n    try {\r\n        let { bLogo, bInvLogo, bPolicy, bTC } = req.files;\r\n        let business = await businessModel.find();\r\n        if (bLogo) {\r\n            business[0].business_Logo = await uploadFile(bLogo);\r\n        }\r\n        if (bInvLogo) {\r\n            business[0].invoiceLogo = await uploadFile(bInvLogo);\r\n        }\r\n        if (bPolicy) {\r\n            business[0].privacyPolicy = await uploadFile(bPolicy);\r\n        }\r\n        if (bTC) {\r\n            business[0].iAgree = await uploadFile(bTC);\r\n        }\r\n        await business[0].save();\r\n        return res.status(201).send({ status: true, message: \"Success\", data: \"business\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getBusinessInfo = async (req, res) => {\r\n    try {\r\n        let business = await businessModel.find();\r\n        if (business.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"No record available\" });\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Record fetched...\", data: business[0] });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst setDefaultGst = async (req, res) => {\r\n    try {\r\n        let { gst } = req.body;\r\n        let business = await businessModel.find();\r\n        if (business.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"No record available\" });\r\n        }\r\n\r\n        for (let gstd of business[0].gsts) {\r\n            console.log(gstd);\r\n            if (gstd.gstNo === gst) {\r\n                business[0].defaultGST.gstNo = gstd.gstNo;\r\n                business[0].defaultGST.pickupAddress = gstd.pickupAddress;\r\n                business[0].defaultGST.stateCode = gstd.stateCode;\r\n            }\r\n        }\r\n        await business[0].save();\r\n        console.log(req.body);\r\n        return res.status(200).send({ status: true, message: \"Default gst updated...\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst saveSocialMedia = async (req, res) => {\r\n    try {\r\n        let { facebook, instagram, twitter, youtube, linkedin } = req.body;\r\n        let business = await businessModel.find();\r\n        if (business.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"No record available\" });\r\n        }\r\n        if (facebook) {\r\n            business[0].socialMedia.facebook = facebook;\r\n        }\r\n        if (instagram) {\r\n            business[0].socialMedia.instagram = instagram;\r\n        }\r\n        if (twitter) {\r\n            business[0].socialMedia.twitter = twitter;\r\n        }\r\n        if (youtube) {\r\n            business[0].socialMedia.youtube = youtube;\r\n        }\r\n        if (linkedin) {\r\n            business[0].socialMedia.linkedin = linkedin;\r\n        }\r\n        await business[0].save();\r\n        return res.status(200).send({ status: true, message: \"Social media links added\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst bannerForClientPage = async (req, res) => {\r\n    try {\r\n        let { images } = req.files;\r\n        let { type } = req.body;\r\n        if (images && type) {\r\n            if (type === \"MULTIPLE\") {\r\n                for await (let x of images) {\r\n                    let url = (await uploadImage(x)).imageURL;\r\n                    await bannerModel.create({ bannerUrl: url, type: \"MULTIPLE\" });\r\n                }\r\n            } else if (type === \"SINGLE\") {\r\n                let url = (await uploadImage(images)).imageURL;\r\n                await bannerModel.create({ bannerUrl: url, type: \"SINGLE\" });\r\n            }\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Banner added\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getBannerForClientPage = async (req, res) => {\r\n    try {\r\n        let data = await bannerModel.find();\r\n        return res.status(200).send({ status: true, data: data, message: \"Banner Images fetched\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst bannerDeleteById = async (req, res) => {\r\n    try {\r\n        let bannerId = req.params.bannerId;\r\n        await bannerModel.findByIdAndDelete(bannerId);\r\n        return res.status(200).send({ status: true, message: \"Banner deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addBusinessInfo,\r\n    addBusinessGST,\r\n    getBusinessInfo,\r\n    addBusinessFiles,\r\n    setDefaultGst,\r\n    saveSocialMedia,\r\n    bannerForClientPage,\r\n    getBannerForClientPage,\r\n    bannerDeleteById\r\n};\r\n","const cancelledReasonModel = require(\"../models/cancelledReasonModel\");\r\nconst questionModel = require(\"../models/questionModel\");\r\nconst orderModel = require(\"../models/orderModel\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\n\r\n// CANCEL ORDER BY ORDER ID\r\nconst addCancelledReason = async (req, res) => {\r\n  try {\r\n    \r\n    let data = req.body;\r\n\r\n    let { questions, customerAnswer } = data;\r\n\r\n    let cancelledReasonData = {\r\n      questions,\r\n      customerAnswer,\r\n    };\r\n\r\n    let newCancelledReason = await cancelledReasonModel.create(\r\n      cancelledReasonData\r\n    );\r\n\r\n    return res\r\n      .status(201)\r\n      .send({ status: true, message: \"Success\", data: newCancelledReason });\r\n  } catch (error) {\r\n    return res.status(500).send({ status: false, message: error.message });\r\n  }\r\n};\r\n\r\nmodule.exports = { addCancelledReason }","const { isValidObjectId } = require(\"mongoose\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst colorModel = require(\"../models/colorModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\n\r\n// ADD TO CART\r\nconst addToCart = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let { product_id, qty, lotSize, colorId } = req.body;\r\n        // Find the cart for the customer\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer ID\" });\r\n        }\r\n        if (!isValidObjectId(colorId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Color ID\" });\r\n        }\r\n        let cart = await cartModel.findOne({ customer_id: customerId });\r\n        let customer = await customerModel.findById(customerId);\r\n        let color = await colorModel.findById(colorId);\r\n\r\n        let isProductExists = await productModel.findOne({\r\n            _id: product_id,\r\n            status: \"Approved\",\r\n        });\r\n\r\n        if (!isProductExists) {\r\n            return res.status(404).send({ status: false, message: \"Product not found\" });\r\n        }\r\n\r\n        let data = {\r\n            product_id: product_id,\r\n            qty: Number(qty),\r\n            lotSize: lotSize,\r\n            color: {\r\n                colorName: color.colorName,\r\n                colorHex: color.colorHex,\r\n            },\r\n        };\r\n        if (!cart) {\r\n            return res.status(400).send({ status: false, message: \"Server Error\" });\r\n        } else {\r\n            data.addedAt = new Date().toLocaleString();\r\n            cart.products.push(data);\r\n        }\r\n        await cart.save();\r\n\r\n        let dataX = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n            cartLength: cart.products.length,\r\n        };\r\n\r\n        res.status(201).send({ status: true, message: \"Cart updated successfully\", data: dataX });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst priceCal = (price, margin, gst) => {\r\n    let marginAmt = Number(price) + (Number(price) * Number(margin)) / 100;\r\n    let gstAmt = (Number(marginAmt) * Number(gst)) / 100;\r\n    return (gstAmt + marginAmt).toFixed(2);\r\n};\r\nconst totalPriceCalc = (products) => {\r\n    let totalPrice = 0;\r\n    products.forEach((element) => {\r\n        let { seller_price, margin, sellingGST } = element.product_id;\r\n        totalPrice += Number(element.qty) * Number(priceCal(seller_price, margin, sellingGST));\r\n    });\r\n    return totalPrice.toFixed(2);\r\n};\r\n\r\nconst qtyIncreaseDecrease = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let index = req.params.index;\r\n        let qty = req.params.qty;\r\n        let cart = await cartModel.findOne({ customer_id: customerId }).populate(\"products.product_id\");\r\n        if (!cart) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        if (cart.products.length > 0) {\r\n            cart.products[index].qty = qty;\r\n            let cartAmt_current = totalPriceCalc(cart.products);\r\n            console.log(cartAmt_current);\r\n            if (cart.currentCoupon && cartAmt_current < cart.currentCoupon.minOrderAmt) {\r\n                console.log(\"hell\");\r\n                cart.currentCoupon = undefined;\r\n            }\r\n            await cart.save();\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        return res.status(201).json({ message: \"Quantity updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst removeFromCart = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let index = req.params.index;\r\n        let cart = await cartModel.findOne({ customer_id: customerId });\r\n\r\n        if (!cart) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (cart.products.length > 0) {\r\n            let arr = cart.products;\r\n            arr.splice(index, 1);\r\n            cart.products = arr;\r\n            await cart.save();\r\n        }\r\n        res.status(201).json({ message: \"Product removed successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL CARTS\r\nconst getAllAbandentCarts = async (req, res) => {\r\n    try {\r\n        let carts = await cartModel.find({ products: { $gte: [{ $size: 0 }] } }).populate([\"customer_id\", { path: \"products.product_id\", model: \"Product\" }]);\r\n        return res.status(200).send({ status: true, data: carts });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET CART BY CUSTOMER ID\r\nconst getCartByCustomerId = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let cart = await cartModel.findOne({ customer_id: customerId }).populate({ path: \"products.product_id\", model: \"Product\", populate: { path: \"brandId\", model: \"Brand\" } });\r\n\r\n        if (!cart) {\r\n            return res.status(404).send({ status: false, message: \"No cart found with this customer\" });\r\n        }\r\n        let customer = await customerModel.findById(customerId);\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n            cartLength: cart.products.length,\r\n        };\r\n        return res.status(200).send({ status: true, data: cart, customerData: data });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addToCart,\r\n    getAllAbandentCarts,\r\n    getCartByCustomerId,\r\n    removeFromCart,\r\n    qtyIncreaseDecrease,\r\n};\r\n","const categoryModel = require(\"../models/categoryModel\");\r\nconst subcategoryModel = require(\"../models/subcategoryModel\");\r\nconst productModel = require(\"../models/productModel\");\r\n\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\n\r\n// ADD CATEGORY\r\nconst addCategory = async (req, res) => {\r\n   try {\r\n      let data = req.body;\r\n      let { category_name, subCategory } = data;\r\n\r\n      if (!isValid(category_name)) {\r\n         return res\r\n            .status(400)\r\n            .send({ status: false, message: \"category is required\" });\r\n      }\r\n\r\n      let category = await categoryModel.findOne({\r\n         category_name: category_name,\r\n      });\r\n\r\n      if (category) {\r\n         return res.status(400).send({\r\n            status: false,\r\n            message:\r\n               \"This category is already exists, please enter a new category\",\r\n         });\r\n      }\r\n      let subCategories = await subcategoryModel.insertMany(subCategory);\r\n\r\n      let categoryData = {\r\n         category_name: category_name,\r\n         sub_category: subCategories,\r\n      };\r\n\r\n      let newCategory = await categoryModel.create(categoryData);\r\n\r\n      return res\r\n         .status(201)\r\n         .send({ status: true, message: \"success\", data: newCategory });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\n// GET ALL CATEGORIES\r\nconst getAllCategories = async (req, res) => {\r\n   try {\r\n      let categories = await categoryModel\r\n         .find({ isDeleted: false })\r\n         .populate(\"sub_category\");\r\n      return res.status(200).send({ status: true, data: categories });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\n// GET CATEGORY BY CATEGORY ID\r\nconst getCategoryById = async (req, res) => {\r\n   try {\r\n      let categoryId = req.params.categoryId;\r\n      if (!isValidObjectId(categoryId)) {\r\n         return res\r\n            .status(400)\r\n            .send({ status: false, message: \"Invalid categoryId\" });\r\n      }\r\n\r\n      let category = await categoryModel.findOne({\r\n         _id: categoryId,\r\n         isDeleted: false,\r\n      });\r\n\r\n      if (!category) {\r\n         return res\r\n            .status(404)\r\n            .send({ status: false, message: \"Category not found\" });\r\n      }\r\n\r\n      return res\r\n         .status(200)\r\n         .send({ status: true, message: \"success\", data: category });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\n// UPDATE CATEGORY BY CATEGORY ID\r\nconst updateCategoryById = async (req, res) => {\r\n   try {\r\n      let categoryId = req.params.categoryId;\r\n\r\n      if (!isValidObjectId(categoryId)) {\r\n         return res\r\n            .status(400)\r\n            .send({ status: false, message: \"invalid category id\" });\r\n      }\r\n\r\n      let category = await categoryModel\r\n         .findOne({ _id: categoryId })\r\n         .populate(\"sub_category\");\r\n\r\n      if (!category) {\r\n         return res\r\n            .status(404)\r\n            .send({ status: false, message: \"Category not found\" });\r\n      }\r\n      let { category_name, subCategory } = req.body;\r\n\r\n      console.log(subCategory, \"sub category1\");\r\n      console.log(category.sub_category, \"sub category2\");\r\n      category.sub_category.forEach(async (el) => {\r\n         let isFound = false;\r\n         subCategory.forEach((innerEl) => {\r\n            if (innerEl.hasOwnProperty(\"_id\")) {\r\n               if (innerEl._id === el._id.toHexString()) {\r\n                  isFound = true;\r\n               }\r\n            }\r\n         });\r\n         if (!isFound) {\r\n            console.log(el._id);\r\n            await subcategoryModel.findOneAndUpdate(\r\n               { _id: el._id, isDeleted: false },\r\n               { isDeleted: true, deletedAt: Date.now() },\r\n               { new: true }\r\n            );\r\n         }\r\n      });\r\n      let subCategoryCreated = [];\r\n      for (const objs of subCategory) {\r\n         if (!objs.hasOwnProperty(\"_id\")) {\r\n            let xId = await subcategoryModel.create(objs);\r\n            subCategoryCreated.push(xId);\r\n         } else {\r\n            subCategoryCreated.push(objs);\r\n         }\r\n      }\r\n\r\n      category.category_name = category_name;\r\n      category.sub_category = subCategoryCreated;\r\n\r\n      console.log(subCategoryCreated, \"crate arr\");\r\n      await category.save();\r\n      return res\r\n         .status(200)\r\n         .send({\r\n            status: true,\r\n            message: \"success\",\r\n            data: \"Category updated successfully\",\r\n         });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\n// DELETE CATEGORY BY CATEGORY ID\r\nconst deleteCategoryById = async (req, res) => {\r\n   try {\r\n      let categoryId = req.params.categoryId;\r\n      if (!isValidObjectId(categoryId)) {\r\n         return res\r\n            .status(400)\r\n            .send({ status: false, message: \"Invalid category id\" });\r\n      }\r\n\r\n      let category = await categoryModel.findOne({ _id: categoryId });\r\n\r\n      if (!category) {\r\n         return res\r\n            .status(404)\r\n            .send({ status: false, message: \"Category not found\" });\r\n      }\r\n\r\n      let deleteCategory = await categoryModel.findOneAndUpdate(\r\n         {\r\n            _id: categoryId,\r\n            isDeleted: false,\r\n         },\r\n         {\r\n            isDeleted: true,\r\n            deletedAt: new Date(),\r\n         },\r\n         { new: true }\r\n      );\r\n\r\n      if (!deleteCategory) {\r\n         return res.status(404).send({\r\n            status: false,\r\n            message: \"category not found or already deletec\",\r\n         });\r\n      }\r\n\r\n      return res.status(200).send({ status: true, message: \"success\" });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\nmodule.exports = {\r\n   addCategory,\r\n   getAllCategories,\r\n   getCategoryById,\r\n   updateCategoryById,\r\n   deleteCategoryById,\r\n};\r\n","const colorModel = require('../models/colorModel');\r\nconst addNewColor = async (req, res) => {\r\n    try {\r\n        let {colorName, colorHex} = req.body;\r\n        if (colorName === \"\") {\r\n            return res\r\n                .status(400)\r\n                .send({message: \"Color Name is required\", status: false});\r\n        }\r\n        if (colorHex === \"\") {\r\n            return res\r\n                .status(400)\r\n                .send({message: \"Color Hex is required\", status: false});\r\n        }\r\n\r\n        let colors = await colorModel.find({\r\n            $or: [{colorName: colorName}, {colorHex: colorHex}],\r\n        });\r\n\r\n        if(colors.length > 0) {\r\n            return res.status(400).send({\r\n                message: \"This color is already exists\",\r\n                status: false,\r\n            });\r\n        }\r\n        await colorModel.create({colorName: colorName, colorHex: colorHex});\r\n        return res.status(201).send({status: true, message: 'Color added successfully'});\r\n    } catch (error) {\r\n        return res.status(500).send({status: false, message: error.message});\r\n    }\r\n}\r\n\r\nconst deleteColorById = async (req, res) => {\r\n    try {\r\n        let colorId = req.params.colorId;\r\n        let color = await colorModel.findById(colorId);\r\n        if (!color) {\r\n            return res.status(400).send({status: false, message: \"Bad Request\"});\r\n        }\r\n        color.isDeleted = true;\r\n        await color.save();\r\n        return res.status(202).send({status: true, message: 'Color deleted successfully'});\r\n    } catch (error) {\r\n        return res.status(500).send({status: false, message: error.message});\r\n    }\r\n}\r\n\r\nconst getAllColor = async (req, res) => {\r\n    try {\r\n        let colors = await colorModel.find({isDeleted:false});\r\n        return res.status(200).send({status: true, message: 'Color fetched successfully', data: colors});\r\n    } catch (error) {\r\n        return res.status(500).send({status: false, message: error.message});\r\n    }\r\n}\r\n\r\nmodule.exports = {addNewColor, deleteColorById, getAllColor}","const couponCodeModel = require(\"../models/couponCodeModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\nconst { isExpiryCoupon } = require(\"../utils/couponExpireUtil\");\r\n\r\n// const isExpiryCoupon = (validTill) => {\r\n//     let day = validTill.getDate();\r\n//     let month = validTill.getMonth() + 1;\r\n//     let year = validTill.getFullYear();\r\n//     let expiryDateMS = new Date(`${year}-${month < 10 ? \"0\" + month : month}-${day < 10 ? \"0\" + day : day}`).getTime() / 1000;\r\n\r\n//     let now = Date.now();\r\n//     // let date = new Date(now + (5.5 * (3600 * 1000))); // Deployment time cases for +5:30 GMT\r\n//     let date = new Date();\r\n//     let dateStr = `${date.getFullYear()}-${date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1) : date.getMonth() + 1}-${date.getDate() < 10 ? \"0\" + date.getDate() : date.getDate()}`;\r\n//     let currentDateMS = new Date(dateStr).getTime() / 1000;\r\n\r\n//     return currentDateMS <= expiryDateMS ? false : true;\r\n// };\r\n\r\nconst generateCoupon = async (req, res) => {\r\n    try {\r\n        let { couponCode, validTill, maxUsers, maxDiscPrice, discountType, discountAmt, minOrderAmt } = req.body;\r\n        if (!couponCode || couponCode === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Coupon code required\" });\r\n        }\r\n        if (!validTill || validTill === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Coupon expiry date required\" });\r\n        }\r\n        if (!maxUsers || Number(maxUsers) === 0) {\r\n            return res.status(400).send({ status: false, message: \"Coupon uses limit is required\" });\r\n        }\r\n\r\n        if (!discountAmt || Number(discountAmt) === 0) {\r\n            return res.status(400).send({ status: false, message: \"Coupon discount amount is required\" });\r\n        }\r\n        if (!discountType || discountType === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Coupon discount type is required\" });\r\n        }\r\n        if (!minOrderAmt || minOrderAmt === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Minimum order is required\" });\r\n        }\r\n        if (discountType === \"Percentage\") {\r\n            if (!maxDiscPrice || Number(maxDiscPrice) === 0) {\r\n                return res.status(400).send({ status: false, message: \"Coupon Maximum discount price is required\" });\r\n            }\r\n        }\r\n        let coupon = await couponCodeModel.findOne({ couponCode: couponCode, isDeleted: false });\r\n        if (coupon) {\r\n            return res.status(200).send({ status: false, message: \"This coupon code is already created\" });\r\n        }\r\n        let newDate = new Date(validTill);\r\n        let createData = {\r\n            couponCode,\r\n            validTill: newDate,\r\n            maxUsers,\r\n            maxDiscPrice,\r\n            discountType,\r\n            discountAmt,\r\n            minOrderAmt,\r\n        };\r\n        if (discountType === \"PRICE\") {\r\n            createData.maxDiscPrice = discountAmt;\r\n        }\r\n        let createdCoupon = await couponCodeModel.create(createData);\r\n        res.status(201).send({ status: true, message: \"Coupon created successfully...\", data: createdCoupon });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst applyCoupon = async (req, res) => {\r\n    try {\r\n        let customer_id = req.params.customerid;\r\n        let { couponCode, orderAmount } = req.body;\r\n        if (!couponCode || couponCode === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Coupon id required\" });\r\n        }\r\n        if (!orderAmount || orderAmount === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Order Amount required\" });\r\n        }\r\n        if (!isValidObjectId(customer_id)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Request\" });\r\n        }\r\n        let customer = await customerModel.findById(customer_id).populate(\"cart_id\");\r\n        if (!customer) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let coupon = await couponCodeModel.findOne({ couponCode: couponCode, isDeleted: false });\r\n        if (!coupon) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Coupon Code\" });\r\n        }\r\n        if (coupon.isExpired) {\r\n            return res.status(200).send({ status: false, message: \"Coupon code expired\" });\r\n        }\r\n        if (coupon.isUsed) {\r\n            return res.status(200).send({ status: false, message: \"Coupon code uses has exceed to its maximum limit\" });\r\n        }\r\n        if (coupon.minOrderAmt > orderAmount) {\r\n            return res.status(200).send({ status: false, message: `This coupon is applicable for Minimum order amount ${coupon.minOrderAmt}` });\r\n        }\r\n\r\n        let day = coupon.validTill.getDate();\r\n        let month = coupon.validTill.getMonth() + 1;\r\n        let year = coupon.validTill.getFullYear();\r\n        let expiryDateMS = new Date(`${year}-${month < 10 ? \"0\" + month : month}-${day < 10 ? \"0\" + day : day}`).getTime() / 1000;\r\n\r\n        let now = Date.now();\r\n        // let date = new Date(now + (5.5 * (3600 * 1000))); // Deployment time cases for +5:30 GMT\r\n        let date = new Date();\r\n        let dateStr = `${date.getFullYear()}-${date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1) : date.getMonth() + 1}-${date.getDate() < 10 ? \"0\" + date.getDate() : date.getDate()}`;\r\n        let currentDateMS = new Date(dateStr).getTime() / 1000;\r\n\r\n        if (currentDateMS <= expiryDateMS) {\r\n            if (coupon.customer_id.includes(customer_id)) {\r\n                return res.status(200).send({ status: false, message: \"Coupon Already applied\" });\r\n            } else {\r\n                if (coupon.customer_id.length >= coupon.maxUsers && coupon.isUsed === false) {\r\n                    coupon.isUsed = true;\r\n                    await coupon.save();\r\n                    return res.status(200).send({ status: false, message: \"Coupon code uses has exceed to its maximum limit\" });\r\n                }\r\n\r\n                // coupon.customer_id.push(customer_id);\r\n                // if (coupon.customer_id.length === coupon.maxUsers) {\r\n                //     coupon.isUsed = true;\r\n                // }\r\n                // await coupon.save();\r\n                // let couponData = {\r\n                //     couponCode: coupon.couponCode,\r\n                //     minOrderAmt: coupon.minOrderAmt,\r\n                //     discountAmt: coupon.discountAmt,\r\n                // };\r\n                // customer.cart_id.currentCoupon = couponData;\r\n                // await customer.cart_id.save();\r\n                return res.status(202).send({\r\n                    status: true,\r\n                    data: coupon.discountAmt,\r\n                    message: \"Coupon applied successfully...\",\r\n                });\r\n            }\r\n        } else {\r\n            coupon.isExpired = true;\r\n            await coupon.save();\r\n            return res.status(200).send({ status: false, message: \"Coupon code expired\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllCoupons = async (req, res) => {\r\n    try {\r\n        let coupons = await couponCodeModel.find({ isDeleted: false }).sort({ createdAt: -1 }).populate(\"customer_id\");\r\n        for (let coupon of coupons) {\r\n            if (!coupon.isExpired) {\r\n                if (isExpiryCoupon(coupon.validTill)) {\r\n                    coupon.isExpired = true;\r\n                    await coupon.save();\r\n                }\r\n            }\r\n        }\r\n        res.status(200).send({ status: true, message: \"All Coupons fetched successfully...\", data: coupons });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst deleteCoupon = async (req, res) => {\r\n    try {\r\n        let couponId = req.params.couponid;\r\n        let coupon = await couponCodeModel.findById(couponId);\r\n        if (!coupon) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        coupon.isDeleted = true;\r\n        await coupon.save();\r\n        return res.status(202).send({ status: true, message: \"Coupon deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { generateCoupon, applyCoupon, getAllCoupons, deleteCoupon };\r\n","const { isValidObjectId } = require(\"mongoose\");\r\nconst customerAddressModel = require(\"../models/customerAddressModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst { isValidRequestBody, isValid } = require(\"../utils/utils\");\r\nconst { stateAndCode } = require(\"../utils/stateNameAndCode\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst bcrypt = require(\"bcrypt\");\r\n// ADD ADDRESS\r\nconst addCustomerInformation = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let customerId = req.params.customerid;\r\n        let { name, alternate_phone, gstNo, email, pincode, password, address, state, city } = data;\r\n\r\n        if (!isValid(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (!state || !name || !pincode || !city || !password || !address) {\r\n            return res.status(400).send({ status: false, message: \"Please provide all required fields\" });\r\n        }\r\n        let addressData = {\r\n            customerId,\r\n            address,\r\n            state,\r\n            pincode,\r\n            city,\r\n        };\r\n        if (Object.keys(stateAndCode).includes(state)) {\r\n            addressData.stateCode = stateAndCode[state];\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"Invalid State\" });\r\n        }\r\n\r\n        let customer = await customerModel.findOne({ _id: customerId, isDeleted: false, isBlocked: false });\r\n        if (!customer) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        let hashedPassword = await bcrypt.hash(password, 10);\r\n        customer.name = name;\r\n        customer.password = hashedPassword;\r\n        if (gstNo) {\r\n            customer.gstNo = gstNo;\r\n        }\r\n        if (alternate_phone) {\r\n            customer.alternate_phone = alternate_phone;\r\n        }\r\n        if (email) {\r\n            customer.email = email;\r\n        }\r\n\r\n        if (customer.isActivated === true) {\r\n            return res.status(400).send({ status: false, message: \"Account is already active\" });\r\n        }\r\n\r\n        let cart = await cartModel.create({ customer_id: customer._id });\r\n        if (!cart) {\r\n            return res.status(500).send({ status: false, message: \"Internal Server Error\" });\r\n        }\r\n        customer.cart_id = cart;\r\n        customer.isActivated = true;\r\n        addressData.customerId = customer;\r\n        let newAddress = await customerAddressModel.create(addressData);\r\n        customer.defaultAddress = newAddress._id;\r\n        await customer.save();\r\n        return res.status(201).send({ status: true, message: \"Successfully registered\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL ADDRESSES BY CUSTOMER ID\r\nconst getAllAddresses = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        if (!customerId) {\r\n            return res.status(400).send({ status: false, message: \"Customer id is required in params\" });\r\n        }\r\n        let address = await customerAddressModel.find({ customerId: customerId, isDeleted: false });\r\n        return res.status(200).send({ status: true, data: address });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE ADDRESS BY CUSTOMER ID\r\nconst updateAddressByCustomerId = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        if (!customerId) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Please provide the customerId in params\",\r\n            });\r\n        }\r\n        let customer = await customerAddressModel.findOne({\r\n            customerId: customerId,\r\n        });\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n\r\n        let body = req.body;\r\n\r\n        if (!isValidRequestBody(body)) {\r\n            return res.status(400).send({ status: false, message: \"Please enter data in body\" });\r\n        }\r\n\r\n        if (\"address\" in body) {\r\n            for (let i = 0; i < customer.address.length; i++) {\r\n                customer.address[i] = body.address[i];\r\n            }\r\n        }\r\n        await customer.save();\r\n\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Address updated successfully\",\r\n            data: customer,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// DELETE CUSTOMER ADDRESS BY CUSTOMER ID\r\nconst deleteAddressById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let addressId = req.params.addressId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        if (!isValidObjectId(addressId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid address id\" });\r\n        }\r\n        let address = await customerAddressModel.findById(addressId);\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"customer not found with this id\" });\r\n        }\r\n        if (!address) {\r\n            return res.status(404).send({ status: false, message: \"address not found with this id\" });\r\n        }\r\n        address.isDeleted = true;\r\n        await address.save();\r\n        if (customer.defaultAddress.toString() === addressId) {\r\n            customer.defaultAddress = undefined;\r\n            customer.save();\r\n        }\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n        };\r\n        if (customer.profileUrl) data.photo = customer.profileUrl;\r\n        if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n        if (customer.gstNo) data.gstNo = customer.gstNo;\r\n        if (customer.defaultAddress) data.defaultAddressId = customer.defaultAddress._id.toString();\r\n        return res.status(200).send({ status: true, data: data, message: \"Address deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst addAddress = async (req, res) => {\r\n    try {\r\n        let { address, state, city, pincode, stateCode } = req.body;\r\n        let customerId = req.params.customerId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (!address || !state || !city || !pincode || !stateCode) {\r\n            return res.status(400).send({ status: false, message: \"All fields are requited\" });\r\n        }\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!customer) {\r\n            return res.status(400).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        let addressObj = await customerAddressModel.create({ customerId, address, state, city, pincode, stateCode });\r\n\r\n        return res.status(201).send({ status: true, message: \"Address created\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nmodule.exports = {\r\n    addCustomerInformation,\r\n    getAllAddresses,\r\n    updateAddressByCustomerId,\r\n    deleteAddressById,\r\n    addAddress,\r\n};\r\n","const customerModel = require(\"../models/customerModel\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst { isValid, isValidMoblie, isValidEmail, isValidPassword } = require(\"../utils/utils\");\r\nconst { customerTokenSecretKey } = require(\"../middlewares/config\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\nconst customerAddressModel = require(\"../models/customerAddressModel\");\r\nconst wishlistModel = require(\"../models/wishlistModel\");\r\n\r\nconst loginUser = async (req, res) => {\r\n    try {\r\n        let { phone, password } = req.body;\r\n\r\n        if (!phone || !password) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        let customer = await customerModel.findOne({ phone: phone, isDeleted: false }).populate(\"cart_id\");\r\n\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Account not found this mobile number, you have to register first\" });\r\n        }\r\n        let wishlist = await wishlistModel.find({ userId: customer._id });\r\n        if (customer.isBlocked) {\r\n            return res.status(403).send({ status: false, message: \"This account has been blocked, Please Contact us!\" });\r\n        }\r\n        // if (!customer.isActivated) {\r\n        //     return res.status(200).send({ status: true, message: \"Account is not active, Please fill your information\" });\r\n        // }\r\n        bcrypt.compare(password, customer.password, function (err, result) {\r\n            if (err) {\r\n                return res.status(400).send({ status: false, message: err.message });\r\n            }\r\n            hasAccess(result);\r\n        });\r\n\r\n        function hasAccess(result) {\r\n            if (result) {\r\n                let date = Date.now();\r\n                let data = {\r\n                    name: customer.name,\r\n                    email: customer.email,\r\n                    customerId: customer._id.toString(),\r\n                    userType: \"CUSTOMER\",\r\n                    isActivated: customer.isActivated,\r\n                    phone: customer.phone,\r\n                    cartLength: customer.cart_id.products.length,\r\n                    wishlistLength: wishlist.length,\r\n                };\r\n                if (customer.profileUrl) data.photo = customer.profileUrl;\r\n                if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n                if (customer.gstNo) data.gstNo = customer.gstNo;\r\n                if (customer.defaultAddress) data.defaultAddressId = customer.defaultAddress._id.toString();\r\n                let issueTime = Math.floor(date / 1000);\r\n                let token = jwt.sign(\r\n                    {\r\n                        userId: customer._id.toString(),\r\n                        phone: customer.phone,\r\n                        userModel: \"CUSTOMER\",\r\n                        iat: issueTime,\r\n                    },\r\n                    customerTokenSecretKey,\r\n                    { expiresIn: \"24h\" }\r\n                );\r\n                data.token = token;\r\n                res.setHeader(\"Authorization\", \"Bearer \" + token);\r\n                return res.status(200).send({\r\n                    status: true,\r\n                    message: \"Login successfully\",\r\n                    data: data,\r\n                });\r\n            } else {\r\n                return res.status(401).send({ status: false, message: \"Login denied\" });\r\n            }\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL CUSTOMERS\r\nconst getAllCustomer = async (req, res) => {\r\n    try {\r\n        let customers = await customerModel.find({ isDeleted: false }).populate(\"defaultAddress\");\r\n        return res.status(200).send({ status: true, data: customers });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET CUSTOMER BY CUSTOMER ID\r\nconst getCustomerById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let customer = await customerModel.findOne({ _id: customerId });\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        return res.status(200).send({ status: true, data: customer });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE CUSTOMER BY CUSTOMER ID\r\nconst updateCustomerById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        let { name, gstNo, alternate_phone, email, password } = req.body;\r\n        if (!name && !gstNo && alternate_phone && email && password) {\r\n            return res.status(400).send({ status: false, message: \"At least one field is require to update your information\" });\r\n        }\r\n        if (name) {\r\n            customer.name = name;\r\n        }\r\n        if (gstNo) {\r\n            customer.gstNo = gstNo;\r\n        }\r\n        if (alternate_phone) {\r\n            customer.alternate_phone = alternate_phone;\r\n        }\r\n        if (email) {\r\n            customer.email = email.toLowerCase();\r\n        }\r\n        if (password) {\r\n            let hashedPassword = await bcrypt.hash(password, 10);\r\n            customer.password = hashedPassword;\r\n        }\r\n        await customer.save();\r\n\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n        };\r\n        if (customer.profileUrl) data.photo = customer.profileUrl;\r\n        if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n        if (customer.gstNo) data.gstNo = customer.gstNo;\r\n        if (customer.defaultAddress) data.defaultAddressId = customer.defaultAddress._id.toString();\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Customer updated successfully\",\r\n            data: data,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// DELETE CUSTOMER BY CUSTOMER ID\r\nconst deleteCustomerById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let customer = await customerModel.findOne({ _id: customerId });\r\n\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        customer.isDeleted = true;\r\n        // customer.isNew = true;\r\n        await customer.save();\r\n        return res.status(200).send({ status: true, message: \"Customer deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst blockCustomerById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let customer = await customerModel.findOne({ _id: customerId });\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        customer.isBlocked = !customer.isBlocked;\r\n        await customer.save();\r\n        let message = customer.isBlocked ? \"Customer has been blocked\" : \"Customer is now Active\";\r\n        return res.status(202).send({ status: true, message: message });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst findOrdersByPhone = async (req, res) => {\r\n    try {\r\n        let { userPhone } = req.body;\r\n        let customer = await customerModel.findOne({ phone: userPhone }).populate({\r\n            path: \"orders\",\r\n            model: \"Order\",\r\n            populate: [\r\n                { path: \"vendorId\", model: \"Vendor\" },\r\n                { path: \"order_status_id\", model: \"Order_Status_Table\" },\r\n                { path: \"ordered_products\", model: \"Ordered_Product\" },\r\n            ],\r\n        });\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        let orders = customer.orders;\r\n        return res.status(200).send({ status: true, message: \"Order fetch successfully\", data: orders });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst setDefaultAddress = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let addressId = req.params.addressId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        if (!isValidObjectId(addressId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid address id\" });\r\n        }\r\n        let address = await customerAddressModel.findById(addressId);\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!address) {\r\n            return res.status(404).send({ status: false, message: \"Address not found with this id\" });\r\n        }\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found with this id\" });\r\n        }\r\n        customer.defaultAddress = address._id;\r\n        await customer.save();\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n        };\r\n        if (customer.profileUrl) data.photo = customer.profileUrl;\r\n        if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n        if (customer.gstNo) data.gstNo = customer.gstNo;\r\n        if (customer.defaultAddress) data.defaultAddressId = customer.defaultAddress._id.toString();\r\n        return res.status(200).send({ status: true, data: data, message: \"Default address updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst changePassword = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let { password } = req.body;\r\n        if (!password) {\r\n            return res.status(400).send({ status: false, message: \"Password is required\" });\r\n        }\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found with this id\" });\r\n        }\r\n        let hashedPassword = await bcrypt.hash(password, 10);\r\n        customer.password = hashedPassword;\r\n        await customer.save();\r\n        return res.status(202).send({ status: true, message: \"Password Updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    loginUser,\r\n    getAllCustomer,\r\n    getCustomerById,\r\n    updateCustomerById,\r\n    deleteCustomerById,\r\n    blockCustomerById,\r\n    findOrdersByPhone,\r\n    setDefaultAddress,\r\n    changePassword,\r\n};\r\n","const HomepageModel = require(\"../models/HomepageModel\");\r\nconst businessModel = require(\"../models/businessModel\");\r\nconst categoryModel = require(\"../models/categoryModel\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst colorModel = require(\"../models/colorModel\");\r\nconst getDashboardData = async (req, res) => {\r\n    try {\r\n        let recommendedProduct = await HomepageModel.find().populate([\"featuredProduct\", \"newArrival\", \"bestSelling\"]);\r\n        let storeInfo = await businessModel.find();\r\n        let category = await categoryModel.find().populate(\"sub_category\");\r\n        let color = await colorModel.find();\r\n        storeInfo[0].defaultGST = undefined;\r\n        storeInfo[0].gsts = undefined;\r\n        let data = {\r\n            recommendedProduct: recommendedProduct[0],\r\n            storeInfo: storeInfo[0],\r\n            category,\r\n            color,\r\n        };\r\n        return res.status(200).send({ status: true, message: \"success\", data: data });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getProductBySlug= async (req, res) => {\r\n    try {\r\n        let slug = req.params.slug;\r\n        // console.log(slug);\r\n        let product = await productModel.findOne({slug:slug, isDeleted:false, stockStatus:'In_stock'}).populate([\"color_id\", \"categoryId\",\"brandId\",\"vendor_id\"]);\r\n        // console.log(product);\r\n        if (product) {\r\n            return res.status(200).send({ message: \"product info fetched\", data: product });\r\n        } else {\r\n            return res.status(200).send({ message: \"product info fetched\", data: null });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { getDashboardData,getProductBySlug };\r\n","const excelJs = require(\"exceljs\");\r\nconst csv2json = require(\"csvtojson\");\r\nlet csvToJsonC = require(\"convert-csv-to-json\");\r\nconst request = require(\"request\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst categoryModel = require(\"../models/categoryModel\");\r\nconst colorModel = require(\"../models/colorModel\");\r\nconst { uploadFile } = require(\"./imageController\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst orderModel = require(\"../models/orderModel\");\r\nconst { dateToLocalDateTime } = require(\"../utils/dateUtils\");\r\n\r\nconst checkProductIds = async (req, res, product) => {\r\n    let categoryIds = {};\r\n    let colorIds = {};\r\n    let vednorIdForx = \"\";\r\n    if (req.userModel === \"ADMIN\") {\r\n        let x = await vendorModel.findOne({ vendor_unique_id: product.vendor_id }).populate(\"brand_id\");\r\n        vednorIdForx = x._id;\r\n    }\r\n    if (Object.keys(categoryIds).length === 0) {\r\n        let x = await categoryModel.find();\r\n        for (let x1 of x) {\r\n            categoryIds[x1._id] = x1.sub_category;\r\n        }\r\n    }\r\n    if (Object.keys(colorIds).length === 0) {\r\n        let x = await colorModel.find();\r\n        for (let x1 of x) {\r\n            colorIds[x1._id] = x1._id;\r\n        }\r\n    }\r\n\r\n    if (product.brandId === \"\" || product.color_id === \"\" || product.categoryId === \"\" || product.subCatId === \"\") {\r\n        return {\r\n            status: false,\r\n            message: \"Please Provide All Dependent Ids for brand, color, category and sub category\",\r\n        };\r\n    }\r\n    if (categoryIds[product.categoryId] !== undefined) {\r\n        if (!categoryIds[product.categoryId].includes(product.subCatId)) {\r\n            return { status: false, message: \"Invalid Sub Category Id\" };\r\n        }\r\n    } else {\r\n        return { status: false, message: \"Invalid Category Id\" };\r\n    }\r\n\r\n    if (product.color_id.length > 0) {\r\n        // console.log(colorIds);\r\n        console.log(colorIds, product.color_id);\r\n        for (let x of product.color_id) {\r\n            // console.log(colorIds, x);\r\n            if (x !== \"\" && colorIds[x] === undefined) {\r\n                return { status: false, message: \"Invalid Color Id\" };\r\n            }\r\n        }\r\n    } else {\r\n        return { status: false, message: \"Color id required\" };\r\n    }\r\n    return {\r\n        status: true,\r\n        message: \"Everyhting is ok\",\r\n        vendorId: vednorIdForx,\r\n    };\r\n};\r\n\r\nconst exportIDs = async (req, res) => {\r\n    //req.userModel === 'ADMIN' || 'VENDOR'\r\n    //req.userId\r\n    try {\r\n        var workbook = new excelJs.Workbook();\r\n        var worksheet = workbook.addWorksheet(\"Brand\");\r\n        var worksheet2 = workbook.addWorksheet(\"Category & SubCategory & Colors\");\r\n\r\n        let categories = await categoryModel.find().populate(\"sub_category\");\r\n        let colors = await colorModel.find();\r\n        worksheet2.columns = [\r\n            { header: \"Category ID\", key: \"category_id\" },\r\n            { header: \"Category Name\", key: \"category_name\" },\r\n            { header: \"SubCategory ID\", key: \"subcategory_id\" },\r\n            { header: \"SubCategory Name\", key: \"subcategory_name\" },\r\n        ];\r\n        for (let cat of categories) {\r\n            Object.keys(cat[\"sub_category\"]).forEach((keys) => {\r\n                worksheet2.addRow({\r\n                    category_id: cat[\"_id\"].toString(),\r\n                    category_name: cat[\"category_name\"],\r\n                    subcategory_id: cat[\"sub_category\"][keys]._id.toString(),\r\n                    subcategory_name: cat[\"sub_category\"][keys].subcategory_name,\r\n                });\r\n            });\r\n        }\r\n        if (req.userModel === \"ADMIN\") {\r\n            let vendors = await vendorModel.find({ isActive: \"Active\", status: \"Approved\" }).populate(\"brand_id\");\r\n\r\n            worksheet.columns = [\r\n                { header: \"Vendor ID\", key: \"vendor_unique_id\" },\r\n                { header: \"Firm Name\", key: \"firmName\" },\r\n                { header: \"Brand ID\", key: \"brand_id\" },\r\n                { header: \"Brand Name\", key: \"brand_name\" },\r\n            ];\r\n\r\n            for (let singleVendor of vendors) {\r\n                Object.keys(singleVendor[\"brand_id\"]).forEach(function (key) {\r\n                    if (singleVendor.marginInPercentage > 0) {\r\n                        worksheet.addRow({\r\n                            vendor_unique_id: singleVendor[\"vendor_unique_id\"].toString(),\r\n                            firmName: singleVendor[\"firmName\"],\r\n                            brand_id: singleVendor[\"brand_id\"][key]._id.toString(),\r\n                            brand_name: singleVendor[\"brand_id\"][key].brand_name,\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            let singleVendor = await vendorModel\r\n                .findById({\r\n                    _id: req.userId,\r\n                    isActive: \"Active\",\r\n                    status: \"Approved\",\r\n                })\r\n                .populate(\"brand_id\");\r\n            worksheet.columns = [\r\n                { header: \"Brand ID\", key: \"brand_id\" },\r\n                { header: \"Brand Name\", key: \"brand_name\" },\r\n            ];\r\n            Object.keys(singleVendor[\"brand_id\"]).forEach(function (key) {\r\n                worksheet.addRow({\r\n                    brand_id: singleVendor[\"brand_id\"][key]._id.toString(),\r\n                    brand_name: singleVendor[\"brand_id\"][key].brand_name,\r\n                });\r\n            });\r\n        }\r\n\r\n        worksheet.getRow(1).eachCell((cell) => {\r\n            cell.font = { bold: true };\r\n            cell.fill = {\r\n                type: \"pattern\",\r\n                pattern: \"solid\",\r\n                fgColor: { argb: \"F08080\" },\r\n            };\r\n        });\r\n        worksheet2.getRow(1).eachCell((cell) => {\r\n            cell.font = { bold: true };\r\n            cell.fill = {\r\n                type: \"pattern\",\r\n                pattern: \"solid\",\r\n                fgColor: { argb: \"9E99F7\" },\r\n            };\r\n        });\r\n        worksheet2.addRow();\r\n        worksheet2.addRow({\r\n            category_id: \"Color ID\",\r\n            category_name: \"Color Name\",\r\n        });\r\n        worksheet2.lastRow.eachCell((cell) => {\r\n            cell.font = { bold: true };\r\n            cell.pattern = \"solid\";\r\n            cell.fill = {\r\n                type: \"pattern\",\r\n                pattern: \"solid\",\r\n                fgColor: { argb: \"F08080\" },\r\n            };\r\n        });\r\n        for (let obj of colors) {\r\n            worksheet2.addRow({\r\n                category_id: obj._id.toString(),\r\n                category_name: obj.colorName,\r\n            });\r\n        }\r\n        worksheet.columns.forEach((column) => {\r\n            const lengths = column.values.map((v) => v.toString().length);\r\n            const maxLength = Math.max(...lengths.filter((v) => typeof v === \"number\"));\r\n            column.width = maxLength + 3;\r\n        });\r\n        worksheet2.columns.forEach((column) => {\r\n            const lengths = column.values.map((v) => v.toString().length);\r\n            const maxLength = Math.max(...lengths.filter((v) => typeof v === \"number\"));\r\n            column.width = maxLength + 3;\r\n        });\r\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\r\n        res.setHeader(\"Content-Disposition\", `attachment; brandid.xlsx`);\r\n\r\n        return workbook.xlsx.write(res).then(() => {\r\n            res.status(200);\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst exportProductAddDemoSheet = async (req, res) => {\r\n    //req.userModel === 'ADMIN' || 'VENDOR'\r\n    try {\r\n        var workbook = new excelJs.Workbook();\r\n        var worksheet = workbook.addWorksheet(\"Add Bulk Product\");\r\n\r\n        let columnData = [\r\n            { header: \"Product Name\", key: \"product_name\" },\r\n            { header: \"SKU CODE\", key: \"skucode\" },\r\n            { header: \"HSN CODE\", key: \"hsncode\" },\r\n            { header: \"Brand ID\", key: \"brand_id\" },\r\n            { header: \"Category ID\", key: \"category_id\" },\r\n            { header: \"Sub Category ID\", key: \"subcategory_id\" },\r\n            { header: \"Color ID\", key: \"color_id\" },\r\n            { header: \"Lot Size\", key: \"lotsize\" },\r\n            { header: \"MRP\", key: \"mrp\" },\r\n            { header: \"GST\", key: \"gst\" },\r\n            { header: \"Seller Price\", key: \"seller_price\" },\r\n            { header: \"In Hand QTY\", key: \"in_hand_qty\" },\r\n            { header: \"Min Order QTY\", key: \"min_order_qty\" },\r\n            { header: \"Sole\", key: \"sole\" },\r\n            { header: \"Material\", key: \"material\" },\r\n            { header: \"Packing Type\", key: \"packing_type\" },\r\n            { header: \"Made In\", key: \"made_in\" },\r\n            { header: \"Weight\", key: \"weight\" },\r\n            { header: \"Description\", key: \"description\" },\r\n            { header: \"Thumbnail URL\", key: \"thumbnail_url\" },\r\n            { header: \"Multiple Images\", key: \"multiple_images\" },\r\n        ];\r\n        var data = {\r\n            product_name: \"Demo prouduct name\",\r\n            skucode: \"---\",\r\n            hsncode: \"---\",\r\n            brand_id: \"64b53---demo---id---747b\",\r\n            category_id: \"64b53---demo---id---747b\",\r\n            subcategory_id: \"64b53---demo---id---747b\",\r\n            color_id: \"64b53---demo---id---747b\",\r\n            lotsize: \"put multiple lot size seperat by ',' comma\",\r\n            mrp: \"100\",\r\n            gst: \"12\",\r\n            seller_price: \"00\",\r\n            in_hand_qty: \"00\",\r\n            min_order_qty: \"0\",\r\n            sole: \"--\",\r\n            material: \"--\",\r\n            packing_type: \"--\",\r\n            made_in: \"India\",\r\n            weight: \"0\",\r\n            description: \"This is demo Description\",\r\n            thumbnail_url: \"put url here\",\r\n            multiple_images: \"put multiple url seperated by ',' comma\",\r\n        };\r\n        if (req.userModel === \"ADMIN\") {\r\n            columnData.unshift({ header: \"Vendor ID\", key: \"vendor_id\" });\r\n            const newColumnData = [...columnData.slice(0, 12), { header: \"Margin\", key: \"margin\" }, { header: \"Selling GST\", key: \"sellingGST\" }, ...columnData.slice(12)];\r\n            columnData = newColumnData;\r\n            data.vendor_id = \"64b53---demo---id---747b\";\r\n            data.margin = 0;\r\n            data.sellingGST = 0;\r\n        }\r\n        worksheet.columns = columnData;\r\n        worksheet.addRow(data);\r\n        worksheet.getRow(1).eachCell((cell) => {\r\n            cell.font = { bold: true };\r\n            cell.fill = {\r\n                type: \"pattern\",\r\n                pattern: \"solid\",\r\n                fgColor: { argb: \"F08080\" },\r\n            };\r\n        });\r\n\r\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\r\n        res.setHeader(\"Content-Disposition\", `attachment; brandid.xlsx`);\r\n\r\n        return workbook.xlsx.write(res).then(() => {\r\n            res.status(200);\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst csvToJson = async (req, res) => {\r\n    try {\r\n        vendorIds = {};\r\n        categoryIds = {};\r\n        colorIds = {};\r\n        let csvUrl = await uploadFile(req.files.csv);\r\n        let resJson = [];\r\n        await csv2json()\r\n            .fromStream(request.get(csvUrl))\r\n            .subscribe((json) => {\r\n                if (json[\"Product Name\"] !== \"\") {\r\n                    resJson.push(json);\r\n                }\r\n            });\r\n        let productData = {\r\n            vendor_id: \"\",\r\n            product_name: \"\",\r\n            sku_code: \"\",\r\n            hsn_code: \"\",\r\n            brandId: \"\",\r\n            color_id: \"\",\r\n            categoryId: \"\",\r\n            subCatId: \"\",\r\n            lotSizeQty: \"\",\r\n            mrp: \"\",\r\n            gst: \"\",\r\n            seller_price: \"\",\r\n            qty_in_hand: \"\",\r\n            min_order_qty: \"\",\r\n            sole: \"\",\r\n            material: \"\",\r\n            packing_type: \"\",\r\n            made_in: \"\",\r\n            weight: \"\",\r\n            description: \"\",\r\n        };\r\n        let productDataArr = [];\r\n        let vendorArr = [];\r\n        for (let Obj of resJson) {\r\n            if (Obj[\"Vendor ID\"] !== undefined) {\r\n                productData.vendor_id = Obj[\"Vendor ID\"];\r\n            }\r\n            if (Obj[\"Product Name\"] !== undefined) {\r\n                productData.product_name = Obj[\"Product Name\"];\r\n            }\r\n            if (Obj[\"SKU CODE\"] !== undefined) {\r\n                productData.sku_code = Obj[\"SKU CODE\"];\r\n            }\r\n            if (Obj[\"HSN CODE\"] !== undefined) {\r\n                productData.hsn_code = Obj[\"HSN CODE\"];\r\n            }\r\n            if (Obj[\"Brand ID\"] !== undefined) {\r\n                productData.brandId = Obj[\"Brand ID\"];\r\n            }\r\n            if (Obj[\"Category ID\"] !== undefined) {\r\n                productData.categoryId = Obj[\"Category ID\"];\r\n            }\r\n            if (Obj[\"Sub Category ID\"] !== undefined) {\r\n                productData.subCatId = Obj[\"Sub Category ID\"];\r\n            }\r\n            if (Obj[\"Color ID\"] !== undefined) {\r\n                productData.color_id = Obj[\"Color ID\"].split(\",\").flatMap((el) => {\r\n                    if (el !== \"\" && el !== \" \") {\r\n                        return el.trim();\r\n                    }\r\n                    return [];\r\n                });\r\n            }\r\n            if (Obj[\"Lot Size\"] !== undefined) {\r\n                productData.lotSizeQty = Obj[\"Lot Size\"].split(\",\").flatMap((el) => {\r\n                    if (el !== \"\" && el !== \" \") {\r\n                        return el.trim();\r\n                    }\r\n                    return [];\r\n                });\r\n            }\r\n            if (Obj[\"MRP\"] !== undefined) {\r\n                productData.mrp = Number(Obj[\"MRP\"]);\r\n            }\r\n            if (Obj[\"GST\"] !== undefined) {\r\n                productData.gst = Number(Obj[\"GST\"]);\r\n            }\r\n            if (Obj[\"Seller Price\"] !== undefined) {\r\n                productData.seller_price = Number(Obj[\"Seller Price\"]);\r\n            }\r\n            if (Obj[\"Margin\"] !== undefined) {\r\n                productData.margin = Number(Obj[\"Margin\"]);\r\n            }\r\n            if (Obj[\"Selling GST\"] !== undefined) {\r\n                productData.sellingGST = Number(Obj[\"Selling GST\"]);\r\n            }\r\n            if (Obj[\"In Hand QTY\"] !== undefined) {\r\n                productData.qty_in_hand = Number(Obj[\"In Hand QTY\"]);\r\n            }\r\n            if (Obj[\"Min Order QTY\"] !== undefined) {\r\n                productData.min_order_qty = Number(Obj[\"Min Order QTY\"]);\r\n            }\r\n            if (Obj[\"Sole\"] !== undefined) {\r\n                productData.sole = Obj[\"Sole\"];\r\n            }\r\n            if (Obj[\"Material\"] !== undefined) {\r\n                productData.material = Obj[\"Material\"];\r\n            }\r\n            if (Obj[\"Packing Type\"] !== undefined) {\r\n                productData.packing_type = Obj[\"Packing Type\"];\r\n            }\r\n            if (Obj[\"Made In\"] !== undefined) {\r\n                productData.made_in = Obj[\"Made In\"];\r\n            }\r\n            if (Obj[\"Weight\"] !== undefined) {\r\n                productData.weight = Obj[\"Weight\"];\r\n            }\r\n            if (Obj[\"Description\"] !== undefined) {\r\n                productData.description = Obj[\"Description\"];\r\n            }\r\n            if (Obj[\"Thumbnail URL\"] !== undefined) {\r\n                productData.thumbnail_pic = Obj[\"Thumbnail URL\"];\r\n            }\r\n            if (Obj[\"Multiple Images\"] !== undefined) {\r\n                productData.multiple_pics = Obj[\"Multiple Images\"].split(\",\").map((el) => el.trim());\r\n            }\r\n            if (req.userModel === \"VENDOR\") {\r\n                productData.vendor_id = req.userId;\r\n            }\r\n            let statusX = await checkProductIds(req, res, productData);\r\n            if (statusX.status) {\r\n                if (req.userModel === \"ADMIN\") {\r\n                    if (vendorArr.indexOf(statusX.vendorId) === -1) {\r\n                        vendorArr.push(statusX.vendorId);\r\n                    }\r\n                    productData.vendor_id = statusX.vendorId;\r\n                    productData.status = \"Approved\";\r\n                }\r\n            } else {\r\n                return res.status(400).send({ status: false, message: statusX.message });\r\n            }\r\n\r\n            productDataArr.push(productData);\r\n            productData = {\r\n                vendor_id: \"\",\r\n                product_name: \"\",\r\n                sku_code: \"\",\r\n                hsn_code: \"\",\r\n                brandId: \"\",\r\n                color_id: \"\",\r\n                categoryId: \"\",\r\n                subCatId: \"\",\r\n                lotSizeQty: \"\",\r\n                mrp: \"\",\r\n                gst: \"\",\r\n                seller_price: \"\",\r\n                qty_in_hand: \"\",\r\n                min_order_qty: \"\",\r\n                sole: \"\",\r\n                material: \"\",\r\n                packing_type: \"\",\r\n                made_in: \"\",\r\n                weight: \"\",\r\n                description: \"\",\r\n                thumbnail_pic: \"\",\r\n                multiple_pics: [],\r\n            };\r\n            if (req.userModel === \"ADMIN\") {\r\n                productData.margin = \"\";\r\n                productData.sellingGST = \"\";\r\n            }\r\n        }\r\n        if (req.userModel === \"ADMIN\") {\r\n            let newProductObj = await productModel.insertMany(productDataArr);\r\n            let arr = [];\r\n            for (let vdr of vendorArr) {\r\n                let x = await vendorModel.findById(vdr);\r\n                arr.push(x);\r\n            }\r\n            for (let prdct of newProductObj) {\r\n                let obj = arr.find((e) => e._id.toString() === prdct.vendor_id.toString());\r\n                if (obj) {\r\n                    obj.products.push(prdct);\r\n                }\r\n            }\r\n            for (let vdr of arr) {\r\n                await vdr.save();\r\n            }\r\n        } else {\r\n            let vendorObj = await vendorModel.findById(req.userId);\r\n            let newProductObj = await productModel.insertMany(productDataArr);\r\n            vendorObj.products.push(...newProductObj);\r\n            await vendorObj.save();\r\n        }\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Bulk Product Added Successfully\",\r\n            data: { categoryIds, colorIds, vendorIds },\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst exportOrderReport = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let orders = await orderModel\r\n            .find({ _id: { $in: data } })\r\n            .populate([\r\n                \"vendorId\",\r\n                \"payment_id\",\r\n                \"order_status_id\",\r\n                \"ordered_products\",\r\n                \"purchaseInvoice\",\r\n                \"saleInvoice\",\r\n                { path: \"CouponCode\", strictPopulate: false },\r\n                { path: \"customer_id\", model: \"Customer\", strictPopulate: false, populate: { path: \"defaultAddress\", model: \"CustomerAddress\", strictPopulate: false } },\r\n            ]);\r\n        let ordersArr = [];\r\n        let orderData = {};\r\n        let productLength = 0;\r\n\r\n        for (let order of orders) {\r\n            orderData[\"orderId\"] = order.orderId;\r\n            orderData[\"orderDate\"] = dateToLocalDateTime(order.order_date);\r\n            orderData[\"invoiceNo\"] = order.saleInvoice ? order.saleInvoice.invoiceNo : \"\";\r\n            orderData[\"invoiceDate\"] = order.saleInvoice ? dateToLocalDateTime(order.saleInvoice.invoiceDate) : \"\";\r\n            orderData[\"productsLength\"] = order.ordered_products ? order.ordered_products.products.length : \"\";\r\n            if (order.ordered_products && order.ordered_products.products.length > productLength) {\r\n                productLength = order.ordered_products.products.length;\r\n            }\r\n            if (order.ordered_products) {\r\n                for (let x1 = 0; x1 < order.ordered_products.products.length; x1++) {\r\n                    orderData[`sale_sku_code_${x1 + 1}`] = order.ordered_products.products[x1].skuCode;\r\n                    orderData[`purchase_sku_code_${x1 + 1}`] = order.ordered_products.products[x1].skuCode;\r\n                    orderData[`sale_lotSize_${x1 + 1}`] = order.ordered_products.products[x1].lotSize;\r\n                    orderData[`purchase_lotSize_${x1 + 1}`] = order.ordered_products.products[x1].lotSize;\r\n                    orderData[`sale_gst_percentage_${x1 + 1}`] = order.ordered_products.products[x1].selling_gst;\r\n                    orderData[`purchase_gst_percentage_${x1 + 1}`] = order.ordered_products.products[x1].seller_gst;\r\n                }\r\n            }\r\n            orderData[\"soldByGst\"] = order.saleInvoice ? order.saleInvoice.soldBy.gst : \"\";\r\n            orderData[\"customerName\"] = order.customer_id.name;\r\n            orderData[\"customerPhone\"] = order.customer_id.phone;\r\n            orderData[\"customerAddress\"] = order.customer_id.defaultAddress.address;\r\n            orderData[\"customerCity\"] = order.customer_id.defaultAddress.city;\r\n            orderData[\"customerState\"] = order.customer_id.defaultAddress.state;\r\n            orderData[\"customerPincode\"] = order.customer_id.defaultAddress.pincode;\r\n            orderData[\"customerGstNo\"] = order.customer_id.gstNo;\r\n            orderData[\"customerAltPhone\"] = order.customer_id.alternate_phone;\r\n            orderData[\"saleGrandTotal\"] = order.grand_total;\r\n            orderData[\"saleInvGrandTotal\"] = order.grand_total;\r\n            orderData[\"saleDiscount\"] = order.discounted_amount;\r\n            orderData[\"saleNetTotal\"] = Number(order.grand_total) - Number(order.discounted_amount);\r\n            orderData[\"saleTaxableAmt\"] = order.total;\r\n            orderData[\"saleGstType\"] = order.saleInvoice ? order.saleInvoice.gstType : \"\";\r\n            orderData[\"saleGstAmt\"] = order.GST_amount;\r\n            orderData[\"sellerName\"] = order.vendorId.representativeName;\r\n            orderData[\"sellerPhone\"] = order.vendorId.mobileNo;\r\n            orderData[\"sellerAddress\"] = order.vendorId.pickupAddress;\r\n            orderData[\"sellerCity\"] = order.vendorId.pickupCity;\r\n            orderData[\"sellerState\"] = order.vendorId.pickupState;\r\n            orderData[\"sellerPincode\"] = order.vendorId.pickupPincode;\r\n            orderData[\"sellerGstNo\"] = order.vendorId.gstNo;\r\n            orderData[\"sellerAltNo\"] = order.vendorId.altMobileNo;\r\n            orderData[\"purchaseGrandTotal\"] = order.vendorAmtInfo.grandTotal;\r\n            orderData[\"purchaseInvGrandTotal\"] = order.vendorAmtInfo.grandTotal;\r\n            orderData[\"purchaseNetTotal\"] = order.vendorAmtInfo.grandTotal;\r\n            orderData[\"purchaseTaxableAmt\"] = order.vendorAmtInfo.total;\r\n            orderData[\"purchaseGstType\"] = order.purchaseInvoice ? order.purchaseInvoice.gstType : \"\";\r\n            orderData[\"purchaseGstAmt\"] = order.vendorAmtInfo.gstAmt;\r\n            orderData[\"orderJourneyFinalStatus\"] = order.order_status_id.status;\r\n            for (let orderStatusList of order.order_status_id.statusList) {\r\n                let actionTakenBy = \"\";\r\n                let updatedDate = dateToLocalDateTime(orderStatusList.updatedAt);\r\n                if (orderStatusList.updatedBy.admin) actionTakenBy = \"ADMIN\";\r\n                if (orderStatusList.updatedBy.vendor) actionTakenBy = \"SELLER\";\r\n                orderData[orderStatusList.status] = `${updatedDate} | ${actionTakenBy}`;\r\n            }\r\n            ordersArr.push(orderData);\r\n            orderData = {};\r\n        }\r\n        var workbook = new excelJs.Workbook();\r\n        var worksheet = workbook.addWorksheet(\"Order Report\");\r\n        let orderCol = [\r\n            { header: \"Order ID\", key: \"orderId\" },\r\n            { header: \"Order date and time\", key: \"orderDate\" },\r\n            { header: \"Invoice No\", key: \"invoiceNo\" },\r\n            { header: \"Invoice date\", key: \"invoiceDate\" },\r\n            { header: \"Order Quantity\", key: \"productsLength\" },\r\n            { header: \"factorEz GST\", key: \"soldByGst\" },\r\n            { header: \"STATE\", key: \"orderStatus\" },\r\n        ];\r\n        let buyerCol = [\r\n            { header: \"Buyer Name\", key: \"customerName\" },\r\n            { header: \"Buyer Phone Number\", key: \"customerPhone\" },\r\n            { header: \"Full Address\", key: \"customerAddress\" },\r\n            { header: \"Buyer City\", key: \"customerCity\" },\r\n            { header: \"Buyer State\", key: \"customerState\" },\r\n            { header: \"Pincode\", key: \"customerPincode\" },\r\n            { header: \"Gst No.\", key: \"customerGstNo\" },\r\n            { header: \"alternative phone\", key: \"customerAltPhone\" },\r\n        ];\r\n        let saleCol = [\r\n            { header: \"Total Amount\", key: \"saleGrandTotal\" },\r\n            { header: \"Discount\", key: \"saleDiscount\" },\r\n            { header: \"Final amount/ sales\", key: \"saleNetTotal\" },\r\n            { header: \"Invoice Value\", key: \"saleInvGrandTotal\" },\r\n            { header: \"Taxable value\", key: \"saleTaxableAmt\" },\r\n            { header: \"Gst Type\", key: \"saleGstType\" },\r\n            { header: \"Gst amount\", key: \"saleGstAmt\" },\r\n        ];\r\n        let sellerCol = [\r\n            { header: \"Seller name\", key: \"sellerName\" },\r\n            { header: \"Seller phone Number\", key: \"sellerPhone\" },\r\n            { header: \"Full Address\", key: \"sellerAddress\" },\r\n            { header: \"Seller City\", key: \"sellerCity\" },\r\n            { header: \"Seller State\", key: \"sellerState\" },\r\n            { header: \"Pincode\", key: \"sellerPincode\" },\r\n            { header: \"Gst No.\", key: \"sellerGstNo\" },\r\n            { header: \"alternative phone\", key: \"sellerAltNo\" },\r\n        ];\r\n        let purchaseCol = [\r\n            { header: \"Total Amount\", key: \"purchaseGrandTotal\" },\r\n            { header: \"Seller Discount\", key: \"purchaseDiscount\" },\r\n            { header: \"Final amount/ purchase\", key: \"purchaseNetTotal\" },\r\n            { header: \"invoice value\", key: \"purchaseInvGrandTotal\" },\r\n            { header: \"Taxable value\", key: \"purchaseTaxableAmt\" },\r\n            { header: \"Gst Type\", key: \"purchaseGstType\" },\r\n            { header: \"Gst amount\", key: \"purchaseGstAmt\" },\r\n        ];\r\n        let orderJourney = [\r\n            { header: \"Final Status\", key: \"orderJourneyFinalStatus\" },\r\n            { header: \"Delivered\", key: \"DELIVERED\" },\r\n            { header: \"Out For Delivery\", key: \"OUT_FOR_DELIVERY\" },\r\n            { header: \"Return delivered to seller/warehouse\", key: \"RETURNED_RTO_DELIVERED\" },\r\n            { header: \"Return\", key: \"RETURNED\" },\r\n            { header: \"Pickup-done/In transit\", key: \"PICKUP_DONE\" },\r\n            { header: \"Pickup-Aligned\", key: \"PICKUP_ALIGNED\" },\r\n            { header: \"Ready to dispatch\", key: \"READY_TO_DISPATCH\" },\r\n            { header: \"Confirmed/in-process\", key: \"CONFIRMED\" },\r\n            { header: \"cancelled\", key: \"CANCELLED\" },\r\n            { header: \"Remarks\", key: \"remarks\" },\r\n        ];\r\n        for (let m = 0; m < productLength; m++) {\r\n            let saleSkuCol = { header: `SKU code ${m + 1}`, key: `sale_sku_code_${m + 1}` };\r\n            let purchaseSkuCol = { header: `SKU code ${m + 1}`, key: `purchase_sku_code_${m + 1}` };\r\n            let saleGstCol = { header: `GST percentage ${m + 1}`, key: `sale_gst_percentage_${m + 1}` };\r\n            let purchaseGstCol = { header: `GST percentage ${m + 1}`, key: `purchase_gst_percentage_${m + 1}` };\r\n            let saleLotSizeCol = { header: `Lot Set/Size set ${m + 1}`, key: `sale_lotSize_${m + 1}` };\r\n            let purchaseLotSizeCol = { header: `Lot Set/Size set ${m + 1}`, key: `purchase_lotSize_${m + 1}` };\r\n            saleCol.push(saleSkuCol, saleLotSizeCol, saleGstCol);\r\n            purchaseCol.push(purchaseSkuCol, purchaseLotSizeCol, purchaseGstCol);\r\n        }\r\n        let columnData = [...orderCol, ...buyerCol, ...saleCol, ...sellerCol, ...purchaseCol, ...orderJourney];\r\n        worksheet.columns = columnData;\r\n        for (let x of ordersArr) {\r\n            worksheet.addRow(x);\r\n        }\r\n        let orderLen = orderCol.length;\r\n        let buyerLen = buyerCol.length + orderLen;\r\n        let saleLen = saleCol.length + buyerLen;\r\n        let sellerLen = sellerCol.length + saleLen;\r\n        let purchaseLen = purchaseCol.length + sellerLen;\r\n        let orderJLen = orderJourney.length + purchaseLen;\r\n        worksheet.getRow(1).height = 20;\r\n        worksheet.getRow(1).eachCell((cell, colNum) => {\r\n            cell.border = {\r\n                top: { style: \"thin\" },\r\n                right: { style: \"thin\" },\r\n                bottom: { style: \"thin\" },\r\n                left: { style: \"thin\" },\r\n            };\r\n            cell.font = { bold: true };\r\n            if (colNum <= orderLen) {\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"d7ff38\" },\r\n                };\r\n            } else if (colNum <= buyerLen) {\r\n                cell.font = { color: { argb: \"ffffff\" } };\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"2e397d\" },\r\n                };\r\n            } else if (colNum <= saleLen) {\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"cad1fa\" },\r\n                };\r\n            } else if (colNum <= sellerLen) {\r\n                cell.font = { color: { argb: \"ffffff\" } };\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"556b58\" },\r\n                };\r\n            } else if (colNum <= purchaseLen) {\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"07f027\" },\r\n                };\r\n            } else {\r\n                cell.font = { color: { argb: \"ffffff\" } };\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"288a70\" },\r\n                };\r\n            }\r\n        });\r\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\r\n        res.setHeader(\"Content-Disposition\", `attachment; orderReport.xlsx`);\r\n        return workbook.xlsx.write(res).then(() => {\r\n            res.status(200);\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { exportProductAddDemoSheet, exportIDs, csvToJson, exportOrderReport };\r\n","const HomepageModel = require(\"../models/HomepageModel\");\r\n\r\nconst addFeaturedProducts = async (req, res) => {\r\n    try {\r\n        let { newArrival, featuredProduct, bestSelling } = req.body;\r\n        let home = await HomepageModel.find();\r\n        if (home.length > 0) {\r\n            if (featuredProduct) {\r\n                if (!home[0].featuredProduct.includes(featuredProduct)) {\r\n                    home[0].featuredProduct.push(featuredProduct);\r\n                }\r\n            }\r\n            if (newArrival) {\r\n                if (!home[0].newArrival.includes(newArrival)) {\r\n                    home[0].newArrival.push(newArrival);\r\n                }\r\n            }\r\n            if (bestSelling) {\r\n                if (!home[0].bestSelling.includes(bestSelling)) {\r\n                    home[0].bestSelling.push(bestSelling);\r\n                }\r\n            }\r\n            await home[0].save();\r\n        } else {\r\n            let data = {};\r\n            if (featuredProduct) {\r\n                data.featuredProduct = featuredProduct;\r\n            }\r\n            if (newArrival) {\r\n                data.newArrival = newArrival;\r\n            }\r\n            if (bestSelling) {\r\n                data.bestSelling = bestSelling;\r\n            }\r\n            await HomepageModel.create(data);\r\n        }\r\n\r\n        return res.status(200).send({ status: true, message: \"Product Added to respective sections...\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst getFeaturedProduct = async (req, res) => {\r\n    try {\r\n        let products = await HomepageModel.find().populate([\r\n            { path: \"featuredProduct\", model: \"Product\", populate: { path: \"vendor_id\", model: \"Vendor\" } },\r\n            { path: \"bestSelling\", model: \"Product\", populate: { path: \"vendor_id\", model: \"Vendor\" } },\r\n            { path: \"newArrival\", model: \"Product\", populate: { path: \"vendor_id\", model: \"Vendor\" } },\r\n        ]);\r\n        return res.status(200).send({ status: true, message: \"fetched...\", data: products[0] ? products[0] : null });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst removeFeaturedProduct = async (req, res) => {\r\n    try {\r\n        let { key, id } = req.body;\r\n        let home = await HomepageModel.find();\r\n        if (home.length > 0) {\r\n            if (key === \"featuredProduct\") {\r\n                let idx = home[0].featuredProduct.findIndex((e) => e._id.toString() === id);\r\n                if (idx >= 0) {\r\n                    home[0].featuredProduct.splice(idx, 1);\r\n                }\r\n            }\r\n            if (key === \"bestSelling\") {\r\n                let idx = home[0].bestSelling.findIndex((e) => e._id.toString() === id);\r\n                if (idx >= 0) {\r\n                    home[0].bestSelling.splice(idx, 1);\r\n                }\r\n            }\r\n            if (key === \"newArrival\") {\r\n                let idx = home[0].newArrival.findIndex((e) => e._id.toString() === id);\r\n                if (idx >= 0) {\r\n                    home[0].newArrival.splice(idx, 1);\r\n                }\r\n            }\r\n            await home[0].save();\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Removed...\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addFeaturedProducts,\r\n    getFeaturedProduct,\r\n    removeFeaturedProduct,\r\n};\r\n","// Generate Random ID of given length\r\nfunction generateRandomID(length, preFix) {\r\n    let id = preFix ? preFix : '';\r\n    const digits = \"0123456789\";\r\n    for (let i = 0; i < length - 5; i++) {\r\n        const randomIndex = Math.floor(Math.random() * digits.length);\r\n        id += digits[randomIndex];\r\n    }\r\n    id += Date.now().toString().slice(8);\r\n    return id;\r\n}\r\n\r\n// Generate Random AlphaNumeric ID of given length\r\nfunction generateRandomAlphaNumericID(length) {\r\n    let id = \"\";\r\n    const characters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n\r\n    for (let i = 0; i < length; i++) {\r\n        const randomIndex = Math.floor(Math.random() * characters.length);\r\n        id += characters[randomIndex];\r\n    }\r\n    return id;\r\n}\r\n\r\nmodule.exports = { generateRandomID, generateRandomAlphaNumericID };\r\n","const express = require(\"express\");\r\nconst { initializeApp } = require(\"firebase/app\");\r\nconst { getStorage, ref, getDownloadURL, uploadBytesResumable } = require(\"firebase/storage\");\r\nconst aws = require(\"aws-sdk\");\r\nrequire(\"aws-sdk/lib/maintenance_mode_message\").suppress = true;\r\nconst config = require(\"../middlewares/firebase\");\r\nconst { awsS3Bucket, awsAccessKey, awsSecretKey, awsS3Region } = require(\"../middlewares/config\");\r\n//Initialize a firebase application\r\ninitializeApp(config.firebaseConfig);\r\n\r\n// Initialize Cloud Storage and get a reference to the service\r\nconst storage = getStorage();\r\nconst uploadImage = async (blobFile) => {\r\n    const dateTime = giveCurrentDateTime();\r\n    const storageRef = ref(storage, `files/${dateTime.toString().replace(\" \", \"_\") + \"_\" + blobFile.name.replace(\" \", \"_\")}`);\r\n\r\n    // // Create file metadata including the content type\r\n    const metadata = {\r\n        contentType: blobFile.mimetype,\r\n    };\r\n\r\n    // // Upload the file in the bucket storage\r\n    const snapshot = await uploadBytesResumable(storageRef, blobFile.data, metadata);\r\n    //by using uploadBytesResumable we can control the progress of uploading like pause, resume, cancel\r\n\r\n    // Grab the public url\r\n    const downloadURL = await getDownloadURL(snapshot.ref);\r\n    return {\r\n        message: \"file uploaded to firebase storage\",\r\n        name: snapshot.metadata.name,\r\n        type: blobFile.mimetype,\r\n        imageURL: downloadURL,\r\n    };\r\n};\r\n\r\nconst giveCurrentDateTime = () => {\r\n    const today = new Date();\r\n    const date = today.getFullYear() + \"-\" + (today.getMonth() + 1) + \"-\" + today.getDate();\r\n    const time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\r\n    const dateTime = date + \" \" + time;\r\n    return dateTime;\r\n};\r\n\r\naws.config.update({\r\n    accessKeyId: awsAccessKey,\r\n    secretAccessKey: awsSecretKey,\r\n    region: awsS3Region,\r\n});\r\n\r\nlet uploadFile = async (image) => {\r\n    return new Promise(function (resolve, reject) {\r\n        let s3 = new aws.S3();\r\n        const dateTime = giveCurrentDateTime();\r\n        var uploadParams = {\r\n            Bucket: awsS3Bucket,\r\n            Key: \"images/\" + dateTime.toString().replace(\" \", \"_\") + \"_\" + image.name.replace(\" \", \"_\"),\r\n            Body: image.data,\r\n            ContentType: image.mimetype,\r\n        };\r\n        s3.upload(uploadParams, function (err, data) {\r\n            if (err) {\r\n                return reject({ error: err });\r\n            }\r\n            return resolve(data.Location);\r\n        });\r\n    });\r\n};\r\n\r\nmodule.exports = { uploadImage, uploadFile };\r\n","const customerModel = require(\"../models/customerModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst businessModel = require(\"../models/businessModel\");\r\nconst invoiceModel = require(\"../models/invoiceModel\");\r\nconst invoiceNoModel = require(\"../models/invoiceNoModel\");\r\nconst customerAddressModel = require(\"../models/customerAddressModel\");\r\nconst orderedProductModel = require(\"../models/orderedProductModel\");\r\nconst { generatePdf } = require(\"../utils/generatePdf\");\r\nconst { dateToLocalDateTime } = require(\"../utils/dateUtils\");\r\nconst { financialYear } = require(\"../utils/getFinancialYear\");\r\n\r\nconst generatePurchaseInvoice = async (data) => {\r\n    try {\r\n        let { vendor_id, order_id, gstAmount, totalAmount } = data;\r\n        let vendor = await vendorModel.findById(vendor_id);\r\n        let business = await businessModel.find();\r\n        if (business.length === 0 || !business[0].defaultGST) {\r\n            return { status: false, err: \"Default gst not found\" };\r\n        }\r\n\r\n        let invNo = await invoiceNoModel.findOne({ invoiceNoType: \"PURCHASE\" });\r\n        let fY = financialYear();\r\n        if (!invNo) {\r\n            invNo = await invoiceNoModel.create({\r\n                invoiceNo: 1,\r\n                invoiceYear: fY,\r\n                invoiceNoLength: 6,\r\n                invoiceNoType: \"PURCHASE\",\r\n            });\r\n        }\r\n        if (Number(fY) !== invNo.invoiceYear) {\r\n            invNo.invoiceNo = 1;\r\n            invNo.invoiceYear = fY;\r\n        }\r\n        let strInvNumber = \"0000000000\" + invNo.invoiceNo;\r\n        let invNumber = `FPIN${invNo.invoiceYear}${strInvNumber.substring(strInvNumber.length - invNo.invoiceNoLength)}`;\r\n        invNo.invoiceNo += 1;\r\n        let generateDate = new Date();\r\n        let invData = {\r\n            invoiceNo: invNumber,\r\n            invoiceDate: generateDate,\r\n            vendor_id,\r\n            order_id,\r\n            gstAmount: gstAmount.toFixed(2),\r\n            totalAmount: totalAmount.toFixed(2),\r\n            invoiceType: \"PURCHASE\",\r\n        };\r\n        if (vendor.gstNo.substring(0, 2) === business[0].defaultGST.gstNo.substring(0, 2)) {\r\n            invData.gstType = \"CGST_SGST\";\r\n        } else {\r\n            invData.gstType = \"IGST\";\r\n        }\r\n\r\n        invData.soldBy = {\r\n            name: vendor.firmName,\r\n            address: vendor.invoiceAddress,\r\n            phone: vendor.mobileNo,\r\n            gst: vendor.gstNo,\r\n        };\r\n\r\n        invData.shippingAddress = {\r\n            name: business[0].business_name,\r\n            address: business[0].defaultGST.pickupAddress,\r\n            phone: business[0].contactNo,\r\n            gst: business[0].defaultGST.gstNo,\r\n        };\r\n        invData.billingAddress = {\r\n            name: business[0].business_name,\r\n            address: business[0].defaultGST.pickupAddress,\r\n            phone: business[0].contactNo,\r\n            gst: business[0].defaultGST.gstNo,\r\n        };\r\n        let invRes = await invoiceModel.create(invData);\r\n        await invNo.save();\r\n        return { status: true, invoice: invRes };\r\n    } catch (err) {\r\n        return { status: false, err: err };\r\n    }\r\n};\r\nconst generateSaleInvoice = async (data) => {\r\n    try {\r\n        let { customer_id, order_id, gstAmount, totalAmount, address } = data;\r\n        let customer = await customerModel.findById(customer_id);\r\n        let business = await businessModel.find();\r\n        if (business.length === 0 || !business[0].defaultGST) {\r\n            return { status: false, err: \"Default gst not found\" };\r\n        }\r\n\r\n        let invNo = await invoiceNoModel.findOne({ invoiceNoType: \"SALE\" });\r\n        let fY = financialYear();\r\n        if (!invNo) {\r\n            invNo = await invoiceNoModel.create({\r\n                invoiceNo: 1,\r\n                invoiceYear: fY,\r\n                invoiceNoLength: 6,\r\n                invoiceNoType: \"SALE\",\r\n            });\r\n        }\r\n        if (Number(fY) !== invNo.invoiceYear) {\r\n            invNo.invoiceNo = 1;\r\n            invNo.invoiceYear = fY;\r\n        }\r\n        let strInvNumber = \"0000000000\" + invNo.invoiceNo;\r\n        let invNumber = `FSIN${invNo.invoiceYear}${strInvNumber.substring(strInvNumber.length - invNo.invoiceNoLength)}`;\r\n        invNo.invoiceNo += 1;\r\n        let generateDate = new Date();\r\n        let invData = {\r\n            invoiceNo: invNumber,\r\n            invoiceDate: generateDate,\r\n            customer_id,\r\n            order_id,\r\n            gstAmount: gstAmount.toFixed(2),\r\n            totalAmount: totalAmount.toFixed(2),\r\n            invoiceType: \"SALE\",\r\n        };\r\n\r\n        if (customer.defaultAddress.stateCode === business[0].defaultGST.gstNo.substring(0, 2)) {\r\n            invData.gstType = \"CGST_SGST\";\r\n        } else {\r\n            invData.gstType = \"IGST\";\r\n        }\r\n        invData.soldBy = {\r\n            name: business[0].business_name,\r\n            address: business[0].defaultGST.pickupAddress,\r\n            phone: business[0].contactNo,\r\n            gst: business[0].defaultGST.gstNo,\r\n        };\r\n        invData.shippingAddress = {\r\n            name: customer.name,\r\n            address: address.address,\r\n            phone: customer.phone,\r\n            gst: customer.gstNo,\r\n        };\r\n        invData.billingAddress = {\r\n            name: customer.name,\r\n            address: address.address,\r\n            phone: customer.phone,\r\n            gst: customer.gstNo,\r\n        };\r\n        let invRes = await invoiceModel.create(invData);\r\n\r\n        await invNo.save();\r\n        return { status: true, invoice: invRes };\r\n    } catch (err) {\r\n        return { status: false, err: err };\r\n    }\r\n};\r\n\r\nconst getAllSaleInvoice = async (req, res) => {\r\n    try {\r\n        let userType = req.userModel;\r\n        let invoices = null;\r\n        if (userType === \"ADMIN\") {\r\n            invoices = await invoiceModel.find({ invoiceType: \"SALE\" });\r\n        } else {\r\n            invoices = await invoiceModel.find({ invoiceType: \"PURCHASE\" });\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Invoice fetched successfully...\", data: invoices });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst getAllPurchaseInvoice = async (req, res) => {\r\n    try {\r\n        let invoices = [];\r\n        if (req.userModel === \"ADMIN\") {\r\n            invoices = await invoiceModel.find({ invoiceType: \"PURCHASE\" });\r\n        }\r\n        if (req.userModel === \"VENDOR\") {\r\n            invoices = await invoiceModel.find({ invoiceType: \"PURCHASE\", vendor_id: req.userId });\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Invoice fetched successfully...\", data: invoices });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst data = {\r\n    logo: \"\",\r\n    brandName: \"\",\r\n    soldBy: \"\",\r\n    soldByAddress: \"\",\r\n    soldByGst: \"\",\r\n    invoiceNo: \"\",\r\n    orderId: \"\",\r\n    orderDate: \"\",\r\n    invoiceDate: \"\",\r\n    billToName: \"\",\r\n    billToAddress: \"\",\r\n    billToPhone: \"\",\r\n    billToGST: \"\",\r\n    shipToName: \"\",\r\n    shipToAddress: \"\",\r\n    shipToPhone: \"\",\r\n    shipToGST: \"\",\r\n    tableRow: [],\r\n    totalAmt: \"\",\r\n    totalCGSTAmt: \"\",\r\n    totalSGSTAmt: \"\",\r\n    totalIGSTAmt: \"\",\r\n    taxableAmt: \"\",\r\n    totalTaxAmt: \"\",\r\n    grossTotalAmt: \"\",\r\n    discountAmt: \"\",\r\n    netPayableAmount: \"\",\r\n};\r\ndata.tableRow = [\r\n    {\r\n        sno: \"1\",\r\n        productName: \"Demo Product 1\",\r\n        color: \"Black\",\r\n        sizeSet: \"5/2 7/2 8/2 9/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"5\",\r\n        rate: \"800\",\r\n        total: \"4000\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"480\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"480\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"2\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"3\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"4\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"5\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"6\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"7\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"8\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"9\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"10\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"11\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"12\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"13\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"14\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"15\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n];\r\ndata.logo = \"https://upload.wikimedia.org/wikipedia/commons/b/b6/Image_created_with_a_mobile_phone.png\";\r\ndata.brandName = \"Shoes House\";\r\ndata.soldBy = \"Mohit Shoes\";\r\ndata.soldByAddress = \"Vinayak logistic Park, Village Hinaura,hasanganj, Unnao-209859, Uttar Pradesh, Lucknow, UTTAR PRADESH, India - 209859, IN-UP\";\r\ndata.soldByGst = \"07AABCU9603R1ZX\";\r\ndata.invoiceNo = \"FSIN2300000007\";\r\n\r\nconst downoadInvoiceByInvoiceNumber = async (req, res) => {\r\n    try {\r\n        let invoiceNumber = req.params.invoicenumber;\r\n        let invoicetype = req.params.invoicetype;\r\n\r\n        let invoice = await invoiceModel.findOne({ invoiceNo: invoiceNumber }).populate(\"order_id\");\r\n        if (!invoice) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (invoicetype === \"PURCHASE\" && !invoice.vendor_id) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let orderedProduct = await orderedProductModel.findOne({ order_id: invoice.order_id }).populate({ path: \"products.product_id\", model: \"Product\" });\r\n        if (!orderedProduct) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let business = await businessModel.find();\r\n        if (business.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (invoicetype === \"PURCHASE\") {\r\n            let invData = {\r\n                logo: business[0].invoiceLogo,\r\n                brandName: business[0].business_name,\r\n                soldBy: invoice.soldBy.name,\r\n                soldByAddress: invoice.soldBy.address,\r\n                soldByPhone: invoice.soldBy.phone,\r\n                soldByGst: invoice.soldBy.gst,\r\n                invoiceNo: invoiceNumber,\r\n                orderId: invoice.order_id.orderId,\r\n                orderDate: dateToLocalDateTime(invoice.order_id.order_date),\r\n                invoiceDate: dateToLocalDateTime(invoice.invoiceDate),\r\n                billToName: invoice.billingAddress.name,\r\n                billToAddress: invoice.billingAddress.address,\r\n                billToPhone: invoice.billingAddress.phone,\r\n                billToGST: invoice.billingAddress.gst,\r\n                shipToName: invoice.shippingAddress.name,\r\n                shipToAddress: invoice.shippingAddress.address,\r\n                shipToPhone: invoice.shippingAddress.phone,\r\n                shipToGST: invoice.shippingAddress.gst,\r\n                tableRow: [],\r\n                totalAmt: \"\" + invoice.totalAmount,\r\n                totalCGSTAmt: \"\",\r\n                totalSGSTAmt: \"\",\r\n                totalIGSTAmt: \"\",\r\n                taxableAmt: invoice.totalAmount,\r\n                totalTaxAmt: invoice.gstAmount,\r\n                grossTotalAmt: (Number(invoice.gstAmount) + Number(invoice.totalAmount)).toFixed(2),\r\n                discountAmt: \"0\",\r\n                netPayableAmount: (Number(invoice.gstAmount) + Number(invoice.totalAmount)).toFixed(2),\r\n            };\r\n            if (invoice.soldBy.gst.substring(0, 2) === invoice.billingAddress.gst.substring(0, 2)) {\r\n                invData.totalCGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                invData.totalSGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                let count = 1;\r\n                for (let product of orderedProduct.products) {\r\n                    if (!product.isRemoved) {\r\n                        let trData = {\r\n                            sno: count,\r\n                            productName: \"\",\r\n                            color: \"\",\r\n                            sizeSet: \"\",\r\n                            hsnCode: \"\",\r\n                            qty: \"\",\r\n                            rate: \"\",\r\n                            total: \"\",\r\n                            cgstPercentage: \"\",\r\n                            cgstAmount: \"\",\r\n                            sgstPercentage: \"\",\r\n                            sgstAmount: \"\",\r\n                            igstPercentage: \"\",\r\n                            igstAmount: \"\",\r\n                        };\r\n                        count += 1;\r\n                        trData.productName = product.product_id.product_name;\r\n                        trData.color = product.color.colorName;\r\n                        trData.sizeSet = product.lotSize;\r\n                        trData.hsnCode = product.hsnCode;\r\n                        trData.qty = product.qty;\r\n                        trData.rate = product.seller_price;\r\n                        trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                        trData.cgstPercentage = Number(product.seller_gst) / 2;\r\n                        trData.cgstAmount = ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                        trData.sgstPercentage = Number(product.seller_gst) / 2;\r\n                        trData.sgstAmount = ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                        trData.igstPercentage = \"\";\r\n                        trData.igstAmount = \"\";\r\n                        invData.tableRow.push(trData);\r\n                    }\r\n                }\r\n            } else {\r\n                invData.totalIGSTAmt = invoice.gstAmount;\r\n                let count = 1;\r\n                for (let product of orderedProduct.products) {\r\n                    if (!product.isRemoved) {\r\n                        let trData = {\r\n                            sno: count,\r\n                            productName: \"\",\r\n                            color: \"\",\r\n                            sizeSet: \"\",\r\n                            hsnCode: \"\",\r\n                            qty: \"\",\r\n                            rate: \"\",\r\n                            total: \"\",\r\n                            cgstPercentage: \"\",\r\n                            cgstAmount: \"\",\r\n                            sgstPercentage: \"\",\r\n                            sgstAmount: \"\",\r\n                            igstPercentage: \"\",\r\n                            igstAmount: \"\",\r\n                        };\r\n                        count += 1;\r\n                        trData.productName = product.product_id.product_name;\r\n                        trData.color = product.color.colorName;\r\n                        trData.sizeSet = product.lotSize;\r\n                        trData.hsnCode = product.hsnCode;\r\n                        trData.qty = product.qty;\r\n                        trData.rate = product.seller_price;\r\n                        trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                        trData.cgstPercentage = \"\";\r\n                        trData.cgstAmount = \"\";\r\n                        trData.sgstPercentage = \"\";\r\n                        trData.sgstAmount = \"\";\r\n                        trData.igstPercentage = product.seller_gst;\r\n                        trData.igstAmount = \"\" + ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                        invData.tableRow.push(trData);\r\n                    }\r\n                }\r\n            }\r\n            let pdf = await generatePdf(invData, \"factorEz.com\");\r\n            res.setHeader(\"Content-Type\", \"application/pdf\");\r\n            res.setHeader(\"Content-Disposition\", \"attachment; invoice.pdf\");\r\n            return res.send(pdf);\r\n        } else {\r\n            let customerAddress = await customerAddressModel.findOne({ customerId: invoice.customer_id });\r\n            let invData = {\r\n                logo: business[0].invoiceLogo,\r\n                brandName: business[0].business_name,\r\n                soldBy: invoice.soldBy.name,\r\n                soldByAddress: invoice.soldBy.address,\r\n                soldByGst: invoice.soldBy.gst,\r\n                soldByPhone: invoice.soldBy.phone,\r\n                invoiceNo: invoiceNumber,\r\n                orderId: invoice.order_id.orderId,\r\n                orderDate: dateToLocalDateTime(invoice.order_id.order_date),\r\n                invoiceDate: dateToLocalDateTime(invoice.invoiceDate),\r\n                billToName: invoice.billingAddress.name,\r\n                billToAddress: invoice.billingAddress.address,\r\n                billToPhone: invoice.billingAddress.phone,\r\n                billToGST: invoice.billingAddress.gst,\r\n                shipToName: invoice.shippingAddress.name,\r\n                shipToAddress: invoice.shippingAddress.address,\r\n                shipToPhone: invoice.shippingAddress.phone,\r\n                shipToGST: invoice.shippingAddress.gst,\r\n                totalAmt: \"\" + invoice.totalAmount,\r\n                tableRow: [],\r\n                totalCGSTAmt: \"\",\r\n                totalSGSTAmt: \"\",\r\n                totalIGSTAmt: \"\",\r\n                taxableAmt: invoice.totalAmount,\r\n                totalTaxAmt: invoice.gstAmount,\r\n                grossTotalAmt: (Number(invoice.gstAmount) + Number(invoice.totalAmount)).toFixed(2),\r\n                discountAmt: \"\",\r\n                netPayableAmount: \"\",\r\n            };\r\n            if (invoice.billingAddress.gst) {\r\n                if (invoice.soldBy.gst.substring(0, 2) === invoice.billingAddress.gst.substring(0, 2)) {\r\n                    invData.totalCGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                    invData.totalSGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                    let count = 1;\r\n                    for (let product of orderedProduct.products) {\r\n                        if (!product.isRemoved) {\r\n                            let trData = {\r\n                                sno: count,\r\n                                productName: \"\",\r\n                                color: \"\",\r\n                                sizeSet: \"\",\r\n                                hsnCode: \"\",\r\n                                qty: \"\",\r\n                                rate: \"\",\r\n                                total: \"\",\r\n                                cgstPercentage: \"\",\r\n                                cgstAmount: \"\",\r\n                                sgstPercentage: \"\",\r\n                                sgstAmount: \"\",\r\n                                igstPercentage: \"\",\r\n                                igstAmount: \"\",\r\n                            };\r\n                            count += 1;\r\n                            trData.productName = product.product_id.product_name;\r\n                            trData.color = product.color.colorName;\r\n                            trData.sizeSet = product.lotSize;\r\n                            trData.hsnCode = product.hsnCode;\r\n                            trData.qty = product.qty;\r\n                            trData.rate = product.seller_price;\r\n                            trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                            trData.cgstPercentage = Number(product.seller_gst) / 2;\r\n                            trData.cgstAmount = ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                            trData.sgstPercentage = Number(product.seller_gst) / 2;\r\n                            trData.sgstAmount = ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                            trData.igstPercentage = \"\";\r\n                            trData.igstAmount = \"\";\r\n                            invData.tableRow.push(trData);\r\n                        }\r\n                    }\r\n                } else {\r\n                    invData.totalIGSTAmt = invoice.gstAmount;\r\n                    let count = 1;\r\n                    for (let product of orderedProduct.products) {\r\n                        if (!product.isRemoved) {\r\n                            let trData = {\r\n                                sno: count,\r\n                                productName: \"\",\r\n                                color: \"\",\r\n                                sizeSet: \"\",\r\n                                hsnCode: \"\",\r\n                                qty: \"\",\r\n                                rate: \"\",\r\n                                total: \"\",\r\n                                cgstPercentage: \"\",\r\n                                cgstAmount: \"\",\r\n                                sgstPercentage: \"\",\r\n                                sgstAmount: \"\",\r\n                                igstPercentage: \"\",\r\n                                igstAmount: \"\",\r\n                            };\r\n                            count += 1;\r\n                            trData.productName = product.product_id.product_name;\r\n                            trData.color = product.color.colorName;\r\n                            trData.sizeSet = product.lotSize;\r\n                            trData.hsnCode = product.hsnCode;\r\n                            trData.qty = product.qty;\r\n                            trData.rate = product.seller_price;\r\n                            trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                            trData.cgstPercentage = \"\";\r\n                            trData.cgstAmount = \"\";\r\n                            trData.sgstPercentage = \"\";\r\n                            trData.sgstAmount = \"\";\r\n                            trData.igstPercentage = product.seller_gst;\r\n                            trData.igstAmount = \"\" + ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                            invData.tableRow.push(trData);\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                if (invoice.soldBy.gst.substring(0, 2) === customerAddress.stateCode) {\r\n                    invData.totalCGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                    invData.totalSGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                    let count = 1;\r\n                    for (let product of orderedProduct.products) {\r\n                        if (!product.isRemoved) {\r\n                            let trData = {\r\n                                sno: count,\r\n                                productName: \"\",\r\n                                color: \"\",\r\n                                sizeSet: \"\",\r\n                                hsnCode: \"\",\r\n                                qty: \"\",\r\n                                rate: \"\",\r\n                                total: \"\",\r\n                                cgstPercentage: \"\",\r\n                                cgstAmount: \"\",\r\n                                sgstPercentage: \"\",\r\n                                sgstAmount: \"\",\r\n                                igstPercentage: \"\",\r\n                                igstAmount: \"\",\r\n                            };\r\n                            count += 1;\r\n                            trData.productName = product.product_id.product_name;\r\n                            trData.color = product.color.colorName;\r\n                            trData.sizeSet = product.lotSize;\r\n                            trData.hsnCode = product.hsnCode;\r\n                            trData.qty = product.qty;\r\n                            trData.rate = Number(product.seller_price) + (Number(product.seller_price) * Number(product.margin)) / 100;\r\n                            trData.total = (Number(trData.rate) * Number(product.qty)).toFixed(2);\r\n                            trData.cgstPercentage = Number(product.selling_gst) / 2;\r\n                            let mrginAmt = Number(product.seller_price) * Number(product.qty) + (Number(product.seller_price) * Number(product.qty) * Number(product.margin)) / 100;\r\n                            trData.cgstAmount = ((mrginAmt * Number(product.selling_gst)) / 100).toFixed(2);\r\n                            trData.sgstPercentage = Number(product.selling_gst) / 2;\r\n                            trData.sgstAmount = ((mrginAmt * Number(product.selling_gst)) / 100).toFixed(2);\r\n                            trData.igstPercentage = \"\";\r\n                            trData.igstAmount = \"\";\r\n                            invData.tableRow.push(trData);\r\n                        }\r\n                    }\r\n                } else {\r\n                    invData.totalIGSTAmt = invoice.gstAmount;\r\n                    let count = 1;\r\n                    for (let product of orderedProduct.products) {\r\n                        if (!product.isRemoved) {\r\n                            let trData = {\r\n                                sno: count,\r\n                                productName: \"\",\r\n                                color: \"\",\r\n                                sizeSet: \"\",\r\n                                hsnCode: \"\",\r\n                                qty: \"\",\r\n                                rate: \"\",\r\n                                total: \"\",\r\n                                cgstPercentage: \"\",\r\n                                cgstAmount: \"\",\r\n                                sgstPercentage: \"\",\r\n                                sgstAmount: \"\",\r\n                                igstPercentage: \"\",\r\n                                igstAmount: \"\",\r\n                            };\r\n                            count += 1;\r\n                            trData.productName = product.product_id.product_name;\r\n                            trData.color = product.color.colorName;\r\n                            trData.sizeSet = product.lotSize;\r\n                            trData.hsnCode = product.hsnCode;\r\n                            trData.qty = product.qty;\r\n                            trData.rate = product.seller_price;\r\n                            trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                            trData.cgstPercentage = \"\";\r\n                            trData.cgstAmount = \"\";\r\n                            trData.sgstPercentage = \"\";\r\n                            trData.sgstAmount = \"\";\r\n                            trData.igstPercentage = product.seller_gst;\r\n                            trData.igstAmount = \"\" + ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                            invData.tableRow.push(trData);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (invoice.order_id.discounted_amount) {\r\n                invData.discountAmt = \"\" + invoice.order_id.discounted_amount;\r\n                invData.netPayableAmount = Number(invoice.gstAmount) + Number(invoice.totalAmount) - Number(invoice.order_id.discounted_amount);\r\n            } else {\r\n                invData.discountAmt = 0;\r\n                invData.netPayableAmount = invData.grossTotalAmt;\r\n            }\r\n            let pdf = await generatePdf(invData, \"factorEz.com\");\r\n\r\n            res.setHeader(\"Content-Type\", \"application/pdf\");\r\n            res.setHeader(\"Content-Disposition\", \"attachment; invoice.pdf\");\r\n            return res.send(pdf);\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { generatePurchaseInvoice, generateSaleInvoice, getAllSaleInvoice, getAllPurchaseInvoice, downoadInvoiceByInvoiceNumber };\r\n","const orderModel = require(\"../models/orderModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst customerAddressModel = require(\"../models/customerAddressModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst paymentModel = require(\"../models/paymentModel\");\r\nconst cancelledReasonModel = require(\"../models/cancelledReasonModel\");\r\n\r\nconst { generateRandomID, generateRandomAlphaNumericID } = require(\"../controllers/idGeneratorController\");\r\n\r\nconst orderedProductModel = require(\"../models/orderedProductModel\");\r\nconst orderStatusTableModel = require(\"../models/orderStatusTableModel\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\nconst couponCodeModel = require(\"../models/couponCodeModel\");\r\nconst { createPayment } = require(\"./paymentController\");\r\nconst { generatePurchaseInvoice, generateSaleInvoice } = require(\"./invoiceController\");\r\nconst { isExpiryCoupon } = require(\"../utils/couponExpireUtil\");\r\n// CREATE ORDER\r\nconst createOrder = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let data = req.body;\r\n\r\n        let { address_id, payment_mode, couponCode, paymentAmt, transaction_id } = data;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id request\" });\r\n        }\r\n        if (!isValidObjectId(address_id)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Address id request\" });\r\n        }\r\n\r\n        if (!payment_mode) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (payment_mode !== \"CUSTOM\" && payment_mode !== \"TWENTY_ADV\" && payment_mode !== \"PREPAID\" && payment_mode !== \"COD\") {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        if ((payment_mode === \"CUSTOM\" || payment_mode === \"TWENTY_ADV\" || payment_mode === \"PREPAID\") && !transaction_id) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        let customer = await customerModel.findById(customerId);\r\n        let address = await customerAddressModel.findById(address_id);\r\n        if (!customer || !address) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let cart = await cartModel.findOne({ customer_id: customerId }).populate({\r\n            path: \"products.product_id\",\r\n            model: \"Product\",\r\n        });\r\n\r\n        let demoObj = {};\r\n        let coupon = null;\r\n        if (couponCode) {\r\n            coupon = await couponCodeModel.findOne({\r\n                couponCode: couponCode,\r\n                isDeleted: false,\r\n                isExpired: false,\r\n            });\r\n            if (!coupon) {\r\n                return res.status(400).send({ status: false, message: \"Invalid Coupon Code\" });\r\n            }\r\n            if (coupon && isExpiryCoupon(coupon.validTill)) {\r\n                coupon.isExpired = true;\r\n                await coupon.save();\r\n                return res.status(400).send({ status: false, message: \"Coupon Code Expired\" });\r\n            }\r\n            if (coupon.customer_id.includes(customerId)) {\r\n                return res.status(200).send({ status: false, message: \"Coupon Already applied\" });\r\n            }\r\n        }\r\n\r\n        if (!cart) {\r\n            return res.status(400).send({ status: false, message: \"Bad Request\" });\r\n        }\r\n        let orderAmt = 0;\r\n        for (let product of cart.products) {\r\n            let mAmt = product.product_id.seller_price + (product.product_id.margin * product.product_id.seller_price) / 100;\r\n            let totalamt = mAmt + (mAmt * product.product_id.sellingGST) / 100;\r\n            orderAmt += product.qty * totalamt;\r\n            let key = product.product_id.vendor_id.toString();\r\n            if (key in demoObj) {\r\n                demoObj[key].push(product);\r\n            } else {\r\n                demoObj[key] = [product];\r\n            }\r\n        }\r\n        if (coupon && coupon.minOrderAmt > orderAmt) {\r\n            return res.status(200).send({ status: false, message: `Coupon not applied, minimum order should be ${coupon.minOrderAmt}` });\r\n        }\r\n        let orders = [];\r\n        let grandTotal = 0;\r\n        for (let vendor of Object.keys(demoObj)) {\r\n            let orderedProduct = null;\r\n            let vendorAmtInfo = {\r\n                grandTotal: 0,\r\n                gstAmt: 0,\r\n                total: 0,\r\n            };\r\n            let total = 0;\r\n            let GST_amount = 0;\r\n            for (let p of demoObj[vendor]) {\r\n                let x = {\r\n                    product_id: \"\",\r\n                    vendor_id: \"\",\r\n                    mrp: \"\",\r\n                    seller_price: \"\",\r\n                    seller_gst: \"\",\r\n                    selling_price: \"\",\r\n                    selling_gst: \"\",\r\n                    margin: \"\",\r\n                    lotSize: \"\",\r\n                    color: {\r\n                        colorName: \"\",\r\n                        colorHex: \"\",\r\n                    },\r\n                    hsnCode: \"\",\r\n                    skuCode: \"\",\r\n                    qty: \"\",\r\n                    addedAt: \"\",\r\n                };\r\n                x.product_id = p.product_id._id;\r\n                x.vendor_id = vendor;\r\n                x.mrp = p.product_id.mrp;\r\n                x.seller_price = p.product_id.seller_price;\r\n                x.seller_gst = p.product_id.gst;\r\n                let marginAmt = (Number(p.product_id.seller_price) * Number(p.product_id.margin)) / 100;\r\n                let sellingGstAmt = ((Number(p.product_id.seller_price) + marginAmt) * Number(p.product_id.sellingGST)) / 100;\r\n                x.selling_price = (Number(p.product_id.seller_price) + marginAmt + sellingGstAmt).toFixed(2);\r\n                x.selling_gst = p.product_id.sellingGST;\r\n                x.lotSize = p.lotSize;\r\n                x.color = {\r\n                    colorName: p.color.colorName,\r\n                    colorHex: p.color.colorHex,\r\n                };\r\n                x.hsnCode = p.product_id.hsn_code;\r\n                x.skuCode = p.product_id.sku_code;\r\n                x.margin = p.product_id.margin;\r\n                x.qty = p.qty;\r\n                x.lotSize = p.lotSize;\r\n                x.addedAt = p.addedAt;\r\n                let currentTotal = (Number(p.product_id.seller_price) + marginAmt) * Number(p.qty);\r\n                total += Number(currentTotal);\r\n                GST_amount += sellingGstAmt * Number(p.qty);\r\n\r\n                let vdrAmt = Number(p.product_id.seller_price) * Number(p.qty);\r\n                let vdrGstAmt = (vdrAmt * Number(p.product_id.gst)) / 100;\r\n                vendorAmtInfo.grandTotal += vdrAmt + vdrGstAmt;\r\n                vendorAmtInfo.gstAmt += vdrGstAmt;\r\n                vendorAmtInfo.total += vdrAmt;\r\n\r\n                if (orderedProduct === null) {\r\n                    orderedProduct = await orderedProductModel.create({\r\n                        products: [x],\r\n                    });\r\n                } else {\r\n                    orderedProduct.products.push(x);\r\n                }\r\n            }\r\n            await orderedProduct.save();\r\n            let odrObj = {\r\n                orderId: generateRandomID(10, \"FZ\"),\r\n                vendorId: vendor,\r\n                order_date: new Date(),\r\n                ordered_products: orderedProduct,\r\n                customer_id: customerId,\r\n                address_id: address_id,\r\n                GST_amount: GST_amount.toFixed(2),\r\n                total: total.toFixed(2),\r\n                grand_total: (Number(GST_amount) + Number(total)).toFixed(2),\r\n                vendorAmtInfo: vendorAmtInfo,\r\n            };\r\n            if (coupon !== null) {\r\n                odrObj.couponCode = coupon._id;\r\n            }\r\n            grandTotal += Number(total) + Number(GST_amount);\r\n            let addedOrder = await orderModel.create(odrObj);\r\n            let status = await orderStatusTableModel.create({\r\n                order_id: addedOrder._id,\r\n            });\r\n            addedOrder.order_status_id = status;\r\n            await addedOrder.save();\r\n            orderedProduct.order_id = addedOrder._id;\r\n            await orderedProduct.save();\r\n            orders.push(addedOrder);\r\n        }\r\n        cart.products = [];\r\n        await cart.save();\r\n        if (coupon !== null && coupon.maxDiscPrice < grandTotal) {\r\n            let maxDiscount = 0;\r\n            if (coupon.discountType === \"PERCENTAGE\") {\r\n                let discAmt = (Number(grandTotal) * Number(coupon.discountAmt)) / 100;\r\n                if (discAmt > coupon.maxDiscPrice) {\r\n                    maxDiscount = coupon.maxDiscPrice;\r\n                } else {\r\n                    maxDiscount = discAmt;\r\n                }\r\n            } else if (coupon.discountType === \"PRICE\") {\r\n                maxDiscount = coupon.discountAmt;\r\n            }\r\n\r\n            if (payment_mode === \"PREPAID\" && Number(paymentAmt) < Number(grandTotal) - Number(maxDiscount)) {\r\n                return res.status(400).send({ status: false, message: \"payment should be equal to grand total amount\" });\r\n            }\r\n\r\n            for (let singleOrder of orders) {\r\n                let percentage = Number(((Number(singleOrder.grand_total) * 100) / Number(grandTotal)).toFixed(2));\r\n                let discountAmt = Number(((Number(maxDiscount) * Number(percentage)) / 100).toFixed(2));\r\n                let partPayment = 0;\r\n                if (payment_mode === \"CUSTOM\" || payment_mode === \"TWENTY_ADV\") {\r\n                    partPayment = Number(((Number(paymentAmt) * Number(percentage)) / 100).toFixed(2));\r\n                }\r\n                if (payment_mode === \"PREPAID\") {\r\n                    partPayment = Number(singleOrder.grand_total) - Number(discountAmt);\r\n                }\r\n                singleOrder.discounted_amount = discountAmt;\r\n                let payment = await createPayment(\r\n                    singleOrder.order_status_id.status,\r\n                    payment_mode,\r\n                    singleOrder.orderId,\r\n                    singleOrder._id,\r\n                    singleOrder.grand_total,\r\n                    discountAmt,\r\n                    partPayment,\r\n                    customerId,\r\n                    transaction_id\r\n                );\r\n                if (payment.status) {\r\n                    singleOrder.payment_id = payment.paymentId;\r\n                } else {\r\n                    return res.status(400).send({ status: false, message: \"Bad request\" });\r\n                }\r\n                singleOrder.shipping_address = {\r\n                    stateCode: address.stateCode,\r\n                    state: address.state,\r\n                    address: address.address,\r\n                };\r\n                await singleOrder.save();\r\n                customer.orders.push(singleOrder._id);\r\n            }\r\n            coupon.customer_id.push(customerId);\r\n            await coupon.save();\r\n            await customer.save();\r\n        } else {\r\n            for (let singleOrder of orders) {\r\n                let percentage = Number(((Number(singleOrder.grand_total) * 100) / Number(grandTotal)).toFixed(2));\r\n                let discountAmt = 0;\r\n                let partPayment = 0;\r\n                if (payment_mode === \"CUSTOM\" || payment_mode === \"TWENTY_ADV\") {\r\n                    partPayment = Number(((paymentAmt * percentage) / 100).toFixed(2));\r\n                }\r\n                if (payment_mode === \"PREPAID\") {\r\n                    partPayment = Number(singleOrder.grand_total) - Number(discountAmt);\r\n                }\r\n                let payment = await createPayment(\r\n                    singleOrder.order_status_id.status,\r\n                    payment_mode,\r\n                    singleOrder.orderId,\r\n                    singleOrder._id,\r\n                    singleOrder.grand_total,\r\n                    discountAmt,\r\n                    partPayment,\r\n                    customerId,\r\n                    transaction_id\r\n                );\r\n                if (payment.status) {\r\n                    singleOrder.payment_id = payment.paymentId;\r\n                } else {\r\n                    return res.status(400).send({ status: false, message: \"Bad request\" });\r\n                }\r\n                singleOrder.shipping_address = {\r\n                    stateCode: address.stateCode,\r\n                    state: address.state,\r\n                    address: address.address,\r\n                };\r\n                await singleOrder.save();\r\n                customer.orders.push(singleOrder._id);\r\n            }\r\n            await customer.save();\r\n        }\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Order Created Successfully\",\r\n            data: \"orders\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL ORDERS\r\nconst getAllOrders = async (req, res) => {\r\n    try {\r\n        let orders = null;\r\n        if (req.userModel === \"VENDOR\") {\r\n            orders = await orderModel\r\n                .find({ vendorId: req.userId })\r\n                .populate([\"vendorId\", \"order_status_id\", \"ordered_products\", \"purchaseInvoice\"])\r\n                .select([\"-shipping_address\", \"-couponCode\", \"-customer_id\"])\r\n                .sort({ createdAt: -1 });\r\n            // .populate({ path: \"ordered_products\", model: \"Ordered_Product\", populate: { path: \"products.product_id\", model: \"Product\" } });\r\n        } else {\r\n            orders = await orderModel\r\n                .find()\r\n                .populate([\r\n                    \"vendorId\",\r\n                    \"payment_id\",\r\n                    \"order_status_id\",\r\n                    \"ordered_products\",\r\n                    \"purchaseInvoice\",\r\n                    \"saleInvoice\",\r\n                    { path: \"CouponCode\", strictPopulate: false },\r\n                    { path: \"customer_id\", model: \"Customer\", populate: { path: \"defaultAddress\", model: \"CustomerAddress\" } },\r\n                ])\r\n                .sort({ createdAt: -1 });\r\n            // .select(\"-vendorAmtInfo\")\r\n            // .populate({\r\n            //     path: \"ordered_products\",\r\n            //     model: \"Ordered_Product\",\r\n            //     populate: { path: \"products.product_id\", model: \"Product\", populate: { path: \"product_id.brandId\", model: \"Brand\" } },\r\n            // });\r\n        }\r\n        return res.status(200).send({ status: true, data: orders });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ORDER BY ORDER ID\r\nconst getOrderByOrderId = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        let customerId = req.params.customerId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        let order = await orderModel\r\n            .findOne({ customer_id: customerId, orderId: orderId })\r\n            .populate([\r\n                \"payment_id\",\r\n                \"order_status_id\",\r\n                { path: \"ordered_products\", model: \"Ordered_Product\", populate: { path: \"products.product_id\", model: \"Product\" } },\r\n                \"saleInvoice\",\r\n                { path: \"CouponCode\", strictPopulate: false },\r\n            ])\r\n            .select(\"-purchaseInvoice\");\r\n        if (!order) {\r\n            return res.status(404).send({ status: false, message: \"Order not found\" });\r\n        }\r\n        return res.status(200).send({ status: true, data: order });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL ORDERS OF A CUSTOMER\r\nconst getOrdersByCustomerId = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let customerOrders = await orderModel.find({ customer_id: customerId }).populate([\"vendorId\", \"customer_id\", \"payment_id\", \"order_status_id\", \"ordered_products\"]);\r\n\r\n        return res.status(200).send({ status: true, data: customerOrders });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// CANCEL ORDER BY ORDER ID\r\nconst cancelOrderByOrderId = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        if (!isValidObjectId(orderId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Order Id\" });\r\n        }\r\n\r\n        let order = await orderModel.findOne({ _id: orderId });\r\n\r\n        if (!order) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order not found with this order id\",\r\n            });\r\n        }\r\n\r\n        let data = req.body;\r\n\r\n        let { Status } = data;\r\n\r\n        if (order.Status === \"Cancelled\") {\r\n            return res.status(400).send({ status: false, message: \"Order is already cancelled\" });\r\n        }\r\n\r\n        let orderStatus = await orderModel.findOneAndUpdate({ _id: orderId }, { $set: { Status: \"Cancelled\" } }, { new: true });\r\n\r\n        await order.save();\r\n\r\n        return res.status(202).send({ status: true, message: \"Order Cancelled Successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE ORDER BY ORDER ID\r\nconst updateOrderByOrderId = async (req, res) => {\r\n    try {\r\n        //CONFIRM, PARTIAL, CANCEL\r\n        let orderId = req.params.orderId;\r\n        let { orderType, cancelMessage, questionId, removedProductIds } = req.body;\r\n        if (!orderType || !orderId) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let order = await orderModel.findOne({ orderId: orderId }).populate([\"ordered_products\", \"order_status_id\"]);\r\n        if (!order) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        if (order.order_status_id.status !== \"PENDING\" && req.userModel === \"VENDOR\") {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        let payment = await paymentModel.findById(order.payment_id._id);\r\n        if (!payment) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        if (orderType === \"PARTIAL_CONFIRMED\") {\r\n            let orderedProduct = order.ordered_products;\r\n            let partialCanceledAmt = 0;\r\n            let partialCanceledGstAmt = 0;\r\n            let orderedProductAmtInfo = {\r\n                productQty: 0,\r\n                total: 0,\r\n                GST_amount: 0,\r\n                grand_total: 0,\r\n            };\r\n            let orderedAmtInfo = {\r\n                grand_total: 0,\r\n                total: 0,\r\n                GST_amount: 0,\r\n                discounted_amount: 0,\r\n            };\r\n            for (let s_product of orderedProduct.products) {\r\n                if (s_product.isRemoved === false && removedProductIds.includes(s_product._id.toString())) {\r\n                    s_product.isRemoved = true;\r\n                    let canceledAmt = Number(s_product.seller_price) * Number(s_product.qty);\r\n                    partialCanceledAmt += canceledAmt;\r\n                    partialCanceledGstAmt += Number(((canceledAmt * Number(s_product.seller_gst)) / 100).toFixed(2));\r\n                    let adminCancelledAmt = canceledAmt + (canceledAmt * s_product.margin) / 100;\r\n                    orderedProductAmtInfo.productQty += 1;\r\n                    orderedProductAmtInfo.total += Number(adminCancelledAmt.toFixed(2));\r\n                    orderedProductAmtInfo.GST_amount += Number(((adminCancelledAmt * s_product.selling_gst) / 100).toFixed(2));\r\n                    orderedProductAmtInfo.grand_total += adminCancelledAmt + Number(((adminCancelledAmt * s_product.selling_gst) / 100).toFixed(2));\r\n                }\r\n            }\r\n            order.order_status_id.status = orderType;\r\n            payment.order_status = \"PARTIAL_CONFIRMED\";\r\n            let updatedByObj = {};\r\n            if (req.userModel === \"VENDOR\") {\r\n                updatedByObj.vendor = req.userId;\r\n            } else if (req.userModel === \"ADMIN\") {\r\n                updatedByObj.admin = req.userId;\r\n            }\r\n            let statusObj = {\r\n                status: orderType,\r\n                updatedBy: updatedByObj,\r\n                updatedAt: new Date(),\r\n                description: cancelMessage,\r\n            };\r\n            order.order_status_id.statusList.push(statusObj);\r\n            order.vendorAmtInfo.gstAmt -= partialCanceledGstAmt;\r\n            order.vendorAmtInfo.total -= partialCanceledAmt;\r\n            order.vendorAmtInfo.grandTotal -= partialCanceledGstAmt + partialCanceledAmt;\r\n            orderedAmtInfo.GST_amount = order.GST_amount;\r\n            orderedAmtInfo.total = order.total;\r\n            orderedAmtInfo.grand_total = order.grand_total;\r\n            order.GST_amount -= orderedProductAmtInfo.GST_amount;\r\n            order.total -= orderedProductAmtInfo.total;\r\n            order.grand_total -= orderedProductAmtInfo.grand_total;\r\n            order.partialCancelOrderInfo = {\r\n                orderedAmtInfo,\r\n                orderedProductAmtInfo,\r\n            };\r\n            await orderedProduct.save();\r\n            await order.order_status_id.save();\r\n            let purchaseGstAmount = 0;\r\n            let purchaseTotalAmount = 0;\r\n            for (let singleOrderProduct of order.ordered_products.products) {\r\n                purchaseGstAmount += (singleOrderProduct.seller_price * singleOrderProduct.qty * singleOrderProduct.seller_gst) / 100;\r\n                purchaseTotalAmount += singleOrderProduct.seller_price * singleOrderProduct.qty;\r\n            }\r\n\r\n            let invDataPurchase = {\r\n                vendor_id: order.vendorId,\r\n                order_id: order._id,\r\n                gstAmount: purchaseGstAmount,\r\n                totalAmount: purchaseTotalAmount,\r\n            };\r\n            let invDataSale = {\r\n                customer_id: order.customer_id,\r\n                order_id: order._id,\r\n                gstAmount: order.GST_amount,\r\n                totalAmount: order.total,\r\n                address: order.shipping_address,\r\n            };\r\n            if ((payment.payment_mode === \"CUSTOM\" || payment.payment_mode === \"TWENTY_ADV\") && payment.partial_payment.payment_amount >= Number(order.grand_total) - Number(order.discounted_amount)) {\r\n                payment.return_amount = (Number(payment.partial_payment.payment_amount) - (Number(order.grand_total) - Number(order.discounted_amount))).toFixed(2);\r\n                payment.balance_amount = 0;\r\n            } else if ((payment.payment_mode === \"CUSTOM\" || payment.payment_mode === \"TWENTY_ADV\") && payment.partial_payment.payment_amount < order.grand_total) {\r\n                payment.return_amount = 0;\r\n                let x = Number(order.grand_total) - Number(order.discounted_amount);\r\n                payment.balance_amount = x - Number(payment.partial_payment.payment_amount).toFixed(2);\r\n            } else if (payment.payment_mode === \"PREPAID\" && payment.payment_amount >= Number(order.grand_total) - Number(order.discounted_amount)) {\r\n                payment.return_amount = (Number(payment.payment_amount) - (Number(order.grand_total) - Number(order.discounted_amount))).toFixed(2);\r\n                payment.balance_amount = 0;\r\n            } else if (payment.payment_mode === \"COD\") {\r\n                payment.return_amount = 0;\r\n                payment.balance_amount = Number(order.grand_total) - Number(order.discounted_amount);\r\n            }\r\n            payment.order_amount = order.grand_total;\r\n            let resData = await generatePurchaseInvoice(invDataPurchase);\r\n            let resData2 = await generateSaleInvoice(invDataSale);\r\n            if (resData.status) {\r\n                order.purchaseInvoice = resData.invoice._id;\r\n            }\r\n            if (resData2.status) {\r\n                order.saleInvoice = resData2.invoice._id;\r\n            }\r\n        }\r\n        if (orderType === \"CANCEL\") {\r\n            order.order_status_id.status = \"CANCELLED\";\r\n            payment.order_status = \"CANCELLED\";\r\n            let updatedByObj = {};\r\n            if (req.userModel === \"VENDOR\") {\r\n                updatedByObj.vendor = req.userId;\r\n            } else if (req.userModel === \"ADMIN\") {\r\n                updatedByObj.admin = req.userId;\r\n            } else {\r\n                updatedByObj.customer = req.userId;\r\n            }\r\n            order.order_status_id.cancelled.userId = updatedByObj;\r\n            order.order_status_id.cancelled.question = questionId;\r\n            order.order_status_id.cancelled.description = cancelMessage;\r\n            order.order_status_id.cancelledStatus = \"CANCELLED\";\r\n            let objOfCancelledStatusList = {\r\n                status: \"CANCELLED\",\r\n                updatedBy: updatedByObj,\r\n                updatedAt: new Date(),\r\n            };\r\n            order.order_status_id.cancelledStatusList.push(objOfCancelledStatusList);\r\n            if (payment.payment_mode === \"CUSTOM\" || payment.payment_mode === \"PREPAID\" || payment.payment_mode === \"TWENTY_ADV\") {\r\n                if (payment.payment_mode === \"CUSTOM\") {\r\n                    payment.return_amount = Number(payment.partial_payment.payment_amount) + Number(payment.cod_received);\r\n                    payment.balance_amount = 0;\r\n                } else if (payment.payment_mode === \"PREPAID\") {\r\n                    payment.return_amount = payment.payment_amount;\r\n                    payment.balance_amount = 0;\r\n                } else if (payment.payment_mode === \"TWENTY_ADV\") {\r\n                    payment.return_amount = payment.partial_payment.payment_amount + Number(payment.cod_received);\r\n                    payment.balance_amount = 0;\r\n                }\r\n            } else if (payment.payment_mode === \"COD\") {\r\n                payment.return_amount = Number(payment.cod_received);\r\n                payment.balance_amount = 0;\r\n            }\r\n            await order.order_status_id.save();\r\n        }\r\n        if (orderType === \"CONFIRMED\") {\r\n            order.order_status_id.status = orderType;\r\n            payment.order_status = \"CONFIRMED\";\r\n            let updatedByObj = {};\r\n            if (req.userModel === \"VENDOR\") {\r\n                updatedByObj.vendor = req.userId;\r\n            } else if (req.userModel === \"ADMIN\") {\r\n                updatedByObj.admin = req.userId;\r\n            }\r\n            let statusObj = {\r\n                status: orderType,\r\n                updatedBy: updatedByObj,\r\n                updatedAt: new Date(),\r\n            };\r\n            order.order_status_id.statusList.push(statusObj);\r\n            await order.order_status_id.save();\r\n            let purchaseGstAmount = 0;\r\n            let purchaseTotalAmount = 0;\r\n            for (let singleOrderProduct of order.ordered_products.products) {\r\n                purchaseGstAmount += (singleOrderProduct.seller_price * singleOrderProduct.qty * singleOrderProduct.seller_gst) / 100;\r\n                purchaseTotalAmount += singleOrderProduct.seller_price * singleOrderProduct.qty;\r\n            }\r\n\r\n            let invDataPurchase = {\r\n                vendor_id: order.vendorId,\r\n                order_id: order._id,\r\n                gstAmount: purchaseGstAmount,\r\n                totalAmount: purchaseTotalAmount,\r\n            };\r\n            let invDataSale = {\r\n                customer_id: order.customer_id,\r\n                order_id: order._id,\r\n                gstAmount: order.GST_amount,\r\n                totalAmount: order.total,\r\n                address: order.shipping_address,\r\n            };\r\n            let resData = await generatePurchaseInvoice(invDataPurchase);\r\n            let resData2 = await generateSaleInvoice(invDataSale);\r\n            if (resData.status) {\r\n                order.purchaseInvoice = resData.invoice._id;\r\n            } else {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: resData.err,\r\n                });\r\n            }\r\n            if (resData2.status) {\r\n                order.saleInvoice = resData2.invoice._id;\r\n            } else {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: resData2.err,\r\n                });\r\n            }\r\n        }\r\n        await payment.save();\r\n        await order.save();\r\n        return res.status(202).send({\r\n            status: true,\r\n            message: \"Order updated successfully\",\r\n            data: order,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getOrderedProduct = async (req, res) => {\r\n    try {\r\n        let id = req.params.orderedproductid;\r\n        let obj = await orderedProductModel.findById(id).populate(\"products.product_id\");\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"details fetched successfully...\",\r\n            data: obj,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst patchTrackingIdByOrderId = async (req, res) => {\r\n    try {\r\n        let id = req.params.orderId;\r\n        let { t_id } = req.body;\r\n        if (!id || !t_id) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let obj = await orderModel.findOne({ orderId: id }).populate(\"order_status_id\");\r\n        if (!obj) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (obj.order_status_id.status === \"PENDING\") {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        obj.tracking_id = t_id;\r\n        await obj.save();\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Tracking ID Updated successfully...\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllCancelledOrder = async (req, res) => {\r\n    try {\r\n        let userModel = req.userModel;\r\n        let userId = req.userId;\r\n        let orders = null;\r\n        if (userModel === \"VENDOR\") {\r\n            orders = await orderModel\r\n                .find({ vendorId: req.userId })\r\n                .populate([\"vendorId\", \"order_status_id\", \"ordered_products\"])\r\n                .select([\"-shipping_address\", \"-couponCode\", \"-customer_id\"])\r\n                .sort({ createdAt: -1 });\r\n        } else {\r\n            orders = await orderModel.find().populate([\"vendorId\", \"customer_id\", \"payment_id\", \"order_status_id\", \"ordered_products\"]).sort({ createdAt: -1 });\r\n        }\r\n\r\n        if (!orders) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let cancelledOrders = [];\r\n        for (let order of orders) {\r\n            if (order.order_status_id.status === \"CANCELLED\") {\r\n                cancelledOrders.push(order);\r\n            }\r\n        }\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Cancelled orders fetched...\",\r\n            data: cancelledOrders,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    createOrder,\r\n    getAllOrders,\r\n    getOrderByOrderId,\r\n    getOrdersByCustomerId,\r\n    cancelOrderByOrderId,\r\n    updateOrderByOrderId,\r\n    getOrderedProduct,\r\n    patchTrackingIdByOrderId,\r\n    getAllCancelledOrder,\r\n};\r\n","const orderStatusTableModel = require(\"../models/orderStatusTableModel\");\r\nconst orderModel = require(\"../models/orderModel\");\r\nconst cancelledReasonModel = require(\"../models/cancelledReasonModel\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\n\r\n// CREATE ORDER STATUS TABLE\r\nconst createOrderStatusTable = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        if (!isValidObjectId(orderId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Order Id\" });\r\n        }\r\n\r\n        let order = await orderModel.findOne({ _id: orderId });\r\n\r\n        if (!order) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order not found with this order id\",\r\n            });\r\n        }\r\n\r\n        let data = req.body;\r\n\r\n        let { questions, customerAnswer } = data;\r\n\r\n        let orderStatus = await orderModel.findOneAndUpdate({ _id: orderId }, { $set: { Status: \"Cancelled\" } }, { new: true });\r\n\r\n        await order.save();\r\n\r\n        let cancelledReasonData = {\r\n            questions,\r\n            customerAnswer,\r\n        };\r\n\r\n        let newCancelledReason = await cancelledReasonModel.create(cancelledReasonData);\r\n\r\n        let cancelledObj = {\r\n            cancelledBy: req.body.cancelledBy,\r\n            userId: req.body.userId,\r\n            reason: newCancelledReason._id,\r\n        };\r\n\r\n        let orderStatusTableData = await orderStatusTableModel.create({\r\n            order_id: order._id,\r\n            status: \"Cancelled\",\r\n            isCompleted: false,\r\n            cancelled: cancelledObj,\r\n        });\r\n\r\n        return res.status(201).send({\r\n            status: true,\r\n            message: \"Success\",\r\n            data: {\r\n                OrderStatusTableData: orderStatusTableData,\r\n                cancelledReasonData: newCancelledReason,\r\n            },\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL ORDER STATUS TABLES\r\nconst getAllOrderStatusTables = async (req, res) => {\r\n    try {\r\n        let allOrderStatusTables = await orderStatusTableModel.find();\r\n        return res.status(200).send({ status: true, data: allOrderStatusTables });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ORDER STATUS TABLE BY ID\r\nconst getOrderStatusTableById = async (req, res) => {\r\n    try {\r\n        let orderStatusTableId = req.params.orderStatusTableId;\r\n\r\n        if (!isValidObjectId(orderStatusTableId)) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Invalid order status table id\",\r\n            });\r\n        }\r\n\r\n        let orderStatusTable = await orderStatusTableModel.findOne({\r\n            _id: orderStatusTableId,\r\n        });\r\n\r\n        if (!orderStatusTable) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order Status Table not found\",\r\n            });\r\n        }\r\n\r\n        return res.status(200).send({ status: true, data: orderStatusTable });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE ORDER STATUS TABLE BY ORDER ID\r\nconst updateOrderStatusByOrderId = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        let { status } = req.body;\r\n        if (!isValidObjectId(orderId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid order id\" });\r\n        }\r\n\r\n        let orderStatusTable = await orderStatusTableModel.findOne({\r\n            order_id: orderId,\r\n        });\r\n\r\n        if (!orderStatusTable) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order status table not found\",\r\n            });\r\n        }\r\n        if (!status) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        orderStatusTable.status = status;\r\n\r\n        let updatedByObj = {};\r\n        if (req.userModel === \"VENDOR\") {\r\n            updatedByObj.vendor = req.userId;\r\n        } else if (req.userModel === \"ADMIN\") {\r\n            updatedByObj.admin = req.userId;\r\n        }\r\n        let statusObj = {\r\n            status: status,\r\n            updatedBy: updatedByObj,\r\n            updatedAt: new Date(),\r\n        };\r\n        orderStatusTable.statusList.push(statusObj);\r\n        await orderStatusTable.save();\r\n        return res.status(202).send({ status: true, message: \"Success\", data: orderStatusTable });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst bulkOrderProcess = async (req, res) => {\r\n    try {\r\n        let { status, orderIds } = req.body;\r\n        // let const records = await Model.find({ '_id': { $in: ids } });\r\n\r\n        let orderStatusTables = await orderStatusTableModel.find({ order_id: { $in: orderIds } });\r\n        let updatedByObj = {};\r\n        if (req.userModel === \"VENDOR\") {\r\n            updatedByObj.vendor = req.userId;\r\n        } else if (req.userModel === \"ADMIN\") {\r\n            updatedByObj.admin = req.userId;\r\n        }\r\n        let statusObj = {\r\n            status: status,\r\n            updatedBy: updatedByObj,\r\n            updatedAt: new Date(),\r\n        };\r\n        for await (let orderStatusTable of orderStatusTables) {\r\n            if (orderStatusTable.status !== \"CANCELLED\" && orderStatusTable.status !== \"PENDING\") {\r\n                orderStatusTable.status = status;\r\n                orderStatusTable.statusList.push(statusObj);\r\n                await orderStatusTable.save();\r\n            }\r\n        }\r\n        return res.status(202).send({ status: true, message: \"Orders Processed\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst cancelOrderReturnById = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        let { status } = req.body;\r\n        if (!isValidObjectId(orderId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid order id\" });\r\n        }\r\n\r\n        let orderStatusTable = await orderStatusTableModel.findOne({\r\n            order_id: orderId,\r\n        });\r\n\r\n        if (!orderStatusTable) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order status table not found\",\r\n            });\r\n        }\r\n        if (!status) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        orderStatusTable.cancelledStatus = status;\r\n        let updatedByObj = {};\r\n        if (req.userModel === \"VENDOR\") {\r\n            updatedByObj.vendor = req.userId;\r\n        } else if (req.userModel === \"ADMIN\") {\r\n            updatedByObj.admin = req.userId;\r\n        } else {\r\n            updatedByObj.customer = req.userId;\r\n        }\r\n        let objOfCancelledStatusList = {\r\n            status: status,\r\n            updatedBy: updatedByObj,\r\n            updatedAt: new Date(),\r\n        };\r\n        orderStatusTable.cancelledStatusList.push(objOfCancelledStatusList);\r\n        await orderStatusTable.save();\r\n        return res.status(202).send({ status: true, message: \"Return Status Updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    createOrderStatusTable,\r\n    getAllOrderStatusTables,\r\n    getOrderStatusTableById,\r\n    updateOrderStatusByOrderId,\r\n    bulkOrderProcess,\r\n    cancelOrderReturnById\r\n};\r\n","const jwt = require(\"jsonwebtoken\");\r\nconst { twilioAccSID, twilioAuthToken, twilioVerifySID, tokenSecretKey, customerTokenSecretKey } = require(\"../middlewares/config\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst accountSid = twilioAccSID;\r\nconst authToken = twilioAuthToken;\r\nconst verifySid = twilioVerifySID;\r\nconst client = require(\"twilio\")(accountSid, authToken);\r\n\r\nconst sendOTP = async (req, res) => {\r\n    try {\r\n        let phone = req.params.phone;\r\n        // console.log(req.params);\r\n        if (!phone) {\r\n            return res.status(400).send({ status: false, message: \"phone number are required\" });\r\n        }\r\n        // console.log(phone);\r\n        let isSent = false;\r\n        await client.verify.v2\r\n            .services(verifySid)\r\n            .verifications.create({ to: `+91${phone}`, channel: \"sms\" })\r\n            .then((verification) => {\r\n                isSent = true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(err);\r\n            });\r\n        if (isSent) {\r\n            return res.status(200).send({ status: true, message: \"OTP send successfully\" });\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"Otp not send\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst createAccountAndToken = async (phone) => {\r\n    try {\r\n        let customer = await customerModel.findOne({ phone: phone, isDeleted: false });\r\n\r\n        if (!customer) {\r\n            customer = await customerModel.create({ phone });\r\n        }\r\n        if (customer.isBlocked) {\r\n            return { statusCode: 403, status: false, message: \"This account has been blocked\" };\r\n        }\r\n        if (!customer.isActivated) {\r\n            return { statusCode: 200, status: true, isActivated: false, data: { customerId: customer._id }, message: \"Account is not active, Please fill your information\" };\r\n        }\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            userType: \"CUSTOMER\",\r\n            customerId: customer._id.toString(),\r\n            phone: customer.phone,\r\n            isActivated: customer.isActivated,\r\n        };\r\n        if (customer.profileUrl) data.photo = customer.profileUrl;\r\n        if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n\r\n        let date = Date.now();\r\n        let issueTime = Math.floor(date / 1000);\r\n        let token = jwt.sign(\r\n            {\r\n                userId: customer._id.toString(),\r\n                phone: customer.phone,\r\n                userModel: \"CUSTOMER\",\r\n                iat: issueTime,\r\n            },\r\n            customerTokenSecretKey,\r\n            { expiresIn: \"24h\" }\r\n        );\r\n        data.token = token;\r\n        return { statusCode: 200, status: true, message: \"Login successfully\", data: data };\r\n    } catch (error) {\r\n        return { statusCode: 500, status: false, message: \"something went wrong\" };\r\n    }\r\n};\r\n\r\nconst updatePassword = async (phone, password) => {\r\n    try {\r\n        let customer = await customerModel.findOne({ phone: phone, isDeleted: false });\r\n        if (!customer) {\r\n            customer = await customerModel.create({ phone });\r\n        }\r\n        if (customer.isBlocked) {\r\n            return { statusCode: 403, status: false, message: \"This account has been blocked\" };\r\n        }\r\n        if (!customer.isActivated) {\r\n            return { statusCode: 200, status: true, isActivated: false, data: { customerId: customer._id }, message: \"Account is not active, Please fill your information\" };\r\n        }\r\n        let hashedPassword = await bcrypt.hash(password, 10);\r\n        customer.password = hashedPassword;\r\n\r\n        await customer.save();\r\n        return { statusCode: 200, status: true, message: \"Password updated successfully\" };\r\n    } catch (error) {\r\n        return { statusCode: 500, status: false, message: \"something went wrong\" };\r\n    }\r\n};\r\n\r\nconst verityOTP = async (req, res) => {\r\n    try {\r\n        let phone = req.params.phone;\r\n        let otpCode = req.params.otpCode;\r\n        if (!phone || !otpCode) {\r\n            return res.status(400).send({ status: false, message: \"phone number and otp are required\" });\r\n        }\r\n        let isValid = false;\r\n        await client.verify.v2\r\n            .services(verifySid)\r\n            .verificationChecks.create({ to: `+91${phone}`, code: otpCode })\r\n            .then((verification_check) => {\r\n                // console.log(\"verification_check.status\", verification_check.status);\r\n                // console.log(\"verification_check\", verification_check);\r\n                if (verification_check.status === \"approved\" || verification_check.valid === true) {\r\n                    isValid = true;\r\n                }\r\n            })\r\n            .catch((err) => {});\r\n        if (isValid) {\r\n            let resAcc = await createAccountAndToken(phone);\r\n            // console.log(resAcc);\r\n            if (resAcc.statusCode === 403) {\r\n                return res.status(403).send({ status: false, message: resAcc.message });\r\n            } else if (resAcc.statusCode === 200 && resAcc.isActivated) {\r\n                res.setHeader(\"Authorization\", \"Bearer \" + resAcc.data.token);\r\n                return res.status(200).send({ status: true, isActivated: true, message: resAcc.message, data: resAcc.data });\r\n            } else if (resAcc.statusCode === 200 && !resAcc.isActivated) {\r\n                return res.status(200).send({ status: true, isActivated: false, message: resAcc.message, data: resAcc.data });\r\n            } else if (resAcc.statusCode === 500) {\r\n                return res.status(500).send({ status: false, message: resAcc.message });\r\n            } else {\r\n                return res.status(400).send({ status: false, message: \"Something went wrong...\" });\r\n            }\r\n        } else {\r\n            return res.status(403).send({ status: false, message: \"otp not verified\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst forgetPasswordUsingOtp = async (req, res) => {\r\n    try {\r\n        let phone = req.params.phone;\r\n        let otpCode = req.params.otpCode;\r\n        let { password } = req.body;\r\n\r\n        if (!phone || !otpCode || !password) {\r\n            return res.status(400).send({ status: false, message: \"Phone number, password and otp are required\" });\r\n        }\r\n\r\n        let isValid = false;\r\n        await client.verify.v2\r\n            .services(verifySid)\r\n            .verificationChecks.create({ to: `+91${phone}`, code: otpCode })\r\n            .then((verification_check) => {\r\n                if (verification_check.status === \"approved\" || verification_check.valid === true) {\r\n                    isValid = true;\r\n                }\r\n            })\r\n            .catch((err) => {});\r\n        if (isValid) {\r\n            let resAcc = await updatePassword(phone, password);\r\n            return res.status(resAcc.statusCode).send({ status: resAcc.status, message: resAcc.message });\r\n        } else {\r\n            return res.status(403).send({ status: false, message: \"OTP not verified\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { sendOTP, verityOTP, forgetPasswordUsingOtp };\r\n","const paymentModel = require(\"../models/paymentModel\");\r\nconst orderModel = require(\"../models/orderModel\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst customerModel = require(\"../models/customerAddressModel\");\r\nconst { generateRandomID } = require(\"./idGeneratorController\");\r\n\r\n// CREATE PAYMENT\r\nconst createPayment = async (order_status, payment_mode, order_sortId, order_id, orderAmt, discountAmt, paymentAmt, customer_id, transaction_id) => {\r\n    try {\r\n        // let orderId = req.params.orderId;\r\n        // let { payment_mode, paymentAmt, customer_id, transaction_id } = req.body;\r\n\r\n        if (!payment_mode || !customer_id) {\r\n            return { status: false };\r\n        }\r\n        let paymentData = {\r\n            order_status,\r\n            paymentId: generateRandomID(20),\r\n            customer_id,\r\n            payment_status: \"\",\r\n            payment_mode,\r\n            order_amount: orderAmt,\r\n            discount_amt: discountAmt,\r\n            balance_amount: 0,\r\n            order_id: {\r\n                orderId: order_id,\r\n                order_custom_id: order_sortId,\r\n            },\r\n        };\r\n        if (payment_mode === \"CUSTOM\" || payment_mode === \"TWENTY_ADV\") {\r\n            paymentData.partial_payment = {\r\n                payment_amount: paymentAmt.toFixed(2),\r\n                date: new Date(),\r\n                transactionId: transaction_id,\r\n            };\r\n            paymentData.payment_status = \"PARTIAL_PAID\";\r\n            if (orderAmt > paymentAmt) {\r\n                paymentData.balance_amount = (orderAmt - paymentAmt - discountAmt).toFixed(2);\r\n            }\r\n        } else if (payment_mode === \"PREPAID\") {\r\n            paymentData.transactionId = transaction_id;\r\n            paymentData.payment_amount = paymentAmt.toFixed(2);\r\n            paymentData.payment_status = \"RECEIVED\";\r\n            paymentData.payment_date = new Date();\r\n            paymentData.balance_amount = 0;\r\n        } else if (payment_mode === \"COD\") {\r\n            paymentData.payment_status = \"PENDING\";\r\n            paymentData.balance_amount = (orderAmt - paymentAmt - discountAmt).toFixed(2);\r\n        }\r\n\r\n        let paymentObj = await paymentModel.create(paymentData);\r\n        return { status: true, paymentId: paymentObj._id };\r\n    } catch (error) {\r\n        return { status: false };\r\n    }\r\n};\r\n\r\n// UPDATE PAYMENT API\r\nconst updatePaymentStatus = async (req, res) => {\r\n    try {\r\n        let paymentId = req.params.paymentId;\r\n        let { payment_date, payment_amount, payment_status } = req.body;\r\n        console.log(req.body);\r\n        // console.log(paymentId);\r\n        let payment = await paymentModel.findById(paymentId);\r\n        // console.log(payment);\r\n        if (!payment) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Payment not found with this payment id\",\r\n            });\r\n        }\r\n\r\n        if (!payment_date || !payment_amount || !payment_status) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"All fields are required\",\r\n            });\r\n        }\r\n\r\n        payment.payment_date = new Date(payment_date);\r\n        switch (payment_status) {\r\n            case \"RECEIVED\": {\r\n                if (Number(payment.balance_amount) !== Number(payment_amount)) {\r\n                    return res.status(400).send({\r\n                        status: false,\r\n                        message: \"Received amount should be equal to balance amount\",\r\n                    });\r\n                } else {\r\n                    payment.payment_amount += Number(payment_amount);\r\n                    payment.cod_received = Number(payment_amount);\r\n                    payment.payment_status = payment_status;\r\n                    payment.balance_amount = 0;\r\n                }\r\n                break;\r\n            }\r\n            case \"REFUNDED\": {\r\n                if (Number(payment.return_amount) !== Number(payment_amount)) {\r\n                    return res.status(400).send({\r\n                        status: false,\r\n                        message: \"Cancelled amount should be equal to refund amount\",\r\n                    });\r\n                } else if (payment.order_status === \"CANCELLED\") {\r\n                    payment.payment_status = \"REFUNDED\";\r\n                    payment.return_amount = Number(payment_amount);\r\n                    payment.balance_amount = 0;\r\n                } else if (payment.order_status === \"PARTIAL_CONFIRMED\") {\r\n                    payment.payment_status = \"PARTIAL_REFUNDED\";\r\n                    payment.return_amount = Number(payment_amount);\r\n                    payment.balance_amount = 0;\r\n                } else {\r\n                    payment.payment_status = \"REFUNDED\";\r\n                    payment.return_amount = Number(payment_amount);\r\n                    payment.balance_amount = 0;\r\n                }\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n        await payment.save();\r\n        return res.status(202).send({\r\n            status: true,\r\n            message: \"Payment status updated successfully\",\r\n            data: payment,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// CREATE PAYMENT\r\nconst addPayment = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        let data = req.body;\r\n        let payment = 856.8;\r\n\r\n        let { payment_mode } = data;\r\n\r\n        let order = await orderModel.findOne({ _id: orderId });\r\n\r\n        if (!order) {\r\n            return res.status(404).send({ status: false, message: \"Order not found\" });\r\n        }\r\n\r\n        if (payment > order.grand_total) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Paid amount can not be greater than the Grand Total\",\r\n            });\r\n        }\r\n\r\n        let paymentDetails = {\r\n            paymentId: generateRandomID(10),\r\n            order_id: order._id,\r\n            customer_id: order.customer_id,\r\n            payment_status: \"Pending\",\r\n            payment_mode,\r\n            transactionId: generateRandomID(25),\r\n            payment_amount: payment,\r\n            payment_date: new Date().toLocaleString(),\r\n            partial_mode: null,\r\n        };\r\n\r\n        if (payment_mode === \"TEN_ADV\") {\r\n            let ten_percent_amount = order.grand_total * 0.1;\r\n            let partialPaymentDetails = {\r\n                payment_mode: \"TEN_ADV\",\r\n                amount: ten_percent_amount,\r\n                date: new Date(),\r\n                transactionId: generateRandomID(25),\r\n            };\r\n\r\n            // paymentDetailsData.push(partialPaymentDetails);\r\n\r\n            let firstPartialPayment = await partialPaymentModel.findOne({});\r\n\r\n            if (firstPartialPayment) {\r\n                let partialPaymentDetails = {\r\n                    payment_mode: \"TEN_ADV\",\r\n                    amount: order.grand_total - ten_percent_amount,\r\n                    date: new Date(),\r\n                    transactionId: generateRandomID(25),\r\n                };\r\n                firstPartialPayment.paymentDetails.push(partialPaymentDetails);\r\n\r\n                await firstPartialPayment.save();\r\n            }\r\n\r\n            let partialPaymentData = {\r\n                paymentDetails: partialPaymentDetails,\r\n                remaining_amount: order.grand_total - partialPaymentDetails.amount,\r\n            };\r\n\r\n            newPartialPayment = await partialPaymentModel.create(partialPaymentData);\r\n\r\n            paymentDetails.partial_mode = newPartialPayment._id;\r\n\r\n            paymentDetails.payment_status = \"Pending\";\r\n            paymentDetails.payment_amount = ten_percent_amount;\r\n\r\n            paymentDetails.paymentDetails = [partialPaymentDetails];\r\n\r\n            let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n            return res.status(200).send({\r\n                status: true,\r\n                message: \"Success\",\r\n                data: {\r\n                    partialPaymentData: newPartialPayment,\r\n                    paymentData: newPayment,\r\n                },\r\n            });\r\n        } else if (payment_mode === \"TWENTY_ADV\") {\r\n            let twenty_percent_amount = order.grand_total * 0.2;\r\n            let partialPaymentDetails = {\r\n                payment_mode: \"TWENTY_ADV\",\r\n                amount: twenty_percent_amount,\r\n                date: new Date(),\r\n                transactionId: generateRandomID(25),\r\n            };\r\n\r\n            let firstPartialPayment = await partialPaymentModel.findOne({\r\n                payment_mode: \"TWENTY_ADV\",\r\n            });\r\n\r\n            if (firstPartialPayment) {\r\n                let partialPaymentDetails = {\r\n                    payment_mode: \"TWENTY_ADV\",\r\n                    amount: order.grand_total - twenty_percent_amount,\r\n                    date: new Date(),\r\n                    transactionId: generateRandomID(25),\r\n                };\r\n                firstPartialPayment.paymentDetails.push(partialPaymentDetails);\r\n\r\n                await firstPartialPayment.save();\r\n            }\r\n\r\n            let partialPaymentData = {\r\n                paymentDetails: partialPaymentDetails,\r\n                remaining_amount: order.grand_total - partialPaymentDetails.amount,\r\n            };\r\n\r\n            newPartialPayment = await partialPaymentModel.create(partialPaymentData);\r\n\r\n            paymentDetails.partial_mode = newPartialPayment._id;\r\n            paymentDetails.payment_status = \"PENDING\";\r\n            paymentDetails.payment_amount = twenty_percent_amount;\r\n\r\n            paymentDetails.paymentDetails = [partialPaymentDetails];\r\n\r\n            let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n            return res.status(200).send({\r\n                status: true,\r\n                message: \"Success\",\r\n                data: {\r\n                    partialPaymentData: newPartialPayment,\r\n                    paymentData: newPayment,\r\n                },\r\n            });\r\n        } else if (payment_mode === \"COD\") {\r\n            if (payment < order.grand_total) {\r\n                let partialPaymentDetails = {\r\n                    payment_mode: \"COD\",\r\n                    amount: payment,\r\n                    date: new Date(),\r\n                    transactionId: generateRandomID(25),\r\n                };\r\n\r\n                // Update the existing Partial_Payment or create a new one\r\n                let partialPaymentData = await partialPaymentModel.findOne({\r\n                    payment_mode: \"COD\",\r\n                });\r\n\r\n                if (partialPaymentData) {\r\n                    partialPaymentData.paymentDetails.push(partialPaymentDetails);\r\n                    partialPaymentData.remaining_amount = order.grand_total - payment - partialPaymentData.paymentDetails.reduce((sum, item) => sum + item.amount, 0);\r\n\r\n                    await partialPaymentData.save();\r\n\r\n                    paymentDetails.partial_mode = partialPaymentData._id;\r\n                } else {\r\n                    partialPaymentData = await partialPaymentModel.create({\r\n                        paymentDetails: [partialPaymentDetails],\r\n                        remaining_amount: order.grand_total - payment,\r\n                        payment_mode: \"COD\",\r\n                    });\r\n\r\n                    const newPartialPayment = await partialPaymentData.save();\r\n                    paymentDetails.partial_mode = newPartialPayment._id;\r\n                }\r\n\r\n                // let partialPaymentData = {\r\n                //   paymentDetails: partialPaymentDetails,\r\n                //   remaining_amount: order.grand_total - partialPaymentDetails.amount,\r\n                // };\r\n\r\n                newPartialPayment = await partialPaymentModel.create(partialPaymentData);\r\n\r\n                paymentDetails.partial_mode = newPartialPayment._id;\r\n                paymentDetails.payment_status = \"PENDING\";\r\n                let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n                return res.status(200).send({\r\n                    status: true,\r\n                    message: \"Success\",\r\n                    data: {\r\n                        partialPaymentData: newPartialPayment,\r\n                        paymentData: newPayment,\r\n                    },\r\n                });\r\n            } else {\r\n                paymentDetails.payment_status = \"RECEIVED\";\r\n                let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n                return res.status(200).send({\r\n                    status: true,\r\n                    message: \"Success\",\r\n                    data: {\r\n                        paymentData: newPayment,\r\n                    },\r\n                });\r\n            }\r\n        } else {\r\n            if (payment === order.grand_total) {\r\n                paymentDetails.payment_status = \"RECEIVED\";\r\n                let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n                return res.status(200).send({ status: true, message: \"Success\", data: newPayment });\r\n            } else {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Paid amount should be equal to Grand Total\",\r\n                });\r\n            }\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { createPayment, updatePaymentStatus, addPayment };\r\n","const { isValidObjectId } = require(\"mongoose\");\r\nconst request = require(\"request\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst brandModel = require(\"../models/brandModel\");\r\nconst categoryModel = require(\"../models/categoryModel\");\r\nconst subCategoryModel = require(\"../models/subcategoryModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst { uploadFile } = require(\"./imageController\");\r\nconst { calculateMarginAndSelling } = require(\"../utils/percentage\");\r\n\r\nconst uploadMultipleImage = async (blob) => {\r\n    let imageFile = await uploadFile(blob);\r\n    return imageFile;\r\n};\r\n\r\n// ADD PRODUCT\r\nconst addProduct = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let {\r\n            product_name,\r\n            sku_code,\r\n            hsn_code,\r\n            brandId,\r\n            color,\r\n            categoryId,\r\n            subCatId,\r\n            stockStatus,\r\n            lotSizeQty,\r\n            mrp,\r\n            seller_price,\r\n            gst,\r\n            sellingGST,\r\n            margin,\r\n            qty_in_hand,\r\n            min_order_qty,\r\n            sole,\r\n            material,\r\n            packing_type,\r\n            made_in,\r\n            weight,\r\n            description,\r\n            meta,\r\n            vendor_id,\r\n        } = data;\r\n\r\n        if (!isValid(product_name)) {\r\n            return res.status(400).send({ status: false, message: \"Product name is required\" });\r\n        }\r\n\r\n        if (!isValid(sku_code)) {\r\n            return res.status(400).send({ status: false, message: \"SKU code is required\" });\r\n        }\r\n        if (!isValid(hsn_code)) {\r\n            return res.status(400).send({ status: false, message: \"HSN code is required\" });\r\n        }\r\n\r\n        if (!isValid(mrp)) {\r\n            return res.status(400).send({ status: false, message: \"Product MRP is required\" });\r\n        }\r\n        if (!isValid(gst)) {\r\n            return res.status(400).send({ status: false, message: \"GST is required\" });\r\n        }\r\n        if (!isValid(brandId)) {\r\n            return res.status(400).send({ status: false, message: \"Brand ID is required\" });\r\n        }\r\n\r\n        if (!isValid(seller_price)) {\r\n            return res.status(400).send({ status: false, message: \"Seller price is required\" });\r\n        }\r\n\r\n        if (!isValid(categoryId)) {\r\n            return res.status(400).send({ status: false, message: \"Category ID is required\" });\r\n        }\r\n\r\n        if (!isValid(subCatId)) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Sub category ID is required\",\r\n            });\r\n        }\r\n\r\n        if (!isValid(stockStatus)) {\r\n            return res.status(400).send({ status: false, message: \"Stock status is required\" });\r\n        }\r\n        if (!isValid(lotSizeQty)) {\r\n            return res.status(400).send({ status: false, message: \"Lot size is required\" });\r\n        }\r\n\r\n        if (!isValid(qty_in_hand)) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Quantity in hand is required\",\r\n            });\r\n        }\r\n\r\n        if (!isValid(min_order_qty)) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Minimum order quantity is required\",\r\n            });\r\n        }\r\n\r\n        if (!isValid(color)) {\r\n            return res.status(400).send({ status: false, message: \"Product color is required\" });\r\n        }\r\n\r\n        if (req.userModel === \"ADMIN\") {\r\n            if (!isValid(sellingGST)) {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Selling GST is required\",\r\n                });\r\n            }\r\n            if (!isValid(margin)) {\r\n                return res.status(400).send({ status: false, message: \"Margin is required\" });\r\n            }\r\n            if (!isValid(vendor_id)) {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Vendor id is required\",\r\n                });\r\n            }\r\n        }\r\n\r\n        if (meta !== undefined) {\r\n            meta = JSON.parse(meta);\r\n        }\r\n        let productData = {\r\n            product_name,\r\n            sku_code,\r\n            brandId,\r\n            gst,\r\n            hsn_code,\r\n            color_id: JSON.parse(color),\r\n            categoryId,\r\n            subCatId,\r\n            stockStatus,\r\n            lotSizeQty: JSON.parse(lotSizeQty),\r\n            mrp,\r\n            seller_price,\r\n            qty_in_hand,\r\n            min_order_qty,\r\n            sole,\r\n            material,\r\n            packing_type,\r\n            made_in,\r\n            weight,\r\n            description,\r\n        };\r\n        if (req.userModel === \"ADMIN\") {\r\n            productData.sellingGST = sellingGST;\r\n            productData.margin = margin;\r\n            productData.status = \"Approved\";\r\n        }\r\n        if (meta !== undefined) {\r\n            productData.meta_title = meta.metaTitle;\r\n            productData.meta_keywords = meta.metaKeyword;\r\n            productData.meta_description = meta.metaDescription;\r\n        }\r\n        if (req.body.vendorId !== undefined) {\r\n            productData.vendor_id = req.body.vendorId;\r\n        } else {\r\n            productData.vendor_id = req.userId;\r\n        }\r\n\r\n        let multipleImage = [];\r\n        if (req.files && req.files.thumbnail) {\r\n            productData.thumbnail_pic = await uploadFile(req.files.thumbnail);\r\n        } else if (data.thumbnail !== undefined) {\r\n            productData.thumbnail_pic = data.thumbnail;\r\n        }\r\n        if (req.files && req.files.mulImg) {\r\n            multipleImage = req.files.mulImg;\r\n            let images = [];\r\n            if (Array.isArray(multipleImage)) {\r\n                for (let val of multipleImage) {\r\n                    let img = await uploadMultipleImage(val);\r\n                    images.push(img);\r\n                }\r\n            } else {\r\n                let img = await uploadMultipleImage(multipleImage);\r\n                images.push(img);\r\n            }\r\n            productData.multiple_pics = images;\r\n            // console.log(images);\r\n        } else if (data.mulImg !== undefined) {\r\n            productData.multiple_pics = data.mulImg;\r\n        }\r\n        // console.log(data);\r\n        let brandObj = await brandModel.findById(brandId);\r\n        let categoryObj = await categoryModel.findById(categoryId);\r\n        let subCatObj = await subCategoryModel.findById(subCatId);\r\n\r\n        if (!brandObj || !categoryObj || !subCatObj) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Brand, aritcle, category or subcategory id had some error\",\r\n            });\r\n        }\r\n        brandId = brandObj;\r\n        categoryId = categoryObj;\r\n        subCatId = subCatObj;\r\n\r\n        let product = await productModel.create(productData);\r\n        let vendor = null;\r\n        if (req.userModel === \"ADMIN\") {\r\n            vendor = await vendorModel.findById(vendor_id);\r\n            product.vendor_id = vendor._id;\r\n        } else {\r\n            vendor = await vendorModel.findById(req.userId);\r\n            product.vendor_id = vendor._id;\r\n        }\r\n        vendor.products.push(product);\r\n        await vendor.save();\r\n        await product.save();\r\n        return res.status(201).send({ status: true, message: \"Success\", data: product });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL PRODUCTS\r\nconst getAllProducts = async (req, res) => {\r\n    try {\r\n        let data = [];\r\n        if (req.userModel === \"VENDOR\") {\r\n            let products = await productModel.find({ isDeleted: false, vendor_id: req.userId }).populate([\"color_id\", \"categoryId\", \"subCatId\", \"brandId\"]);\r\n            data = products;\r\n        } else {\r\n            let products = await productModel.find({ isDeleted: false }).populate([\"color_id\", \"categoryId\", \"subCatId\", \"brandId\", \"vendor_id\"]);\r\n            for (let x of products) {\r\n                if (x.vendor_id.status === \"Approved\") {\r\n                    data.push(x);\r\n                }\r\n            }\r\n        }\r\n        return res.status(200).send({ status: true, data: data });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllProductsForDashboard = async (req, res) => {\r\n    try {\r\n        let products = await productModel\r\n            .find({\r\n                isDeleted: false,\r\n                stockStatus: \"In_stock\",\r\n                status: \"Approved\",\r\n            })\r\n            .populate([\"color_id\", \"categoryId\", \"subCatId\", \"brandId\", \"vendor_id\"]);\r\n\r\n        let data = [];\r\n        for (let x of products) {\r\n            if (x.vendor_id.status === \"Approved\") {\r\n                data.push(x);\r\n            }\r\n        }\r\n        return res.status(200).send({ status: true, data: data });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst getAllProductsForFilter = async (req, res) => {\r\n    try {\r\n        products = await productModel\r\n            .find({\r\n                isDeleted: false,\r\n                stockStatus: \"In_stock\",\r\n                status: \"Approved\",\r\n            })\r\n            .populate([\"color_id\", \"categoryId\", \"subCatId\", \"brandId\", \"vendor_id\"]);\r\n        return res.status(200).send({ status: true, data: products });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET PRODUCT BY PRODUCT ID\r\nconst getProductById = async (req, res) => {\r\n    try {\r\n        let productId = req.params.productId;\r\n        let product = null;\r\n        if (req.userModel === \"VENDOR\") {\r\n            product = await productModel.findOne({\r\n                _id: productId,\r\n                isDeleted: false,\r\n                vendor_id: req.userId,\r\n            });\r\n        } else {\r\n            product = await productModel.findOne({\r\n                _id: productId,\r\n                isDeleted: false,\r\n            });\r\n        }\r\n        return res.status(200).send({ status: true, data: product });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE PRODUCT BY PRODUCT ID\r\nconst updateProductByProductId = async (req, res) => {\r\n    try {\r\n        let productId = req.params.productId;\r\n        if (!isValidObjectId(productId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid product id\" });\r\n        }\r\n\r\n        let product = await productModel.findOne({\r\n            _id: productId,\r\n            isDeleted: false,\r\n        });\r\n\r\n        if (!product) {\r\n            return res.status(404).send({ status: false, message: \"Product not found\" });\r\n        }\r\n\r\n        let body = req.body;\r\n\r\n        if (\"product_name\" in body) {\r\n            product.product_name = body.product_name;\r\n        }\r\n\r\n        if (\"sku_code\" in body) {\r\n            product.sku_code = body.sku_code;\r\n        }\r\n\r\n        if (\"description\" in body) {\r\n            product.description = body.description;\r\n        }\r\n\r\n        if (\"mrp\" in body) {\r\n            product.mrp = body.mrp;\r\n        }\r\n\r\n        if (\"seller_price\" in body) {\r\n            product.seller_price = body.seller_price;\r\n        }\r\n\r\n        if (\"selling_price\" in body) {\r\n            product.selling_price = body.selling_price;\r\n        }\r\n\r\n        if (\"gst_amount\" in body) {\r\n            product.gst_amount = body.gst_amount;\r\n        }\r\n\r\n        if (\"stock_status\" in body) {\r\n            product.stockStatus = body.stock_status;\r\n        }\r\n\r\n        if (\"qty_in_hand\" in body) {\r\n            product.qty_in_hand = body.qty_in_hand;\r\n        }\r\n\r\n        if (\"min_order_qty\" in body) {\r\n            product.min_order_qty = body.min_order_qty;\r\n        }\r\n\r\n        if (\"size_qty\" in body) {\r\n            product.size_qty = body.size_qty;\r\n        }\r\n\r\n        if (\"color\" in body) {\r\n            product.color = body.color;\r\n        }\r\n\r\n        if (\"style\" in body) {\r\n            product.style = body.style;\r\n        }\r\n\r\n        if (\"sole\" in body) {\r\n            product.sole = body.sole;\r\n        }\r\n\r\n        if (\"material\" in body) {\r\n            product.material = body.material;\r\n        }\r\n\r\n        if (\"packing_type\" in body) {\r\n            product.packing_type = body.packing_type;\r\n        }\r\n\r\n        if (\"made_in\" in body) {\r\n            product.made_in = body.made_in;\r\n        }\r\n\r\n        if (\"primary_category\" in body) {\r\n            product.primary_category = body.primary_category;\r\n        }\r\n\r\n        if (\"weight\" in body) {\r\n            product.weight = body.weight;\r\n        }\r\n\r\n        if (\"category\" in body) {\r\n            product.categoryId = body.category;\r\n        }\r\n\r\n        if (\"meta_title\" in body) {\r\n            product.meta_title = body.meta_title;\r\n        }\r\n\r\n        if (\"meta_description\" in body) {\r\n            product.meta_description = body.meta_description;\r\n        }\r\n\r\n        if (\"status\" in body) {\r\n            product.status = body.status;\r\n        }\r\n\r\n        await product.save();\r\n\r\n        return res.status(200).send({ status: true, message: \"success\", data: product });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// DELETE PRODUCT BY PRODUCT ID\r\nconst deleteProductByProductId = async (req, res) => {\r\n    try {\r\n        let productId = req.params.productId;\r\n        if (!isValidObjectId) {\r\n            return res.status(400).send({ status: false, message: \"Invalid product id\" });\r\n        }\r\n\r\n        let product = await productModel.findOne({\r\n            _id: productId,\r\n            isDeleted: false,\r\n        });\r\n\r\n        if (!product) {\r\n            return res.status(404).send({ status: false, message: \"Product not found\" });\r\n        }\r\n\r\n        let deleteProduct = await productModel.findOneAndUpdate(\r\n            {\r\n                _id: productId,\r\n                isDeleted: false,\r\n            },\r\n            {\r\n                isDeleted: true,\r\n                deletedAt: new Date(),\r\n            },\r\n            { new: true }\r\n        );\r\n\r\n        if (!deleteProduct) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Product not found or already deleted\",\r\n            });\r\n        }\r\n\r\n        return res.status(200).send({ status: true, message: \"Product deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst changeProductStatus = async (req, res) => {\r\n    try {\r\n        let { newStatus, margin, sellingGST } = req.body;\r\n        let productId = req.params.productId;\r\n        let product = await productModel.findById(productId);\r\n        if (!product) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Bad request\",\r\n            });\r\n        }\r\n        product.status = newStatus;\r\n        if (newStatus === \"Approved\") {\r\n            if (!margin || !sellingGST) {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Bad request\",\r\n                });\r\n            }\r\n            product.margin = margin;\r\n            product.sellingGST = sellingGST;\r\n            product.selling_price = product.seller_price;\r\n        } else {\r\n            product.margin = undefined;\r\n            product.sellingGST = undefined;\r\n            product.selling_price = undefined;\r\n        }\r\n        await product.save();\r\n        return res.status(200).send({ status: true, message: \"Product updated successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst changeProductStockStatus = async (req, res) => {\r\n    try {\r\n        let { newStockStatus } = req.body;\r\n        let productId = req.params.productId;\r\n        let product = await productModel.findById(productId);\r\n        if (!product) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Bad request\",\r\n            });\r\n        }\r\n        product.stockStatus = newStockStatus;\r\n        await product.save();\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Product Stock Status updated successfully\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst csvProduct = async (req, res) => {\r\n    try {\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Product Stock Status updated successfully\",\r\n            data: \"xlsxUrl\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst updateProduct = async (req, res) => {\r\n    try {\r\n        let productId = req.params.productId;\r\n        let {\r\n            product_name,\r\n            sku_code,\r\n            hsn_code,\r\n            description,\r\n            mrp,\r\n            gst,\r\n            seller_price,\r\n            sellingGST,\r\n            margin,\r\n            qty_in_hand,\r\n            min_order_qty,\r\n            lotSizeQty,\r\n            color_id,\r\n            sole,\r\n            material,\r\n            packing_type,\r\n            made_in,\r\n            weight,\r\n            categoryId,\r\n            subCatId,\r\n        } = req.body;\r\n\r\n        let product = await productModel.findById(productId);\r\n        if (product_name) {\r\n            product.product_name = product_name;\r\n        }\r\n        if (sku_code) {\r\n            product.sku_code = sku_code;\r\n        }\r\n        if (hsn_code) {\r\n            product.hsn_code = hsn_code;\r\n        }\r\n        if (description) {\r\n            product.description = description;\r\n        }\r\n        if (mrp) {\r\n            product.mrp = mrp;\r\n        }\r\n        if (gst) {\r\n            product.gst = gst;\r\n        }\r\n        if (seller_price) {\r\n            product.seller_price = seller_price;\r\n        }\r\n        if (sellingGST) {\r\n            product.sellingGST = sellingGST;\r\n        }\r\n        if (margin) {\r\n            product.margin = margin;\r\n        }\r\n        if (qty_in_hand) {\r\n            product.qty_in_hand = qty_in_hand;\r\n        }\r\n        if (min_order_qty) {\r\n            product.min_order_qty = min_order_qty;\r\n        }\r\n        if (lotSizeQty) {\r\n            product.lotSizeQty = lotSizeQty.split(\",\");\r\n        }\r\n        if (color_id) {\r\n            console.log(color_id);\r\n            product.color_id = color_id;\r\n        }\r\n        if (sole) {\r\n            product.sole = sole;\r\n        }\r\n        if (material) {\r\n            product.material = material;\r\n        }\r\n        if (packing_type) {\r\n            product.packing_type = packing_type;\r\n        }\r\n        if (made_in) {\r\n            product.made_in = made_in;\r\n        }\r\n        if (weight) {\r\n            product.weight = weight;\r\n        }\r\n        if (categoryId) {\r\n            product.categoryId = categoryId;\r\n        }\r\n        if (subCatId) {\r\n            product.subCatId = subCatId;\r\n        }\r\n        if (req.files) {\r\n            let { thumbnail_pic, multiple_pics } = req.files;\r\n            if (thumbnail_pic) {\r\n                product.thumbnail_pic = await uploadFile(thumbnail_pic);\r\n            }\r\n            if (multiple_pics) {\r\n                if (multiple_pics.length) {\r\n                    let images = [];\r\n                    for (let singleFile of multiple_pics) {\r\n                        let x = await uploadMultipleImage(singleFile);\r\n                        images.push(x);\r\n                    }\r\n                    product.multiple_pics = images;\r\n                } else {\r\n                    let x = await uploadFile(multiple_pics);\r\n                    product.multiple_pics = [x];\r\n                }\r\n            }\r\n        }\r\n        await product.save();\r\n        return res.status(201).send({\r\n            status: true,\r\n            message: \"Product updated successfully\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addProduct,\r\n    getAllProducts,\r\n    getProductById,\r\n    updateProductByProductId,\r\n    deleteProductByProductId,\r\n    getAllProductsForDashboard,\r\n    changeProductStatus,\r\n    changeProductStockStatus,\r\n    csvProduct,\r\n    getAllProductsForFilter,\r\n    updateProduct,\r\n};\r\n","const adminModel = require(\"../models/adminModel\");\nconst vendorModel = require(\"../models/vendorModel\");\nconst { uploadFile } = require(\"./imageController\");\nconst bcrypt = require(\"bcrypt\");\n\nconst changePassword = async (req, res) => {\n    let vendor = await vendorModel.findById(req.body.userid);\n    vendor.password = await bcrypt.hash(req.body.password, 10);\n    vendor.save();\n    res.status(200).send({\n        status: true,\n        message: \"password changed successfully\",\n    });\n};\n\nconst updateProfile = async (req, res) => {\n    try {\n        let userId = req.userId;\n        let userType = req.userModel;\n        let { fullName, emailID, phone, altPhone, newPass, oldPass } = req.body;\n        if (userType === \"ADMIN\") {\n            let admin = await adminModel.findById(userId);\n            if (oldPass && newPass) {\n                bcrypt.compare(oldPass, admin.password, function (err, result) {\n                    if (err) {\n                    }\n                    hasAccess(result, admin);\n                });\n                async function hasAccess(result, admin) {\n                    if (result) {\n                        admin.password = await bcrypt.hash(newPass, 10);\n                        if (fullName) admin.name = fullName;\n                        if (emailID) admin.email = emailID;\n                        if (phone && emailID) {\n                            let x = await adminModel.find({\n                                $or: [{ email: emailID }, { phone: phone }],\n                            });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message:\n                                        \"Mobile and Email number already exists\",\n                                });\n                            }\n                            admin.phone = phone;\n                            admin.email = emailID;\n                        } else if (phone) {\n                            let x = await adminModel.find({ phone: phone });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message: \"Mobile number already exists\",\n                                });\n                            }\n                            admin.phone = phone;\n                        } else if (emailID) {\n                            let x = await adminModel.find({ email: emailID });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message: \"Email id already exists\",\n                                });\n                            }\n                            admin.email = emailID;\n                        }\n\n                        if (req.files) {\n                            let { profileImg } = req.files;\n                            let imgRes = await uploadFile(profileImg);\n                            admin.profileUrl = imgRes;\n                        }\n                        let y = await admin.save();\n                        let data = {};\n                        data.name = y.name;\n                        data.email = y.email;\n                        data.userType = y.isSuperAdmin\n                            ? \"Super Admin\"\n                            : \"Admin\";\n                        data.role = y.role;\n                        data.phone = y.phone;\n                        data.photo = y.profileUrl;\n                        // console.log(vendor);\n                        return res.status(202).send({\n                            status: true,\n                            message: \"Profile updated successfully\",\n                            data: data,\n                        });\n                    } else {\n                        return res.status(401).send({\n                            status: true,\n                            message: \"Invalid Password\",\n                        });\n                    }\n                }\n            } else {\n                if (fullName) admin.name = fullName;\n                if (emailID) admin.email = emailID;\n                if (phone && emailID) {\n                    let x = await adminModel.find({\n                        $or: [{ email: emailID }, { phone: phone }],\n                    });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Mobile and Email number already exists\",\n                        });\n                    }\n                    admin.phone = phone;\n                    admin.email = emailID;\n                } else if (phone) {\n                    let x = await adminModel.find({ phone: phone });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Mobile number already exists\",\n                        });\n                    }\n                    admin.phone = phone;\n                } else if (emailID) {\n                    let x = await adminModel.find({ email: emailID });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Email id already exists\",\n                        });\n                    }\n                    admin.email = emailID;\n                }\n\n                if (req.files) {\n                    let { profileImg } = req.files;\n                    let imgRes = await uploadFile(profileImg);\n                    admin.profileUrl = imgRes;\n                }\n                let y = await admin.save();\n                let data = {};\n                data.name = y.name;\n                data.email = y.email;\n                data.userType = y.isSuperAdmin ? \"Super Admin\" : \"Admin\";\n                data.role = y.role;\n                data.phone = y.phone;\n                data.photo = y.profileUrl;\n                // console.log(vendor);\n                return res.status(202).send({\n                    status: true,\n                    message: \"Profile updated successfully\",\n                    data: data,\n                });\n            }\n        } else {\n            let vendor = await vendorModel.findById(userId);\n            if (oldPass && newPass) {\n                bcrypt.compare(\n                    oldPass,\n                    vendor.password,\n                    function (err, result) {\n                        if (err) {\n                        }\n                        hasAccess(result, vendor);\n                    }\n                );\n                async function hasAccess(result, vendor) {\n                    if (result) {\n                        console.log(result);\n                        vendor.password = await bcrypt.hash(newPass, 10);\n                        if (fullName) vendor.representativeName = fullName;\n                        if (altPhone) vendor.altMobileNo = altPhone;\n                        if (req.files) {\n                            let { profileImg } = req.files;\n                            let imgRes = await uploadFile(profileImg);\n                            vendor.profileUrl = imgRes;\n                        }\n                        if (phone && emailID) {\n                            let x = await vendorModel.find({\n                                $or: [\n                                    { emailId: emailID },\n                                    { mobileNo: phone },\n                                ],\n                            });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message:\n                                        \"Mobile and Email number already exists\",\n                                });\n                            }\n                            vendor.mobileNo = phone;\n                            vendor.emailId = emailID;\n                        } else if (phone) {\n                            let x = await vendorModel.find({ mobileNo: phone });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message: \"Mobile number already exists\",\n                                });\n                            }\n                            vendor.mobileNo = phone;\n                        } else if (emailID) {\n                            let x = await vendorModel.find({\n                                emailId: emailID,\n                            });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message: \"Email id already exists\",\n                                });\n                            }\n                            vendor.emailId = emailID;\n                        }\n\n                        let y = await vendor.save();\n                        let data = {};\n                        data.name = y.representativeName;\n                        data.email = y.emailId;\n                        data.userType = \"Seller\";\n                        data.role = y.role;\n                        data.altMobileNo = y.altMobileNo;\n                        data.phone = y.mobileNo;\n                        data.photo = y.profileUrl;\n                        data.vendorId = y.vendor_unique_id;\n                        return res.status(202).send({\n                            status: true,\n                            message: \"Profile updated successfully\",\n                            data: data,\n                        });\n                    } else {\n                        return res.status(401).send({\n                            status: true,\n                            message: \"Invalid Password\",\n                        });\n                    }\n                }\n            } else {\n                if (fullName) vendor.representativeName = fullName;\n                if (altPhone) vendor.altMobileNo = altPhone;\n                if (req.files) {\n                    let { profileImg } = req.files;\n                    let imgRes = await uploadFile(profileImg);\n                    vendor.profileUrl = imgRes;\n                }\n                if (phone && emailID) {\n                    let x = await vendorModel.find({\n                        $or: [{ emailId: emailID }, { mobileNo: phone }],\n                    });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Mobile and Email number already exists\",\n                        });\n                    }\n                    vendor.mobileNo = phone;\n                    vendor.emailId = emailID;\n                } else if (phone) {\n                    let x = await vendorModel.find({ mobileNo: phone });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Mobile number already exists\",\n                        });\n                    }\n                    vendor.mobileNo = phone;\n                } else if (emailID) {\n                    let x = await vendorModel.find({\n                        emailId: emailID,\n                    });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Email id already exists\",\n                        });\n                    }\n                    vendor.emailId = emailID;\n                }\n\n                let y = await vendor.save();\n                let data = {};\n                data.name = y.representativeName;\n                data.email = y.emailId;\n                data.userType = \"Seller\";\n                data.role = y.role;\n                data.altMobileNo = y.altMobileNo;\n                data.phone = y.mobileNo;\n                data.photo = y.profileUrl;\n                data.vendorId = y.vendor_unique_id;\n                return res.status(202).send({\n                    status: true,\n                    message: \"Profile updated successfully\",\n                    data: data,\n                });\n            }\n        }\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nmodule.exports = { updateProfile, changePassword };\n","const questionModel = require(\"../models/questionModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\n\r\n// ADD QUESTIONS\r\nconst addQuestions = async (req, res) => {\r\n    try {\r\n        let { questionFor, question } = req.body;\r\n\r\n        if (!isValid(questionFor)) {\r\n            return res.status(400).send({ status: false, message: \"QuestionFor field is required\" });\r\n        }\r\n\r\n        if (!isValid(question)) {\r\n            return res.status(400).send({ status: false, message: \"Question is required\" });\r\n        }\r\n\r\n        let questionObj = {\r\n            questionFor,\r\n            question,\r\n        };\r\n\r\n        await questionModel.create(questionObj);\r\n        let allQuestion = await questionModel.find({ questionFor: questionFor, isDeleted: false });\r\n\r\n        return res.status(201).send({\r\n            status: true,\r\n            message: \"Question added successfully\",\r\n            data: allQuestion,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllQuestionByModel = async (req, res) => {\r\n    try {\r\n        let model = req.userModel;\r\n        let questions = await questionModel.find({ questionFor: model, isDeleted: false });\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Question fetched successfully\",\r\n            data: questions,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllQuestion = async (req, res) => {\r\n    try {\r\n        let questions = await questionModel.find({ isDeleted: false });\r\n        let data = {\r\n            admin: [],\r\n            vendor: [],\r\n            customer: [],\r\n        };\r\n        for (let x of questions) {\r\n            if (x.questionFor === \"ADMIN\") {\r\n                data.admin.push(x);\r\n            }\r\n            if (x.questionFor === \"VENDOR\") {\r\n                data.vendor.push(x);\r\n            }\r\n            if (x.questionFor === \"CUSTOMER\") {\r\n                data.customer.push(x);\r\n            }\r\n        }\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Question fetched successfully\",\r\n            data: data,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst deleteQuestionById = async (req, res) => {\r\n    try {\r\n        let questionId = req.params.questionid;\r\n        let question = await questionModel.findById(questionId);\r\n        if (question) {\r\n            question.isDeleted = true;\r\n            await question.save();\r\n            let questions = await questionModel.find({ questionFor: question.questionFor, isDeleted: false });\r\n            return res.status(200).send({\r\n                status: true,\r\n                message: \"Question fetched successfully\",\r\n                data: questions,\r\n            });\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"question id is not valid\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { addQuestions, getAllQuestionByModel, getAllQuestion, deleteQuestionById };\r\n","const excelJs = require(\"exceljs\");\nconst orderModel = require(\"../models/orderModel\");\n\nconst getOrderReport = async (req, res) => {\n    try {\n        //{ saleInvoice: { $exists: true } }\n        let orders = await orderModel.find({ saleInvoice: { $exists: true } }).populate([\"payment_id\", \"order_status_id\"]);\n        return res.status(200).send({ status: true, message: \"Order Report fetched...\", data: orders });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst exportSaleReport = async (req, res) => {\n    try {\n        let { startDate, endDate } = req.body;\n        if (!startDate || !endDate) {\n            return res.status(400).send({ status: false, message: \"Start date end end date are required\" });\n        }\n        let date1 = new Date(startDate).getTime();\n        let date2 = new Date(endDate).getTime();\n        if (date1 > date2) {\n            return res.status(400).send({ status: false, message: \"Wrong date range\" });\n        }\n        var workbook = new excelJs.Workbook();\n        var worksheet = workbook.addWorksheet(\"Add Bulk Product\");\n\n        let columnData = [\n            { header: \"Order ID\", key: \"order_id\" },\n            { header: \"Order Date and Time\", key: \"order_date\" },\n            { header: \"Invoice No\", key: \"invoice_no\" },\n            { header: \"Invoice Date\", key: \"invoice_date\" },\n            { header: \"Order value\", key: \"order_value\" },\n            { header: \"Order Qty\", key: \"order_qty\" },\n            { header: \"Invoice value/confirmed value\", key: \"invoice_value\" },\n            { header: \"Advance\", key: \"advance\" },\n            { header: \"Discount\", key: \"discount\" },\n            { header: \"Net Amount\", key: \"net_amount\" },\n            { header: \"Refund\", key: \"refund\" },\n            { header: \"Cash on delivery\", key: \"cash_on_delivery\" },\n        ];\n        var data = {\n            order_id: \"FZ12345678\",\n            order_date: \"07-08-2023 at 18:37:00\",\n            invoice_no: \"FSIN2312345678\",\n            invoice_date: \"07-08-2023 at 18:37:00\",\n            order_qty: \"4\",\n            invoice_value: \"10000\",\n            advance: \"2000\",\n            discount: \"1200\",\n            net_amount: \"6800\",\n            refund: \"00\",\n            cash_on_delivery: \"6800\",\n        };\n        if (req.userModel === \"ADMIN\") {\n            columnData.unshift({ header: \"Buyer name\", key: \"buyer_name\" }, { header: \"Buyer No.\", key: \"buyer_no\" });\n\n            data.buyer_name = \"SANJEET KUMAR\";\n            data.buyer_no = 1234567891;\n        }\n        worksheet.columns = columnData;\n        worksheet.addRow(data);\n        worksheet.getRow(1).eachCell((cell) => {\n            cell.font = { bold: true };\n            cell.fill = {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: { argb: \"F08080\" },\n            };\n        });\n\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        res.setHeader(\"Content-Disposition\", `attachment; brandid.xlsx`);\n\n        return workbook.xlsx.write(res).then(() => {\n            res.status(200);\n        });\n        // return res.status(200).send({ status: true, message: \"Report exported\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst exportPurchaseReport = async (req, res) => {\n    try {\n        let { startDate, endDate } = req.body;\n        if (!startDate || !endDate) {\n            return res.status(400).send({ status: false, message: \"Start date end end date are required\" });\n        }\n        let date1 = new Date(startDate).getTime();\n        let date2 = new Date(endDate).getTime();\n        if (date1 > date2) {\n            return res.status(400).send({ status: false, message: \"Wrong date range\" });\n        }\n        var workbook = new excelJs.Workbook();\n        var worksheet = workbook.addWorksheet(\"Add Bulk Product\");\n        let columnData = [\n            { header: \"Order ID\", key: \"order_id\" },\n            { header: \"Order Date and Time\", key: \"order_date\" },\n            { header: \"Invoice No\", key: \"invoice_no\" },\n            { header: \"Invoice Date\", key: \"invoice_date\" },\n            { header: \"Seller name\", key: \"seller_name\" },\n            { header: \"Seller Phone No.\", key: \"seller_phone\" },\n            { header: \"Seller GST\", key: \"seller_gst\" },\n            { header: \"FactorEz GST\t\", key: \"factorez_gst\" },\n            { header: \"Purchase \", key: \"purchase\" },\n            { header: \"Invoice value/confirmed value\", key: \"invoice_value\" },\n            { header: \"GST Percentage\", key: \"gst_percentage\" },\n            { header: \"Taxable value\", key: \"taxable_value\" },\n            { header: \"Gst amount\", key: \"gst_amount\" },\n            { header: \"Quantity\", key: \"quantity\" },\n            { header: \"Order status\", key: \"order_status\" },\n        ];\n        var data = {\n            order_id: \"FZ12345678\",\n            order_date: \"07-08-2023 at 18:37:00\",\n            invoice_no: \"FSIN2312345678\",\n            invoice_date: \"07-08-2023 at 18:37:00\",\n            seller_name: \"Navnit Sekh\",\n            seller_phone: \"1234567891\",\n            seller_gst: \"09ABCDE4455R23\",\n            factorez_gst: \"09ABCDE4455R23\",\n            purchase: \"4000\",\n            invoice_value: \"5000\",\n            gst_percentage: \"18\",\n            taxable_value: \"5000\",\n            gst_amount: \"1000\",\n            quantity: \"3\",\n            order_status: \"pending\",\n        };\n        // if (req.userModel === \"ADMIN\") {\n        //     columnData.unshift({ header: \"Buyer name\", key: \"buyer_name\" }, { header: \"Buyer No.\", key: \"buyer_no\" });\n\n        //     data.buyer_name = \"SANJEET KUMAR\";\n        //     data.buyer_no = 1234567891;\n        // }\n        worksheet.columns = columnData;\n        worksheet.addRow(data);\n        worksheet.getRow(1).eachCell((cell) => {\n            cell.font = { bold: true };\n            cell.fill = {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: { argb: \"F08080\" },\n            };\n        });\n\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        res.setHeader(\"Content-Disposition\", `attachment; brandid.xlsx`);\n\n        return workbook.xlsx.write(res).then(() => {\n            res.status(200);\n        });\n        // return res.status(200).send({ status: true, message: \"Report exported\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst getPaymentReport = async (req, res) => {\n    try {\n        let orders = await orderModel.find({ saleInvoice: { $exists: true } }).populate([\"vendorId\", \"payment_id\", \"order_status_id\"]);\n        return res.status(200).send({ status: true, message: \"Payment report fetched\", data: orders });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst updatePaymentReport = async (req, res) => {\n    try {\n        let orderId = req.params.orderid;\n        let { paymentStatus, paidAmount, paymentDate, transactionId, settlementAmt, message } = req.body;\n        let data = req.body;\n        let order = await orderModel.findById(orderId);\n        if (!order) {\n            return res.status(400).send({ status: false, message: \"Order id not found\" });\n        }\n        if (paymentStatus) order.paymentReportStatus.paymentStatus = paymentStatus;\n        if (paidAmount) order.paymentReportStatus.paidAmount = paidAmount;\n        if (paymentDate) order.paymentReportStatus.paymentDate = paymentDate;\n        if (transactionId) order.paymentReportStatus.transactionId = transactionId;\n        if (settlementAmt) order.paymentReportStatus.settlementAmt = settlementAmt;\n        if (message) order.paymentReportStatus.message = message;\n        data.updateAt = new Date();\n        order.paymentReportStatus.logs.push(data);\n        await order.save();\n        let orders = await orderModel.find({ saleInvoice: { $exists: true } }).populate([\"vendorId\", \"payment_id\", \"order_status_id\"]);\n        return res.status(200).send({ status: true, message: \"Payment Report Updated\", data: orders });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nmodule.exports = { getOrderReport, exportSaleReport, exportPurchaseReport, getPaymentReport, updatePaymentReport };\n","const vendorModel = require(\"../models/vendorModel\");\r\nconst bankModel = require(\"../models/bankModel\");\r\nconst documentModel = require(\"../models/documentModel\");\r\nconst { uploadFile } = require(\"./imageController\");\r\nconst { generateRandomID, generateRandomAlphaNumericID } = require(\"../controllers/idGeneratorController\");\r\n\r\nconst { isValid, isValidEmail, isValidMoblie, isValidGST } = require(\"../utils/utils\");\r\nconst { roleEnums } = require(\"../utils/enums\");\r\nconst brandModel = require(\"../models/brandModel\");\r\nconst bcrypt = require(\"bcrypt\");\r\n\r\n// ADD VENDOR\r\nconst addVendor = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let {\r\n            firmName,\r\n            brandName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId,\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            acHolderName,\r\n            acNo,\r\n            bankName,\r\n            branch,\r\n            ifsc,\r\n            termsAndConditions,\r\n        } = data;\r\n        if (password === \"\") {\r\n            return res.status(400).send({ message: \"Password is required\", status: false });\r\n        }\r\n        password = await bcrypt.hash(password, 10);\r\n\r\n        let isVendor = await vendorModel.findOne({ emailId: emailId });\r\n        if (isVendor) {\r\n            return res.status(400).send({ message: \"Email id already exists\", status: false });\r\n        }\r\n        // console.log(data);\r\n        let gstRegDoc = await uploadFile(req.files.gstRegDoc);\r\n        let brandLogo = await uploadFile(req.files.brandLogo);\r\n        let brandRegDoc = await uploadFile(req.files.brandRegDoc);\r\n        let cancelledCheque = await uploadFile(req.files.cancelledCheque);\r\n        let documentData = {\r\n            brandRegDoc: brandRegDoc,\r\n            gstRegDoc: gstRegDoc,\r\n        };\r\n\r\n        let bankData = {\r\n            acHolderName: acHolderName,\r\n            acNo: acNo,\r\n            bankName: bankName,\r\n            branch: branch,\r\n            ifsc: ifsc,\r\n            cancelledCheque: cancelledCheque,\r\n        };\r\n\r\n        let brandData = {\r\n            brand_name: brandName,\r\n            brandLogo: brandLogo,\r\n        };\r\n        let vendorData = {\r\n            firmName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId: emailId.toLowerCase(),\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            termsAndConditions,\r\n        };\r\n\r\n        let document = await documentModel.create(documentData);\r\n        let bank = await bankModel.create(bankData);\r\n        let brand = await brandModel.create(brandData);\r\n\r\n        vendorData.bank_id = bank;\r\n        vendorData.document_id = document;\r\n        vendorData.brand_id = brand;\r\n        vendorData.vendor_unique_id = generateRandomID(10);\r\n        vendorData.auth_unique_id = generateRandomID(10);\r\n        vendorData.db_unique_id = generateRandomAlphaNumericID(20);\r\n        vendorData.sharing_unique_id = generateRandomAlphaNumericID(20);\r\n        // console.log(vendorData);\r\n        vendorData.role = [\"VENDOR\"];\r\n\r\n        let vendor = await vendorModel.create(vendorData);\r\n        brand.vendor_id = vendor;\r\n        await brand.save();\r\n        return res.status(201).send({ status: true, message: \"Success\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst createVendorByAdmin = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let adminId = req.userId;\r\n        let model = req.userModel;\r\n        let {\r\n            firmName,\r\n            brandName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId,\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            acHolderName,\r\n            acNo,\r\n            bankName,\r\n            branch,\r\n            ifsc,\r\n        } = data;\r\n        if (password === \"\") {\r\n            return res.status(400).send({ message: \"Password is required\", status: false });\r\n        }\r\n        let isVendor = await vendorModel.findOne({ emailId: emailId });\r\n        if (isVendor) {\r\n            return res.status(400).send({ message: \"Email id already exists\", status: false });\r\n        }\r\n        password = await bcrypt.hash(password, 10);\r\n        // console.log(data);\r\n        let gstRegDoc = await uploadFile(req.files.gstRegDoc);\r\n        let brandLogo = await uploadFile(req.files.brandLogo);\r\n        let brandRegDoc = await uploadFile(req.files.brandRegDoc);\r\n        let cancelledCheque = await uploadFile(req.files.cancelledCheque);\r\n        let documentData = {\r\n            brandRegDoc: brandRegDoc,\r\n            gstRegDoc: gstRegDoc,\r\n            actionTakenBy: adminId,\r\n        };\r\n\r\n        let bankData = {\r\n            acHolderName: acHolderName,\r\n            acNo: acNo,\r\n            bankName: bankName,\r\n            branch: branch,\r\n            ifsc: ifsc,\r\n            cancelledCheque: cancelledCheque,\r\n            actionTakenBy: adminId,\r\n        };\r\n\r\n        let brandData = {\r\n            brand_name: brandName,\r\n            brandLogo: brandLogo,\r\n            brandStatus: \"Approved\",\r\n        };\r\n        let vendorData = {\r\n            firmName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId: emailId.toLowerCase(),\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            termsAndConditions: true,\r\n        };\r\n        let document = await documentModel.create(documentData);\r\n        let bank = await bankModel.create(bankData);\r\n        let brand = await brandModel.create(brandData);\r\n        vendorData.bank_id = bank;\r\n        vendorData.document_id = document;\r\n        vendorData.brand_id = brand;\r\n        vendorData.vendor_unique_id = generateRandomID(10);\r\n        vendorData.auth_unique_id = generateRandomID(10);\r\n        vendorData.db_unique_id = generateRandomAlphaNumericID(20);\r\n        vendorData.sharing_unique_id = generateRandomAlphaNumericID(20);\r\n        vendorData.role = [\"VENDOR\"];\r\n        vendorData.actionTakenBy = adminId;\r\n        vendorData.status = \"Approved\";\r\n        vendorData.basicInfoStatus = \"Approved\";\r\n        let vendor = await vendorModel.create(vendorData);\r\n        brand.vendor_id = vendor;\r\n        await brand.save();\r\n        return res.status(201).send({ status: true, message: \"Success\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllVendors = async (req, res) => {\r\n    try {\r\n        let vendors = await vendorModel.find({ isDeleted: false }).populate([\"bank_id\", \"document_id\", \"actionTakenBy\", \"brand_id\"]);\r\n        return res.status(201).send({ status: true, message: \"Success\", data: vendors });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst updateVendor = async (req, res) => {\r\n    try {\r\n        let {\r\n            firmName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId,\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            brand_id,\r\n            brand_name,\r\n            bank_id,\r\n            acHolderName,\r\n            acNo,\r\n            bankName,\r\n            branch,\r\n            ifsc,\r\n        } = req.body;\r\n        let vendorObjId = req.params.vendorId;\r\n        let vendor = await vendorModel.findById(vendorObjId).populate([\"bank_id\", \"document_id\", \"brand_id\"]);\r\n        if (firmName) {\r\n            vendor.firmName = firmName;\r\n        }\r\n        if (gstNo) {\r\n            vendor.gstNo = gstNo;\r\n        }\r\n        if (representativeName) {\r\n            vendor.representativeName = representativeName;\r\n        }\r\n        if (emailId) {\r\n            vendor.emailId = emailId.toLowerCase();\r\n        }\r\n        if (password) {\r\n            vendor.password = await bcrypt.hash(password, 10);\r\n        }\r\n        if (mobileNo) {\r\n            vendor.mobileNo = mobileNo;\r\n        }\r\n        if (altMobileNo) {\r\n            vendor.altMobileNo = altMobileNo;\r\n        }\r\n        if (pickupState) {\r\n            vendor.pickupState = pickupState;\r\n        }\r\n        if (pickupState) {\r\n            vendor.pickupState = pickupState;\r\n        }\r\n        if (pickupCity) {\r\n            vendor.pickupCity = pickupCity;\r\n        }\r\n        if (pickupPincode) {\r\n            vendor.pickupPincode = pickupPincode;\r\n        }\r\n        if (invoiceAddress) {\r\n            vendor.invoiceAddress = invoiceAddress;\r\n        }\r\n        if (pickupAddress) {\r\n            vendor.pickupAddress = pickupAddress;\r\n        }\r\n        if (brand_id) {\r\n            for (let brandX of vendor.brand_id) {\r\n                console.log(brandX);\r\n                if (brandX._id.toString() === brand_id) {\r\n                    brandX.brand_name = brand_name;\r\n                    await brandX.save();\r\n                }\r\n            }\r\n        }\r\n        if (bank_id) {\r\n            if (bankName) {\r\n                vendor.bank_id.bankName = bankName;\r\n            }\r\n            if (acHolderName) {\r\n                vendor.bank_id.acHolderName = acHolderName;\r\n            }\r\n            if (acNo) {\r\n                vendor.bank_id.acNo = acNo;\r\n            }\r\n            if (branch) {\r\n                vendor.bank_id.branch = branch;\r\n            }\r\n            if (ifsc) {\r\n                vendor.bank_id.ifsc = ifsc;\r\n            }\r\n            await vendor.bank_id.save();\r\n        }\r\n\r\n        if (req.files) {\r\n            let { cancelledCheque, gstRegDoc, brandRegDoc } = req.files;\r\n            if (cancelledCheque) {\r\n                vendor.bank_id.cancelledCheque = await uploadFile(cancelledCheque);\r\n            }\r\n            if (gstRegDoc) {\r\n                vendor.document_id.gstRegDoc = await uploadFile(gstRegDoc);\r\n            }\r\n            if (brandRegDoc) {\r\n                vendor.document_id.brandRegDoc = await uploadFile(brandRegDoc);\r\n            }\r\n            await vendor.document_id.save();\r\n        }\r\n        await vendor.save();\r\n        res.status(201).send({ status: true, message: \"successfully\", data: vendor });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { getAllVendors, addVendor, createVendorByAdmin, updateVendor };\r\n","const { isValidObjectId } = require(\"mongoose\");\nconst productModel = require(\"../models/productModel\");\nconst wishlistModel = require(\"../models/wishlistModel\");\nconst customerModel = require(\"../models/customerModel\");\n\nconst addToWishlist = async (req, res) => {\n    try {\n        let { productId } = req.body;\n        if (!productId) {\n            return res.status(400).send({ status: false, message: \"bad request\" });\n        }\n        if (!isValidObjectId(productId)) {\n            return res.status(400).send({ status: false, message: \"invalid product id\" });\n        }\n        let product = await productModel.findById(productId);\n        if (!product) {\n            return res.status(400).send({ status: false, message: \"product not found\" });\n        }\n        let wishlistObj = await wishlistModel.findOne({ productId: productId, userId: req.userId });\n        if (wishlistObj) {\n            return res.status(200).send({ status: false, message: \"Already in wishlist\" });\n        }\n        let customer = await customerModel.findById(req.userId).populate(\"cart_id\");\n        await wishlistModel.create({ productId: productId, userId: customer._id });\n        let wishlist = await wishlistModel.find({ userId: customer._id });\n        let dataX = {\n            name: customer.name,\n            email: customer.email,\n            customerId: customer._id.toString(),\n            userType: \"CUSTOMER\",\n            isActivated: customer.isActivated,\n            phone: customer.phone,\n            cartLength: customer.cart_id.products.length,\n            wishlistLength: wishlist.length,\n        };\n        res.status(201).send({ status: true, data: dataX, message: \"Added to wishlist\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst removeFromWishlist = async (req, res) => {\n    try {\n        let wishlistId = req.params.wishlistId;\n        if (!wishlistId) {\n            return res.status(400).send({ status: false, message: \"bad request\" });\n        }\n        if (!isValidObjectId(wishlistId)) {\n            return res.status(400).send({ status: false, message: \"invalid wishlist id\" });\n        }\n        let wishlist = await wishlistModel.findOneAndDelete({ userId: req.userId, productId: wishlistId });\n        if (wishlist) {\n            res.status(200).send({ status: true, message: \"Removed from wishlist\" });\n        } else {\n            return res.status(400).send({ status: false, message: \"Bad request\" });\n        }\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\nconst getWishlistProduct = async (req, res) => {\n    try {\n        let data = await wishlistModel.find({ userId: req.userId }).populate(\"productId\");\n        res.status(200).send({ status: true, data: data, message: \"Wishlist fetched\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nmodule.exports = { addToWishlist, removeFromWishlist, getWishlistProduct };\n","const adminModel = require(\"../models/adminModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst { tokenSecretKey, customerTokenSecretKey } = require(\"../middlewares/config\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\n\r\n// AUTHENTICATION\r\nconst Authentication = async (req, res, next) => {\r\n    try {\r\n        let tokenWithBearer = req.headers.authorization;\r\n\r\n        if (!tokenWithBearer) {\r\n            return res.status(400).send({ status: false, message: \"token is required\" });\r\n        }\r\n\r\n        let tokenArray = tokenWithBearer.split(\" \");\r\n\r\n        let token = tokenArray[1];\r\n\r\n        if (!token) {\r\n            return res.status(401).send({ status: false, message: \"Invalid token\" });\r\n        }\r\n\r\n        jwt.verify(token, tokenSecretKey, function (err, decode) {\r\n            if (err) {\r\n                return res.status(400).send({ status: false, message: err.message });\r\n            } else {\r\n                req.userId = decode.userId;\r\n                req.userModel = decode.userModel;\r\n                req.userPhone = decode.phone ? decode.phone : \"\"; //'ADMIN': 'VENDOR'\r\n                next();\r\n            }\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst AuthenticationCustomer = async (req, res, next) => {\r\n    try {\r\n        let tokenWithBearer = req.headers.authorization;\r\n        \r\n        if (!tokenWithBearer) {\r\n            return res.status(400).send({ status: false, message: \"token is required\" });\r\n        }\r\n\r\n        let tokenArray = tokenWithBearer.split(\" \");\r\n\r\n        let token = tokenArray[1];\r\n\r\n        if (!token) {\r\n            return res.status(401).send({ status: false, message: \"Invalid token\" });\r\n        }\r\n\r\n        jwt.verify(token, customerTokenSecretKey, function (err, decode) {\r\n            if (err) {\r\n                return res.status(400).send({ status: false, message: err.message });\r\n            } else {\r\n                req.userId = decode.userId;\r\n                req.userModel = decode.userModel;\r\n                req.userPhone = decode.phone ? decode.phone : \"\"; //'ADMIN': 'VENDOR':\"CUSTOMER\"\r\n                next();\r\n            }\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// AUTHORIZATION\r\nconst Authorization = async (req, res, next) => {\r\n    try {\r\n        let tokenId = req.userId;\r\n        let UserId = req.params.userId;\r\n\r\n        if (!isValidObjectId(UserId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid admin id\" });\r\n        }\r\n\r\n        let admin = await adminModel.findById(UserId);\r\n\r\n        if (!admin) {\r\n            return res.status(404).send({ status: false, message: \"Admin not found\" });\r\n        }\r\n\r\n        let adminId = admin._id;\r\n\r\n        if (adminId.toString() !== tokenId.toString()) {\r\n            return res.status(403).send({ status: false, message: \"authorization failed\" });\r\n        }\r\n        next();\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { Authentication, Authorization, AuthenticationCustomer };\r\n","const dotenv = require(\"dotenv\");\r\n\r\n// getting all ENV variables before starting another processes\r\ndotenv.config();\r\n\r\nmodule.exports = {\r\n    mongoDbUrl: process.env.MONGO_DB_URL,\r\n    tokenSecretKey: process.env.TOKEN_SECRET_KEY,\r\n    customerTokenSecretKey: process.env.CUSTOMER_TOKEN_SECRET_KEY,\r\n    port: process.env.PORT,\r\n    apiKey: process.env.FIREBASE_API_KEY,\r\n    authDomain: process.env.FIREBASE_AUTH_DOMAIN,\r\n    projectId: process.env.FIREBASE_PROJECT_ID,\r\n    storageBucket: process.env.FIREBASE_STORAGE_BUCKET,\r\n    messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID,\r\n    appId: process.env.FIREBASE_APP_ID,\r\n    measurementId: process.env.FIREBASE_MEASUREMENT_ID,\r\n    adminSecretKey: process.env.ADMIN_SECRET_KEY,\r\n    twilioAuthToken: process.env.TWILIO_AUTH_TOKEN,\r\n    twilioAccSID: process.env.TWILIO_ACCOUNT_SID,\r\n    twilioVerifySID: process.env.TWILIO_VERIFY_SID,\r\n    awsAccessKey: process.env.AWS_ACCESS_KEY_ID,\r\n    awsSecretKey: process.env.AWS_SECRET_ACCESS_KEY,\r\n    awsS3Region: process.env.S3_REGION,\r\n    awsS3Bucket: process.env.S3_BUCKET,\r\n};\r\n","const dotenv = require(\"dotenv\");\r\nconst {\r\n  apiKey,\r\n  authDomain,\r\n  projectId,\r\n  storageBucket,\r\n  messagingSenderId,\r\n  appId,\r\n  measurementId,\r\n} = require(\"../middlewares/config\");\r\n\r\ndotenv.config();\r\n\r\nconst firebaseConfig = {\r\n  apiKey: apiKey,\r\n  authDomain: authDomain,\r\n  projectId: projectId,\r\n  storageBucket: storageBucket,\r\n  messagingSenderId: messagingSenderId,\r\n  appId: appId,\r\n  measurementId: measurementId,\r\n};\r\n\r\nmodule.exports = { firebaseConfig };","const adminModel = require(\"../models/adminModel\");\r\nlet customerModel = require(\"../models/customerModel\");\r\nlet vendorModel = require(\"../models/vendorModel\");\r\nconst { roleEnums, accessControls } = require(\"../utils/enums\");\r\n\r\nconst checkUser = async (req, accessEnum) => {\r\n    let user = null;\r\n    if (req.userModel === \"ADMIN\") {\r\n        user = await adminModel.findOne({ _id: req.userId });\r\n    } else if (req.userModel === \"VENDOR\") {\r\n        user = await vendorModel.findOne({ _id: req.userId });\r\n    }\r\n    if (!user) {\r\n        return false;\r\n    }\r\n    req.userData = user;\r\n    for (let x of user.role) {\r\n        if (accessEnum.includes(x)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n};\r\n\r\n// ADD PRODUCT ROLE\r\nconst AddProductRole = async (req, res, next) => {\r\n    try {\r\n        // roleEnums.MANAGE_PRODUCT.ADD_PRODUCT\r\n        req.userId;\r\n        const admin = await adminModel.findOne({ _id: req.userId });\r\n        next();\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// ALL PRODUCT ROLE\r\nconst AllProductRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [\r\n            accessControls.PRODUCT.PRODUCT_ALL_PRODUCT,\r\n            accessControls.PRODUCT.ACCESS.PRODUCT_DOWNLOAD,\r\n            accessControls.PRODUCT.ACCESS.PRODUCT_EDIT,\r\n            accessControls.PRODUCT.ACCESS.PRODUCT_VIEW,\r\n            accessControls.PRODUCT.PRODUCT_ADD_PRODUCT,\r\n            \"ADMIN\",\r\n        ];\r\n        if (req.userModel === \"VENDOR\") {\r\n            next();\r\n            return;\r\n        }\r\n        let flag = await checkUser(req, accessEnum);\r\n        if (flag) {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n        // admin.role.includes\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// ALL PRODUCT ROLE\r\nconst AllMenuRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [accessControls.PRODUCT.ACCESS.PRODUCT_DOWNLOAD, \"ADMIN\"];\r\n\r\n        let user;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        } else if (req.userModel === \"vendor\") {\r\n            user = await vendorModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n        // admin.role.includes\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE VENDORS\r\nconst AllVendorRoles = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [\r\n            accessControls.VENDOR.ACCESS.VENDOR_DOWNLOAD,\r\n            accessControls.VENDOR.ACCESS.VENDOR_EDIT,\r\n            accessControls.VENDOR.ACCESS.VENDOR_VIEW,\r\n            accessControls.VENDOR.VENDOR_ADD_VENDOR,\r\n            accessControls.VENDOR.VENDOR_ALL_VENDOR,\r\n            accessControls.VENDOR.VENDOR_VENDOR_MOV,\r\n            accessControls.VENDOR.VENDOR_VENDOR_PAYMENT,\r\n            \"ADMIN\",\r\n        ];\r\n        let user;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE VENDORS\r\nconst AddProductColorRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.PRODUCT_COLOR, \"ADMIN\"];\r\n        let user;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE VENDORS\r\nconst AddProductBrandRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.BRAND, \"ADMIN\"];\r\n        let user;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        } else if (req.userModel === \"vendor\") {\r\n            user = await vendorModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE ORDER ROLE\r\nconst ManageOrderRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [\r\n            accessControls.ORDERS.ORDERS_ABANDONED_ORDERS,\r\n            accessControls.ORDERS.ORDERS_ALL_ORDERS,\r\n            accessControls.ORDERS.ORDERS_CHANGE_ORDER_STATUS,\r\n            accessControls.ORDERS.ACCESS.ORDERS_DOWNLOAD,\r\n            accessControls.ORDERS.ACCESS.ORDERS_EDIT,\r\n            accessControls.ORDERS.ACCESS.ORDERS_VIEW,\r\n            \"ADMIN\",\r\n        ];\r\n        let user = null;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        } else if (req.userModel === \"vendor\") {\r\n            user = await vendorModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE HOMEPAGE ROLE\r\nconst ManageHomePage = async (req, res) => {\r\n    try {\r\n        let accessEnum = [roleEnums.HOMEPAGE_MANAGE, \"ADMIN\"];\r\n\r\n        let flag = await checkUser(req, accessEnum);\r\n\r\n        if (flag) {\r\n            next;\r\n            return;\r\n        }\r\n\r\n        return res.status(401).send({\r\n            status: false,\r\n            message: \"you don't have permission for this action\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst colorRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.PRODUCT_COLOR, \"ADMIN\"];\r\n        let flag = await checkUser(req, accessEnum);\r\n        if (flag) {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst verifyProudct = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.PRODUCT_REVIEW, \"ADMIN\"];\r\n        let flag = await checkUser(req, accessEnum);\r\n        if (flag) {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst outOfStockProduct = async (req, res, next) => {\r\n    try {\r\n        console.log(req.userModel);\r\n        if (req.userModel === \"VENDOR\") {\r\n            next();\r\n            return;\r\n        }\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.PRODUCT_REVIEW, \"ADMIN\"];\r\n        let flag = await checkUser(req, accessEnum);\r\n        if (flag) {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst abandonedOrderRole = async (req, res, next) => {\r\n    try {\r\n        if (req.userModel === \"ADMIN\") {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    AddProductRole,\r\n    AllProductRole,\r\n    AllMenuRole,\r\n    AllVendorRoles,\r\n    AddProductColorRole,\r\n    AddProductBrandRole,\r\n    ManageOrderRole,\r\n    colorRole,\r\n    verifyProudct,\r\n    outOfStockProduct,\r\n    abandonedOrderRole,\r\n};\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst homepageSchema = new mongoose.Schema(\r\n    {\r\n        featuredProduct: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Product\",\r\n            },\r\n        ],\r\n        newArrival: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Product\",\r\n            },\r\n        ],\r\n        bestSelling: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Product\",\r\n            },\r\n        ],\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Homepage\", homepageSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst { listOfRoleEnums, listOfAccessControll } = require(\"../utils/enums\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst adminSchema = new mongoose.Schema(\r\n    {\r\n        name: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n        email: {\r\n            type: String,\r\n            required: true,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n        phone: {\r\n            type: String,\r\n            required: true,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n        password: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n        role: [\r\n            {\r\n                type: String,\r\n                enum: listOfAccessControll(),\r\n            },\r\n        ],\r\n        profileUrl: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        isSuperAdmin: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\nmodule.exports = mongoose.model(\"Admin\", adminSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst bankSchema = new mongoose.Schema(\r\n    {\r\n        acHolderName: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n\r\n        acNo: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n\r\n        bankName: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n\r\n        branch: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n\r\n        ifsc: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        cancelledCheque: {\r\n            type: String,\r\n        },\r\n        actionTakenBy: {\r\n            type: ObjectId,\r\n            ref: \"Admin\",\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Bank\", bankSchema);\r\n","const mongoose = require(\"mongoose\");\nconst ObjectId = mongoose.Schema.Types.ObjectId;\n\nconst bannerSchema = new mongoose.Schema(\n    {\n        bannerUrl: {\n            type: String,\n            required: true,\n        },\n        type: {\n            type: String,\n            enum: [\"SINGLE\", \"MULTIPLE\"],\n            required: true,\n        },\n    },\n    { timestamps: true }\n);\n\nmodule.exports = mongoose.model(\"Banner\", bannerSchema);\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst brandSchema = new mongoose.Schema(\r\n    {\r\n        brand_name: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        brandLogo: {\r\n            type: String,\r\n        },\r\n        vendor_id: {\r\n            type:ObjectId,\r\n            ref:\"Vendor\"\r\n        },\r\n        brandStatus:{\r\n            type: String,\r\n            enum: [\"Approved\", \"Rejected\", \"Pending\"],\r\n            default:\"Pending\",\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n\r\n        deletedAt: {\r\n            type: Date,\r\n            default: null,\r\n        },\r\n    },\r\n    {timestamps: true}\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Brand\", brandSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst businessSchema = new mongoose.Schema(\r\n    {\r\n        business_name: {\r\n            type: String,\r\n        },\r\n        business_Logo: {\r\n            type: String,\r\n        },\r\n        invoiceLogo: {\r\n            type: String,\r\n        },\r\n        contactNo: {\r\n            type: String,\r\n        },\r\n        contactEmail: {\r\n            type: String,\r\n        },\r\n        socialMedia: {\r\n            facebook: {\r\n                type: String,\r\n            },\r\n            instagram: {\r\n                type: String,\r\n            },\r\n            twitter: {\r\n                type: String,\r\n            },\r\n            linkedin: {\r\n                type: String,\r\n            },\r\n            youtube: {\r\n                type: String,\r\n            },\r\n        },\r\n        privacyPolicy: {\r\n            type: String,\r\n        },\r\n        iAgree: {\r\n            type: String,\r\n        },\r\n        gsts: [\r\n            {\r\n                gstNo: {\r\n                    type: String,\r\n                },\r\n                pickupAddress: {\r\n                    type: String,\r\n                },\r\n                stateCode: {\r\n                    type: String,\r\n                },\r\n            },\r\n        ],\r\n        defaultGST: {\r\n            gstNo: {\r\n                type: String,\r\n            },\r\n            pickupAddress: {\r\n                type: String,\r\n            },\r\n            stateCode: {\r\n                type: String,\r\n            },\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Business\", businessSchema);\r\n","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\n\r\nconst cancelledReasonSchema = new mongoose.Schema({\r\n    questions: {\r\n        type: ObjectId,\r\n        ref: 'Question',\r\n    },\r\n\r\n    customerAnswer: {\r\n        type: String,\r\n    }\r\n}, {timestamps: true});\r\n\r\nmodule.exports = mongoose.model('Cancelled_Reason', cancelledReasonSchema);","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst cartSchema = new mongoose.Schema(\r\n    {\r\n        products: [\r\n            {\r\n                product_id: {\r\n                    type: ObjectId,\r\n                    ref: \"Product\",\r\n                },\r\n                qty: {\r\n                    type: Number,\r\n                },\r\n                lotSize: {\r\n                    type: String,\r\n                },\r\n                color: {\r\n                    colorName: { type: String },\r\n                    colorHex: { type: String },\r\n                },\r\n                addedAt: {\r\n                    type: String,\r\n                },\r\n            },\r\n        ],\r\n        customer_id: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Cart\", cartSchema);\r\n","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst categorySchema = new mongoose.Schema({\r\n    category_name: {\r\n        type: String,\r\n        required: true,\r\n    },\r\n\r\n    sub_category: [{type:ObjectId, ref: 'Subcategory'}],\r\n\r\n    isDeleted: {\r\n        type: Boolean,\r\n        default: false\r\n    },\r\n\r\n    deletedAt: {\r\n        type: Date,\r\n        default: null,\r\n    }\r\n\r\n}, { timestamps: true });\r\n\r\nmodule.exports = mongoose.model('Category', categorySchema);","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst colorSchema = new mongoose.Schema({\r\n    colorName:{\r\n        type: String,\r\n        trim:true,\r\n        unique:true\r\n    },\r\n    colorHex: {\r\n        type: String,\r\n        trim:true,\r\n        unique:true\r\n    },\r\n    products:[\r\n        {\r\n            type:ObjectId,\r\n            ref:'Product'\r\n        }\r\n    ],\r\n    isDeleted:{\r\n        type:Boolean,\r\n        default:false,\r\n    }\r\n}, {timestamps: true});\r\n\r\nmodule.exports = mongoose.model('Color', colorSchema);","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst couponCodeSchema = new mongoose.Schema(\r\n    {\r\n        customer_id: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Customer\",\r\n            },\r\n        ],\r\n        couponCode: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        validTill: {\r\n            type: Date,\r\n            required: true,\r\n        },\r\n        maxUsers: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        minOrderAmt: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        isUsed: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        isExpired: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        generatedBy: {\r\n            type: ObjectId,\r\n            ref: \"Admin\",\r\n        },\r\n        maxDiscPrice: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        discountType: {\r\n            type: String,\r\n            enum: [\"PRICE\", \"PERCENTAGE\"],\r\n            required: true,\r\n        },\r\n        discountAmt: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"CouponCode\", couponCodeSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst customerAddressSchema = new mongoose.Schema(\r\n    {\r\n        customerId: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n\r\n        address: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n\r\n        state: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        city: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        pincode: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        stateCode: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n\r\n        deletedAt: {\r\n            type: Date,\r\n            default: null,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"CustomerAddress\", customerAddressSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst customerSchema = new mongoose.Schema(\r\n    {\r\n        name: {\r\n            type: String,\r\n        },\r\n        defaultAddress: {\r\n            type: ObjectId,\r\n            ref: \"CustomerAddress\",\r\n        },\r\n        gstNo: {\r\n            type: String,\r\n        },\r\n        phone: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        alternate_phone: {\r\n            type: String,\r\n        },\r\n        email: {\r\n            type: String,\r\n        },\r\n        profileUrl: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        password: {\r\n            type: String,\r\n        },\r\n\r\n        isActivated: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        isBlocked: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        cart_id: {\r\n            type: ObjectId,\r\n            ref: \"Cart\",\r\n        },\r\n        orders: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order\",\r\n            },\r\n        ],\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        deletedAt: {\r\n            type: Date,\r\n            default: null,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Customer\", customerSchema);\r\n","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst documentSchema = new mongoose.Schema({\r\n    brandRegDoc: {\r\n        type: String,\r\n    },\r\n\r\n    gstRegDoc: {\r\n        type: String,\r\n    },\r\n    actionTakenBy:{\r\n        type:ObjectId,\r\n        ref:'Admin'\r\n    }\r\n},\r\n{timestamps: true})\r\n\r\nmodule.exports = mongoose.model('Document', documentSchema);","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst invoiceSchema = new mongoose.Schema(\r\n    {\r\n        invoiceNo: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        invoiceDate: {\r\n            type: Date,\r\n            required: true,\r\n        },\r\n        invoiceType: {\r\n            type: String,\r\n            enum: [\"PURCHASE\", \"SALE\"],\r\n            required: true,\r\n        },\r\n        customer_id: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n        vendor_id: {\r\n            type: ObjectId,\r\n            ref: \"Vendor\",\r\n        },\r\n        order_id: {\r\n            type: ObjectId,\r\n            ref: \"Order\",\r\n        },\r\n        gstAmount: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        gstType: {\r\n            type: String,\r\n            enum: [\"CGST_SGST\", \"IGST\"],\r\n            required: true,\r\n        },\r\n        totalAmount: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        invoiceStatus: {\r\n            type: String,\r\n            enum: [\"PAID\", \"UNPAID\", \"OVERDUE\"],\r\n            default: \"UNPAID\",\r\n        },\r\n        soldBy: {\r\n            name: { type: String },\r\n            address: { type: String },\r\n            phone: { type: String },\r\n            gst: { type: String },\r\n        },\r\n        shippingAddress: {\r\n            name: {\r\n                type: String,\r\n            },\r\n            address: {\r\n                type: String,\r\n                required: true,\r\n            },\r\n            phone: {\r\n                type: String,\r\n            },\r\n            gst: {\r\n                type: String,\r\n            },\r\n        },\r\n        billingAddress: {\r\n            name: {\r\n                type: String,\r\n            },\r\n            address: {\r\n                type: String,\r\n                required: true,\r\n            },\r\n            phone: {\r\n                type: String,\r\n            },\r\n            gst: {\r\n                type: String,\r\n            },\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Invoice\", invoiceSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst invoiceNoSchema = new mongoose.Schema(\r\n    {\r\n        invoiceNo: {\r\n            type: Number,\r\n            default: 0,\r\n            required: true,\r\n        },\r\n        invoiceYear: {\r\n            type: Number,\r\n            default: 23,\r\n            required: true,\r\n        },\r\n        invoiceNoLength: {\r\n            type: Number,\r\n            default: 9,\r\n            required: true,\r\n        },\r\n        invoiceNoType:{\r\n            type: String,\r\n            enum: [\"PURCHASE\", \"SALE\"],\r\n            required: true,\r\n        }\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"InvoiceNo\", invoiceNoSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst orderSchema = new mongoose.Schema(\r\n    {\r\n        orderId: {\r\n            type: String,\r\n        },\r\n\r\n        vendorId: {\r\n            type: ObjectId,\r\n            ref: \"Vendor\",\r\n        },\r\n        vendorAmtInfo: {\r\n            grandTotal: { type: Number },\r\n            gstAmt: { type: Number },\r\n            total: { type: Number },\r\n        },\r\n\r\n        transaction_id: {\r\n            type: String,\r\n        },\r\n\r\n        shipping_charges: {\r\n            type: Number,\r\n        },\r\n\r\n        grand_total: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n\r\n        total: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n\r\n        total_pairs: {\r\n            type: Number,\r\n        },\r\n\r\n        GST_amount: {\r\n            type: Number,\r\n        },\r\n        discounted_amount: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        order_date: {\r\n            type: Date,\r\n        },\r\n\r\n        tracking_id: {\r\n            type: String,\r\n        },\r\n\r\n        transport_bilty: {\r\n            type: String,\r\n        },\r\n\r\n        ordered_products: {\r\n            type: ObjectId,\r\n            ref: \"Ordered_Product\",\r\n        },\r\n\r\n        order_status_id: {\r\n            type: ObjectId,\r\n            ref: \"Order_Status_Table\",\r\n        },\r\n\r\n        payment_id: {\r\n            type: ObjectId,\r\n            ref: \"Payment\",\r\n        },\r\n\r\n        customer_id: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n\r\n        shipping_address: {\r\n            stateCode: { type: String },\r\n            state: { type: String },\r\n            address: { type: String },\r\n        },\r\n        couponCode: {\r\n            type: ObjectId,\r\n            ref: \"CouponCode\",\r\n        },\r\n        saleInvoice: {\r\n            type: ObjectId,\r\n            ref: \"Invoice\",\r\n        },\r\n        purchaseInvoice: {\r\n            type: ObjectId,\r\n            ref: \"Invoice\",\r\n        },\r\n        paymentReportStatus: {\r\n            paymentStatus: {\r\n                type: String,\r\n                enum: [\"PENDING\", \"DUE\", \"PARTIAL_PAID\", \"FULL_PAID\", \"SETTLED_PAID\"],\r\n                default: \"PENDING\",\r\n            },\r\n            paidAmount: {\r\n                type: Number,\r\n            },\r\n            paymentDate: {\r\n                type: Date,\r\n            },\r\n            transactionId: {\r\n                type: String,\r\n            },\r\n            settlementAmt: {\r\n                type: Number,\r\n            },\r\n            message: {\r\n                type: String,\r\n            },\r\n            logs: [],\r\n        },\r\n        partialCancelOrderInfo: {\r\n            orderedAmtInfo: {\r\n                grand_total: {\r\n                    type: Number,\r\n                },\r\n\r\n                total: {\r\n                    type: Number,\r\n                },\r\n\r\n                GST_amount: {\r\n                    type: Number,\r\n                },\r\n            },\r\n            orderedProductAmtInfo: {\r\n                productQty: {\r\n                    type: Number,\r\n                },\r\n                grand_total: {\r\n                    type: Number,\r\n                },\r\n                total: {\r\n                    type: Number,\r\n                },\r\n                GST_amount: {\r\n                    type: Number,\r\n                },\r\n            },\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Order\", orderSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst orderStatusTableSchema = new mongoose.Schema(\r\n    {\r\n        order_id: {\r\n            type: ObjectId,\r\n            ref: \"Order\",\r\n            required: true,\r\n        },\r\n\r\n        status: {\r\n            type: String,\r\n            enum: [\r\n                \"PENDING\",\r\n                \"CONFIRMED\",\r\n                \"PARTIAL_CONFIRMED\",\r\n                \"READY_TO_DISPATCH\",\r\n                \"PICKUP_ALIGNED\",\r\n                \"PICKUP_DONE\",\r\n                \"RETURNED\",\r\n                \"RETURNED_RTO\",\r\n                \"RETURNED_RTO_DELIVERED\",\r\n                \"DELIVERED\",\r\n                \"CANCELLED\",\r\n                \"OUT_FOR_DELIVERY\",\r\n            ],\r\n            default: \"PENDING\",\r\n        },\r\n\r\n        isCompleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n\r\n        statusList: [\r\n            {\r\n                status: {\r\n                    type: String,\r\n                    enum: [\r\n                        \"CONFIRMED\",\r\n                        \"PARTIAL_CONFIRMED\",\r\n                        \"READY_TO_DISPATCH\",\r\n                        \"PICKUP_ALIGNED\",\r\n                        \"PICKUP_DONE\",\r\n                        \"RETURNED\",\r\n                        \"RETURNED_RTO\",\r\n                        \"RETURNED_RTO_DELIVERED\",\r\n                        \"DELIVERED\",\r\n                        \"OUT_FOR_DELIVERY\",\r\n                    ],\r\n                },\r\n                updatedBy: {\r\n                    vendor: { type: ObjectId, ref: \"Vendor\" },\r\n                    admin: { type: ObjectId, ref: \"Admin\" },\r\n                },\r\n                updatedAt: {\r\n                    type: Date,\r\n                },\r\n            },\r\n        ],\r\n        cancelled: {\r\n            cancelledBy: {\r\n                type: String,\r\n                enum: [\"Super_Admin\", \"Vendor\", \"Customer\"],\r\n            },\r\n\r\n            userId: {\r\n                vendor: { type: ObjectId, ref: \"Vendor\" },\r\n                admin: { type: ObjectId, ref: \"Admin\" },\r\n                customer: { type: ObjectId, ref: \"Customer\" },\r\n            },\r\n\r\n            question: {\r\n                type: ObjectId,\r\n                ref: \"Question\",\r\n            },\r\n            description: {\r\n                type: String,\r\n            },\r\n        },\r\n        cancelledStatus: {\r\n            type: String,\r\n            enum: [\"PICKUP_ALIGNED\", \"PICKUP_DONE\", \"RETURNED\", \"RETURNED_RTO\", \"RETURNED_RTO_DELIVERED\", \"CANCELLED\"],\r\n        },\r\n        cancelledStatusList: [\r\n            {\r\n                status: {\r\n                    type: String,\r\n                    enum: [\"PICKUP_ALIGNED\", \"PICKUP_DONE\", \"RETURNED\", \"RETURNED_RTO\", \"RETURNED_RTO_DELIVERED\", \"CANCELLED\"],\r\n                },\r\n                updatedBy: {\r\n                    vendor: { type: ObjectId, ref: \"Vendor\" },\r\n                    admin: { type: ObjectId, ref: \"Admin\" },\r\n                    customer: { type: ObjectId, ref: \"Customer\" },\r\n                },\r\n                updatedAt: {\r\n                    type: Date,\r\n                },\r\n            },\r\n        ],\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Order_Status_Table\", orderStatusTableSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst orderedProductSchema = new mongoose.Schema(\r\n    {\r\n        products: [\r\n            {\r\n                product_id: {\r\n                    type: ObjectId,\r\n                    ref: \"Product\",\r\n                    required: true,\r\n                },\r\n                vendor_id: {\r\n                    type: ObjectId,\r\n                    ref: \"Vendor\",\r\n                    required: true,\r\n                },\r\n                mrp: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                seller_price: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                seller_gst: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                selling_price: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                selling_gst: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                margin: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                lotSize: {\r\n                    type: String,\r\n                },\r\n                color: {\r\n                    colorName: { type: String },\r\n                    colorHex: { type: String },\r\n                },\r\n                hsnCode: {\r\n                    type: String,\r\n                },\r\n                skuCode: {\r\n                    type: String,\r\n                },\r\n                qty: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                addedAt: {\r\n                    type: String,\r\n                },\r\n                isRemoved: {\r\n                    type: Boolean,\r\n                    default: false,\r\n                },\r\n            },\r\n        ],\r\n        order_id: {\r\n            type: ObjectId,\r\n            ref: \"Order\",\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Ordered_Product\", orderedProductSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst otpSchema = new mongoose.Schema(\r\n  {\r\n    mobile: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n\r\n    otp: {\r\n      type: String,\r\n    },\r\n\r\n    createdAt: {\r\n      type: Date,\r\n      default: Date.now(),\r\n      index: { expires: 300 },\r\n    },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"OTP\", otpSchema);","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst paymentSchema = new mongoose.Schema(\r\n    {\r\n        paymentId: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        order_id: {\r\n            orderId: {\r\n                type: ObjectId,\r\n                ref: \"Order\",\r\n            },\r\n            order_custom_id: {\r\n                type: String,\r\n            },\r\n        },\r\n        customer_id: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n        order_status: {\r\n            type: String,\r\n            enum: [\r\n                \"PENDING\",\r\n                \"CONFIRMED\",\r\n                \"PARTIAL_CONFIRMED\",\r\n                \"READY_TO_DISPATCH\",\r\n                \"PICKUP_ALIGNED\",\r\n                \"PICKUP_DONE\",\r\n                \"RETURNED\",\r\n                \"RETURNED_RTO\",\r\n                \"RETURNED_RTO_DELIVERED\",\r\n                \"DELIVERED\",\r\n                \"CANCELLED\",\r\n                \"OUT_FOR_DELIVERY\",\r\n            ],\r\n            default: \"PENDING\",\r\n        },\r\n        payment_status: {\r\n            type: String,\r\n            enum: [\"PENDING\", \"PARTIAL_PAID\", \"RECEIVED\", \"FAILED\", \"PARTIAL_REFUNDED\", \"REFUNDED\"],\r\n        },\r\n\r\n        payment_mode: {\r\n            type: String,\r\n            enum: [\"COD\", \"CUSTOM\", \"TWENTY_ADV\", \"PREPAID\"],\r\n        },\r\n\r\n        transactionId: {\r\n            type: String,\r\n        },\r\n\r\n        payment_amount: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        return_amount: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        cod_received: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        payment_date: {\r\n            type: Date, // when final payment will received, we'll put payment date\r\n        },\r\n        partial_payment: {\r\n            payment_amount: {\r\n                type: Number,\r\n            },\r\n            date: {\r\n                type: Date,\r\n            },\r\n            transactionId: {\r\n                type: String,\r\n            },\r\n        },\r\n        order_amount: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        discount_amt: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        balance_amount: {\r\n            type: Number,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Payment\", paymentSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst slugify = require(\"slugify\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst productSchema = new mongoose.Schema(\r\n    {\r\n        product_name: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n\r\n        sku_code: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n        hsn_code: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n\r\n        description: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n\r\n        mrp: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        gst: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n\r\n        seller_price: {\r\n            type: Number,\r\n        },\r\n        sellingGST: {\r\n            type: Number,\r\n        },\r\n        margin: {\r\n            type: Number,\r\n        },\r\n\r\n        stockStatus: {\r\n            type: String,\r\n            enum: [\"In_stock\", \"Out_of_stock\"],\r\n            default: \"In_stock\",\r\n        },\r\n\r\n        qty_in_hand: {\r\n            type: Number,\r\n        },\r\n\r\n        min_order_qty: {\r\n            type: Number,\r\n        },\r\n        lotSizeQty: [\r\n            {\r\n                type: String,\r\n                required: true,\r\n                trim: true,\r\n            },\r\n        ],\r\n        color_id: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Color\",\r\n            },\r\n        ],\r\n        sole: {\r\n            type: String,\r\n            trim: true,\r\n            default:\"\"\r\n        },\r\n\r\n        material: {\r\n            type: String,\r\n            trim: true,\r\n            default:\"\"\r\n        },\r\n        packing_type: {\r\n            type: String,\r\n            trim: true,\r\n            default:\"\"\r\n        },\r\n\r\n        made_in: {\r\n            type: String,\r\n            trim: true,\r\n            default:\"India\"\r\n        },\r\n\r\n        weight: {\r\n            type: Number,\r\n        },\r\n\r\n        categoryId: {\r\n            type: ObjectId,\r\n            ref: \"Category\",\r\n            required: true,\r\n        },\r\n        subCatId: {\r\n            type: ObjectId,\r\n            ref: \"Subcategory\",\r\n            required: true,\r\n        },\r\n\r\n        thumbnail_pic: {\r\n            type: String,\r\n        },\r\n\r\n        multiple_pics: [\r\n            {\r\n                type: String,\r\n            },\r\n        ],\r\n\r\n        meta_title: {\r\n            type: String,\r\n        },\r\n\r\n        meta_keywords: {\r\n            type: String,\r\n        },\r\n\r\n        meta_description: {\r\n            type: String,\r\n        },\r\n\r\n        slug: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n\r\n        status: {\r\n            type: String,\r\n            enum: [\"Approved\", \"Pending\", \"Rejected\"],\r\n            default: \"Pending\",\r\n        },\r\n\r\n        brandId: {\r\n            type: ObjectId,\r\n            ref: \"Brand\",\r\n        },\r\n\r\n        vendor_id: {\r\n            type: ObjectId,\r\n            ref: \"Vendor\",\r\n        },\r\n\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n\r\n        deletedAt: {\r\n            type: Date,\r\n            default: null,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nproductSchema.pre(\"validate\", function (next) {\r\n    if (this.product_name) {\r\n        let product = this.product_name + \" \" + this.sku_code;\r\n        this.slug = slugify(product, { lower: true, strict: true });\r\n    }\r\n    next();\r\n});\r\n\r\nmodule.exports = mongoose.model(\"Product\", productSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst questionSchema = new mongoose.Schema(\r\n    {\r\n        questionFor: {\r\n            type: String,\r\n            enum: [\"ADMIN\", \"CUSTOMER\", \"VENDOR\"],\r\n        },\r\n\r\n        question: {\r\n            type: String,\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Question\", questionSchema);\r\n","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst subcategorySchema = new mongoose.Schema({\r\n            subcategory_name: {\r\n                type: String, required: true,\r\n            },\r\n            productId: [{\r\n                type: ObjectId, ref: 'Product',\r\n            }],\r\n            isDeleted: {\r\n                type: Boolean,\r\n                default:\r\n                    false\r\n            },\r\n\r\n            deletedAt: {\r\n                type: Date,\r\n                default:\r\n                    null,\r\n            }\r\n\r\n        },\r\n        {\r\n            timestamps: true\r\n        }\r\n    )\r\n;\r\n\r\nmodule.exports = mongoose.model('Subcategory', subcategorySchema);","const mongoose = require(\"mongoose\");\r\nconst { listOfRoleEnums, listOfAccessControll } = require(\"../utils/enums\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst vendorSchema = new mongoose.Schema(\r\n    {\r\n        firmName: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n\r\n        gstNo: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        representativeName: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n        profileUrl: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        emailId: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        password: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        mobileNo: {\r\n            type: String,\r\n            required: true,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        altMobileNo: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        pickupState: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        pickupCity: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        pickupPincode: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        invoiceAddress: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        pickupAddress: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        termsAndConditions: {\r\n            type: Boolean,\r\n            required: true,\r\n        },\r\n        bank_id: {\r\n            type: ObjectId,\r\n            ref: \"Bank\",\r\n        },\r\n        document_id: {\r\n            type: ObjectId,\r\n            ref: \"Document\",\r\n        },\r\n\r\n        brand_id: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Brand\",\r\n            },\r\n        ],\r\n\r\n        vendor_unique_id: {\r\n            type: String,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        auth_unique_id: {\r\n            type: String,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        db_unique_id: {\r\n            type: String,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        sharing_unique_id: {\r\n            type: String,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        basicInfoStatus: {\r\n            type: String,\r\n            enum: [\"Approved\", \"Rejected\", \"Pending\"],\r\n            default: \"Pending\",\r\n        },\r\n        products: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Product\",\r\n            },\r\n        ],\r\n\r\n        orders: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order\",\r\n            },\r\n        ],\r\n\r\n        order_success: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order_Success\",\r\n            },\r\n        ],\r\n\r\n        order_canclled: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order_Cancelled\",\r\n            },\r\n        ],\r\n\r\n        order_pending: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order_Pending\",\r\n            },\r\n        ],\r\n\r\n        order_inprogress: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order_Inprogress\",\r\n            },\r\n        ],\r\n\r\n        logistics_id: {\r\n            type: ObjectId,\r\n            ref: \"Logistics\",\r\n        },\r\n\r\n        business_id: {\r\n            type: ObjectId,\r\n            ref: \"Business\",\r\n        },\r\n        status: {\r\n            type: String,\r\n            enum: [\"Pending\", \"Rejected\", \"Inprogress\", \"Approved\"],\r\n            default: \"Pending\",\r\n        },\r\n        isActive: {\r\n            type: String,\r\n            enum: [\"Active\", \"Inactive\", \"Blocked\"],\r\n            default: \"Active\",\r\n        },\r\n        actionTakenBy: {\r\n            type: ObjectId,\r\n            ref: \"Admin\",\r\n        },\r\n        marginInPercentage: {\r\n            type: Number,\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        role: [\r\n            {\r\n                type: String,\r\n                enum: \"VENDOR\",\r\n            },\r\n        ],\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Vendor\", vendorSchema);\r\n","const mongoose = require(\"mongoose\");\nconst ObjectId = mongoose.Schema.Types.ObjectId;\n\nconst wishlistSchema = new mongoose.Schema(\n    {\n        productId: {\n            type: ObjectId,\n            ref: \"Product\",\n            required: true,\n        },\n        userId: {\n            type: ObjectId,\n            ref: \"Customer\",\n            required: true,\n        },\n    },\n    { timestamps: true }\n);\n\nmodule.exports = mongoose.model(\"Wishlist\", wishlistSchema);\n","const express = require(\"express\");\nconst { Authentication } = require(\"../middlewares/auth\");\nconst { getDashboardData } = require(\"../controllers/adminDashboard\");\nconst router = express.Router();\n\nrouter.get(\"/admin-dashboard\", Authentication, getDashboardData);\n\nmodule.exports = router;\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst adminController = require(\"../controllers/adminController\");\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\nconst { AddProductRole } = require(\"../middlewares/roleAuth\");\r\nconst { uploadFile } = require(\"../controllers/imageController\");\r\n\r\nrouter.post(\"/addadmin\", Authentication, adminController.addAdmin);\r\nrouter.get(\"/getadmin\", Authentication, adminController.getAllAdmin);\r\nrouter.put(\"/update-admin/:adminid\", Authentication, adminController.updateAdminInfo);\r\nrouter.delete(\"/delete-admin/:adminid\", Authentication, adminController.deleteAdminById);\r\nrouter.post(\"/adminlogin\", adminController.adminLogin);\r\nrouter.post(\"/createsuperadmin/:secretKey\", adminController.createSuperAdmin);\r\nrouter.get(\"/alladminenums\", Authentication, adminController.getAllSubadminEnums);\r\nrouter.put(\"/verifyvendor/:vendorId\", Authentication, adminController.verifyVendor);\r\nrouter.put(\"/changevendorpassword\", adminController.changeVendorPassword);\r\nrouter.delete(\"/deleteVendor\", Authentication, adminController.deleteVendor);\r\n\r\nmodule.exports = router;\r\n","const express = require('express');\r\nconst router = express.Router();\r\nconst brandController = require('../controllers/brandController');\r\nconst {Authentication} = require(\"../middlewares/auth\");\r\n\r\n\r\nrouter.post(\"/brand\", Authentication, brandController.addBrand);\r\nrouter.get('/brands', Authentication,  brandController.getAllBrands);\r\nrouter.get(\"/brands/:vendorId\", Authentication, brandController.getAllBrandByVendor);\r\nrouter.patch(\"/verifybrand/:brandId\", Authentication, brandController.verifyBrandById);\r\n\r\nmodule.exports = router;","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst {\r\n    addBusinessInfo,\r\n    saveSocialMedia,\r\n    addBusinessGST,\r\n    getBusinessInfo,\r\n    addBusinessFiles,\r\n    setDefaultGst,\r\n    bannerForClientPage,\r\n    getBannerForClientPage,\r\n    bannerDeleteById,\r\n} = require(\"../controllers/businessController\");\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/addbusinessinfo\", Authentication, addBusinessInfo);\r\nrouter.post(\"/addbusinessgst\", Authentication, addBusinessGST);\r\nrouter.get(\"/getbusinessinfo\", Authentication, getBusinessInfo);\r\nrouter.post(\"/addbusinessfiles\", Authentication, addBusinessFiles);\r\nrouter.patch(\"/updatedefgst\", Authentication, setDefaultGst);\r\nrouter.post(\"/savesocialmedia\", Authentication, saveSocialMedia);\r\nrouter.post(\"/bannerupload\", Authentication, bannerForClientPage);\r\nrouter.get(\"/bannerimages\", Authentication, getBannerForClientPage);\r\nrouter.get(\"/bannerimagesforclient\", AuthenticationCustomer, getBannerForClientPage);\r\nrouter.delete(\"/deletebanner/:bannerId\", Authentication, bannerDeleteById);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst { addToCart, getAllAbandentCarts, getCartByCustomerId, removeFromCart, qtyIncreaseDecrease } = require(\"../controllers/cartController\");\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\nconst { abandonedOrderRole } = require(\"../middlewares/roleAuth\");\r\n\r\nrouter.post(\"/addtocart/:customerId\", AuthenticationCustomer, addToCart);\r\nrouter.get(\"/cart/:customerId\", getCartByCustomerId);\r\nrouter.get(\"/abandonedcarts\", Authentication, abandonedOrderRole, getAllAbandentCarts);\r\nrouter.put(\"/removefromcart/:customerId/:index\", AuthenticationCustomer, removeFromCart);\r\nrouter.put(\"/qty-increase-decrease/:customerId/:index/:qty\", AuthenticationCustomer, qtyIncreaseDecrease);\r\n\r\nmodule.exports = router;\r\n","const express = require('express');\r\nconst router = express.Router();\r\n\r\nconst categoryController = require('../controllers/categoryController');\r\n\r\n\r\n\r\nrouter.post(\"/category\", categoryController.addCategory);\r\nrouter.get('/categories', categoryController.getAllCategories);\r\n// router.get('/category/:categoryId', productController.getProductById);\r\nrouter.put('/category/:categoryId', categoryController.updateCategoryById);\r\n// router.delete('/category/:categoryId', productController.addProduct);\r\n\r\n\r\nmodule.exports = router;","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\nconst { colorRole } = require(\"../middlewares/roleAuth\");\r\nconst { getAllColor, addNewColor, deleteColorById } = require(\"../controllers/colorController\");\r\n\r\nrouter.get(\"/getallcolors\", getAllColor);\r\nrouter.post(\"/addnewcolor\", Authentication, colorRole, addNewColor);\r\nrouter.delete(\"/deletecolorbyid/:colorId\", Authentication, colorRole, deleteColorById);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst { getAllCoupons, generateCoupon, applyCoupon, deleteCoupon } = require(\"../controllers/couponCodeController\");\r\nconst router = express.Router();\r\n\r\nrouter.get(\"/allcoupon\", getAllCoupons);\r\nrouter.post(\"/generatecoupon\", generateCoupon);\r\nrouter.post(\"/applycoupon/:customerid\", applyCoupon);\r\nrouter.patch(\"/deletecoupon/:couponid\", deleteCoupon);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst customerController = require(\"../controllers/customerController\");\r\nconst customerAddressController = require(\"../controllers/customerAddressController\");\r\n\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/login-customer\", customerController.loginUser);\r\nrouter.get(\"/customers\", Authentication, customerController.getAllCustomer);\r\nrouter.get(\"/customer/:customerId\", Authentication, customerController.getCustomerById);\r\nrouter.put(\"/updatecustomer/:customerId\", AuthenticationCustomer, customerController.updateCustomerById);\r\nrouter.delete(\"/customer/:customerId\", Authentication, customerController.deleteCustomerById);\r\nrouter.post(\"/addcustomrinformation/:customerid\", customerAddressController.addCustomerInformation);\r\nrouter.delete(\"/address/:customerId/:addressId\", AuthenticationCustomer, customerAddressController.deleteAddressById);\r\nrouter.patch(\"/blockcustomer/:customerId\", Authentication, customerController.blockCustomerById);\r\nrouter.post(\"/getordersbycustomerphone\", Authentication, customerController.findOrdersByPhone);\r\nrouter.post(\"/addaddress/:customerId\", AuthenticationCustomer, customerAddressController.addAddress);\r\nrouter.get(\"/getalladdress/:customerId\", AuthenticationCustomer, customerAddressController.getAllAddresses);\r\nrouter.put(\"/setdefaultaddress/:customerId/:addressId\", AuthenticationCustomer, customerController.setDefaultAddress);\r\nrouter.post(\"/change-password/:customerId\", Authentication, customerController.changePassword);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\nconst { AuthenticationCustomer } = require(\"../middlewares/auth\");\nconst { getDashboardData, getProductBySlug } = require(\"../controllers/dashboardController\");\nconst router = express.Router();\n\nrouter.get(\"/get-store-info\", getDashboardData);\nrouter.get(\"/get-product-info-by-id/:slug\", getProductBySlug);\n\nmodule.exports = router;\n","const express = require(\"express\");\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\nconst { addFeaturedProducts, removeFeaturedProduct, getFeaturedProduct } = require(\"../controllers/homepageController\");\r\nconst router = express.Router();\r\n\r\nrouter.post(\"/bestsellingproducts\", Authentication, addFeaturedProducts);\r\nrouter.post(\"/removebestsellingproduct\", Authentication, removeFeaturedProduct);\r\nrouter.get(\"/allbestsellingproduct\", Authentication, getFeaturedProduct);\r\n\r\nmodule.exports = router;","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\nconst { getAllPurchaseInvoice, getAllSaleInvoice, downoadInvoiceByInvoiceNumber } = require(\"../controllers/invoiceController\");\r\n\r\nrouter.get(\"/purchaseinvoice\", Authentication, getAllPurchaseInvoice);\r\nrouter.get(\"/saleinvoice\", Authentication, getAllSaleInvoice);\r\nrouter.get(\"/downloadpdf/:invoicenumber/:invoicetype\", Authentication, downoadInvoiceByInvoiceNumber);\r\nrouter.get(\"/customer-downloadpdf/:invoicenumber/:invoicetype\", AuthenticationCustomer, downoadInvoiceByInvoiceNumber);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst orderController = require(\"../controllers/orderController\");\r\nconst orderStatusTableController = require(\"../controllers/orderStatusTableController\");\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\nconst orderedProductModel = require(\"../models/orderedProductModel\");\r\nconst { exportOrderReport } = require(\"../controllers/excelFileController\");\r\n\r\nrouter.get(\"/orders\", Authentication, orderController.getAllOrders);\r\nrouter.get(\"/order/:customerId/:orderId\", AuthenticationCustomer, orderController.getOrderByOrderId);\r\nrouter.get(\"/orders/:customerId\", AuthenticationCustomer, orderController.getOrdersByCustomerId);\r\nrouter.get(\"/orderedproduct/:orderedproductid\", orderController.getOrderedProduct);\r\nrouter.post(\"/createorder/:customerId\", orderController.createOrder);\r\nrouter.put(\"/cancelorder/:orderId\", orderController.cancelOrderByOrderId);\r\nrouter.put(\"/updateorder/:orderId\", Authentication, orderController.updateOrderByOrderId);\r\nrouter.patch(\"/patchtrackingid/:orderId\", orderController.patchTrackingIdByOrderId);\r\nrouter.get(\"/getcancelledorders\", Authentication, orderController.getAllCancelledOrder);\r\n\r\nrouter.post(\"/order-report\", Authentication, exportOrderReport);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst orderStatusTableController = require(\"../controllers/orderStatusTableController\");\r\n\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/change-order-status/:orderId\", Authentication, orderStatusTableController.updateOrderStatusByOrderId);\r\nrouter.post(\"/change-bulk-order-status\", Authentication, orderStatusTableController.bulkOrderProcess);\r\nrouter.post(\"/return-order-status/:orderId\", Authentication, orderStatusTableController.cancelOrderReturnById);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst { sendOTP, verityOTP, forgetPasswordUsingOtp } = require(\"../controllers/otpController\");\r\nconst { sentOTP, verifyOTP } = require('../controllers/OTP');\r\nconst router = express.Router();\r\n\r\n// router.get(\"/sendotp/:phone\", sendOTP);\r\nrouter.get(\"/verifyotp/:phone/:otpCode\", verityOTP);\r\nrouter.post(\"/forget-password/:phone/:otpCode\", forgetPasswordUsingOtp);\r\n\r\n// router.post(\"/messages\", sendSMS);\r\nrouter.post(\"/sendOTP\", sentOTP);\r\nrouter.post(\"/verifyOTP\", verifyOTP);\r\n\r\nmodule.exports = router;\r\n","const express = require('express');\r\nconst router = express.Router();\r\nconst paymentController = require('../controllers/paymentController');\r\n\r\nconst { Authentication } = require('../middlewares/auth');\r\n\r\n\r\nrouter.post(\"/addpayment/:orderId\", paymentController.createPayment);\r\nrouter.put(\"/updatepaymentstatus/:paymentId\", paymentController.updatePaymentStatus);\r\nrouter.post(\"/createpayment/:orderId\", paymentController.addPayment);\r\n\r\n\r\nmodule.exports = router;","const express = require(\"express\");\r\nconst app = express();\r\nconst router = express.Router();\r\n\r\nconst productController = require(\"../controllers/productController\");\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\nconst { AddProductRole, AllProductRole, verifyProudct, outOfStockProduct } = require(\"../middlewares/roleAuth\");\r\nconst { exportIDs, exportProductAddDemoSheet, csvToJson } = require(\"../controllers/excelFileController\");\r\n\r\n// PRODUCT ROUTES\r\nrouter.post(\"/product\", Authentication, productController.addProduct);\r\nrouter.get(\"/products\", Authentication, productController.getAllProducts);\r\nrouter.get(\"/allproducts\", Authentication, productController.getAllProductsForFilter);\r\nrouter.get(\"/dashboardproduct\", AuthenticationCustomer, productController.getAllProductsForDashboard);\r\nrouter.get(\"/product/:productId\", productController.getProductById);\r\nrouter.patch(\"/changeproductstatus/:productId\", Authentication, productController.changeProductStatus);\r\nrouter.patch(\"/changeproductstockstatus/:productId\", Authentication, productController.changeProductStockStatus);\r\nrouter.put(\"/updateproduct/:productId\", Authentication, productController.updateProduct);\r\n\r\n// router.post(\"/csvupload\", productController.csvProduct);\r\nrouter.get(\"/downloadDependencies\", Authentication, exportIDs);\r\nrouter.get(\"/downloadprodctxlsx\", Authentication, exportProductAddDemoSheet);\r\nrouter.post(\"/bulkproductupload\", Authentication, csvToJson);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\nconst router = express.Router();\nconst { Authentication } = require(\"../middlewares/auth\");\nconst { updateProfile, changePassword } = require(\"../controllers/profileController\");\n\nrouter.put(\"/update-userprofile\", Authentication, updateProfile);\nrouter.post(\"/changePassword\", changePassword);\n\nmodule.exports = router;\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst questionController = require(\"../controllers/questionController\");\r\nconst cancelledReasonController = require(\"../controllers/cancelReasonController\");\r\n\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/addquestion\", Authentication, questionController.addQuestions);\r\nrouter.get(\"/getallquestion\", Authentication, questionController.getAllQuestion);\r\nrouter.get(\"/getallquestionbyuser\", Authentication, questionController.getAllQuestionByModel);\r\nrouter.delete(\"/delete-question-byid/:questionid\", Authentication, questionController.deleteQuestionById);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\nconst { getOrderReport, exportSaleReport, exportPurchaseReport, getPaymentReport, updatePaymentReport } = require(\"../controllers/reportController\");\nconst { Authentication } = require(\"../middlewares/auth\");\nconst router = express.Router();\n\nrouter.get(\"/order-report\", Authentication, getOrderReport);\nrouter.post(\"/export-sale-report\", Authentication, exportSaleReport);\nrouter.post(\"/export-purchase-report\", Authentication, exportPurchaseReport);\nrouter.get(\"/payment-report\", Authentication, getPaymentReport);\nrouter.put(\"/update-payment-report/:orderid\", Authentication, updatePaymentReport)\n\nmodule.exports = router;\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst vendorController = require(\"../controllers/vendorController\");\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/addvendor\", vendorController.addVendor);\r\nrouter.get(\"/allvendors\", vendorController.getAllVendors);\r\nrouter.post(\"/create-vendor-by-admin\", Authentication, vendorController.createVendorByAdmin);\r\nrouter.put(\"/update-vendor-by-admin/:vendorId\", Authentication, vendorController.updateVendor);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\nconst { addToWishlist, removeFromWishlist, getWishlistProduct } = require(\"../controllers/wishlistController\");\nconst { AuthenticationCustomer } = require(\"../middlewares/auth\");\nconst router = express.Router();\n\nrouter.post(\"/add-to-wishlist\", AuthenticationCustomer, addToWishlist);\nrouter.delete(\"/remove-from-wishlist/:wishlistId\", AuthenticationCustomer, removeFromWishlist);\nrouter.get(\"/get-wishlist\", AuthenticationCustomer, getWishlistProduct);\nmodule.exports = router;\n","const isExpiryCoupon = (validTill) => {\n    let day = validTill.getDate();\n    let month = validTill.getMonth() + 1;\n    let year = validTill.getFullYear();\n    let expiryDateMS = new Date(`${year}-${month < 10 ? \"0\" + month : month}-${day < 10 ? \"0\" + day : day}`).getTime() / 1000;\n\n    let now = Date.now();\n    // let date = new Date(now + (5.5 * (3600 * 1000))); // Deployment time cases for +5:30 GMT\n    let date = new Date();\n    let dateStr = `${date.getFullYear()}-${date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1) : date.getMonth() + 1}-${date.getDate() < 10 ? \"0\" + date.getDate() : date.getDate()}`;\n    let currentDateMS = new Date(dateStr).getTime() / 1000;\n\n    return currentDateMS <= expiryDateMS ? false : true;\n};\n\nmodule.exports = { isExpiryCoupon };\n","const dateToLocalDate = (date) => {\n    let day = date.getDate();\n    let month = date.getMonth() + 1;\n    let year = date.getFullYear();\n    day = day < 10 ? \"0\" + day : day;\n    month = month < 10 ? \"0\" + month : month;\n    return `${day}/${month}/${year}`;\n};\n\nconst dateToLocalDateTime = (date) => {\n    let day = date.getDate();\n    let month = date.getMonth() + 1;\n    let year = date.getFullYear();\n    let hr = date.getHours();\n    let min = date.getMinutes();\n    let ampm = hr < 12 ? \"AM\" : \"PM\";\n    hr = hr % 12;\n    hr = hr ? hr : 12;\n    hr = hr < 10 ? \"0\" + hr : hr;\n    min = min < 10 ? \"0\" + min : min;\n    day = day < 10 ? \"0\" + day : day;\n    month = month < 10 ? \"0\" + month : month;\n    return `${day}/${month}/${year} ${hr}:${min} ${ampm}`;\n};\n\nmodule.exports = { dateToLocalDate, dateToLocalDateTime };\n","let roleEnums = {\r\n    MANAGE_MENU: {\r\n        ADD_CATEGORY: \"ADD_CATEGORY\",\r\n        ADD_SUBCATEGORY: \"ADD_SUBCATEGORY\",\r\n    },\r\n    MANAGE_PRODUCT: {\r\n        ADD_PRODUCT: \"ADD_PRODUCT\",\r\n        ALL_PRODUCT: \"ALL_PRODUCT\",\r\n        PRODUCT_COLOR: \"PRODUCT_COLOR\",\r\n        PRODUCT_SIZE: \"PRODUCT_SIZE\",\r\n        BRAND: \"BRAND\",\r\n        OUT_OF_STOCK_PRODUCTS: \"OUT_OF_STOCK_PRODUCTS\",\r\n        PRODUCT_REVIEW: \"PRODUCT_REVIEW\",\r\n    },\r\n    MANAGE_ORDERS: {\r\n        ALL_ORDERS: \"ALL_ORDERS\",\r\n        CONFIRM_ORDERS: \"CONFIRM_ORDERS\",\r\n        SHIPPED_ORDER: \"SHIPPED_ORDER\",\r\n        PICKUP_PENDING: \"PICKUP_PENDING\",\r\n        DELIVERED_ORDER: \"DELIVERED_ORDER\",\r\n        RTO_ORDER: \"RTO_ORDER\",\r\n        RTO_DELIVERED: \"RTO_DELIVERED\",\r\n        CANCEL_ORDER: \"CANCEL_ORDER\",\r\n        PARTIAL_DELIVERED: \"PARTIAL_DELIVERED\",\r\n        HOLD: \"HOLD\",\r\n        PICKUP_INITIATE: \"PICKUP_INITIATE\",\r\n    },\r\n    IMPORT_PINCODE: \"IMPORT_PINCODE\",\r\n    MANAGE_RETURN: {\r\n        RETURN_REQUEST: \"RETURN_REQUEST\",\r\n        SETTLEMENT_REQUEST: \"SETTLEMENT_REQUEST\",\r\n        REFUNDED: \"REFUNDED\",\r\n        SETTLEMENT_REQUEST_CANCEL: \"SETTLEMENT_REQUEST_CANCEL\",\r\n    },\r\n    ALL_USERS: \"ALL_USERS\",\r\n    MANAGE_COUPONS: {\r\n        ADD_COUPON: \"ADD_COUPON\",\r\n        ALL_COUPON: \"ALL_COUPON\",\r\n    },\r\n    MANAGE_SALES: \"MANAGE_SALES\",\r\n    HOMEPAGE_MANAGE: \"HOMEPAGE_MANAGE\",\r\n    MANAGE_VENDOR: {\r\n        ADD_VENDOR: \"ADD_VENDOR\",\r\n        ALL_VENDOR: \"ALL_VENDOR\",\r\n        ALL_OUTSTANDING: \"ALL_OUTSTANDING\",\r\n        ALL_SETTLED: \"ALL_SETTLED\",\r\n    },\r\n    ADD_EMPLOYEE: \"ADD_EMPLOYEE\",\r\n    EXPORT_INFORMATION: \"EXPORT_INFORMATION\",\r\n};\r\nlet accessControls = {\r\n    ORDERS: {\r\n        ACCESS: {\r\n            ORDERS_VIEW: false,\r\n            ORDERS_EDIT: false,\r\n            ORDERS_DOWNLOAD: false,\r\n        },\r\n        ORDERS_ALL_ORDERS: \"ALL_ORDERS\",\r\n        ORDERS_CHANGE_ORDER_STATUS: \"CHANGE_ORDER_STATUS\",\r\n        ORDERS_ABANDONED_ORDERS: \"ABANDONED_ORDERS\",\r\n    },\r\n    COUPON: {\r\n        ACCESS: {\r\n            COUPON_VIEW: false,\r\n            COUPON_EDIT: false,\r\n            COUPON_DOWNLOAD: false,\r\n        },\r\n        COUPON_ALL_COUPON: \"ALL_COUPON\",\r\n        COUPON_ADD_NEW_COUPON: \"ADD_NEW_COUPON\",\r\n    },\r\n    PRODUCT: {\r\n        ACCESS: {\r\n            PRODUCT_VIEW: false,\r\n            PRODUCT_EDIT: false,\r\n            PRODUCT_DOWNLOAD: false,\r\n        },\r\n        PRODUCT_ALL_PRODUCT: \"ALL_PRODUCT\",\r\n        PRODUCT_ADD_PRODUCT: \"ADD_PRODUCT\",\r\n    },\r\n    VENDOR: {\r\n        ACCESS: {\r\n            VENDOR_VIEW: false,\r\n            VENDOR_EDIT: false,\r\n            VENDOR_DOWNLOAD: false,\r\n        },\r\n        VENDOR_ALL_VENDOR: \"ALL_VENDOR\",\r\n        VENDOR_ADD_VENDOR: \"ADD_VENDOR\",\r\n        VENDOR_VENDOR_PAYMENT: \"VENDOR_PAYMENT\",\r\n        VENDOR_VENDOR_MOV: \"VENDOR_MOV\",\r\n    },\r\n    CUSTOMER: {\r\n        ACCESS: {\r\n            CUSTOMER_VIEW: false,\r\n            CUSTOMER_EDIT: false,\r\n            CUSTOMER_DOWNLOAD: false,\r\n        },\r\n        CUSTOMER_ALL_CUSTOMER: \"ALL_CUSTOMER\",\r\n        CUSTOMER_CUSTOMER_ORDER_BY_PHONE: \"CUSTOMER_ORDER_BY_PHONE\",\r\n    },\r\n    SETTING: {\r\n        SETTING_BUSINESS_INFO_SETTING: \"BUSINESS_INFO_SETTING\",\r\n        SETTING_HOMEPAGE_SETTING: \"HOMEPAGE_SETTING\",\r\n    },\r\n    REPORT: {\r\n        ACCESS: { REPORT_VIEW: false, REPORT_DOWNLOAD: false },\r\n    },\r\n    SUB_ADMIN: {\r\n        ACCESS: { SUBADMIN_VIEW: false, SUBADMIN_DOWNLOAD: false },\r\n        SUB_ADMIN_ALL_ADMIN: \"ALL_ADMIN\",\r\n        SUB_ADMIN_ADD_ADMIN: \"ADD_ADMIN\",\r\n    },\r\n};\r\nconst listOfRoleEnums = () => {\r\n    let arr = [\"ADMIN\"];\r\n\r\n    for (let keys in roleEnums) {\r\n        if (typeof roleEnums[keys] === \"string\") {\r\n            arr.push(roleEnums[keys]);\r\n        } else {\r\n            arr = [...arr, ...Object.values(roleEnums[keys]).flat()];\r\n        }\r\n    }\r\n    return arr;\r\n};\r\n\r\nconst listOfAccessControll = () => {\r\n    let arr = [\"ADMIN\"];\r\n    for (let x of Object.keys(accessControls)) {\r\n        if (typeof accessControls[x] !== \"string\") {\r\n            for (let y of Object.keys(accessControls[x])) {\r\n                if (typeof accessControls[x][y] !== \"string\") {\r\n                    for (let z of Object.keys(accessControls[x][y])) {\r\n                        arr.push(z);\r\n                    }\r\n                } else {\r\n                    arr.push(y);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return arr;\r\n};\r\n\r\nmodule.exports = {\r\n    roleEnums,\r\n    listOfRoleEnums,\r\n    accessControls,\r\n    listOfAccessControll,\r\n};\r\n","const Puppeteer = require(\"puppeteer\");\r\nvar hbs = require(\"handlebars\");\r\nvar fs = require(\"fs\");\r\nconst path = require(\"path\");\r\n\r\nconst generatePdf = async (invData, footerText) => {\r\n    const templatePath = path.resolve(\"invoice.hbs\");\r\n    const content = fs.readFileSync(templatePath, \"utf8\");\r\n    const template = hbs.compile(content);\r\n    let html = template(invData);\r\n    const browser = await Puppeteer.launch({ headless: \"new\" });\r\n    const page = await browser.newPage();\r\n    await page.setContent(html);\r\n\r\n    await page.addStyleTag({ content: \".pageNumbers { content: counter(page) }\" })\r\n    let pdf = await page.pdf({\r\n        format:'A4',\r\n        printBackground: true,\r\n        displayHeaderFooter: true,\r\n        footerTemplate: `<div style='width:100%; font-size:10px; text-align: end; font-weight: 600; padding-right:20px'>${footerText}<span style=\"margin-left:5px;\"><span class='pageNumber'></span><span>/</span><span class='totalPages'></span></span></div>`,\r\n    });\r\n    await browser.close();\r\n    return pdf;\r\n};\r\n\r\nmodule.exports = { generatePdf };\r\n\r\n\r\n// const data = {\r\n//     logo: \"\",\r\n//     brandName: \"\",\r\n//     soldBy: \"\",\r\n//     soldByAddress: \"\",\r\n//     soldByGst: \"\",\r\n//     invoiceNo: \"\",\r\n//     orderId: \"\",\r\n//     orderDate: \"\",\r\n//     invoiceDate: \"\",\r\n//     billToName: \"\",\r\n//     billToAddress: \"\",\r\n//     billToPhone: \"\",\r\n//     billToGST: \"\",\r\n//     shipToName: \"\",\r\n//     shipToAddress: \"\",\r\n//     shipToPhone: \"\",\r\n//     shipToGST: \"\",\r\n//     tableRow: [],\r\n//     totalAmt: \"\",\r\n//     totalCGSTAmt: \"\",\r\n//     totalSGSTAmt: \"\",\r\n//     totalIGSTAmt: \"\",\r\n//     taxableAmt: \"\",\r\n//     totalTaxAmt: \"\",\r\n//     grossTotalAmt: \"\",\r\n//     discountAmt: \"\",\r\n//     netPayableAmount: \"\",\r\n// };","const financialYear = () => {\n    let date = new Date();\n    let currentYear = date.getFullYear();\n    let currentMonth = date.getMonth() + 1;\n    let year = \"\";\n    if (currentMonth < 4) {\n        year = currentYear - 1;\n    } else {\n        year = currentYear;\n    }\n    return year.toString().slice(2);\n};\n\nmodule.exports = { financialYear };\n","const percentage = (num, per) => {\r\n    return (Number(num)*Number(per))/100;\r\n}\r\n\r\nconst calculateMarginAndSelling = (sellerAmount, margin, sellingGst) => {\r\n    if(Number(sellerAmount) === 0){\r\n        return 0;\r\n    }\r\n  \r\n    let baseAmount = Number(sellerAmount);\r\n    if(Number(margin) === 0){\r\n        return Number(baseAmount.toFixed(2));\r\n    }else{\r\n        let basePlusMarginAmt = percentage(baseAmount, margin) + baseAmount;\r\n        let totalAmt = percentage(basePlusMarginAmt, sellingGst) + Number(basePlusMarginAmt);\r\n        return Number(totalAmt.toFixed(2));\r\n    }\r\n}\r\nmodule.exports = {percentage,calculateMarginAndSelling};","const stateAndCode = {\r\n    \"Himachal Pradesh\": \"02\",\r\n    Punjab: \"03\",\r\n    Chandigarh: \"04\",\r\n    Uttarakhand: \"05\",\r\n    Haryana: \"06\",\r\n    Delhi: \"07\",\r\n    Rajasthan: \"08\",\r\n    \"Uttar Pradesh\": \"09\",\r\n    Bihar: \"10\",\r\n    Sikkim: \"11\",\r\n    \"Arunanchal Pradesh\": \"12\",\r\n    Nagaland: \"13\",\r\n    Manipur: \"14\",\r\n    Mizoram: \"15\",\r\n    Tripura: \"16\",\r\n    Meghalaya: \"17\",\r\n    Assam: \"18\",\r\n    \"West Bengal\": \"19\",\r\n    Jharkhand: \"20\",\r\n    Odisha: \"21\",\r\n    Chattisgarh: \"22\",\r\n    \"Madhya Pradesh\": \"23\",\r\n    Gujarat: \"24\",\r\n    \"Dadra And Nagar Haveli And Daman And  Diu\": \"26\",\r\n    Maharashtra: \"27\",\r\n    Karnataka: \"29\",\r\n    Goa: \"30\",\r\n    Lakshadweep: \"31\",\r\n    Kerela: \"32\",\r\n    \"Tamil Nadu\": \"33\",\r\n    Puducherry: \"34\",\r\n    \"Andaman and Nicobar Islands\": \"35\",\r\n    Telangana: \"36\",\r\n    \"Andhra Pradesh\": \"37\",\r\n    Ladakh: \"38\",\r\n    \"Other Territory\": \"97\",\r\n};\r\n\r\nmodule.exports = {stateAndCode}","const ObjectId = require(\"mongoose\").Types.ObjectId;\r\n\r\nconst isValidRequestBody = (requestBody) => {\r\n  return Object.keys(requestBody).length > 0;\r\n};\r\n\r\nconst isValidObjectId = (objectId) => {\r\n  if (!ObjectId.isValid(objectId)) return false;\r\n  return true;\r\n};\r\n\r\nconst isValid = (value) => {\r\n  if (typeof value === \"undefined\" || typeof value === null) return false;\r\n  if (typeof value === \"string\" && value.trim().length == 0) return false;\r\n  return true;\r\n};\r\n\r\nlet isValidName = function (name) {\r\n  let nameRegex = /^[A-Za-z\\s]{1,}[A-Za-z\\s]{0,}$/;\r\n  return nameRegex.test(name);\r\n};\r\n\r\nconst isValidEmail = function (gmail) {\r\n  let regex = /^\\w+([\\.-]?\\w+)@\\w+([\\.-]?\\w+)(\\.\\w{2,6})+$/;\r\n  return regex.test(gmail);\r\n};\r\n\r\nlet isValidPassword = function (password) {\r\n  let regexPassword =\r\n    /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,15}$/;\r\n  return regexPassword.test(password);\r\n};\r\n\r\nconst isValidMoblie = function (mobile) {\r\n  let regex =\r\n    /^(?:(?:\\+|0{0,2})91(\\s*|[\\-])?|[0]?)?([6789]\\d{2}([-]?)\\d{3}([-]?)\\d{4})$/;\r\n  return regex.test(mobile);\r\n};\r\n\r\nconst isValidGST = function (GST) {\r\n  let regex = /\\d{2}[A-Z]{5}\\d{4}[A-Z]{1}[A-Z\\d]{1}[Z]{1}[A-Z\\d]{1}/;\r\n  return regex.test(GST);\r\n};\r\n\r\nconst isValidPrice = function (price) {\r\n  let regex = /^\\d+(?:[.,]\\d+)*$/;\r\n  return regex.test(price);\r\n};\r\n\r\nconst isValidImg = (img) => {\r\n  const reg = /image\\/png|image\\/jpeg|image\\/jpg/;\r\n  return reg.test(img);\r\n};\r\n\r\nfunction isValidStatus(value) {\r\n  if( [\"pending\", \"completed\", \"cancled\"].indexOf(value) == -1) {return false}\r\n  else return true\r\n};\r\n\r\nfunction isValidPin(pin) {\r\n  const regex = /^[1-9]{1}[0-9]{2}\\\\s{0, 1}[0-9]{3}$/;\r\n  return regex.test(pin);\r\n}\r\n\r\nmodule.exports = {\r\n  isValidRequestBody,\r\n  isValidObjectId,\r\n  isValid,\r\n  isValidName,\r\n  isValidEmail,\r\n  isValidImg,\r\n  isValidPassword,\r\n  isValidMoblie,\r\n  isValidGST,\r\n  isValidPrice,\r\n  isValidStatus,\r\n  isValidPin\r\n};","module.exports = require(\"aws-sdk\");","module.exports = require(\"aws-sdk/lib/maintenance_mode_message\");","module.exports = require(\"axios\");","module.exports = require(\"bcrypt\");","module.exports = require(\"body-parser\");","module.exports = require(\"convert-csv-to-json\");","module.exports = require(\"cors\");","module.exports = require(\"csvtojson\");","module.exports = require(\"dotenv\");","module.exports = require(\"exceljs\");","module.exports = require(\"express\");","module.exports = require(\"express-fileupload\");","module.exports = require(\"firebase/app\");","module.exports = require(\"firebase/storage\");","module.exports = require(\"handlebars\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"lodash\");","module.exports = require(\"mongoose\");","module.exports = require(\"puppeteer\");","module.exports = require(\"request\");","module.exports = require(\"slugify\");","module.exports = require(\"twilio\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const express = require(\"express\");\r\nconst mongoose = require(\"mongoose\");\r\nconst bodyParser = require(\"body-parser\");\r\nconst fileUpload = require(\"express-fileupload\");\r\nconst path = require(\"path\");\r\nconst cors = require(\"cors\");\r\nconst app = express();\r\nrequire(\"dotenv\").config();\r\n\r\nconst productRoutes = require(\"./src/routes/productRoutes\");\r\nconst categoryRoutes = require(\"./src/routes/categoryRoutes\");\r\nconst brandRoutes = require(\"./src/routes/brandRoutes\");\r\nconst vendorRoutes = require(\"./src/routes/vendorRoutes\");\r\nconst adminRoutes = require(\"./src/routes/adminRoutes\");\r\nconst colorRoutes = require(\"./src/routes/colorRoutes\");\r\nconst customerRoutes = require(\"./src/routes/customerRoutes\");\r\nconst orderRoutes = require(\"./src/routes/orderRoutes\");\r\nconst paymentRoutes = require(\"./src/routes/paymentRoutes\");\r\nconst cartRoutes = require(\"./src/routes/cartRoutes\");\r\nconst questionRoutes = require(\"./src/routes/questionsRoutes\");\r\nconst couponRoutes = require(\"./src/routes/couponCodeRoutes\");\r\nconst businessRoutes = require(\"./src/routes/businessRoutes\");\r\nconst homepageRoutes = require(\"./src/routes/homepageRoutes\");\r\nconst invoiceRoutes = require(\"./src/routes/invoiceRoutes\");\r\nconst optRoutes = require(\"./src/routes/otpRoutes\");\r\nconst orderStatusRoute = require(\"./src/routes/orderStatusTableRoutes\");\r\nconst profileRoutes = require(\"./src/routes/profileRoutes\");\r\nconst reportRoutes = require(\"./src/routes/reportRoutes\");\r\nconst dashboardRoutes = require(\"./src/routes/dashboardRoutes\");\r\nconst wishlistRoutes = require(\"./src/routes/wishlistRoutes\");\r\nconst adminDashboardRoute = require(\"./src/routes/adminDashboardRoute\");\r\nconst { mongoDbUrl, port } = require(\"./src/middlewares/config\");\r\n\r\napp.use(express.json());\r\napp.use(fileUpload());\r\napp.use(express.urlencoded({ extended: true }));\r\napp.use(bodyParser.json());\r\napp.use(cors());\r\n\r\nmongoose\r\n    .connect(mongoDbUrl, { useNewUrlParser: true })\r\n    .then(() => console.log(\"Connected with Database\"))\r\n    .catch((err) => console.log(err));\r\n\r\napp.use(\"/\", productRoutes);\r\napp.use(\"/\", categoryRoutes);\r\napp.use(\"/\", brandRoutes);\r\napp.use(\"/\", vendorRoutes);\r\napp.use(\"/\", adminRoutes);\r\napp.use(\"/\", colorRoutes);\r\napp.use(\"/\", customerRoutes);\r\napp.use(\"/\", orderRoutes);\r\napp.use(\"/\", paymentRoutes);\r\napp.use(\"/\", cartRoutes);\r\napp.use(\"/\", questionRoutes);\r\napp.use(\"/\", couponRoutes);\r\napp.use(\"/\", businessRoutes);\r\napp.use(\"/\", homepageRoutes);\r\napp.use(\"/\", invoiceRoutes);\r\napp.use(\"/\", optRoutes);\r\napp.use(\"/\", orderStatusRoute);\r\napp.use(\"/\", profileRoutes);\r\napp.use(\"/\", reportRoutes);\r\napp.use(\"/\", dashboardRoutes);\r\napp.use(\"/\", wishlistRoutes);\r\napp.use(\"/\", adminDashboardRoute);\r\n\r\napp.get(\"/\", (req, res) => {\r\n    res.send(\"<h1>factorez.com backend deployed successfully</h1>\");\r\n});\r\n\r\napp.listen(port, () => console.log(`Server is up and running on port: ${port}`));\r\n"],"names":["axios","bcrypt","otpModel","module","exports","sentOTP","async","req","res","mobile","body","apiKey","sid","type","senderId","OTP","length","id","i","Math","floor","digits","random","generateRandomID","smsData","method","url","headers","data","response","hash","otp","save","status","send","message","error","console","log","verifyOTP","otpHolder","find","validOTP","validUser","compare","deleteMany","adminModel","jwt","listOfRoleEnums","roleEnums","adminSecretKey","tokenSecretKey","vendorModel","isValid","isValidEmail","productModel","addAdmin","name","email","phone","password","role","$or","toLowerCase","isDeleted","admin","create","undefined","isSuperAdmin","getAllAdmin","select","createSuperAdmin","params","secretKey","superAdmin","adminLogin","includes","user","findOne","emailId","vendor_unique_id","err","result","date","Date","now","userFlag","userType","photo","profileUrl","vendorId","representativeName","altMobileNo","mobileNo","issueTime","token","sign","userId","_id","toString","userModel","iat","expiresIn","setHeader","hasAccess","getAllSubadminEnums","verifyVendor","vendorMargin","vendorStatus","vendorObj","findById","marginInPercentage","actionTakenBy","updateMany","vendor_id","$set","margin","deleteVendor","vendor","changeVendorPassword","newPassword","hashedPassword","updateAdminInfo","adminId","adminid","deleteAdminById","customerModel","orderModel","getDateStrToMS","dateStr","setHours","getTime","getCurrentYear","firstMonth","getFullYear","lastMonth","getCurrentMonth","firstDay","getMonth","lastDay","getCurrentWeek","curr","first","getDate","getDay","last","setDate","getDashboardData","products","populate","productCount","customerCount","vendorCount","orderCount","todayOrderCount","thisWeakOrderCount","thisMonthOrderCount","thisYearOrderCount","thisYearSale","thisMonthSale","thisWeekSale","overAllSale","todaySale","x","isActive","todayMS","orders","order_date","order_status_id","grand_total","overallOrder","brandModel","isValidObjectId","uploadFile","addBrand","brand_name","brandLogo","logoUrl","files","brandData","newBrand","brand_id","push","getAllBrands","brands","getAllBrandByVendor","verifyBrandById","brandId","brandStatus","brand","businessModel","uploadImage","bannerModel","addBusinessInfo","bName","bEmail","bNumber","businessData","business_name","contactNo","contactEmail","businessExists","addBusinessGST","gsts","defaultGST","getBusinessInfo","business","addBusinessFiles","bLogo","bInvLogo","bPolicy","bTC","business_Logo","invoiceLogo","privacyPolicy","iAgree","setDefaultGst","gst","gstd","gstNo","pickupAddress","stateCode","saveSocialMedia","facebook","instagram","twitter","youtube","linkedin","socialMedia","bannerForClientPage","images","imageURL","bannerUrl","getBannerForClientPage","bannerDeleteById","bannerId","findByIdAndDelete","cancelledReasonModel","addCancelledReason","questions","customerAnswer","cancelledReasonData","newCancelledReason","cartModel","colorModel","addToCart","customerId","product_id","qty","lotSize","colorId","cart","customer_id","customer","color","Number","colorName","colorHex","addedAt","toLocaleString","dataX","isActivated","cartLength","getAllAbandentCarts","carts","$gte","$size","path","model","getCartByCustomerId","customerData","removeFromCart","index","arr","splice","json","qtyIncreaseDecrease","cartAmt_current","totalPrice","forEach","element","seller_price","sellingGST","price","marginAmt","toFixed","priceCal","totalPriceCalc","currentCoupon","minOrderAmt","categoryModel","subcategoryModel","addCategory","category_name","subCategory","categoryData","sub_category","insertMany","newCategory","getAllCategories","categories","getCategoryById","categoryId","category","updateCategoryById","el","isFound","innerEl","hasOwnProperty","toHexString","findOneAndUpdate","deletedAt","new","subCategoryCreated","objs","xId","deleteCategoryById","addNewColor","deleteColorById","getAllColor","colors","couponCodeModel","isExpiryCoupon","generateCoupon","couponCode","validTill","maxUsers","maxDiscPrice","discountType","discountAmt","createData","createdCoupon","applyCoupon","customerid","orderAmount","coupon","isExpired","isUsed","day","month","year","expiryDateMS","getAllCoupons","coupons","sort","createdAt","deleteCoupon","couponId","couponid","customerAddressModel","isValidRequestBody","stateAndCode","addCustomerInformation","alternate_phone","pincode","address","state","city","addressData","Object","keys","isBlocked","cart_id","newAddress","defaultAddress","getAllAddresses","updateAddressByCustomerId","deleteAddressById","addressId","defaultAddressId","addAddress","isValidMoblie","isValidPassword","customerTokenSecretKey","wishlistModel","loginUser","wishlist","wishlistLength","getAllCustomer","customers","getCustomerById","updateCustomerById","deleteCustomerById","blockCustomerById","findOrdersByPhone","userPhone","setDefaultAddress","changePassword","HomepageModel","recommendedProduct","storeInfo","getProductBySlug","slug","product","stockStatus","excelJs","csv2json","request","dateToLocalDateTime","checkProductIds","categoryIds","colorIds","vednorIdForx","x1","color_id","subCatId","exportProductAddDemoSheet","workbook","Workbook","worksheet","addWorksheet","columnData","header","key","product_name","skucode","hsncode","category_id","subcategory_id","lotsize","mrp","in_hand_qty","min_order_qty","sole","material","packing_type","made_in","weight","description","thumbnail_url","multiple_images","unshift","newColumnData","slice","columns","addRow","getRow","eachCell","cell","font","bold","fill","pattern","fgColor","argb","xlsx","write","then","exportIDs","worksheet2","cat","subcategory_name","vendors","singleVendor","firmName","lastRow","obj","column","lengths","values","map","v","maxLength","max","filter","width","csvToJson","vendorIds","csvUrl","csv","resJson","fromStream","get","subscribe","productData","sku_code","hsn_code","lotSizeQty","qty_in_hand","productDataArr","vendorArr","Obj","split","flatMap","trim","thumbnail_pic","multiple_pics","statusX","indexOf","newProductObj","vdr","prdct","e","exportOrderReport","$in","strictPopulate","ordersArr","orderData","productLength","order","orderId","saleInvoice","invoiceNo","invoiceDate","ordered_products","skuCode","selling_gst","seller_gst","soldBy","discounted_amount","total","gstType","GST_amount","pickupCity","pickupState","pickupPincode","vendorAmtInfo","grandTotal","purchaseInvoice","gstAmt","orderStatusList","statusList","updatedDate","updatedAt","updatedBy","orderCol","buyerCol","saleCol","sellerCol","purchaseCol","orderJourney","m","saleSkuCol","purchaseSkuCol","saleGstCol","purchaseGstCol","saleLotSizeCol","purchaseLotSizeCol","orderLen","buyerLen","saleLen","sellerLen","purchaseLen","height","colNum","border","top","style","right","bottom","left","addFeaturedProducts","newArrival","featuredProduct","bestSelling","home","getFeaturedProduct","removeFeaturedProduct","idx","findIndex","preFix","generateRandomAlphaNumericID","characters","initializeApp","getStorage","ref","getDownloadURL","uploadBytesResumable","aws","config","awsS3Bucket","awsAccessKey","awsSecretKey","awsS3Region","firebaseConfig","storage","giveCurrentDateTime","today","getHours","getMinutes","getSeconds","update","accessKeyId","secretAccessKey","region","blobFile","dateTime","storageRef","replace","metadata","contentType","mimetype","snapshot","downloadURL","image","Promise","resolve","reject","s3","S3","uploadParams","Bucket","Key","Body","ContentType","upload","Location","invoiceModel","invoiceNoModel","orderedProductModel","generatePdf","financialYear","generatePurchaseInvoice","order_id","gstAmount","totalAmount","invNo","invoiceNoType","fY","invoiceYear","invoiceNoLength","strInvNumber","invNumber","substring","invData","invoiceType","invoiceAddress","shippingAddress","billingAddress","invRes","invoice","generateSaleInvoice","getAllSaleInvoice","invoices","getAllPurchaseInvoice","downoadInvoiceByInvoiceNumber","invoiceNumber","invoicenumber","invoicetype","orderedProduct","logo","brandName","soldByAddress","soldByPhone","soldByGst","orderDate","billToName","billToAddress","billToPhone","billToGST","shipToName","shipToAddress","shipToPhone","shipToGST","tableRow","totalAmt","totalCGSTAmt","totalSGSTAmt","totalIGSTAmt","taxableAmt","totalTaxAmt","grossTotalAmt","netPayableAmount","count","isRemoved","trData","sno","productName","sizeSet","hsnCode","rate","cgstPercentage","cgstAmount","sgstPercentage","sgstAmount","igstPercentage","igstAmount","pdf","customerAddress","mrginAmt","paymentModel","orderStatusTableModel","createPayment","createOrder","address_id","payment_mode","paymentAmt","transaction_id","demoObj","orderAmt","mAmt","totalamt","p","selling_price","sellingGstAmt","currentTotal","vdrAmt","vdrGstAmt","odrObj","addedOrder","maxDiscount","discAmt","singleOrder","percentage","partPayment","payment","payment_id","paymentId","shipping_address","getAllOrders","getOrderByOrderId","getOrdersByCustomerId","customerOrders","cancelOrderByOrderId","Status","updateOrderByOrderId","orderType","cancelMessage","questionId","removedProductIds","partialCanceledAmt","partialCanceledGstAmt","orderedProductAmtInfo","productQty","orderedAmtInfo","s_product","canceledAmt","adminCancelledAmt","order_status","updatedByObj","statusObj","partialCancelOrderInfo","purchaseGstAmount","purchaseTotalAmount","singleOrderProduct","invDataPurchase","invDataSale","partial_payment","payment_amount","return_amount","balance_amount","order_amount","resData","resData2","cancelled","question","cancelledStatus","objOfCancelledStatusList","cancelledStatusList","cod_received","getOrderedProduct","orderedproductid","patchTrackingIdByOrderId","t_id","tracking_id","getAllCancelledOrder","cancelledOrders","createOrderStatusTable","cancelledObj","cancelledBy","reason","orderStatusTableData","isCompleted","OrderStatusTableData","getAllOrderStatusTables","allOrderStatusTables","getOrderStatusTableById","orderStatusTableId","orderStatusTable","updateOrderStatusByOrderId","bulkOrderProcess","orderIds","orderStatusTables","cancelOrderReturnById","twilioAccSID","twilioAuthToken","twilioVerifySID","accountSid","authToken","verifySid","client","sendOTP","isSent","verify","v2","services","verifications","to","channel","verification","catch","verityOTP","otpCode","verificationChecks","code","verification_check","valid","resAcc","statusCode","createAccountAndToken","forgetPasswordUsingOtp","updatePassword","order_sortId","paymentData","payment_status","discount_amt","order_custom_id","transactionId","payment_date","updatePaymentStatus","addPayment","paymentDetails","partial_mode","ten_percent_amount","partialPaymentDetails","amount","firstPartialPayment","partialPaymentModel","partialPaymentData","remaining_amount","newPartialPayment","newPayment","twenty_percent_amount","reduce","sum","item","subCategoryModel","calculateMarginAndSelling","uploadMultipleImage","blob","addProduct","meta","JSON","parse","meta_title","metaTitle","meta_keywords","metaKeyword","meta_description","metaDescription","multipleImage","thumbnail","mulImg","Array","isArray","val","img","brandObj","categoryObj","subCatObj","getAllProducts","getProductById","productId","updateProductByProductId","gst_amount","stock_status","size_qty","primary_category","deleteProductByProductId","getAllProductsForDashboard","changeProductStatus","newStatus","changeProductStockStatus","newStockStatus","csvProduct","getAllProductsForFilter","updateProduct","singleFile","updateProfile","fullName","emailID","altPhone","newPass","oldPass","profileImg","imgRes","y","userid","questionModel","addQuestions","questionFor","questionObj","allQuestion","getAllQuestionByModel","getAllQuestion","deleteQuestionById","questionid","getOrderReport","$exists","exportSaleReport","startDate","endDate","invoice_no","invoice_date","order_qty","invoice_value","advance","discount","net_amount","refund","cash_on_delivery","buyer_name","buyer_no","exportPurchaseReport","seller_name","seller_phone","factorez_gst","purchase","gst_percentage","taxable_value","quantity","getPaymentReport","updatePaymentReport","orderid","paymentStatus","paidAmount","paymentDate","settlementAmt","paymentReportStatus","updateAt","logs","bankModel","documentModel","isValidGST","getAllVendors","addVendor","acHolderName","acNo","bankName","branch","ifsc","termsAndConditions","gstRegDoc","brandRegDoc","cancelledCheque","documentData","bankData","vendorData","document","bank","bank_id","document_id","auth_unique_id","db_unique_id","sharing_unique_id","createVendorByAdmin","basicInfoStatus","updateVendor","vendorObjId","brandX","addToWishlist","removeFromWishlist","wishlistId","findOneAndDelete","getWishlistProduct","Authentication","next","tokenWithBearer","authorization","decode","Authorization","tokenId","UserId","AuthenticationCustomer","mongoDbUrl","process","env","MONGO_DB_URL","TOKEN_SECRET_KEY","CUSTOMER_TOKEN_SECRET_KEY","port","PORT","FIREBASE_API_KEY","authDomain","FIREBASE_AUTH_DOMAIN","projectId","FIREBASE_PROJECT_ID","storageBucket","FIREBASE_STORAGE_BUCKET","messagingSenderId","FIREBASE_MESSAGING_SENDER_ID","appId","FIREBASE_APP_ID","measurementId","FIREBASE_MEASUREMENT_ID","ADMIN_SECRET_KEY","TWILIO_AUTH_TOKEN","TWILIO_ACCOUNT_SID","TWILIO_VERIFY_SID","AWS_ACCESS_KEY_ID","AWS_SECRET_ACCESS_KEY","S3_REGION","S3_BUCKET","dotenv","accessControls","checkUser","accessEnum","userData","AddProductRole","AllProductRole","PRODUCT","PRODUCT_ALL_PRODUCT","ACCESS","PRODUCT_DOWNLOAD","PRODUCT_EDIT","PRODUCT_VIEW","PRODUCT_ADD_PRODUCT","AllMenuRole","AllVendorRoles","VENDOR","VENDOR_DOWNLOAD","VENDOR_EDIT","VENDOR_VIEW","VENDOR_ADD_VENDOR","VENDOR_ALL_VENDOR","VENDOR_VENDOR_MOV","VENDOR_VENDOR_PAYMENT","AddProductColorRole","MANAGE_PRODUCT","PRODUCT_COLOR","AddProductBrandRole","BRAND","ManageOrderRole","ORDERS","ORDERS_ABANDONED_ORDERS","ORDERS_ALL_ORDERS","ORDERS_CHANGE_ORDER_STATUS","ORDERS_DOWNLOAD","ORDERS_EDIT","ORDERS_VIEW","colorRole","verifyProudct","PRODUCT_REVIEW","outOfStockProduct","abandonedOrderRole","mongoose","ObjectId","Schema","Types","homepageSchema","timestamps","listOfAccessControll","adminSchema","String","required","unique","enum","Boolean","default","bankSchema","bannerSchema","brandSchema","businessSchema","cancelledReasonSchema","cartSchema","categorySchema","colorSchema","couponCodeSchema","generatedBy","customerAddressSchema","customerSchema","documentSchema","invoiceSchema","invoiceStatus","invoiceNoSchema","orderSchema","shipping_charges","total_pairs","transport_bilty","orderStatusTableSchema","orderedProductSchema","otpSchema","expires","paymentSchema","slugify","productSchema","pre","this","lower","strict","questionSchema","subcategorySchema","vendorSchema","order_success","order_canclled","order_pending","order_inprogress","logistics_id","business_id","wishlistSchema","express","router","Router","adminController","post","put","delete","brandController","patch","categoryController","customerController","customerAddressController","orderController","orderStatusTableController","paymentController","productController","questionController","vendorController","dateToLocalDate","hr","min","ampm","MANAGE_MENU","ADD_CATEGORY","ADD_SUBCATEGORY","ADD_PRODUCT","ALL_PRODUCT","PRODUCT_SIZE","OUT_OF_STOCK_PRODUCTS","MANAGE_ORDERS","ALL_ORDERS","CONFIRM_ORDERS","SHIPPED_ORDER","PICKUP_PENDING","DELIVERED_ORDER","RTO_ORDER","RTO_DELIVERED","CANCEL_ORDER","PARTIAL_DELIVERED","HOLD","PICKUP_INITIATE","IMPORT_PINCODE","MANAGE_RETURN","RETURN_REQUEST","SETTLEMENT_REQUEST","REFUNDED","SETTLEMENT_REQUEST_CANCEL","ALL_USERS","MANAGE_COUPONS","ADD_COUPON","ALL_COUPON","MANAGE_SALES","HOMEPAGE_MANAGE","MANAGE_VENDOR","ADD_VENDOR","ALL_VENDOR","ALL_OUTSTANDING","ALL_SETTLED","ADD_EMPLOYEE","EXPORT_INFORMATION","COUPON","COUPON_VIEW","COUPON_EDIT","COUPON_DOWNLOAD","COUPON_ALL_COUPON","COUPON_ADD_NEW_COUPON","CUSTOMER","CUSTOMER_VIEW","CUSTOMER_EDIT","CUSTOMER_DOWNLOAD","CUSTOMER_ALL_CUSTOMER","CUSTOMER_CUSTOMER_ORDER_BY_PHONE","SETTING","SETTING_BUSINESS_INFO_SETTING","SETTING_HOMEPAGE_SETTING","REPORT","REPORT_VIEW","REPORT_DOWNLOAD","SUB_ADMIN","SUBADMIN_VIEW","SUBADMIN_DOWNLOAD","SUB_ADMIN_ALL_ADMIN","SUB_ADMIN_ADD_ADMIN","flat","z","Puppeteer","hbs","fs","footerText","templatePath","content","readFileSync","html","compile","template","browser","launch","headless","page","newPage","setContent","addStyleTag","format","printBackground","displayHeaderFooter","footerTemplate","close","currentYear","num","per","sellerAmount","sellingGst","baseAmount","basePlusMarginAmt","Punjab","Chandigarh","Uttarakhand","Haryana","Delhi","Rajasthan","Bihar","Sikkim","Nagaland","Manipur","Mizoram","Tripura","Meghalaya","Assam","Jharkhand","Odisha","Chattisgarh","Gujarat","Maharashtra","Karnataka","Goa","Lakshadweep","Kerela","Puducherry","Telangana","Ladakh","requestBody","objectId","value","isValidName","test","gmail","isValidImg","GST","isValidPrice","isValidStatus","isValidPin","pin","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","bodyParser","fileUpload","cors","app","productRoutes","categoryRoutes","brandRoutes","vendorRoutes","adminRoutes","colorRoutes","customerRoutes","orderRoutes","paymentRoutes","cartRoutes","questionRoutes","couponRoutes","businessRoutes","homepageRoutes","invoiceRoutes","optRoutes","orderStatusRoute","profileRoutes","reportRoutes","dashboardRoutes","wishlistRoutes","adminDashboardRoute","use","urlencoded","extended","connect","useNewUrlParser","listen"],"sourceRoot":""}