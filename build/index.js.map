{"version":3,"file":"index.js","mappings":"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","sources":["webpack://shoewebsite/./src/controllers/OTP.js","webpack://shoewebsite/./src/controllers/adminController.js","webpack://shoewebsite/./src/controllers/adminDashboard.js","webpack://shoewebsite/./src/controllers/brandController.js","webpack://shoewebsite/./src/controllers/businessController.js","webpack://shoewebsite/./src/controllers/cancelReasonController.js","webpack://shoewebsite/./src/controllers/cartController.js","webpack://shoewebsite/./src/controllers/categoryController.js","webpack://shoewebsite/./src/controllers/colorController.js","webpack://shoewebsite/./src/controllers/couponCodeController.js","webpack://shoewebsite/./src/controllers/customerAddressController.js","webpack://shoewebsite/./src/controllers/customerController.js","webpack://shoewebsite/./src/controllers/dashboardController.js","webpack://shoewebsite/./src/controllers/excelFileController.js","webpack://shoewebsite/./src/controllers/homepageController.js","webpack://shoewebsite/./src/controllers/idGeneratorController.js","webpack://shoewebsite/./src/controllers/imageController.js","webpack://shoewebsite/./src/controllers/invoiceController.js","webpack://shoewebsite/./src/controllers/orderController.js","webpack://shoewebsite/./src/controllers/orderStatusTableController.js","webpack://shoewebsite/./src/controllers/otpController.js","webpack://shoewebsite/./src/controllers/paymentController.js","webpack://shoewebsite/./src/controllers/productController.js","webpack://shoewebsite/./src/controllers/profileController.js","webpack://shoewebsite/./src/controllers/questionController.js","webpack://shoewebsite/./src/controllers/reportController.js","webpack://shoewebsite/./src/controllers/vendorController.js","webpack://shoewebsite/./src/controllers/wishlistController.js","webpack://shoewebsite/./src/middlewares/auth.js","webpack://shoewebsite/./src/middlewares/config.js","webpack://shoewebsite/./src/middlewares/firebase.js","webpack://shoewebsite/./src/middlewares/roleAuth.js","webpack://shoewebsite/./src/models/HomepageModel.js","webpack://shoewebsite/./src/models/adminModel.js","webpack://shoewebsite/./src/models/bankModel.js","webpack://shoewebsite/./src/models/bannerModel.js","webpack://shoewebsite/./src/models/brandModel.js","webpack://shoewebsite/./src/models/businessModel.js","webpack://shoewebsite/./src/models/cancelledReasonModel.js","webpack://shoewebsite/./src/models/cartModel.js","webpack://shoewebsite/./src/models/categoryModel.js","webpack://shoewebsite/./src/models/colorModel.js","webpack://shoewebsite/./src/models/couponCodeModel.js","webpack://shoewebsite/./src/models/customerAddressModel.js","webpack://shoewebsite/./src/models/customerModel.js","webpack://shoewebsite/./src/models/documentModel.js","webpack://shoewebsite/./src/models/invoiceModel.js","webpack://shoewebsite/./src/models/invoiceNoModel.js","webpack://shoewebsite/./src/models/orderModel.js","webpack://shoewebsite/./src/models/orderStatusTableModel.js","webpack://shoewebsite/./src/models/orderedProductModel.js","webpack://shoewebsite/./src/models/otpModel.js","webpack://shoewebsite/./src/models/paymentModel.js","webpack://shoewebsite/./src/models/productModel.js","webpack://shoewebsite/./src/models/questionModel.js","webpack://shoewebsite/./src/models/subcategoryModel.js","webpack://shoewebsite/./src/models/vendorModel.js","webpack://shoewebsite/./src/models/wishlistModel.js","webpack://shoewebsite/./src/routes/adminDashboardRoute.js","webpack://shoewebsite/./src/routes/adminRoutes.js","webpack://shoewebsite/./src/routes/brandRoutes.js","webpack://shoewebsite/./src/routes/businessRoutes.js","webpack://shoewebsite/./src/routes/cartRoutes.js","webpack://shoewebsite/./src/routes/categoryRoutes.js","webpack://shoewebsite/./src/routes/colorRoutes.js","webpack://shoewebsite/./src/routes/couponCodeRoutes.js","webpack://shoewebsite/./src/routes/customerRoutes.js","webpack://shoewebsite/./src/routes/dashboardRoutes.js","webpack://shoewebsite/./src/routes/homepageRoutes.js","webpack://shoewebsite/./src/routes/invoiceRoutes.js","webpack://shoewebsite/./src/routes/orderRoutes.js","webpack://shoewebsite/./src/routes/orderStatusTableRoutes.js","webpack://shoewebsite/./src/routes/otpRoutes.js","webpack://shoewebsite/./src/routes/paymentRoutes.js","webpack://shoewebsite/./src/routes/productRoutes.js","webpack://shoewebsite/./src/routes/profileRoutes.js","webpack://shoewebsite/./src/routes/questionsRoutes.js","webpack://shoewebsite/./src/routes/reportRoutes.js","webpack://shoewebsite/./src/routes/vendorRoutes.js","webpack://shoewebsite/./src/routes/wishlistRoutes.js","webpack://shoewebsite/./src/utils/couponExpireUtil.js","webpack://shoewebsite/./src/utils/dateUtils.js","webpack://shoewebsite/./src/utils/enums.js","webpack://shoewebsite/./src/utils/generatePdf.js","webpack://shoewebsite/./src/utils/getFinancialYear.js","webpack://shoewebsite/./src/utils/percentage.js","webpack://shoewebsite/./src/utils/stateNameAndCode.js","webpack://shoewebsite/./src/utils/utils.js","webpack://shoewebsite/external commonjs \"aws-sdk\"","webpack://shoewebsite/external commonjs \"aws-sdk/lib/maintenance_mode_message\"","webpack://shoewebsite/external commonjs \"axios\"","webpack://shoewebsite/external commonjs \"bcrypt\"","webpack://shoewebsite/external commonjs \"body-parser\"","webpack://shoewebsite/external commonjs \"convert-csv-to-json\"","webpack://shoewebsite/external commonjs \"cors\"","webpack://shoewebsite/external commonjs \"csvtojson\"","webpack://shoewebsite/external commonjs \"dotenv\"","webpack://shoewebsite/external commonjs \"exceljs\"","webpack://shoewebsite/external commonjs \"express\"","webpack://shoewebsite/external commonjs \"express-fileupload\"","webpack://shoewebsite/external commonjs \"firebase/app\"","webpack://shoewebsite/external commonjs \"firebase/storage\"","webpack://shoewebsite/external commonjs \"handlebars\"","webpack://shoewebsite/external commonjs \"jsonwebtoken\"","webpack://shoewebsite/external commonjs \"lodash\"","webpack://shoewebsite/external commonjs \"mongoose\"","webpack://shoewebsite/external commonjs \"puppeteer\"","webpack://shoewebsite/external commonjs \"request\"","webpack://shoewebsite/external commonjs \"slugify\"","webpack://shoewebsite/external commonjs \"twilio\"","webpack://shoewebsite/external node-commonjs \"fs\"","webpack://shoewebsite/external node-commonjs \"path\"","webpack://shoewebsite/webpack/bootstrap","webpack://shoewebsite/./index.js"],"sourcesContent":["const axios = require(\"axios\");\r\nconst _ = require(\"lodash\");\r\nconst bcrypt = require('bcrypt');\r\nconst otpModel = require('../models/otpModel');\r\n\r\n\r\n// GENERATE RANDOM NUMERIC ID OF GIVEN LENGTH\r\nfunction generateRandomID(length) {\r\n    let id = '';\r\n    const digits = '0123456789';\r\n  \r\n    for (let i = 0; i < length; i++) {\r\n      const randomIndex = Math.floor(Math.random() * digits.length);\r\n      id += digits[randomIndex];\r\n    }\r\n    return id;\r\n}\r\n\r\n\r\n// SEND OTP THROUGH KALEYRA SMS API\r\nconst sentOTP = async (req, res) => {\r\n    try {\r\n        const apiKey = \"A78cd4e6b7179e5439caac3c9f5f75b63\";\r\n        const sid = \"HXIN1777665894IN\";\r\n        const type = \"OTP\";\r\n        const senderId = \"FCTREZ\";\r\n        let to = 917042072054;\r\n        let OTP = generateRandomID(4);\r\n        const otpTemplateId = \"1007482403267557324\";\r\n        // const { to, OTP } = req.body;\r\n        // console.log(\"mobile: \", to);\r\n\r\n        const body = `Your OTP Code for registration on factorez is ${OTP}. Thank you for Signup on FactorEz.com`;\r\n\r\n        const smsData = {\r\n            method: \"POST\",\r\n            url: `https://api.kaleyra.io/v1/${sid}/messages`,\r\n            headers: {\r\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n                \"api-key\": apiKey,\r\n            },\r\n            data: `to=${to}&type=${type}&sender=${senderId}&body=${body}&template_id=${otpTemplateId}`,\r\n        };\r\n\r\n        const response = await axios(smsData);\r\n        // console.log(\"OTP SMS sent successfully!\", response.data);\r\n\r\n        let hashedOTP = await bcrypt.hash(OTP, 10);\r\n        OTP = hashedOTP;\r\n\r\n        // console.log(\"hashed OTP: \", OTP);\r\n\r\n        let otp = new otpModel({ mobile: to, otp: OTP });\r\n\r\n        await otp.save();\r\n\r\n        return res.status(200).send({ status: true, message: \"OTP sent successfully\", data: response.data });\r\n    } catch (error) {\r\n        console.log(\"Error sending SMS:\", error.message);\r\n        return res.status(401).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n\r\n// VERIFY OTP\r\nconst verifyOTP = async (req, res) => {\r\n    try {\r\n        let { mobile, OTP } = req.body;\r\n\r\n        let otpHolder = await otpModel.find({mobile: mobile});\r\n\r\n        if (!otpHolder.length) {\r\n            return res.status(401).send({status: false, message: 'You are using an expired OTP'});\r\n        }\r\n\r\n        let validOTP = otpHolder[otpHolder.length - 1];\r\n\r\n        let validUser = bcrypt.compare(OTP, validOTP.otp);\r\n\r\n        if (validOTP.mobile === mobile && validUser) {\r\n            await otpModel.deleteMany({mobile: validOTP.mobile});\r\n\r\n            return res.status(200).send({status: true, message: 'User verified'});\r\n        } else {\r\n            return res.status(401).send({status: false, message: 'Authentication failed'});\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({status: false, message: error.message})\r\n    }\r\n}\r\n\r\nmodule.exports = { sentOTP, verifyOTP };","const adminModel = require(\"../models/adminModel\");\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst { listOfRoleEnums, roleEnums } = require(\"../utils/enums\");\r\nconst { adminSecretKey, tokenSecretKey } = require(\"../middlewares/config\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst documentModel = require(\"../models/documentModel\");\r\nconst bankModel = require(\"../models/bankModel\");\r\nconst brandModel = require(\"../models/brandModel\");\r\nconst { isValid, isValidEmail } = require(\"../utils/utils\");\r\nconst productModel = require(\"../models/productModel\");\r\n\r\nconst addAdmin = async (req, res) => {\r\n    try {\r\n        let { name, email, phone, password, role } = req.body;\r\n\r\n        let admins = await adminModel.find({\r\n            $or: [{ email: email }, { phone: phone }],\r\n        });\r\n        if (admins.length > 0) {\r\n            return res.status(400).send({\r\n                message: \"Email or Password already exists\",\r\n                status: false,\r\n            });\r\n        }\r\n        if (name === \"\") {\r\n            return res.status(400).send({ message: \"Name is required\", status: false });\r\n        }\r\n        if (email === \"\") {\r\n            return res.status(400).send({ message: \"Email is required\", status: false });\r\n        }\r\n        if (phone === \"\") {\r\n            return res.status(400).send({ message: \"Phone number is required\", status: false });\r\n        }\r\n        if (password === \"\") {\r\n            return res.status(400).send({ message: \"Password is required\", status: false });\r\n        }\r\n        if (role === \"\") {\r\n            return res.status(400).send({ message: \"Admin Role is required\", status: false });\r\n        }\r\n        let hashedPassword = await bcrypt.hash(password, 10);\r\n        password = hashedPassword;\r\n        let data = {\r\n            name,\r\n            email: email.toLowerCase(),\r\n            password,\r\n            role,\r\n            phone,\r\n            isDeleted: false,\r\n        };\r\n        let admin = await adminModel.create(data);\r\n        admin.password = undefined;\r\n        admin.isSuperAdmin = undefined;\r\n        return res.status(201).send({ status: true, message: \"Successful\", data: admin });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllAdmin = async (req, res) => {\r\n    let admin = await adminModel.find({ isSuperAdmin: false, isDeleted: false }).select([\"-password\", \"-isSuperAdmin\"]);\r\n    return res.status(200).send({ status: true, message: \"All admins\", data: admin });\r\n};\r\n\r\nconst updateAdminInfo = async (req, res) => {\r\n    try {\r\n        let adminId = req.params.adminid;\r\n        let { phone, password, email, name, role } = req.body;\r\n        let admin = await adminModel.findOne({ _id: adminId, isDeleted: false });\r\n        if (!admin) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (phone) admin.phone = phone;\r\n        if (email) admin.email = email.toLowerCase();\r\n        if (name) admin.name = name;\r\n        if (role) admin.role = role;\r\n        if (password) {\r\n            let hashedPassword = await bcrypt.hash(password, 10);\r\n            admin.password = hashedPassword;\r\n        }\r\n        await admin.save();\r\n        return res.status(202).send({ status: true, message: \"Admin Updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst createSuperAdmin = async (req, res) => {\r\n    try {\r\n        let { name, email, phone, password } = req.body;\r\n        let params = req.params.secretKey;\r\n        if (params === adminSecretKey) {\r\n            let admins = await adminModel.find({\r\n                $or: [{ email: email }, { phone: phone }],\r\n            });\r\n            if (admins.length > 0) {\r\n                return res.status(400).send({\r\n                    message: \"Email or Password already exists\",\r\n                    status: false,\r\n                });\r\n            }\r\n            if (name === \"\") {\r\n                return res.status(400).send({ message: \"Name is required\", status: false });\r\n            }\r\n            if (email === \"\") {\r\n                return res.status(400).send({ message: \"Email is required\", status: false });\r\n            }\r\n            if (phone === \"\") {\r\n                return res.status(400).send({ message: \"Phone number is required\", status: false });\r\n            }\r\n            if (password === \"\") {\r\n                return res.status(400).send({ message: \"Password is required\", status: false });\r\n            }\r\n            let hashedPassword = await bcrypt.hash(password, 10);\r\n            password = hashedPassword;\r\n            let data = {\r\n                name,\r\n                email: email.toLowerCase(),\r\n                password,\r\n                role: [\"ADMIN\"],\r\n                phone,\r\n                isSuperAdmin: true,\r\n                isDeleted: false,\r\n            };\r\n            let superAdmin = await adminModel.create(data);\r\n            superAdmin.password = undefined;\r\n            superAdmin.isSuperAdmin = undefined;\r\n            return res.status(201).send({ status: true, message: \"Successful\", data: superAdmin });\r\n        }\r\n        return res.status(401).send({ status: true, message: \"Invalid signature\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst adminLogin = async (req, res) => {\r\n    try {\r\n        let { email, password } = req.body;\r\n        if (!isValid(email)) {\r\n            return res.status(400).send({ status: false, message: \"Email or USER Id is required\" });\r\n        }\r\n\r\n        if (email.includes(\"@\")) {\r\n            if (!isValidEmail(email)) {\r\n                return res.status(400).send({ status: false, message: \"Invalid email\" });\r\n            }\r\n        }\r\n        if (!isValid(password)) {\r\n            return res.status(400).send({ status: false, message: \"password is required\" });\r\n        }\r\n        // const EmailRegex = /^\\w+([\\.]?\\w+)*@\\w+([\\.]?\\w+)*(\\.\\w{2,3})+$/;\r\n        // const UserIDReges = /^[0-9]{8,14}$/;\r\n        // const PasswordRegex = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{10,20}$/;\r\n\r\n        // if ((!EmailRegex.test(email) && !UserIDReges.test(email)) || !PasswordRegex.test(password)) {\r\n        //     return res.status(400).send({ status: false, message: \"Please provide valid Credentials\" });\r\n        // }\r\n        let user = null;\r\n        if (email.includes(\"@\")) {\r\n            user = await adminModel.findOne({ email: email.toLowerCase(), isDeleted: false });\r\n            if (!user) {\r\n                user = await vendorModel.findOne({ emailId: email.toLowerCase() });\r\n            }\r\n        } else {\r\n            user = await vendorModel.findOne({ vendor_unique_id: email });\r\n        }\r\n        if (!user) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Email id or Username\" });\r\n        }\r\n        bcrypt.compare(password, user.password, function (err, result) {\r\n            if (err) {\r\n                return res.status(400).send({ status: false, message: err.message });\r\n            }\r\n            hasAccess(result);\r\n        });\r\n\r\n        function hasAccess(result) {\r\n            if (result) {\r\n                let date = Date.now();\r\n                let data = {};\r\n                let userFlag = \"isSuperAdmin\" in user;\r\n                if (!userFlag) {\r\n                    if (user.status === \"Pending\" || user.status === \"Inprogress\") {\r\n                        return res.status(401).send({ status: false, message: \"Account is under review\" });\r\n                    }\r\n                    if (user.status === \"Rejected\") {\r\n                        return res.status(401).send({ status: false, message: \"Account has been Rejected, Please contact us.\" });\r\n                    }\r\n                }\r\n                if (!userFlag) {\r\n                    data.name = user.representativeName;\r\n                    data.email = user.emailId;\r\n                    data.userType = \"Seller\";\r\n                    data.role = user.role;\r\n                    data.altMobileNo = user.altMobileNo;\r\n                    data.phone = user.mobileNo;\r\n                    data.photo = user.profileUrl;\r\n                    data.vendorId = user.vendor_unique_id;\r\n                } else {\r\n                    data.name = user.name;\r\n                    data.email = user.email;\r\n                    data.userType = user.isSuperAdmin ? \"Super Admin\" : \"Admin\";\r\n                    data.role = user.role;\r\n                    data.phone = user.phone;\r\n                    data.photo = user.profileUrl;\r\n                    data.vendorId = null;\r\n                }\r\n\r\n                let issueTime = Math.floor(date / 1000);\r\n                let token = jwt.sign(\r\n                    {\r\n                        email: data.email,\r\n                        userId: user._id.toString(),\r\n                        userModel: userFlag ? \"ADMIN\" : \"VENDOR\",\r\n                        iat: issueTime,\r\n                    },\r\n                    tokenSecretKey,\r\n                    { expiresIn: \"12h\" }\r\n                );\r\n                data.token = token;\r\n\r\n                res.setHeader(\"Authorization\", \"Bearer\", token);\r\n                return res.status(200).send({\r\n                    status: false,\r\n                    message: \"Successfully logged in\",\r\n                    data: data,\r\n                });\r\n            } else {\r\n                return res.status(401).send({ status: false, message: \"Incorrect Password\" });\r\n            }\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst getAllSubadminEnums = async (req, res) => {\r\n    try {\r\n        return res.status(200).send({ status: true, message: \"Data Accessed\", data: roleEnums });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst verifyVendor = async (req, res) => {\r\n    try {\r\n        let { vendorMargin, vendorStatus } = req.body;\r\n        let vendorObj = await vendorModel.findById(req.params.vendorId);\r\n        if (vendorStatus === \"Approved\") {\r\n            if (vendorMargin) {\r\n                vendorObj.marginInPercentage = vendorMargin;\r\n            }\r\n            vendorObj.status = vendorStatus;\r\n            vendorObj.actionTakenBy = req.userId;\r\n            await productModel.updateMany({ vendor_id: vendorObj._id }, { $set: { margin: vendorMargin } });\r\n            await vendorObj.save();\r\n        } else if (vendorStatus === \"Rejected\") {\r\n            vendorObj.status = vendorStatus;\r\n            vendorObj.actionTakenBy = req.userId;\r\n            await vendorObj.save();\r\n        } else {\r\n            if (vendorMargin) {\r\n                await productModel.updateMany({ vendor_id: vendorObj._id }, { $set: { margin: vendorMargin } });\r\n                vendorObj.marginInPercentage = vendorMargin;\r\n            }\r\n            await vendorObj.save();\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Vendor Updated\", data: \"Updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst deleteVendor = async (req, res) => {\r\n    try {\r\n        let { vendorId } = req.body;\r\n        if (!vendorId) {\r\n            return res.status(400).send({ status: false, message: \"bad request\" });\r\n        }\r\n        let vendor = await vendorModel.findById(vendorId);\r\n        if (!vendor) {\r\n            return res.status(400).send({ status: false, message: \"vendor not found\" });\r\n        }\r\n        vendor.isDeleted = true;\r\n        await vendor.save();\r\n        return res.status(202).send({ status: true, message: \"vendor deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst changeVendorPassword = async (req, res) => {\r\n    try {\r\n        let { vendorId, newPassword } = req.body;\r\n\r\n        let vendor = await vendorModel.findOne({ _id: vendorId });\r\n        if (!vendor) {\r\n            return res.status(404).send({ status: false, message: \"Vendor Not Found\" });\r\n        }\r\n        if (newPassword === \"\") {\r\n            return res.status(400).send({ message: \"Password is required\", status: false });\r\n        }\r\n        let hashedPassword = await bcrypt.hash(newPassword, 10);\r\n\r\n        vendor.password = hashedPassword;\r\n        await vendor.save();\r\n        return res.status(201).send({ message: \"Password updated\", status: true });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst deleteAdminById = async (req, res) => {\r\n    try {\r\n        let adminId = req.params.adminid;\r\n        let admin = await adminModel.findById(adminId);\r\n        if (!admin) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        admin.isDeleted = true;\r\n        await admin.save();\r\n        return res.status(202).send({ status: true, message: \"Admin Deleted\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addAdmin,\r\n    getAllAdmin,\r\n    createSuperAdmin,\r\n    adminLogin,\r\n    getAllSubadminEnums,\r\n    verifyVendor,\r\n    deleteVendor,\r\n    changeVendorPassword,\r\n    updateAdminInfo,\r\n    deleteAdminById,\r\n};\r\n","const productModel = require(\"../models/productModel\");\nconst customerModel = require(\"../models/customerModel\");\nconst vendorModel = require(\"../models/vendorModel\");\nconst orderModel = require(\"../models/orderModel\");\n\nconst getDateStrToMS = (dateStr) => {\n    dateStr.setHours(0, 0, 0, 0);\n    return dateStr.getTime();\n};\n\nconst getCurrentYear = () => {\n    var date = new Date();\n    var firstMonth = new Date(date.getFullYear(), 0, 1);\n    var lastMonth = new Date(date.getFullYear(), 12, 0);\n    return [firstMonth.getTime(), lastMonth.getTime()];\n};\n\nconst getCurrentMonth = () => {\n    var date = new Date();\n    var firstDay = new Date(date.getFullYear(), date.getMonth(), 1);\n    var lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0);\n    return [firstDay.getTime(), lastDay.getTime()];\n};\n\nconst getCurrentWeek = () => {\n    var curr = new Date();\n    curr.setHours(0, 0, 0, 0);\n    var first = curr.getDate() - curr.getDay();\n    var last = first + 6;\n    var firstDay = new Date(curr.setDate(first));\n    var lastDay = new Date(curr.setDate(last));\n    console.log(firstDay);\n    console.log(lastDay);\n    return [firstDay.getTime(), lastDay.getTime()];\n};\n\nconst getDashboardData = async (req, res) => {\n    try {\n        let products = await productModel.find({ isDeleted: false }).populate(\"vendor_id\");\n        let productCount = 0;\n        let customerCount = 0;\n        let vendorCount = 0;\n        let orderCount = 0;\n        let todayOrderCount = 0;\n        let thisWeakOrderCount = 0;\n        let thisMonthOrderCount = 0;\n        let thisYearOrderCount = 0;\n        let thisYearSale = 0;\n        let thisMonthSale = 0;\n        let thisWeekSale = 0;\n        let overAllSale = 0;\n        let todaySale = 0;\n        for (let x of products) {\n            if (x.vendor_id.isActive === \"Active\") {\n                productCount++;\n            }\n        }\n        let customer = await customerModel.find({ isDeleted: false });\n        customerCount += customer.length;\n        let vendors = await vendorModel.find({ isActive: \"Active\" });\n        vendorCount += vendors.length;\n\n        let todayMS = getDateStrToMS(new Date());\n\n        let orders = await orderModel.find().populate(\"order_status_id\");\n        for (let x of orders) {\n            console.log(x);\n            if (getDateStrToMS(x.order_date) === todayMS) {\n                todayOrderCount++;\n                if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                    todaySale += x.grand_total;\n                }\n            }\n            if (getDateStrToMS(x.order_date) >= getCurrentWeek()[0] && getDateStrToMS(x.order_date) <= getCurrentWeek()[1]) {\n                thisWeakOrderCount++;\n                if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                    thisWeekSale += x.grand_total;\n                }\n            }\n            if (getDateStrToMS(x.order_date) >= getCurrentMonth()[0] && getDateStrToMS(x.order_date) <= getCurrentMonth()[1]) {\n                thisMonthOrderCount++;\n                if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                    thisMonthSale += x.grand_total;\n                }\n            }\n            if (getDateStrToMS(x.order_date) >= getCurrentYear()[0] && getDateStrToMS(x.order_date) <= getCurrentYear()[1]) {\n                thisYearOrderCount++;\n                if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                    thisYearSale += x.grand_total;\n                }\n            }\n            if (x.order_status_id.status !== \"PENDING\" && x.order_status_id.status !== \"CANCELLED\") {\n                overAllSale += x.grand_total;\n            }\n            orderCount++;\n        }\n\n        let data = {\n            productCount,\n            customerCount,\n            vendorCount,\n            todayOrderCount,\n            thisWeakOrderCount,\n            thisMonthOrderCount,\n            thisYearOrderCount,\n            thisYearSale,\n            thisMonthSale,\n            thisWeekSale,\n            todaySale,\n            overAllSale,\n            overallOrder: orderCount,\n        };\n        return res.status(200).send({ status: true, data: { ...data }, message: \"Dashboard data fetched\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nmodule.exports = { getDashboardData };\n","const brandModel = require(\"../models/brandModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst { uploadFile } = require(\"./imageController\");\r\n// ADD BRAND DETAILS\r\nconst addBrand = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let { brand_name, vendor_id, brandLogo } = data;\r\n        if (!isValid(brand_name)) {\r\n            return res.status(400).send({ status: false, message: \"Brand Name is required\" });\r\n        }\r\n\r\n        let brand = await brandModel.findOne({\r\n            brand_name: brand_name,\r\n        });\r\n        if (brand) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"This category is already exists, please enter a new category\",\r\n            });\r\n        }\r\n        let vendor = await vendorModel.findOne({ vendor_unique_id: vendor_id });\r\n        let logoUrl = null;\r\n        if (req.files) {\r\n            logoUrl = await uploadFile(req.files.brandLogo);\r\n        } else {\r\n            logoUrl = brandLogo;\r\n        }\r\n        let brandData = {\r\n            brand_name: brand_name,\r\n            vendor_id: vendor,\r\n            brandLogo: logoUrl,\r\n        };\r\n\r\n        let newBrand = await brandModel.create(brandData);\r\n        vendor.brand_id.push(newBrand);\r\n        await vendor.save();\r\n\r\n        return res.status(201).send({ status: true, message: \"success\", data: newBrand });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL BRANDS\r\nconst getAllBrands = async (req, res) => {\r\n    try {\r\n        let brands = null;\r\n        if (req.userModel === \"VENDOR\") {\r\n            brands = await brandModel.find({ isDeleted: false, vendor_id: req.userId }).populate(\"vendor_id\");\r\n        } else {\r\n            brands = await brandModel.find({ isDeleted: false }).populate(\"vendor_id\");\r\n        }\r\n        return res.status(200).send({ status: true, data: brands });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllBrandByVendor = async (req, res) => {\r\n    try {\r\n        if (req.userModel === \"VENDOR\") {\r\n            let vendor = await vendorModel.findOne({ vendor_unique_id: req.params.vendorId }).populate(\"brand_id\");\r\n            if (!vendor) {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Vendor Not Found\",\r\n                });\r\n            }\r\n            return res.status(200).send({ status: true, data: vendor.brand_id });\r\n        } else {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Bad Request\",\r\n            });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst verifyBrandById = async (req, res) => {\r\n    try {\r\n        let brandId = req.params.brandId;\r\n        let brandStatus = req.body.brandStatus;\r\n        if (req.userModel === \"Super Admin\" || req.userModel === \"ADMIN\") {\r\n            let brand = await brandModel.findById(brandId);\r\n            if (!brand) {\r\n                return res.status(400).send({ status: false, data: \"Bad request\" });\r\n            }\r\n            brand.brandStatus = brandStatus;\r\n            await brand.save();\r\n            return res.status(202).send({ status: true, data: \"Brand status change successfully\" });\r\n        } else {\r\n            return res.status(400).send({ status: false, data: \"Bad request\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { addBrand, getAllBrands, getAllBrandByVendor, verifyBrandById };\r\n","const businessModel = require(\"../models/businessModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst { uploadFile, uploadImage } = require(\"./imageController\");\r\nconst bannerModel = require(\"../models/bannerModel\");\r\n\r\n// ADD BUSINESS DETAILS\r\nconst addBusinessInfo = async (req, res) => {\r\n    try {\r\n        let { bName, bEmail, bNumber } = req.body;\r\n\r\n        if (!bName || !bEmail || !bNumber) {\r\n            return res.status(400).send({ status: false, message: \"All fields are required\" });\r\n        }\r\n\r\n        let businessData = {\r\n            business_name: bName,\r\n            contactNo: bNumber,\r\n            contactEmail: bEmail,\r\n        };\r\n        console.log(businessData);\r\n        let businessExists = await businessModel.find();\r\n        console.log(businessExists);\r\n        if (businessExists.length > 0) {\r\n            businessExists[0].business_name = bName;\r\n            businessExists[0].contactNo = bNumber;\r\n            businessExists[0].contactEmail = bEmail;\r\n            await businessExists[0].save();\r\n        } else {\r\n            await businessModel.create(businessData);\r\n        }\r\n        return res.status(201).send({ status: true, message: \"Success\", data: \"business\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst addBusinessGST = async (req, res) => {\r\n    try {\r\n        let { gsts } = req.body;\r\n        if (!gsts || gsts.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"Add GST\" });\r\n        }\r\n\r\n        let businessExists = await businessModel.find();\r\n        if (businessExists.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"Add business Name and other fields then add GST\" });\r\n        }\r\n        businessExists[0].gsts = gsts;\r\n        businessExists[0].defaultGST = {};\r\n        await businessExists[0].save();\r\n        return res.status(201).send({ status: true, message: \"GST updated to business\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst addBusinessFiles = async (req, res) => {\r\n    try {\r\n        let { bLogo, bInvLogo, bPolicy, bTC } = req.files;\r\n        let business = await businessModel.find();\r\n        if (bLogo) {\r\n            business[0].business_Logo = await uploadFile(bLogo);\r\n        }\r\n        if (bInvLogo) {\r\n            business[0].invoiceLogo = await uploadFile(bInvLogo);\r\n        }\r\n        if (bPolicy) {\r\n            business[0].privacyPolicy = await uploadFile(bPolicy);\r\n        }\r\n        if (bTC) {\r\n            business[0].iAgree = await uploadFile(bTC);\r\n        }\r\n        await business[0].save();\r\n        return res.status(201).send({ status: true, message: \"Success\", data: \"business\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getBusinessInfo = async (req, res) => {\r\n    try {\r\n        let business = await businessModel.find();\r\n        if (business.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"No record available\" });\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Record fetched...\", data: business[0] });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst setDefaultGst = async (req, res) => {\r\n    try {\r\n        let { gst } = req.body;\r\n        let business = await businessModel.find();\r\n        if (business.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"No record available\" });\r\n        }\r\n\r\n        for (let gstd of business[0].gsts) {\r\n            console.log(gstd);\r\n            if (gstd.gstNo === gst) {\r\n                business[0].defaultGST.gstNo = gstd.gstNo;\r\n                business[0].defaultGST.pickupAddress = gstd.pickupAddress;\r\n                business[0].defaultGST.stateCode = gstd.stateCode;\r\n            }\r\n        }\r\n        await business[0].save();\r\n        console.log(req.body);\r\n        return res.status(200).send({ status: true, message: \"Default gst updated...\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst saveSocialMedia = async (req, res) => {\r\n    try {\r\n        let { facebook, instagram, twitter, youtube, linkedin } = req.body;\r\n        let business = await businessModel.find();\r\n        if (business.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"No record available\" });\r\n        }\r\n        if (facebook) {\r\n            business[0].socialMedia.facebook = facebook;\r\n        }\r\n        if (instagram) {\r\n            business[0].socialMedia.instagram = instagram;\r\n        }\r\n        if (twitter) {\r\n            business[0].socialMedia.twitter = twitter;\r\n        }\r\n        if (youtube) {\r\n            business[0].socialMedia.youtube = youtube;\r\n        }\r\n        if (linkedin) {\r\n            business[0].socialMedia.linkedin = linkedin;\r\n        }\r\n        await business[0].save();\r\n        return res.status(200).send({ status: true, message: \"Social media links added\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst bannerForClientPage = async (req, res) => {\r\n    try {\r\n        let { images } = req.files;\r\n        let { type } = req.body;\r\n        if (images && type) {\r\n            if (type === \"MULTIPLE\") {\r\n                for await (let x of images) {\r\n                    let url = (await uploadImage(x)).imageURL;\r\n                    await bannerModel.create({ bannerUrl: url, type: \"MULTIPLE\" });\r\n                }\r\n            } else if (type === \"SINGLE\") {\r\n                let url = (await uploadImage(images)).imageURL;\r\n                await bannerModel.create({ bannerUrl: url, type: \"SINGLE\" });\r\n            }\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Banner added\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getBannerForClientPage = async (req, res) => {\r\n    try {\r\n        let data = await bannerModel.find();\r\n        return res.status(200).send({ status: true, data: data, message: \"Banner Images fetched\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst bannerDeleteById = async (req, res) => {\r\n    try {\r\n        let bannerId = req.params.bannerId;\r\n        await bannerModel.findByIdAndDelete(bannerId);\r\n        return res.status(200).send({ status: true, message: \"Banner deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addBusinessInfo,\r\n    addBusinessGST,\r\n    getBusinessInfo,\r\n    addBusinessFiles,\r\n    setDefaultGst,\r\n    saveSocialMedia,\r\n    bannerForClientPage,\r\n    getBannerForClientPage,\r\n    bannerDeleteById\r\n};\r\n","const cancelledReasonModel = require(\"../models/cancelledReasonModel\");\r\nconst questionModel = require(\"../models/questionModel\");\r\nconst orderModel = require(\"../models/orderModel\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\n\r\n// CANCEL ORDER BY ORDER ID\r\nconst addCancelledReason = async (req, res) => {\r\n  try {\r\n    \r\n    let data = req.body;\r\n\r\n    let { questions, customerAnswer } = data;\r\n\r\n    let cancelledReasonData = {\r\n      questions,\r\n      customerAnswer,\r\n    };\r\n\r\n    let newCancelledReason = await cancelledReasonModel.create(\r\n      cancelledReasonData\r\n    );\r\n\r\n    return res\r\n      .status(201)\r\n      .send({ status: true, message: \"Success\", data: newCancelledReason });\r\n  } catch (error) {\r\n    return res.status(500).send({ status: false, message: error.message });\r\n  }\r\n};\r\n\r\nmodule.exports = { addCancelledReason }","const { isValidObjectId } = require(\"mongoose\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst colorModel = require(\"../models/colorModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\n\r\n// ADD TO CART\r\nconst addToCart = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let { product_id, qty, lotSize, colorId } = req.body;\r\n        // Find the cart for the customer\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer ID\" });\r\n        }\r\n        if (!isValidObjectId(colorId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Color ID\" });\r\n        }\r\n        let cart = await cartModel.findOne({ customer_id: customerId });\r\n        let customer = await customerModel.findById(customerId);\r\n        let color = await colorModel.findById(colorId);\r\n\r\n        let isProductExists = await productModel.findOne({\r\n            _id: product_id,\r\n            status: \"Approved\",\r\n        });\r\n\r\n        if (!isProductExists) {\r\n            return res.status(404).send({ status: false, message: \"Product not found\" });\r\n        }\r\n\r\n        let data = {\r\n            product_id: product_id,\r\n            qty: Number(qty),\r\n            lotSize: lotSize,\r\n            color: {\r\n                colorName: color.colorName,\r\n                colorHex: color.colorHex,\r\n            },\r\n        };\r\n        if (!cart) {\r\n            return res.status(400).send({ status: false, message: \"Server Error\" });\r\n        } else {\r\n            data.addedAt = new Date().toLocaleString();\r\n            cart.products.push(data);\r\n        }\r\n        await cart.save();\r\n\r\n        let dataX = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n            cartLength: cart.products.length,\r\n        };\r\n\r\n        res.status(201).send({ status: true, message: \"Cart updated successfully\", data: dataX });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst priceCal = (price, margin, gst) => {\r\n    let marginAmt = Number(price) + (Number(price) * Number(margin)) / 100;\r\n    let gstAmt = (Number(marginAmt) * Number(gst)) / 100;\r\n    return (gstAmt + marginAmt).toFixed(2);\r\n};\r\nconst totalPriceCalc = (products) => {\r\n    let totalPrice = 0;\r\n    products.forEach((element) => {\r\n        let { seller_price, margin, sellingGST } = element.product_id;\r\n        totalPrice += Number(element.qty) * Number(priceCal(seller_price, margin, sellingGST));\r\n    });\r\n    return totalPrice.toFixed(2);\r\n};\r\n\r\nconst qtyIncreaseDecrease = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let index = req.params.index;\r\n        let qty = req.params.qty;\r\n        let cart = await cartModel.findOne({ customer_id: customerId }).populate(\"products.product_id\");\r\n        if (!cart) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        if (cart.products.length > 0) {\r\n            cart.products[index].qty = qty;\r\n            let cartAmt_current = totalPriceCalc(cart.products);\r\n            console.log(cartAmt_current);\r\n            if (cart.currentCoupon && cartAmt_current < cart.currentCoupon.minOrderAmt) {\r\n                console.log(\"hell\");\r\n                cart.currentCoupon = undefined;\r\n            }\r\n            await cart.save();\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        return res.status(201).json({ message: \"Quantity updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst removeFromCart = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let index = req.params.index;\r\n        let cart = await cartModel.findOne({ customer_id: customerId });\r\n\r\n        if (!cart) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (cart.products.length > 0) {\r\n            let arr = cart.products;\r\n            arr.splice(index, 1);\r\n            cart.products = arr;\r\n            await cart.save();\r\n        }\r\n        res.status(201).json({ message: \"Product removed successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL CARTS\r\nconst getAllAbandentCarts = async (req, res) => {\r\n    try {\r\n        let carts = await cartModel.find({ products: { $gte: [{ $size: 0 }] } }).populate([\"customer_id\", { path: \"products.product_id\", model: \"Product\" }]);\r\n        return res.status(200).send({ status: true, data: carts });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET CART BY CUSTOMER ID\r\nconst getCartByCustomerId = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let cart = await cartModel.findOne({ customer_id: customerId }).populate({ path: \"products.product_id\", model: \"Product\", populate: { path: \"brandId\", model: \"Brand\" } });\r\n\r\n        if (!cart) {\r\n            return res.status(404).send({ status: false, message: \"No cart found with this customer\" });\r\n        }\r\n        let customer = await customerModel.findById(customerId);\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n            cartLength: cart.products.length,\r\n        };\r\n        return res.status(200).send({ status: true, data: cart, customerData: data });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addToCart,\r\n    getAllAbandentCarts,\r\n    getCartByCustomerId,\r\n    removeFromCart,\r\n    qtyIncreaseDecrease,\r\n};\r\n","const categoryModel = require(\"../models/categoryModel\");\r\nconst subcategoryModel = require(\"../models/subcategoryModel\");\r\nconst productModel = require(\"../models/productModel\");\r\n\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\n\r\n// ADD CATEGORY\r\nconst addCategory = async (req, res) => {\r\n   try {\r\n      let data = req.body;\r\n      let { category_name, subCategory } = data;\r\n\r\n      if (!isValid(category_name)) {\r\n         return res\r\n            .status(400)\r\n            .send({ status: false, message: \"category is required\" });\r\n      }\r\n\r\n      let category = await categoryModel.findOne({\r\n         category_name: category_name,\r\n      });\r\n\r\n      if (category) {\r\n         return res.status(400).send({\r\n            status: false,\r\n            message:\r\n               \"This category is already exists, please enter a new category\",\r\n         });\r\n      }\r\n      let subCategories = await subcategoryModel.insertMany(subCategory);\r\n\r\n      let categoryData = {\r\n         category_name: category_name,\r\n         sub_category: subCategories,\r\n      };\r\n\r\n      let newCategory = await categoryModel.create(categoryData);\r\n\r\n      return res\r\n         .status(201)\r\n         .send({ status: true, message: \"success\", data: newCategory });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\n// GET ALL CATEGORIES\r\nconst getAllCategories = async (req, res) => {\r\n   try {\r\n      let categories = await categoryModel\r\n         .find({ isDeleted: false })\r\n         .populate(\"sub_category\");\r\n      return res.status(200).send({ status: true, data: categories });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\n// GET CATEGORY BY CATEGORY ID\r\nconst getCategoryById = async (req, res) => {\r\n   try {\r\n      let categoryId = req.params.categoryId;\r\n      if (!isValidObjectId(categoryId)) {\r\n         return res\r\n            .status(400)\r\n            .send({ status: false, message: \"Invalid categoryId\" });\r\n      }\r\n\r\n      let category = await categoryModel.findOne({\r\n         _id: categoryId,\r\n         isDeleted: false,\r\n      });\r\n\r\n      if (!category) {\r\n         return res\r\n            .status(404)\r\n            .send({ status: false, message: \"Category not found\" });\r\n      }\r\n\r\n      return res\r\n         .status(200)\r\n         .send({ status: true, message: \"success\", data: category });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\n// UPDATE CATEGORY BY CATEGORY ID\r\nconst updateCategoryById = async (req, res) => {\r\n   try {\r\n      let categoryId = req.params.categoryId;\r\n\r\n      if (!isValidObjectId(categoryId)) {\r\n         return res\r\n            .status(400)\r\n            .send({ status: false, message: \"invalid category id\" });\r\n      }\r\n\r\n      let category = await categoryModel\r\n         .findOne({ _id: categoryId })\r\n         .populate(\"sub_category\");\r\n\r\n      if (!category) {\r\n         return res\r\n            .status(404)\r\n            .send({ status: false, message: \"Category not found\" });\r\n      }\r\n      let { category_name, subCategory } = req.body;\r\n\r\n      console.log(subCategory, \"sub category1\");\r\n      console.log(category.sub_category, \"sub category2\");\r\n      category.sub_category.forEach(async (el) => {\r\n         let isFound = false;\r\n         subCategory.forEach((innerEl) => {\r\n            if (innerEl.hasOwnProperty(\"_id\")) {\r\n               if (innerEl._id === el._id.toHexString()) {\r\n                  isFound = true;\r\n               }\r\n            }\r\n         });\r\n         if (!isFound) {\r\n            console.log(el._id);\r\n            await subcategoryModel.findOneAndUpdate(\r\n               { _id: el._id, isDeleted: false },\r\n               { isDeleted: true, deletedAt: Date.now() },\r\n               { new: true }\r\n            );\r\n         }\r\n      });\r\n      let subCategoryCreated = [];\r\n      for (const objs of subCategory) {\r\n         if (!objs.hasOwnProperty(\"_id\")) {\r\n            let xId = await subcategoryModel.create(objs);\r\n            subCategoryCreated.push(xId);\r\n         } else {\r\n            subCategoryCreated.push(objs);\r\n         }\r\n      }\r\n\r\n      category.category_name = category_name;\r\n      category.sub_category = subCategoryCreated;\r\n\r\n      console.log(subCategoryCreated, \"crate arr\");\r\n      await category.save();\r\n      return res\r\n         .status(200)\r\n         .send({\r\n            status: true,\r\n            message: \"success\",\r\n            data: \"Category updated successfully\",\r\n         });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\n// DELETE CATEGORY BY CATEGORY ID\r\nconst deleteCategoryById = async (req, res) => {\r\n   try {\r\n      let categoryId = req.params.categoryId;\r\n      if (!isValidObjectId(categoryId)) {\r\n         return res\r\n            .status(400)\r\n            .send({ status: false, message: \"Invalid category id\" });\r\n      }\r\n\r\n      let category = await categoryModel.findOne({ _id: categoryId });\r\n\r\n      if (!category) {\r\n         return res\r\n            .status(404)\r\n            .send({ status: false, message: \"Category not found\" });\r\n      }\r\n\r\n      let deleteCategory = await categoryModel.findOneAndUpdate(\r\n         {\r\n            _id: categoryId,\r\n            isDeleted: false,\r\n         },\r\n         {\r\n            isDeleted: true,\r\n            deletedAt: new Date(),\r\n         },\r\n         { new: true }\r\n      );\r\n\r\n      if (!deleteCategory) {\r\n         return res.status(404).send({\r\n            status: false,\r\n            message: \"category not found or already deletec\",\r\n         });\r\n      }\r\n\r\n      return res.status(200).send({ status: true, message: \"success\" });\r\n   } catch (error) {\r\n      return res.status(500).send({ status: false, message: error.message });\r\n   }\r\n};\r\n\r\nmodule.exports = {\r\n   addCategory,\r\n   getAllCategories,\r\n   getCategoryById,\r\n   updateCategoryById,\r\n   deleteCategoryById,\r\n};\r\n","const colorModel = require('../models/colorModel');\r\nconst addNewColor = async (req, res) => {\r\n    try {\r\n        let {colorName, colorHex} = req.body;\r\n        if (colorName === \"\") {\r\n            return res\r\n                .status(400)\r\n                .send({message: \"Color Name is required\", status: false});\r\n        }\r\n        if (colorHex === \"\") {\r\n            return res\r\n                .status(400)\r\n                .send({message: \"Color Hex is required\", status: false});\r\n        }\r\n\r\n        let colors = await colorModel.find({\r\n            $or: [{colorName: colorName}, {colorHex: colorHex}],\r\n        });\r\n\r\n        if(colors.length > 0) {\r\n            return res.status(400).send({\r\n                message: \"This color is already exists\",\r\n                status: false,\r\n            });\r\n        }\r\n        await colorModel.create({colorName: colorName, colorHex: colorHex});\r\n        return res.status(201).send({status: true, message: 'Color added successfully'});\r\n    } catch (error) {\r\n        return res.status(500).send({status: false, message: error.message});\r\n    }\r\n}\r\n\r\nconst deleteColorById = async (req, res) => {\r\n    try {\r\n        let colorId = req.params.colorId;\r\n        let color = await colorModel.findById(colorId);\r\n        if (!color) {\r\n            return res.status(400).send({status: false, message: \"Bad Request\"});\r\n        }\r\n        color.isDeleted = true;\r\n        await color.save();\r\n        return res.status(202).send({status: true, message: 'Color deleted successfully'});\r\n    } catch (error) {\r\n        return res.status(500).send({status: false, message: error.message});\r\n    }\r\n}\r\n\r\nconst getAllColor = async (req, res) => {\r\n    try {\r\n        let colors = await colorModel.find({isDeleted:false});\r\n        return res.status(200).send({status: true, message: 'Color fetched successfully', data: colors});\r\n    } catch (error) {\r\n        return res.status(500).send({status: false, message: error.message});\r\n    }\r\n}\r\n\r\nmodule.exports = {addNewColor, deleteColorById, getAllColor}","const couponCodeModel = require(\"../models/couponCodeModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\nconst { isExpiryCoupon } = require(\"../utils/couponExpireUtil\");\r\n\r\n// const isExpiryCoupon = (validTill) => {\r\n//     let day = validTill.getDate();\r\n//     let month = validTill.getMonth() + 1;\r\n//     let year = validTill.getFullYear();\r\n//     let expiryDateMS = new Date(`${year}-${month < 10 ? \"0\" + month : month}-${day < 10 ? \"0\" + day : day}`).getTime() / 1000;\r\n\r\n//     let now = Date.now();\r\n//     // let date = new Date(now + (5.5 * (3600 * 1000))); // Deployment time cases for +5:30 GMT\r\n//     let date = new Date();\r\n//     let dateStr = `${date.getFullYear()}-${date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1) : date.getMonth() + 1}-${date.getDate() < 10 ? \"0\" + date.getDate() : date.getDate()}`;\r\n//     let currentDateMS = new Date(dateStr).getTime() / 1000;\r\n\r\n//     return currentDateMS <= expiryDateMS ? false : true;\r\n// };\r\n\r\nconst generateCoupon = async (req, res) => {\r\n    try {\r\n        let { couponCode, validTill, maxUsers, maxDiscPrice, discountType, discountAmt, minOrderAmt } = req.body;\r\n        if (!couponCode || couponCode === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Coupon code required\" });\r\n        }\r\n        if (!validTill || validTill === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Coupon expiry date required\" });\r\n        }\r\n        if (!maxUsers || Number(maxUsers) === 0) {\r\n            return res.status(400).send({ status: false, message: \"Coupon uses limit is required\" });\r\n        }\r\n\r\n        if (!discountAmt || Number(discountAmt) === 0) {\r\n            return res.status(400).send({ status: false, message: \"Coupon discount amount is required\" });\r\n        }\r\n        if (!discountType || discountType === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Coupon discount type is required\" });\r\n        }\r\n        if (!minOrderAmt || minOrderAmt === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Minimum order is required\" });\r\n        }\r\n        if (discountType === \"Percentage\") {\r\n            if (!maxDiscPrice || Number(maxDiscPrice) === 0) {\r\n                return res.status(400).send({ status: false, message: \"Coupon Maximum discount price is required\" });\r\n            }\r\n        }\r\n        let coupon = await couponCodeModel.findOne({ couponCode: couponCode, isDeleted: false });\r\n        if (coupon) {\r\n            return res.status(200).send({ status: false, message: \"This coupon code is already created\" });\r\n        }\r\n        let newDate = new Date(validTill);\r\n        let createData = {\r\n            couponCode,\r\n            validTill: newDate,\r\n            maxUsers,\r\n            maxDiscPrice,\r\n            discountType,\r\n            discountAmt,\r\n            minOrderAmt,\r\n        };\r\n        if (discountType === \"PRICE\") {\r\n            createData.maxDiscPrice = discountAmt;\r\n        }\r\n        let createdCoupon = await couponCodeModel.create(createData);\r\n        res.status(201).send({ status: true, message: \"Coupon created successfully...\", data: createdCoupon });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst applyCoupon = async (req, res) => {\r\n    try {\r\n        let customer_id = req.params.customerid;\r\n        let { couponCode, orderAmount } = req.body;\r\n        if (!couponCode || couponCode === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Coupon id required\" });\r\n        }\r\n        if (!orderAmount || orderAmount === \"\") {\r\n            return res.status(400).send({ status: false, message: \"Order Amount required\" });\r\n        }\r\n        if (!isValidObjectId(customer_id)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Request\" });\r\n        }\r\n        let customer = await customerModel.findById(customer_id).populate(\"cart_id\");\r\n        if (!customer) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let coupon = await couponCodeModel.findOne({ couponCode: couponCode, isDeleted: false });\r\n        if (!coupon) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Coupon Code\" });\r\n        }\r\n        if (coupon.isExpired) {\r\n            return res.status(200).send({ status: false, message: \"Coupon code expired\" });\r\n        }\r\n        if (coupon.isUsed) {\r\n            return res.status(200).send({ status: false, message: \"Coupon code uses has exceed to its maximum limit\" });\r\n        }\r\n        if (coupon.minOrderAmt > orderAmount) {\r\n            return res.status(200).send({ status: false, message: `This coupon is applicable for Minimum order amount ${coupon.minOrderAmt}` });\r\n        }\r\n\r\n        let day = coupon.validTill.getDate();\r\n        let month = coupon.validTill.getMonth() + 1;\r\n        let year = coupon.validTill.getFullYear();\r\n        let expiryDateMS = new Date(`${year}-${month < 10 ? \"0\" + month : month}-${day < 10 ? \"0\" + day : day}`).getTime() / 1000;\r\n\r\n        let now = Date.now();\r\n        // let date = new Date(now + (5.5 * (3600 * 1000))); // Deployment time cases for +5:30 GMT\r\n        let date = new Date();\r\n        let dateStr = `${date.getFullYear()}-${date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1) : date.getMonth() + 1}-${date.getDate() < 10 ? \"0\" + date.getDate() : date.getDate()}`;\r\n        let currentDateMS = new Date(dateStr).getTime() / 1000;\r\n\r\n        if (currentDateMS <= expiryDateMS) {\r\n            if (coupon.customer_id.includes(customer_id)) {\r\n                return res.status(200).send({ status: false, message: \"Coupon Already applied\" });\r\n            } else {\r\n                if (coupon.customer_id.length >= coupon.maxUsers && coupon.isUsed === false) {\r\n                    coupon.isUsed = true;\r\n                    await coupon.save();\r\n                    return res.status(200).send({ status: false, message: \"Coupon code uses has exceed to its maximum limit\" });\r\n                }\r\n\r\n                // coupon.customer_id.push(customer_id);\r\n                // if (coupon.customer_id.length === coupon.maxUsers) {\r\n                //     coupon.isUsed = true;\r\n                // }\r\n                // await coupon.save();\r\n                // let couponData = {\r\n                //     couponCode: coupon.couponCode,\r\n                //     minOrderAmt: coupon.minOrderAmt,\r\n                //     discountAmt: coupon.discountAmt,\r\n                // };\r\n                // customer.cart_id.currentCoupon = couponData;\r\n                // await customer.cart_id.save();\r\n                return res.status(202).send({\r\n                    status: true,\r\n                    data: coupon.discountAmt,\r\n                    message: \"Coupon applied successfully...\",\r\n                });\r\n            }\r\n        } else {\r\n            coupon.isExpired = true;\r\n            await coupon.save();\r\n            return res.status(200).send({ status: false, message: \"Coupon code expired\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllCoupons = async (req, res) => {\r\n    try {\r\n        let coupons = await couponCodeModel.find({ isDeleted: false }).sort({ createdAt: -1 }).populate(\"customer_id\");\r\n        for (let coupon of coupons) {\r\n            if (!coupon.isExpired) {\r\n                if (isExpiryCoupon(coupon.validTill)) {\r\n                    coupon.isExpired = true;\r\n                    await coupon.save();\r\n                }\r\n            }\r\n        }\r\n        res.status(200).send({ status: true, message: \"All Coupons fetched successfully...\", data: coupons });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst deleteCoupon = async (req, res) => {\r\n    try {\r\n        let couponId = req.params.couponid;\r\n        let coupon = await couponCodeModel.findById(couponId);\r\n        if (!coupon) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        coupon.isDeleted = true;\r\n        await coupon.save();\r\n        return res.status(202).send({ status: true, message: \"Coupon deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { generateCoupon, applyCoupon, getAllCoupons, deleteCoupon };\r\n","const { isValidObjectId } = require(\"mongoose\");\r\nconst customerAddressModel = require(\"../models/customerAddressModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst { isValidRequestBody, isValid } = require(\"../utils/utils\");\r\nconst { stateAndCode } = require(\"../utils/stateNameAndCode\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst bcrypt = require(\"bcrypt\");\r\n// ADD ADDRESS\r\nconst addCustomerInformation = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let customerId = req.params.customerid;\r\n        let { name, alternate_phone, gstNo, email, pincode, password, address, state, city } = data;\r\n\r\n        if (!isValid(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (!state || !name || !pincode || !city || !password || !address) {\r\n            return res.status(400).send({ status: false, message: \"Please provide all required fields\" });\r\n        }\r\n        let addressData = {\r\n            customerId,\r\n            address,\r\n            state,\r\n            pincode,\r\n            city,\r\n        };\r\n        if (Object.keys(stateAndCode).includes(state)) {\r\n            addressData.stateCode = stateAndCode[state];\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"Invalid State\" });\r\n        }\r\n\r\n        let customer = await customerModel.findOne({ _id: customerId, isDeleted: false, isBlocked: false });\r\n        if (!customer) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        let hashedPassword = await bcrypt.hash(password, 10);\r\n        customer.name = name;\r\n        customer.password = hashedPassword;\r\n        if (gstNo) {\r\n            customer.gstNo = gstNo;\r\n        }\r\n        if (alternate_phone) {\r\n            customer.alternate_phone = alternate_phone;\r\n        }\r\n        if (email) {\r\n            customer.email = email;\r\n        }\r\n\r\n        if (customer.isActivated === true) {\r\n            return res.status(400).send({ status: false, message: \"Account is already active\" });\r\n        }\r\n\r\n        let cart = await cartModel.create({ customer_id: customer._id });\r\n        if (!cart) {\r\n            return res.status(500).send({ status: false, message: \"Internal Server Error\" });\r\n        }\r\n        customer.cart_id = cart;\r\n        customer.isActivated = true;\r\n        addressData.customerId = customer;\r\n        let newAddress = await customerAddressModel.create(addressData);\r\n        customer.defaultAddress = newAddress._id;\r\n        await customer.save();\r\n        return res.status(201).send({ status: true, message: \"Successfully registered\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL ADDRESSES BY CUSTOMER ID\r\nconst getAllAddresses = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        if (!customerId) {\r\n            return res.status(400).send({ status: false, message: \"Customer id is required in params\" });\r\n        }\r\n        let address = await customerAddressModel.find({ customerId: customerId, isDeleted: false });\r\n        return res.status(200).send({ status: true, data: address });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE ADDRESS BY CUSTOMER ID\r\nconst updateAddressByCustomerId = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        if (!customerId) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Please provide the customerId in params\",\r\n            });\r\n        }\r\n        let customer = await customerAddressModel.findOne({\r\n            customerId: customerId,\r\n        });\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n\r\n        let body = req.body;\r\n\r\n        if (!isValidRequestBody(body)) {\r\n            return res.status(400).send({ status: false, message: \"Please enter data in body\" });\r\n        }\r\n\r\n        if (\"address\" in body) {\r\n            for (let i = 0; i < customer.address.length; i++) {\r\n                customer.address[i] = body.address[i];\r\n            }\r\n        }\r\n        await customer.save();\r\n\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Address updated successfully\",\r\n            data: customer,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// DELETE CUSTOMER ADDRESS BY CUSTOMER ID\r\nconst deleteAddressById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let addressId = req.params.addressId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        if (!isValidObjectId(addressId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid address id\" });\r\n        }\r\n        let address = await customerAddressModel.findById(addressId);\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"customer not found with this id\" });\r\n        }\r\n        if (!address) {\r\n            return res.status(404).send({ status: false, message: \"address not found with this id\" });\r\n        }\r\n        address.isDeleted = true;\r\n        await address.save();\r\n        if (customer.defaultAddress.toString() === addressId) {\r\n            customer.defaultAddress = undefined;\r\n            customer.save();\r\n        }\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n        };\r\n        if (customer.profileUrl) data.photo = customer.profileUrl;\r\n        if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n        if (customer.gstNo) data.gstNo = customer.gstNo;\r\n        if (customer.defaultAddress) data.defaultAddressId = customer.defaultAddress._id.toString();\r\n        return res.status(200).send({ status: true, data: data, message: \"Address deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst addAddress = async (req, res) => {\r\n    try {\r\n        let { address, state, city, pincode, stateCode } = req.body;\r\n        let customerId = req.params.customerId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (!address || !state || !city || !pincode || !stateCode) {\r\n            return res.status(400).send({ status: false, message: \"All fields are requited\" });\r\n        }\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!customer) {\r\n            return res.status(400).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        let addressObj = await customerAddressModel.create({ customerId, address, state, city, pincode, stateCode });\r\n\r\n        return res.status(201).send({ status: true, message: \"Address created\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nmodule.exports = {\r\n    addCustomerInformation,\r\n    getAllAddresses,\r\n    updateAddressByCustomerId,\r\n    deleteAddressById,\r\n    addAddress,\r\n};\r\n","const customerModel = require(\"../models/customerModel\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst { isValid, isValidMoblie, isValidEmail, isValidPassword } = require(\"../utils/utils\");\r\nconst { customerTokenSecretKey } = require(\"../middlewares/config\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\nconst customerAddressModel = require(\"../models/customerAddressModel\");\r\nconst wishlistModel = require(\"../models/wishlistModel\");\r\n\r\nconst loginUser = async (req, res) => {\r\n    try {\r\n        let { phone, password } = req.body;\r\n\r\n        if (!phone || !password) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        let customer = await customerModel.findOne({ phone: phone, isDeleted: false }).populate(\"cart_id\");\r\n\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Account not found this mobile number, you have to register first\" });\r\n        }\r\n        let wishlist = await wishlistModel.find({ userId: customer._id });\r\n        if (customer.isBlocked) {\r\n            return res.status(403).send({ status: false, message: \"This account has been blocked, Please Contact us!\" });\r\n        }\r\n        // if (!customer.isActivated) {\r\n        //     return res.status(200).send({ status: true, message: \"Account is not active, Please fill your information\" });\r\n        // }\r\n        bcrypt.compare(password, customer.password, function (err, result) {\r\n            if (err) {\r\n                return res.status(400).send({ status: false, message: err.message });\r\n            }\r\n            hasAccess(result);\r\n        });\r\n\r\n        function hasAccess(result) {\r\n            if (result) {\r\n                let date = Date.now();\r\n                let data = {\r\n                    name: customer.name,\r\n                    email: customer.email,\r\n                    customerId: customer._id.toString(),\r\n                    userType: \"CUSTOMER\",\r\n                    isActivated: customer.isActivated,\r\n                    phone: customer.phone,\r\n                    cartLength: customer.cart_id.products.length,\r\n                    wishlistLength: wishlist.length,\r\n                };\r\n                if (customer.profileUrl) data.photo = customer.profileUrl;\r\n                if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n                if (customer.gstNo) data.gstNo = customer.gstNo;\r\n                if (customer.defaultAddress) data.defaultAddressId = customer.defaultAddress._id.toString();\r\n                let issueTime = Math.floor(date / 1000);\r\n                let token = jwt.sign(\r\n                    {\r\n                        userId: customer._id.toString(),\r\n                        phone: customer.phone,\r\n                        userModel: \"CUSTOMER\",\r\n                        iat: issueTime,\r\n                    },\r\n                    customerTokenSecretKey,\r\n                    { expiresIn: \"24h\" }\r\n                );\r\n                data.token = token;\r\n                res.setHeader(\"Authorization\", \"Bearer \" + token);\r\n                return res.status(200).send({\r\n                    status: true,\r\n                    message: \"Login successfully\",\r\n                    data: data,\r\n                });\r\n            } else {\r\n                return res.status(401).send({ status: false, message: \"Login denied\" });\r\n            }\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL CUSTOMERS\r\nconst getAllCustomer = async (req, res) => {\r\n    try {\r\n        let customers = await customerModel.find({ isDeleted: false }).populate(\"defaultAddress\");\r\n        return res.status(200).send({ status: true, data: customers });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET CUSTOMER BY CUSTOMER ID\r\nconst getCustomerById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let customer = await customerModel.findOne({ _id: customerId });\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        return res.status(200).send({ status: true, data: customer });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE CUSTOMER BY CUSTOMER ID\r\nconst updateCustomerById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        let { name, gstNo, alternate_phone, email, password } = req.body;\r\n        if (!name && !gstNo && alternate_phone && email && password) {\r\n            return res.status(400).send({ status: false, message: \"At least one field is require to update your information\" });\r\n        }\r\n        if (name) {\r\n            customer.name = name;\r\n        }\r\n        if (gstNo) {\r\n            customer.gstNo = gstNo;\r\n        }\r\n        if (alternate_phone) {\r\n            customer.alternate_phone = alternate_phone;\r\n        }\r\n        if (email) {\r\n            customer.email = email.toLowerCase();\r\n        }\r\n        if (password) {\r\n            let hashedPassword = await bcrypt.hash(password, 10);\r\n            customer.password = hashedPassword;\r\n        }\r\n        await customer.save();\r\n\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n        };\r\n        if (customer.profileUrl) data.photo = customer.profileUrl;\r\n        if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n        if (customer.gstNo) data.gstNo = customer.gstNo;\r\n        if (customer.defaultAddress) data.defaultAddressId = customer.defaultAddress._id.toString();\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Customer updated successfully\",\r\n            data: data,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// DELETE CUSTOMER BY CUSTOMER ID\r\nconst deleteCustomerById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let customer = await customerModel.findOne({ _id: customerId });\r\n\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        customer.isDeleted = true;\r\n        // customer.isNew = true;\r\n        await customer.save();\r\n        return res.status(200).send({ status: true, message: \"Customer deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst blockCustomerById = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let customer = await customerModel.findOne({ _id: customerId });\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        customer.isBlocked = !customer.isBlocked;\r\n        await customer.save();\r\n        let message = customer.isBlocked ? \"Customer has been blocked\" : \"Customer is now Active\";\r\n        return res.status(202).send({ status: true, message: message });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst findOrdersByPhone = async (req, res) => {\r\n    try {\r\n        let { userPhone } = req.body;\r\n        let customer = await customerModel.findOne({ phone: userPhone }).populate({\r\n            path: \"orders\",\r\n            model: \"Order\",\r\n            populate: [\r\n                { path: \"vendorId\", model: \"Vendor\" },\r\n                { path: \"order_status_id\", model: \"Order_Status_Table\" },\r\n                { path: \"ordered_products\", model: \"Ordered_Product\" },\r\n            ],\r\n        });\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found\" });\r\n        }\r\n        let orders = customer.orders;\r\n        return res.status(200).send({ status: true, message: \"Order fetch successfully\", data: orders });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst setDefaultAddress = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let addressId = req.params.addressId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        if (!isValidObjectId(addressId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid address id\" });\r\n        }\r\n        let address = await customerAddressModel.findById(addressId);\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!address) {\r\n            return res.status(404).send({ status: false, message: \"Address not found with this id\" });\r\n        }\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found with this id\" });\r\n        }\r\n        customer.defaultAddress = address._id;\r\n        await customer.save();\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            customerId: customer._id.toString(),\r\n            userType: \"CUSTOMER\",\r\n            isActivated: customer.isActivated,\r\n            phone: customer.phone,\r\n        };\r\n        if (customer.profileUrl) data.photo = customer.profileUrl;\r\n        if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n        if (customer.gstNo) data.gstNo = customer.gstNo;\r\n        if (customer.defaultAddress) data.defaultAddressId = customer.defaultAddress._id.toString();\r\n        return res.status(200).send({ status: true, data: data, message: \"Default address updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst changePassword = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let { password } = req.body;\r\n        if (!password) {\r\n            return res.status(400).send({ status: false, message: \"Password is required\" });\r\n        }\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        let customer = await customerModel.findById(customerId);\r\n        if (!customer) {\r\n            return res.status(404).send({ status: false, message: \"Customer not found with this id\" });\r\n        }\r\n        let hashedPassword = await bcrypt.hash(password, 10);\r\n        customer.password = hashedPassword;\r\n        await customer.save();\r\n        return res.status(202).send({ status: true, message: \"Password Updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    loginUser,\r\n    getAllCustomer,\r\n    getCustomerById,\r\n    updateCustomerById,\r\n    deleteCustomerById,\r\n    blockCustomerById,\r\n    findOrdersByPhone,\r\n    setDefaultAddress,\r\n    changePassword,\r\n};\r\n","const HomepageModel = require(\"../models/HomepageModel\");\r\nconst businessModel = require(\"../models/businessModel\");\r\nconst categoryModel = require(\"../models/categoryModel\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst colorModel = require(\"../models/colorModel\");\r\nconst getDashboardData = async (req, res) => {\r\n    try {\r\n        let recommendedProduct = await HomepageModel.find().populate([\"featuredProduct\", \"newArrival\", \"bestSelling\"]);\r\n        let storeInfo = await businessModel.find();\r\n        let category = await categoryModel.find().populate(\"sub_category\");\r\n        let color = await colorModel.find();\r\n        storeInfo[0].defaultGST = undefined;\r\n        storeInfo[0].gsts = undefined;\r\n        let data = {\r\n            recommendedProduct: recommendedProduct[0],\r\n            storeInfo: storeInfo[0],\r\n            category,\r\n            color,\r\n        };\r\n        return res.status(200).send({ status: true, message: \"success\", data: data });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getProductBySlug= async (req, res) => {\r\n    try {\r\n        let slug = req.params.slug;\r\n        // console.log(slug);\r\n        let product = await productModel.findOne({slug:slug, isDeleted:false, stockStatus:'In_stock'}).populate([\"color_id\", \"categoryId\",\"brandId\",\"vendor_id\"]);\r\n        // console.log(product);\r\n        if (product) {\r\n            return res.status(200).send({ message: \"product info fetched\", data: product });\r\n        } else {\r\n            return res.status(200).send({ message: \"product info fetched\", data: null });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { getDashboardData,getProductBySlug };\r\n","const excelJs = require(\"exceljs\");\r\nconst csv2json = require(\"csvtojson\");\r\nlet csvToJsonC = require(\"convert-csv-to-json\");\r\nconst request = require(\"request\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst categoryModel = require(\"../models/categoryModel\");\r\nconst colorModel = require(\"../models/colorModel\");\r\nconst { uploadFile } = require(\"./imageController\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst orderModel = require(\"../models/orderModel\");\r\nconst { dateToLocalDateTime } = require(\"../utils/dateUtils\");\r\n\r\nconst checkProductIds = async (req, res, product) => {\r\n    let categoryIds = {};\r\n    let colorIds = {};\r\n    let vednorIdForx = \"\";\r\n    if (req.userModel === \"ADMIN\") {\r\n        let x = await vendorModel.findOne({ vendor_unique_id: product.vendor_id }).populate(\"brand_id\");\r\n        vednorIdForx = x._id;\r\n    }\r\n    if (Object.keys(categoryIds).length === 0) {\r\n        let x = await categoryModel.find();\r\n        for (let x1 of x) {\r\n            categoryIds[x1._id] = x1.sub_category;\r\n        }\r\n    }\r\n    if (Object.keys(colorIds).length === 0) {\r\n        let x = await colorModel.find();\r\n        for (let x1 of x) {\r\n            colorIds[x1._id] = x1._id;\r\n        }\r\n    }\r\n\r\n    if (product.brandId === \"\" || product.color_id === \"\" || product.categoryId === \"\" || product.subCatId === \"\") {\r\n        return {\r\n            status: false,\r\n            message: \"Please Provide All Dependent Ids for brand, color, category and sub category\",\r\n        };\r\n    }\r\n    if (categoryIds[product.categoryId] !== undefined) {\r\n        if (!categoryIds[product.categoryId].includes(product.subCatId)) {\r\n            return { status: false, message: \"Invalid Sub Category Id\" };\r\n        }\r\n    } else {\r\n        return { status: false, message: \"Invalid Category Id\" };\r\n    }\r\n\r\n    if (product.color_id.length > 0) {\r\n        // console.log(colorIds);\r\n        console.log(colorIds, product.color_id);\r\n        for (let x of product.color_id) {\r\n            // console.log(colorIds, x);\r\n            if (x !== \"\" && colorIds[x] === undefined) {\r\n                return { status: false, message: \"Invalid Color Id\" };\r\n            }\r\n        }\r\n    } else {\r\n        return { status: false, message: \"Color id required\" };\r\n    }\r\n    return {\r\n        status: true,\r\n        message: \"Everyhting is ok\",\r\n        vendorId: vednorIdForx,\r\n    };\r\n};\r\n\r\nconst exportIDs = async (req, res) => {\r\n    //req.userModel === 'ADMIN' || 'VENDOR'\r\n    //req.userId\r\n    try {\r\n        var workbook = new excelJs.Workbook();\r\n        var worksheet = workbook.addWorksheet(\"Brand\");\r\n        var worksheet2 = workbook.addWorksheet(\"Category & SubCategory & Colors\");\r\n\r\n        let categories = await categoryModel.find().populate(\"sub_category\");\r\n        let colors = await colorModel.find();\r\n        worksheet2.columns = [\r\n            { header: \"Category ID\", key: \"category_id\" },\r\n            { header: \"Category Name\", key: \"category_name\" },\r\n            { header: \"SubCategory ID\", key: \"subcategory_id\" },\r\n            { header: \"SubCategory Name\", key: \"subcategory_name\" },\r\n        ];\r\n        for (let cat of categories) {\r\n            Object.keys(cat[\"sub_category\"]).forEach((keys) => {\r\n                worksheet2.addRow({\r\n                    category_id: cat[\"_id\"].toString(),\r\n                    category_name: cat[\"category_name\"],\r\n                    subcategory_id: cat[\"sub_category\"][keys]._id.toString(),\r\n                    subcategory_name: cat[\"sub_category\"][keys].subcategory_name,\r\n                });\r\n            });\r\n        }\r\n        if (req.userModel === \"ADMIN\") {\r\n            let vendors = await vendorModel.find({ isActive: \"Active\", status: \"Approved\" }).populate(\"brand_id\");\r\n\r\n            worksheet.columns = [\r\n                { header: \"Vendor ID\", key: \"vendor_unique_id\" },\r\n                { header: \"Firm Name\", key: \"firmName\" },\r\n                { header: \"Brand ID\", key: \"brand_id\" },\r\n                { header: \"Brand Name\", key: \"brand_name\" },\r\n            ];\r\n\r\n            for (let singleVendor of vendors) {\r\n                Object.keys(singleVendor[\"brand_id\"]).forEach(function (key) {\r\n                    if (singleVendor.marginInPercentage > 0) {\r\n                        worksheet.addRow({\r\n                            vendor_unique_id: singleVendor[\"vendor_unique_id\"].toString(),\r\n                            firmName: singleVendor[\"firmName\"],\r\n                            brand_id: singleVendor[\"brand_id\"][key]._id.toString(),\r\n                            brand_name: singleVendor[\"brand_id\"][key].brand_name,\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            let singleVendor = await vendorModel\r\n                .findById({\r\n                    _id: req.userId,\r\n                    isActive: \"Active\",\r\n                    status: \"Approved\",\r\n                })\r\n                .populate(\"brand_id\");\r\n            worksheet.columns = [\r\n                { header: \"Brand ID\", key: \"brand_id\" },\r\n                { header: \"Brand Name\", key: \"brand_name\" },\r\n            ];\r\n            Object.keys(singleVendor[\"brand_id\"]).forEach(function (key) {\r\n                worksheet.addRow({\r\n                    brand_id: singleVendor[\"brand_id\"][key]._id.toString(),\r\n                    brand_name: singleVendor[\"brand_id\"][key].brand_name,\r\n                });\r\n            });\r\n        }\r\n\r\n        worksheet.getRow(1).eachCell((cell) => {\r\n            cell.font = { bold: true };\r\n            cell.fill = {\r\n                type: \"pattern\",\r\n                pattern: \"solid\",\r\n                fgColor: { argb: \"F08080\" },\r\n            };\r\n        });\r\n        worksheet2.getRow(1).eachCell((cell) => {\r\n            cell.font = { bold: true };\r\n            cell.fill = {\r\n                type: \"pattern\",\r\n                pattern: \"solid\",\r\n                fgColor: { argb: \"9E99F7\" },\r\n            };\r\n        });\r\n        worksheet2.addRow();\r\n        worksheet2.addRow({\r\n            category_id: \"Color ID\",\r\n            category_name: \"Color Name\",\r\n        });\r\n        worksheet2.lastRow.eachCell((cell) => {\r\n            cell.font = { bold: true };\r\n            cell.pattern = \"solid\";\r\n            cell.fill = {\r\n                type: \"pattern\",\r\n                pattern: \"solid\",\r\n                fgColor: { argb: \"F08080\" },\r\n            };\r\n        });\r\n        for (let obj of colors) {\r\n            worksheet2.addRow({\r\n                category_id: obj._id.toString(),\r\n                category_name: obj.colorName,\r\n            });\r\n        }\r\n        worksheet.columns.forEach((column) => {\r\n            const lengths = column.values.map((v) => v.toString().length);\r\n            const maxLength = Math.max(...lengths.filter((v) => typeof v === \"number\"));\r\n            column.width = maxLength + 3;\r\n        });\r\n        worksheet2.columns.forEach((column) => {\r\n            const lengths = column.values.map((v) => v.toString().length);\r\n            const maxLength = Math.max(...lengths.filter((v) => typeof v === \"number\"));\r\n            column.width = maxLength + 3;\r\n        });\r\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\r\n        res.setHeader(\"Content-Disposition\", `attachment; brandid.xlsx`);\r\n\r\n        return workbook.xlsx.write(res).then(() => {\r\n            res.status(200);\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst exportProductAddDemoSheet = async (req, res) => {\r\n    //req.userModel === 'ADMIN' || 'VENDOR'\r\n    try {\r\n        var workbook = new excelJs.Workbook();\r\n        var worksheet = workbook.addWorksheet(\"Add Bulk Product\");\r\n\r\n        let columnData = [\r\n            { header: \"Product Name\", key: \"product_name\" },\r\n            { header: \"SKU CODE\", key: \"skucode\" },\r\n            { header: \"HSN CODE\", key: \"hsncode\" },\r\n            { header: \"Brand ID\", key: \"brand_id\" },\r\n            { header: \"Category ID\", key: \"category_id\" },\r\n            { header: \"Sub Category ID\", key: \"subcategory_id\" },\r\n            { header: \"Color ID\", key: \"color_id\" },\r\n            { header: \"Lot Size\", key: \"lotsize\" },\r\n            { header: \"MRP\", key: \"mrp\" },\r\n            { header: \"GST\", key: \"gst\" },\r\n            { header: \"Seller Price\", key: \"seller_price\" },\r\n            { header: \"In Hand QTY\", key: \"in_hand_qty\" },\r\n            { header: \"Min Order QTY\", key: \"min_order_qty\" },\r\n            { header: \"Sole\", key: \"sole\" },\r\n            { header: \"Material\", key: \"material\" },\r\n            { header: \"Packing Type\", key: \"packing_type\" },\r\n            { header: \"Made In\", key: \"made_in\" },\r\n            { header: \"Weight\", key: \"weight\" },\r\n            { header: \"Description\", key: \"description\" },\r\n            { header: \"Thumbnail URL\", key: \"thumbnail_url\" },\r\n            { header: \"Multiple Images\", key: \"multiple_images\" },\r\n        ];\r\n        var data = {\r\n            product_name: \"Demo prouduct name\",\r\n            skucode: \"---\",\r\n            hsncode: \"---\",\r\n            brand_id: \"64b53---demo---id---747b\",\r\n            category_id: \"64b53---demo---id---747b\",\r\n            subcategory_id: \"64b53---demo---id---747b\",\r\n            color_id: \"64b53---demo---id---747b\",\r\n            lotsize: \"put multiple lot size seperat by ',' comma\",\r\n            mrp: \"100\",\r\n            gst: \"12\",\r\n            seller_price: \"00\",\r\n            in_hand_qty: \"00\",\r\n            min_order_qty: \"0\",\r\n            sole: \"--\",\r\n            material: \"--\",\r\n            packing_type: \"--\",\r\n            made_in: \"India\",\r\n            weight: \"0\",\r\n            description: \"This is demo Description\",\r\n            thumbnail_url: \"put url here\",\r\n            multiple_images: \"put multiple url seperated by ',' comma\",\r\n        };\r\n        if (req.userModel === \"ADMIN\") {\r\n            columnData.unshift({ header: \"Vendor ID\", key: \"vendor_id\" });\r\n            const newColumnData = [...columnData.slice(0, 12), { header: \"Margin\", key: \"margin\" }, { header: \"Selling GST\", key: \"sellingGST\" }, ...columnData.slice(12)];\r\n            columnData = newColumnData;\r\n            data.vendor_id = \"64b53---demo---id---747b\";\r\n            data.margin = 0;\r\n            data.sellingGST = 0;\r\n        }\r\n        worksheet.columns = columnData;\r\n        worksheet.addRow(data);\r\n        worksheet.getRow(1).eachCell((cell) => {\r\n            cell.font = { bold: true };\r\n            cell.fill = {\r\n                type: \"pattern\",\r\n                pattern: \"solid\",\r\n                fgColor: { argb: \"F08080\" },\r\n            };\r\n        });\r\n\r\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\r\n        res.setHeader(\"Content-Disposition\", `attachment; brandid.xlsx`);\r\n\r\n        return workbook.xlsx.write(res).then(() => {\r\n            res.status(200);\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst csvToJson = async (req, res) => {\r\n    try {\r\n        vendorIds = {};\r\n        categoryIds = {};\r\n        colorIds = {};\r\n        let csvUrl = await uploadFile(req.files.csv);\r\n        let resJson = [];\r\n        await csv2json()\r\n            .fromStream(request.get(csvUrl))\r\n            .subscribe((json) => {\r\n                if (json[\"Product Name\"] !== \"\") {\r\n                    resJson.push(json);\r\n                }\r\n            });\r\n        let productData = {\r\n            vendor_id: \"\",\r\n            product_name: \"\",\r\n            sku_code: \"\",\r\n            hsn_code: \"\",\r\n            brandId: \"\",\r\n            color_id: \"\",\r\n            categoryId: \"\",\r\n            subCatId: \"\",\r\n            lotSizeQty: \"\",\r\n            mrp: \"\",\r\n            gst: \"\",\r\n            seller_price: \"\",\r\n            qty_in_hand: \"\",\r\n            min_order_qty: \"\",\r\n            sole: \"\",\r\n            material: \"\",\r\n            packing_type: \"\",\r\n            made_in: \"\",\r\n            weight: \"\",\r\n            description: \"\",\r\n        };\r\n        let productDataArr = [];\r\n        let vendorArr = [];\r\n        for (let Obj of resJson) {\r\n            if (Obj[\"Vendor ID\"] !== undefined) {\r\n                productData.vendor_id = Obj[\"Vendor ID\"];\r\n            }\r\n            if (Obj[\"Product Name\"] !== undefined) {\r\n                productData.product_name = Obj[\"Product Name\"];\r\n            }\r\n            if (Obj[\"SKU CODE\"] !== undefined) {\r\n                productData.sku_code = Obj[\"SKU CODE\"];\r\n            }\r\n            if (Obj[\"HSN CODE\"] !== undefined) {\r\n                productData.hsn_code = Obj[\"HSN CODE\"];\r\n            }\r\n            if (Obj[\"Brand ID\"] !== undefined) {\r\n                productData.brandId = Obj[\"Brand ID\"];\r\n            }\r\n            if (Obj[\"Category ID\"] !== undefined) {\r\n                productData.categoryId = Obj[\"Category ID\"];\r\n            }\r\n            if (Obj[\"Sub Category ID\"] !== undefined) {\r\n                productData.subCatId = Obj[\"Sub Category ID\"];\r\n            }\r\n            if (Obj[\"Color ID\"] !== undefined) {\r\n                productData.color_id = Obj[\"Color ID\"].split(\",\").flatMap((el) => {\r\n                    if (el !== \"\" && el !== \" \") {\r\n                        return el.trim();\r\n                    }\r\n                    return [];\r\n                });\r\n            }\r\n            if (Obj[\"Lot Size\"] !== undefined) {\r\n                productData.lotSizeQty = Obj[\"Lot Size\"].split(\",\").flatMap((el) => {\r\n                    if (el !== \"\" && el !== \" \") {\r\n                        return el.trim();\r\n                    }\r\n                    return [];\r\n                });\r\n            }\r\n            if (Obj[\"MRP\"] !== undefined) {\r\n                productData.mrp = Number(Obj[\"MRP\"]);\r\n            }\r\n            if (Obj[\"GST\"] !== undefined) {\r\n                productData.gst = Number(Obj[\"GST\"]);\r\n            }\r\n            if (Obj[\"Seller Price\"] !== undefined) {\r\n                productData.seller_price = Number(Obj[\"Seller Price\"]);\r\n            }\r\n            if (Obj[\"Margin\"] !== undefined) {\r\n                productData.margin = Number(Obj[\"Margin\"]);\r\n            }\r\n            if (Obj[\"Selling GST\"] !== undefined) {\r\n                productData.sellingGST = Number(Obj[\"Selling GST\"]);\r\n            }\r\n            if (Obj[\"In Hand QTY\"] !== undefined) {\r\n                productData.qty_in_hand = Number(Obj[\"In Hand QTY\"]);\r\n            }\r\n            if (Obj[\"Min Order QTY\"] !== undefined) {\r\n                productData.min_order_qty = Number(Obj[\"Min Order QTY\"]);\r\n            }\r\n            if (Obj[\"Sole\"] !== undefined) {\r\n                productData.sole = Obj[\"Sole\"];\r\n            }\r\n            if (Obj[\"Material\"] !== undefined) {\r\n                productData.material = Obj[\"Material\"];\r\n            }\r\n            if (Obj[\"Packing Type\"] !== undefined) {\r\n                productData.packing_type = Obj[\"Packing Type\"];\r\n            }\r\n            if (Obj[\"Made In\"] !== undefined) {\r\n                productData.made_in = Obj[\"Made In\"];\r\n            }\r\n            if (Obj[\"Weight\"] !== undefined) {\r\n                productData.weight = Obj[\"Weight\"];\r\n            }\r\n            if (Obj[\"Description\"] !== undefined) {\r\n                productData.description = Obj[\"Description\"];\r\n            }\r\n            if (Obj[\"Thumbnail URL\"] !== undefined) {\r\n                productData.thumbnail_pic = Obj[\"Thumbnail URL\"];\r\n            }\r\n            if (Obj[\"Multiple Images\"] !== undefined) {\r\n                productData.multiple_pics = Obj[\"Multiple Images\"].split(\",\").map((el) => el.trim());\r\n            }\r\n            if (req.userModel === \"VENDOR\") {\r\n                productData.vendor_id = req.userId;\r\n            }\r\n            let statusX = await checkProductIds(req, res, productData);\r\n            if (statusX.status) {\r\n                if (req.userModel === \"ADMIN\") {\r\n                    if (vendorArr.indexOf(statusX.vendorId) === -1) {\r\n                        vendorArr.push(statusX.vendorId);\r\n                    }\r\n                    productData.vendor_id = statusX.vendorId;\r\n                    productData.status = \"Approved\";\r\n                }\r\n            } else {\r\n                return res.status(400).send({ status: false, message: statusX.message });\r\n            }\r\n\r\n            productDataArr.push(productData);\r\n            productData = {\r\n                vendor_id: \"\",\r\n                product_name: \"\",\r\n                sku_code: \"\",\r\n                hsn_code: \"\",\r\n                brandId: \"\",\r\n                color_id: \"\",\r\n                categoryId: \"\",\r\n                subCatId: \"\",\r\n                lotSizeQty: \"\",\r\n                mrp: \"\",\r\n                gst: \"\",\r\n                seller_price: \"\",\r\n                qty_in_hand: \"\",\r\n                min_order_qty: \"\",\r\n                sole: \"\",\r\n                material: \"\",\r\n                packing_type: \"\",\r\n                made_in: \"\",\r\n                weight: \"\",\r\n                description: \"\",\r\n                thumbnail_pic: \"\",\r\n                multiple_pics: [],\r\n            };\r\n            if (req.userModel === \"ADMIN\") {\r\n                productData.margin = \"\";\r\n                productData.sellingGST = \"\";\r\n            }\r\n        }\r\n        if (req.userModel === \"ADMIN\") {\r\n            let newProductObj = await productModel.insertMany(productDataArr);\r\n            let arr = [];\r\n            for (let vdr of vendorArr) {\r\n                let x = await vendorModel.findById(vdr);\r\n                arr.push(x);\r\n            }\r\n            for (let prdct of newProductObj) {\r\n                let obj = arr.find((e) => e._id.toString() === prdct.vendor_id.toString());\r\n                if (obj) {\r\n                    obj.products.push(prdct);\r\n                }\r\n            }\r\n            for (let vdr of arr) {\r\n                await vdr.save();\r\n            }\r\n        } else {\r\n            let vendorObj = await vendorModel.findById(req.userId);\r\n            let newProductObj = await productModel.insertMany(productDataArr);\r\n            vendorObj.products.push(...newProductObj);\r\n            await vendorObj.save();\r\n        }\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Bulk Product Added Successfully\",\r\n            data: { categoryIds, colorIds, vendorIds },\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst exportOrderReport = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let orders = await orderModel\r\n            .find({ _id: { $in: data } })\r\n            .populate([\r\n                \"vendorId\",\r\n                \"payment_id\",\r\n                \"order_status_id\",\r\n                \"ordered_products\",\r\n                \"purchaseInvoice\",\r\n                \"saleInvoice\",\r\n                { path: \"CouponCode\", strictPopulate: false },\r\n                { path: \"customer_id\", model: \"Customer\", strictPopulate: false, populate: { path: \"defaultAddress\", model: \"CustomerAddress\", strictPopulate: false } },\r\n            ]);\r\n        let ordersArr = [];\r\n        let orderData = {};\r\n        let productLength = 0;\r\n\r\n        for (let order of orders) {\r\n            orderData[\"orderId\"] = order.orderId;\r\n            orderData[\"orderDate\"] = dateToLocalDateTime(order.order_date);\r\n            orderData[\"invoiceNo\"] = order.saleInvoice ? order.saleInvoice.invoiceNo : \"\";\r\n            orderData[\"invoiceDate\"] = order.saleInvoice ? dateToLocalDateTime(order.saleInvoice.invoiceDate) : \"\";\r\n            orderData[\"productsLength\"] = order.ordered_products ? order.ordered_products.products.length : \"\";\r\n            if (order.ordered_products && order.ordered_products.products.length > productLength) {\r\n                productLength = order.ordered_products.products.length;\r\n            }\r\n            if (order.ordered_products) {\r\n                for (let x1 = 0; x1 < order.ordered_products.products.length; x1++) {\r\n                    orderData[`sale_sku_code_${x1 + 1}`] = order.ordered_products.products[x1].skuCode;\r\n                    orderData[`purchase_sku_code_${x1 + 1}`] = order.ordered_products.products[x1].skuCode;\r\n                    orderData[`sale_lotSize_${x1 + 1}`] = order.ordered_products.products[x1].lotSize;\r\n                    orderData[`purchase_lotSize_${x1 + 1}`] = order.ordered_products.products[x1].lotSize;\r\n                    orderData[`sale_gst_percentage_${x1 + 1}`] = order.ordered_products.products[x1].selling_gst;\r\n                    orderData[`purchase_gst_percentage_${x1 + 1}`] = order.ordered_products.products[x1].seller_gst;\r\n                }\r\n            }\r\n            orderData[\"soldByGst\"] = order.saleInvoice ? order.saleInvoice.soldBy.gst : \"\";\r\n            orderData[\"customerName\"] = order.customer_id.name;\r\n            orderData[\"customerPhone\"] = order.customer_id.phone;\r\n            orderData[\"customerAddress\"] = order.customer_id.defaultAddress.address;\r\n            orderData[\"customerCity\"] = order.customer_id.defaultAddress.city;\r\n            orderData[\"customerState\"] = order.customer_id.defaultAddress.state;\r\n            orderData[\"customerPincode\"] = order.customer_id.defaultAddress.pincode;\r\n            orderData[\"customerGstNo\"] = order.customer_id.gstNo;\r\n            orderData[\"customerAltPhone\"] = order.customer_id.alternate_phone;\r\n            orderData[\"saleGrandTotal\"] = order.grand_total;\r\n            orderData[\"saleInvGrandTotal\"] = order.grand_total;\r\n            orderData[\"saleDiscount\"] = order.discounted_amount;\r\n            orderData[\"saleNetTotal\"] = Number(order.grand_total) - Number(order.discounted_amount);\r\n            orderData[\"saleTaxableAmt\"] = order.total;\r\n            orderData[\"saleGstType\"] = order.saleInvoice ? order.saleInvoice.gstType : \"\";\r\n            orderData[\"saleGstAmt\"] = order.GST_amount;\r\n            orderData[\"sellerName\"] = order.vendorId.representativeName;\r\n            orderData[\"sellerPhone\"] = order.vendorId.mobileNo;\r\n            orderData[\"sellerAddress\"] = order.vendorId.pickupAddress;\r\n            orderData[\"sellerCity\"] = order.vendorId.pickupCity;\r\n            orderData[\"sellerState\"] = order.vendorId.pickupState;\r\n            orderData[\"sellerPincode\"] = order.vendorId.pickupPincode;\r\n            orderData[\"sellerGstNo\"] = order.vendorId.gstNo;\r\n            orderData[\"sellerAltNo\"] = order.vendorId.altMobileNo;\r\n            orderData[\"purchaseGrandTotal\"] = order.vendorAmtInfo.grandTotal;\r\n            orderData[\"purchaseInvGrandTotal\"] = order.vendorAmtInfo.grandTotal;\r\n            orderData[\"purchaseNetTotal\"] = order.vendorAmtInfo.grandTotal;\r\n            orderData[\"purchaseTaxableAmt\"] = order.vendorAmtInfo.total;\r\n            orderData[\"purchaseGstType\"] = order.purchaseInvoice ? order.purchaseInvoice.gstType : \"\";\r\n            orderData[\"purchaseGstAmt\"] = order.vendorAmtInfo.gstAmt;\r\n            orderData[\"orderJourneyFinalStatus\"] = order.order_status_id.status;\r\n            for (let orderStatusList of order.order_status_id.statusList) {\r\n                let actionTakenBy = \"\";\r\n                let updatedDate = dateToLocalDateTime(orderStatusList.updatedAt);\r\n                if (orderStatusList.updatedBy.admin) actionTakenBy = \"ADMIN\";\r\n                if (orderStatusList.updatedBy.vendor) actionTakenBy = \"SELLER\";\r\n                orderData[orderStatusList.status] = `${updatedDate} | ${actionTakenBy}`;\r\n            }\r\n            ordersArr.push(orderData);\r\n            orderData = {};\r\n        }\r\n        var workbook = new excelJs.Workbook();\r\n        var worksheet = workbook.addWorksheet(\"Order Report\");\r\n        let orderCol = [\r\n            { header: \"Order ID\", key: \"orderId\" },\r\n            { header: \"Order date and time\", key: \"orderDate\" },\r\n            { header: \"Invoice No\", key: \"invoiceNo\" },\r\n            { header: \"Invoice date\", key: \"invoiceDate\" },\r\n            { header: \"Order Quantity\", key: \"productsLength\" },\r\n            { header: \"factorEz GST\", key: \"soldByGst\" },\r\n            { header: \"STATE\", key: \"orderStatus\" },\r\n        ];\r\n        let buyerCol = [\r\n            { header: \"Buyer Name\", key: \"customerName\" },\r\n            { header: \"Buyer Phone Number\", key: \"customerPhone\" },\r\n            { header: \"Full Address\", key: \"customerAddress\" },\r\n            { header: \"Buyer City\", key: \"customerCity\" },\r\n            { header: \"Buyer State\", key: \"customerState\" },\r\n            { header: \"Pincode\", key: \"customerPincode\" },\r\n            { header: \"Gst No.\", key: \"customerGstNo\" },\r\n            { header: \"alternative phone\", key: \"customerAltPhone\" },\r\n        ];\r\n        let saleCol = [\r\n            { header: \"Total Amount\", key: \"saleGrandTotal\" },\r\n            { header: \"Discount\", key: \"saleDiscount\" },\r\n            { header: \"Final amount/ sales\", key: \"saleNetTotal\" },\r\n            { header: \"Invoice Value\", key: \"saleInvGrandTotal\" },\r\n            { header: \"Taxable value\", key: \"saleTaxableAmt\" },\r\n            { header: \"Gst Type\", key: \"saleGstType\" },\r\n            { header: \"Gst amount\", key: \"saleGstAmt\" },\r\n        ];\r\n        let sellerCol = [\r\n            { header: \"Seller name\", key: \"sellerName\" },\r\n            { header: \"Seller phone Number\", key: \"sellerPhone\" },\r\n            { header: \"Full Address\", key: \"sellerAddress\" },\r\n            { header: \"Seller City\", key: \"sellerCity\" },\r\n            { header: \"Seller State\", key: \"sellerState\" },\r\n            { header: \"Pincode\", key: \"sellerPincode\" },\r\n            { header: \"Gst No.\", key: \"sellerGstNo\" },\r\n            { header: \"alternative phone\", key: \"sellerAltNo\" },\r\n        ];\r\n        let purchaseCol = [\r\n            { header: \"Total Amount\", key: \"purchaseGrandTotal\" },\r\n            { header: \"Seller Discount\", key: \"purchaseDiscount\" },\r\n            { header: \"Final amount/ purchase\", key: \"purchaseNetTotal\" },\r\n            { header: \"invoice value\", key: \"purchaseInvGrandTotal\" },\r\n            { header: \"Taxable value\", key: \"purchaseTaxableAmt\" },\r\n            { header: \"Gst Type\", key: \"purchaseGstType\" },\r\n            { header: \"Gst amount\", key: \"purchaseGstAmt\" },\r\n        ];\r\n        let orderJourney = [\r\n            { header: \"Final Status\", key: \"orderJourneyFinalStatus\" },\r\n            { header: \"Delivered\", key: \"DELIVERED\" },\r\n            { header: \"Out For Delivery\", key: \"OUT_FOR_DELIVERY\" },\r\n            { header: \"Return delivered to seller/warehouse\", key: \"RETURNED_RTO_DELIVERED\" },\r\n            { header: \"Return\", key: \"RETURNED\" },\r\n            { header: \"Pickup-done/In transit\", key: \"PICKUP_DONE\" },\r\n            { header: \"Pickup-Aligned\", key: \"PICKUP_ALIGNED\" },\r\n            { header: \"Ready to dispatch\", key: \"READY_TO_DISPATCH\" },\r\n            { header: \"Confirmed/in-process\", key: \"CONFIRMED\" },\r\n            { header: \"cancelled\", key: \"CANCELLED\" },\r\n            { header: \"Remarks\", key: \"remarks\" },\r\n        ];\r\n        for (let m = 0; m < productLength; m++) {\r\n            let saleSkuCol = { header: `SKU code ${m + 1}`, key: `sale_sku_code_${m + 1}` };\r\n            let purchaseSkuCol = { header: `SKU code ${m + 1}`, key: `purchase_sku_code_${m + 1}` };\r\n            let saleGstCol = { header: `GST percentage ${m + 1}`, key: `sale_gst_percentage_${m + 1}` };\r\n            let purchaseGstCol = { header: `GST percentage ${m + 1}`, key: `purchase_gst_percentage_${m + 1}` };\r\n            let saleLotSizeCol = { header: `Lot Set/Size set ${m + 1}`, key: `sale_lotSize_${m + 1}` };\r\n            let purchaseLotSizeCol = { header: `Lot Set/Size set ${m + 1}`, key: `purchase_lotSize_${m + 1}` };\r\n            saleCol.push(saleSkuCol, saleLotSizeCol, saleGstCol);\r\n            purchaseCol.push(purchaseSkuCol, purchaseLotSizeCol, purchaseGstCol);\r\n        }\r\n        let columnData = [...orderCol, ...buyerCol, ...saleCol, ...sellerCol, ...purchaseCol, ...orderJourney];\r\n        worksheet.columns = columnData;\r\n        for (let x of ordersArr) {\r\n            worksheet.addRow(x);\r\n        }\r\n        let orderLen = orderCol.length;\r\n        let buyerLen = buyerCol.length + orderLen;\r\n        let saleLen = saleCol.length + buyerLen;\r\n        let sellerLen = sellerCol.length + saleLen;\r\n        let purchaseLen = purchaseCol.length + sellerLen;\r\n        let orderJLen = orderJourney.length + purchaseLen;\r\n        worksheet.getRow(1).height = 20;\r\n        worksheet.getRow(1).eachCell((cell, colNum) => {\r\n            cell.border = {\r\n                top: { style: \"thin\" },\r\n                right: { style: \"thin\" },\r\n                bottom: { style: \"thin\" },\r\n                left: { style: \"thin\" },\r\n            };\r\n            cell.font = { bold: true };\r\n            if (colNum <= orderLen) {\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"d7ff38\" },\r\n                };\r\n            } else if (colNum <= buyerLen) {\r\n                cell.font = { color: { argb: \"ffffff\" } };\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"2e397d\" },\r\n                };\r\n            } else if (colNum <= saleLen) {\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"cad1fa\" },\r\n                };\r\n            } else if (colNum <= sellerLen) {\r\n                cell.font = { color: { argb: \"ffffff\" } };\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"556b58\" },\r\n                };\r\n            } else if (colNum <= purchaseLen) {\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"07f027\" },\r\n                };\r\n            } else {\r\n                cell.font = { color: { argb: \"ffffff\" } };\r\n                cell.fill = {\r\n                    type: \"pattern\",\r\n                    pattern: \"solid\",\r\n                    fgColor: { argb: \"288a70\" },\r\n                };\r\n            }\r\n        });\r\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\r\n        res.setHeader(\"Content-Disposition\", `attachment; orderReport.xlsx`);\r\n        return workbook.xlsx.write(res).then(() => {\r\n            res.status(200);\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { exportProductAddDemoSheet, exportIDs, csvToJson, exportOrderReport };\r\n","const HomepageModel = require(\"../models/HomepageModel\");\r\n\r\nconst addFeaturedProducts = async (req, res) => {\r\n    try {\r\n        let { newArrival, featuredProduct, bestSelling } = req.body;\r\n        let home = await HomepageModel.find();\r\n        if (home.length > 0) {\r\n            if (featuredProduct) {\r\n                if (!home[0].featuredProduct.includes(featuredProduct)) {\r\n                    home[0].featuredProduct.push(featuredProduct);\r\n                }\r\n            }\r\n            if (newArrival) {\r\n                if (!home[0].newArrival.includes(newArrival)) {\r\n                    home[0].newArrival.push(newArrival);\r\n                }\r\n            }\r\n            if (bestSelling) {\r\n                if (!home[0].bestSelling.includes(bestSelling)) {\r\n                    home[0].bestSelling.push(bestSelling);\r\n                }\r\n            }\r\n            await home[0].save();\r\n        } else {\r\n            let data = {};\r\n            if (featuredProduct) {\r\n                data.featuredProduct = featuredProduct;\r\n            }\r\n            if (newArrival) {\r\n                data.newArrival = newArrival;\r\n            }\r\n            if (bestSelling) {\r\n                data.bestSelling = bestSelling;\r\n            }\r\n            await HomepageModel.create(data);\r\n        }\r\n\r\n        return res.status(200).send({ status: true, message: \"Product Added to respective sections...\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst getFeaturedProduct = async (req, res) => {\r\n    try {\r\n        let products = await HomepageModel.find().populate([\r\n            { path: \"featuredProduct\", model: \"Product\", populate: { path: \"vendor_id\", model: \"Vendor\" } },\r\n            { path: \"bestSelling\", model: \"Product\", populate: { path: \"vendor_id\", model: \"Vendor\" } },\r\n            { path: \"newArrival\", model: \"Product\", populate: { path: \"vendor_id\", model: \"Vendor\" } },\r\n        ]);\r\n        return res.status(200).send({ status: true, message: \"fetched...\", data: products[0] ? products[0] : null });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst removeFeaturedProduct = async (req, res) => {\r\n    try {\r\n        let { key, id } = req.body;\r\n        let home = await HomepageModel.find();\r\n        if (home.length > 0) {\r\n            if (key === \"featuredProduct\") {\r\n                let idx = home[0].featuredProduct.findIndex((e) => e._id.toString() === id);\r\n                if (idx >= 0) {\r\n                    home[0].featuredProduct.splice(idx, 1);\r\n                }\r\n            }\r\n            if (key === \"bestSelling\") {\r\n                let idx = home[0].bestSelling.findIndex((e) => e._id.toString() === id);\r\n                if (idx >= 0) {\r\n                    home[0].bestSelling.splice(idx, 1);\r\n                }\r\n            }\r\n            if (key === \"newArrival\") {\r\n                let idx = home[0].newArrival.findIndex((e) => e._id.toString() === id);\r\n                if (idx >= 0) {\r\n                    home[0].newArrival.splice(idx, 1);\r\n                }\r\n            }\r\n            await home[0].save();\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Removed...\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addFeaturedProducts,\r\n    getFeaturedProduct,\r\n    removeFeaturedProduct,\r\n};\r\n","// Generate Random ID of given length\r\nfunction generateRandomID(length, preFix) {\r\n    let id = preFix ? preFix : '';\r\n    const digits = \"0123456789\";\r\n    for (let i = 0; i < length - 5; i++) {\r\n        const randomIndex = Math.floor(Math.random() * digits.length);\r\n        id += digits[randomIndex];\r\n    }\r\n    id += Date.now().toString().slice(8);\r\n    return id;\r\n}\r\n\r\n// Generate Random AlphaNumeric ID of given length\r\nfunction generateRandomAlphaNumericID(length) {\r\n    let id = \"\";\r\n    const characters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n\r\n    for (let i = 0; i < length; i++) {\r\n        const randomIndex = Math.floor(Math.random() * characters.length);\r\n        id += characters[randomIndex];\r\n    }\r\n    return id;\r\n}\r\n\r\nmodule.exports = { generateRandomID, generateRandomAlphaNumericID };\r\n","const express = require(\"express\");\r\nconst { initializeApp } = require(\"firebase/app\");\r\nconst { getStorage, ref, getDownloadURL, uploadBytesResumable } = require(\"firebase/storage\");\r\nconst aws = require(\"aws-sdk\");\r\nrequire(\"aws-sdk/lib/maintenance_mode_message\").suppress = true;\r\nconst config = require(\"../middlewares/firebase\");\r\nconst { awsS3Bucket, awsAccessKey, awsSecretKey, awsS3Region } = require(\"../middlewares/config\");\r\n//Initialize a firebase application\r\ninitializeApp(config.firebaseConfig);\r\n\r\n// Initialize Cloud Storage and get a reference to the service\r\nconst storage = getStorage();\r\nconst uploadImage = async (blobFile) => {\r\n    const dateTime = giveCurrentDateTime();\r\n    const storageRef = ref(storage, `files/${dateTime.toString().replace(\" \", \"_\") + \"_\" + blobFile.name.replace(\" \", \"_\")}`);\r\n\r\n    // // Create file metadata including the content type\r\n    const metadata = {\r\n        contentType: blobFile.mimetype,\r\n    };\r\n\r\n    // // Upload the file in the bucket storage\r\n    const snapshot = await uploadBytesResumable(storageRef, blobFile.data, metadata);\r\n    //by using uploadBytesResumable we can control the progress of uploading like pause, resume, cancel\r\n\r\n    // Grab the public url\r\n    const downloadURL = await getDownloadURL(snapshot.ref);\r\n    return {\r\n        message: \"file uploaded to firebase storage\",\r\n        name: snapshot.metadata.name,\r\n        type: blobFile.mimetype,\r\n        imageURL: downloadURL,\r\n    };\r\n};\r\n\r\nconst giveCurrentDateTime = () => {\r\n    const today = new Date();\r\n    const date = today.getFullYear() + \"-\" + (today.getMonth() + 1) + \"-\" + today.getDate();\r\n    const time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\r\n    const dateTime = date + \" \" + time;\r\n    return dateTime;\r\n};\r\n\r\naws.config.update({\r\n    accessKeyId: awsAccessKey,\r\n    secretAccessKey: awsSecretKey,\r\n    region: awsS3Region,\r\n});\r\n\r\nlet uploadFile = async (image) => {\r\n    return new Promise(function (resolve, reject) {\r\n        let s3 = new aws.S3();\r\n        const dateTime = giveCurrentDateTime();\r\n        var uploadParams = {\r\n            Bucket: awsS3Bucket,\r\n            Key: \"images/\" + dateTime.toString().replace(\" \", \"_\") + \"_\" + image.name.replace(\" \", \"_\"),\r\n            Body: image.data,\r\n            ContentType: image.mimetype,\r\n        };\r\n        s3.upload(uploadParams, function (err, data) {\r\n            if (err) {\r\n                return reject({ error: err });\r\n            }\r\n            return resolve(data.Location);\r\n        });\r\n    });\r\n};\r\n\r\nmodule.exports = { uploadImage, uploadFile };\r\n","const customerModel = require(\"../models/customerModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst businessModel = require(\"../models/businessModel\");\r\nconst invoiceModel = require(\"../models/invoiceModel\");\r\nconst invoiceNoModel = require(\"../models/invoiceNoModel\");\r\nconst customerAddressModel = require(\"../models/customerAddressModel\");\r\nconst orderedProductModel = require(\"../models/orderedProductModel\");\r\nconst { generatePdf } = require(\"../utils/generatePdf\");\r\nconst { dateToLocalDateTime } = require(\"../utils/dateUtils\");\r\nconst { financialYear } = require(\"../utils/getFinancialYear\");\r\n\r\nconst generatePurchaseInvoice = async (data) => {\r\n    try {\r\n        let { vendor_id, order_id, gstAmount, totalAmount } = data;\r\n        let vendor = await vendorModel.findById(vendor_id);\r\n        let business = await businessModel.find();\r\n        if (business.length === 0 || !business[0].defaultGST) {\r\n            return { status: false, err: \"Default gst not found\" };\r\n        }\r\n\r\n        let invNo = await invoiceNoModel.findOne({ invoiceNoType: \"PURCHASE\" });\r\n        let fY = financialYear();\r\n        if (!invNo) {\r\n            invNo = await invoiceNoModel.create({\r\n                invoiceNo: 1,\r\n                invoiceYear: fY,\r\n                invoiceNoLength: 6,\r\n                invoiceNoType: \"PURCHASE\",\r\n            });\r\n        }\r\n        if (Number(fY) !== invNo.invoiceYear) {\r\n            invNo.invoiceNo = 1;\r\n            invNo.invoiceYear = fY;\r\n        }\r\n        let strInvNumber = \"0000000000\" + invNo.invoiceNo;\r\n        let invNumber = `FPIN${invNo.invoiceYear}${strInvNumber.substring(strInvNumber.length - invNo.invoiceNoLength)}`;\r\n        invNo.invoiceNo += 1;\r\n        let generateDate = new Date();\r\n        let invData = {\r\n            invoiceNo: invNumber,\r\n            invoiceDate: generateDate,\r\n            vendor_id,\r\n            order_id,\r\n            gstAmount: gstAmount.toFixed(2),\r\n            totalAmount: totalAmount.toFixed(2),\r\n            invoiceType: \"PURCHASE\",\r\n        };\r\n        if (vendor.gstNo.substring(0, 2) === business[0].defaultGST.gstNo.substring(0, 2)) {\r\n            invData.gstType = \"CGST_SGST\";\r\n        } else {\r\n            invData.gstType = \"IGST\";\r\n        }\r\n\r\n        invData.soldBy = {\r\n            name: vendor.firmName,\r\n            address: vendor.invoiceAddress,\r\n            phone: vendor.mobileNo,\r\n            gst: vendor.gstNo,\r\n        };\r\n\r\n        invData.shippingAddress = {\r\n            name: business[0].business_name,\r\n            address: business[0].defaultGST.pickupAddress,\r\n            phone: business[0].contactNo,\r\n            gst: business[0].defaultGST.gstNo,\r\n        };\r\n        invData.billingAddress = {\r\n            name: business[0].business_name,\r\n            address: business[0].defaultGST.pickupAddress,\r\n            phone: business[0].contactNo,\r\n            gst: business[0].defaultGST.gstNo,\r\n        };\r\n        let invRes = await invoiceModel.create(invData);\r\n        await invNo.save();\r\n        return { status: true, invoice: invRes };\r\n    } catch (err) {\r\n        return { status: false, err: err };\r\n    }\r\n};\r\nconst generateSaleInvoice = async (data) => {\r\n    try {\r\n        let { customer_id, order_id, gstAmount, totalAmount, address } = data;\r\n        let customer = await customerModel.findById(customer_id);\r\n        let business = await businessModel.find();\r\n        if (business.length === 0 || !business[0].defaultGST) {\r\n            return { status: false, err: \"Default gst not found\" };\r\n        }\r\n\r\n        let invNo = await invoiceNoModel.findOne({ invoiceNoType: \"SALE\" });\r\n        let fY = financialYear();\r\n        if (!invNo) {\r\n            invNo = await invoiceNoModel.create({\r\n                invoiceNo: 1,\r\n                invoiceYear: fY,\r\n                invoiceNoLength: 6,\r\n                invoiceNoType: \"SALE\",\r\n            });\r\n        }\r\n        if (Number(fY) !== invNo.invoiceYear) {\r\n            invNo.invoiceNo = 1;\r\n            invNo.invoiceYear = fY;\r\n        }\r\n        let strInvNumber = \"0000000000\" + invNo.invoiceNo;\r\n        let invNumber = `FSIN${invNo.invoiceYear}${strInvNumber.substring(strInvNumber.length - invNo.invoiceNoLength)}`;\r\n        invNo.invoiceNo += 1;\r\n        let generateDate = new Date();\r\n        let invData = {\r\n            invoiceNo: invNumber,\r\n            invoiceDate: generateDate,\r\n            customer_id,\r\n            order_id,\r\n            gstAmount: gstAmount.toFixed(2),\r\n            totalAmount: totalAmount.toFixed(2),\r\n            invoiceType: \"SALE\",\r\n        };\r\n\r\n        if (customer.defaultAddress.stateCode === business[0].defaultGST.gstNo.substring(0, 2)) {\r\n            invData.gstType = \"CGST_SGST\";\r\n        } else {\r\n            invData.gstType = \"IGST\";\r\n        }\r\n        invData.soldBy = {\r\n            name: business[0].business_name,\r\n            address: business[0].defaultGST.pickupAddress,\r\n            phone: business[0].contactNo,\r\n            gst: business[0].defaultGST.gstNo,\r\n        };\r\n        invData.shippingAddress = {\r\n            name: customer.name,\r\n            address: address.address,\r\n            phone: customer.phone,\r\n            gst: customer.gstNo,\r\n        };\r\n        invData.billingAddress = {\r\n            name: customer.name,\r\n            address: address.address,\r\n            phone: customer.phone,\r\n            gst: customer.gstNo,\r\n        };\r\n        let invRes = await invoiceModel.create(invData);\r\n\r\n        await invNo.save();\r\n        return { status: true, invoice: invRes };\r\n    } catch (err) {\r\n        return { status: false, err: err };\r\n    }\r\n};\r\n\r\nconst getAllSaleInvoice = async (req, res) => {\r\n    try {\r\n        let userType = req.userModel;\r\n        let invoices = null;\r\n        if (userType === \"ADMIN\") {\r\n            invoices = await invoiceModel.find({ invoiceType: \"SALE\" });\r\n        } else {\r\n            invoices = await invoiceModel.find({ invoiceType: \"PURCHASE\" });\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Invoice fetched successfully...\", data: invoices });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst getAllPurchaseInvoice = async (req, res) => {\r\n    try {\r\n        let invoices = [];\r\n        if (req.userModel === \"ADMIN\") {\r\n            invoices = await invoiceModel.find({ invoiceType: \"PURCHASE\" });\r\n        }\r\n        if (req.userModel === \"VENDOR\") {\r\n            invoices = await invoiceModel.find({ invoiceType: \"PURCHASE\", vendor_id: req.userId });\r\n        }\r\n        return res.status(200).send({ status: true, message: \"Invoice fetched successfully...\", data: invoices });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst data = {\r\n    logo: \"\",\r\n    brandName: \"\",\r\n    soldBy: \"\",\r\n    soldByAddress: \"\",\r\n    soldByGst: \"\",\r\n    invoiceNo: \"\",\r\n    orderId: \"\",\r\n    orderDate: \"\",\r\n    invoiceDate: \"\",\r\n    billToName: \"\",\r\n    billToAddress: \"\",\r\n    billToPhone: \"\",\r\n    billToGST: \"\",\r\n    shipToName: \"\",\r\n    shipToAddress: \"\",\r\n    shipToPhone: \"\",\r\n    shipToGST: \"\",\r\n    tableRow: [],\r\n    totalAmt: \"\",\r\n    totalCGSTAmt: \"\",\r\n    totalSGSTAmt: \"\",\r\n    totalIGSTAmt: \"\",\r\n    taxableAmt: \"\",\r\n    totalTaxAmt: \"\",\r\n    grossTotalAmt: \"\",\r\n    discountAmt: \"\",\r\n    netPayableAmount: \"\",\r\n};\r\ndata.tableRow = [\r\n    {\r\n        sno: \"1\",\r\n        productName: \"Demo Product 1\",\r\n        color: \"Black\",\r\n        sizeSet: \"5/2 7/2 8/2 9/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"5\",\r\n        rate: \"800\",\r\n        total: \"4000\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"480\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"480\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"2\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"3\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"4\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"5\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"6\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"7\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"8\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"9\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"10\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"11\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"12\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"13\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"14\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n    {\r\n        sno: \"15\",\r\n        productName: \"Demo Product 2\",\r\n        color: \"Blue\",\r\n        sizeSet: \"8/2 9/2 5/2 7/2\",\r\n        hsnCode: \"123456\",\r\n        qty: \"6\",\r\n        rate: \"910\",\r\n        total: \"5460\",\r\n        cgstPercentage: \"12\",\r\n        cgstAmount: \"655.20\",\r\n        sgstPercentage: \"12\",\r\n        sgstAmount: \"655.20\",\r\n        igstPercentage: \"\",\r\n        igstAmount: \"\",\r\n    },\r\n];\r\ndata.logo = \"https://upload.wikimedia.org/wikipedia/commons/b/b6/Image_created_with_a_mobile_phone.png\";\r\ndata.brandName = \"Shoes House\";\r\ndata.soldBy = \"Mohit Shoes\";\r\ndata.soldByAddress = \"Vinayak logistic Park, Village Hinaura,hasanganj, Unnao-209859, Uttar Pradesh, Lucknow, UTTAR PRADESH, India - 209859, IN-UP\";\r\ndata.soldByGst = \"07AABCU9603R1ZX\";\r\ndata.invoiceNo = \"FSIN2300000007\";\r\n\r\nconst downoadInvoiceByInvoiceNumber = async (req, res) => {\r\n    try {\r\n        let invoiceNumber = req.params.invoicenumber;\r\n        let invoicetype = req.params.invoicetype;\r\n\r\n        let invoice = await invoiceModel.findOne({ invoiceNo: invoiceNumber }).populate(\"order_id\");\r\n        if (!invoice) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (invoicetype === \"PURCHASE\" && !invoice.vendor_id) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let orderedProduct = await orderedProductModel.findOne({ order_id: invoice.order_id }).populate({ path: \"products.product_id\", model: \"Product\" });\r\n        if (!orderedProduct) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let business = await businessModel.find();\r\n        if (business.length === 0) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (invoicetype === \"PURCHASE\") {\r\n            let invData = {\r\n                logo: business[0].invoiceLogo,\r\n                brandName: business[0].business_name,\r\n                soldBy: invoice.soldBy.name,\r\n                soldByAddress: invoice.soldBy.address,\r\n                soldByPhone: invoice.soldBy.phone,\r\n                soldByGst: invoice.soldBy.gst,\r\n                invoiceNo: invoiceNumber,\r\n                orderId: invoice.order_id.orderId,\r\n                orderDate: dateToLocalDateTime(invoice.order_id.order_date),\r\n                invoiceDate: dateToLocalDateTime(invoice.invoiceDate),\r\n                billToName: invoice.billingAddress.name,\r\n                billToAddress: invoice.billingAddress.address,\r\n                billToPhone: invoice.billingAddress.phone,\r\n                billToGST: invoice.billingAddress.gst,\r\n                shipToName: invoice.shippingAddress.name,\r\n                shipToAddress: invoice.shippingAddress.address,\r\n                shipToPhone: invoice.shippingAddress.phone,\r\n                shipToGST: invoice.shippingAddress.gst,\r\n                tableRow: [],\r\n                totalAmt: \"\" + invoice.totalAmount,\r\n                totalCGSTAmt: \"\",\r\n                totalSGSTAmt: \"\",\r\n                totalIGSTAmt: \"\",\r\n                taxableAmt: invoice.totalAmount,\r\n                totalTaxAmt: invoice.gstAmount,\r\n                grossTotalAmt: (Number(invoice.gstAmount) + Number(invoice.totalAmount)).toFixed(2),\r\n                discountAmt: \"0\",\r\n                netPayableAmount: (Number(invoice.gstAmount) + Number(invoice.totalAmount)).toFixed(2),\r\n            };\r\n            if (invoice.soldBy.gst.substring(0, 2) === invoice.billingAddress.gst.substring(0, 2)) {\r\n                invData.totalCGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                invData.totalSGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                let count = 1;\r\n                for (let product of orderedProduct.products) {\r\n                    if (!product.isRemoved) {\r\n                        let trData = {\r\n                            sno: count,\r\n                            productName: \"\",\r\n                            color: \"\",\r\n                            sizeSet: \"\",\r\n                            hsnCode: \"\",\r\n                            qty: \"\",\r\n                            rate: \"\",\r\n                            total: \"\",\r\n                            cgstPercentage: \"\",\r\n                            cgstAmount: \"\",\r\n                            sgstPercentage: \"\",\r\n                            sgstAmount: \"\",\r\n                            igstPercentage: \"\",\r\n                            igstAmount: \"\",\r\n                        };\r\n                        count += 1;\r\n                        trData.productName = product.product_id.product_name;\r\n                        trData.color = product.color.colorName;\r\n                        trData.sizeSet = product.lotSize;\r\n                        trData.hsnCode = product.hsnCode;\r\n                        trData.qty = product.qty;\r\n                        trData.rate = product.seller_price;\r\n                        trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                        trData.cgstPercentage = Number(product.seller_gst) / 2;\r\n                        trData.cgstAmount = ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                        trData.sgstPercentage = Number(product.seller_gst) / 2;\r\n                        trData.sgstAmount = ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                        trData.igstPercentage = \"\";\r\n                        trData.igstAmount = \"\";\r\n                        invData.tableRow.push(trData);\r\n                    }\r\n                }\r\n            } else {\r\n                invData.totalIGSTAmt = invoice.gstAmount;\r\n                let count = 1;\r\n                for (let product of orderedProduct.products) {\r\n                    if (!product.isRemoved) {\r\n                        let trData = {\r\n                            sno: count,\r\n                            productName: \"\",\r\n                            color: \"\",\r\n                            sizeSet: \"\",\r\n                            hsnCode: \"\",\r\n                            qty: \"\",\r\n                            rate: \"\",\r\n                            total: \"\",\r\n                            cgstPercentage: \"\",\r\n                            cgstAmount: \"\",\r\n                            sgstPercentage: \"\",\r\n                            sgstAmount: \"\",\r\n                            igstPercentage: \"\",\r\n                            igstAmount: \"\",\r\n                        };\r\n                        count += 1;\r\n                        trData.productName = product.product_id.product_name;\r\n                        trData.color = product.color.colorName;\r\n                        trData.sizeSet = product.lotSize;\r\n                        trData.hsnCode = product.hsnCode;\r\n                        trData.qty = product.qty;\r\n                        trData.rate = product.seller_price;\r\n                        trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                        trData.cgstPercentage = \"\";\r\n                        trData.cgstAmount = \"\";\r\n                        trData.sgstPercentage = \"\";\r\n                        trData.sgstAmount = \"\";\r\n                        trData.igstPercentage = product.seller_gst;\r\n                        trData.igstAmount = \"\" + ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                        invData.tableRow.push(trData);\r\n                    }\r\n                }\r\n            }\r\n            let pdf = await generatePdf(invData, \"factorEz.com\");\r\n            res.setHeader(\"Content-Type\", \"application/pdf\");\r\n            res.setHeader(\"Content-Disposition\", \"attachment; invoice.pdf\");\r\n            return res.send(pdf);\r\n        } else {\r\n            let customerAddress = await customerAddressModel.findOne({ customerId: invoice.customer_id });\r\n            let invData = {\r\n                logo: business[0].invoiceLogo,\r\n                brandName: business[0].business_name,\r\n                soldBy: invoice.soldBy.name,\r\n                soldByAddress: invoice.soldBy.address,\r\n                soldByGst: invoice.soldBy.gst,\r\n                soldByPhone: invoice.soldBy.phone,\r\n                invoiceNo: invoiceNumber,\r\n                orderId: invoice.order_id.orderId,\r\n                orderDate: dateToLocalDateTime(invoice.order_id.order_date),\r\n                invoiceDate: dateToLocalDateTime(invoice.invoiceDate),\r\n                billToName: invoice.billingAddress.name,\r\n                billToAddress: invoice.billingAddress.address,\r\n                billToPhone: invoice.billingAddress.phone,\r\n                billToGST: invoice.billingAddress.gst,\r\n                shipToName: invoice.shippingAddress.name,\r\n                shipToAddress: invoice.shippingAddress.address,\r\n                shipToPhone: invoice.shippingAddress.phone,\r\n                shipToGST: invoice.shippingAddress.gst,\r\n                totalAmt: \"\" + invoice.totalAmount,\r\n                tableRow: [],\r\n                totalCGSTAmt: \"\",\r\n                totalSGSTAmt: \"\",\r\n                totalIGSTAmt: \"\",\r\n                taxableAmt: invoice.totalAmount,\r\n                totalTaxAmt: invoice.gstAmount,\r\n                grossTotalAmt: (Number(invoice.gstAmount) + Number(invoice.totalAmount)).toFixed(2),\r\n                discountAmt: \"\",\r\n                netPayableAmount: \"\",\r\n            };\r\n            if (invoice.billingAddress.gst) {\r\n                if (invoice.soldBy.gst.substring(0, 2) === invoice.billingAddress.gst.substring(0, 2)) {\r\n                    invData.totalCGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                    invData.totalSGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                    let count = 1;\r\n                    for (let product of orderedProduct.products) {\r\n                        if (!product.isRemoved) {\r\n                            let trData = {\r\n                                sno: count,\r\n                                productName: \"\",\r\n                                color: \"\",\r\n                                sizeSet: \"\",\r\n                                hsnCode: \"\",\r\n                                qty: \"\",\r\n                                rate: \"\",\r\n                                total: \"\",\r\n                                cgstPercentage: \"\",\r\n                                cgstAmount: \"\",\r\n                                sgstPercentage: \"\",\r\n                                sgstAmount: \"\",\r\n                                igstPercentage: \"\",\r\n                                igstAmount: \"\",\r\n                            };\r\n                            count += 1;\r\n                            trData.productName = product.product_id.product_name;\r\n                            trData.color = product.color.colorName;\r\n                            trData.sizeSet = product.lotSize;\r\n                            trData.hsnCode = product.hsnCode;\r\n                            trData.qty = product.qty;\r\n                            trData.rate = product.seller_price;\r\n                            trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                            trData.cgstPercentage = Number(product.seller_gst) / 2;\r\n                            trData.cgstAmount = ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                            trData.sgstPercentage = Number(product.seller_gst) / 2;\r\n                            trData.sgstAmount = ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                            trData.igstPercentage = \"\";\r\n                            trData.igstAmount = \"\";\r\n                            invData.tableRow.push(trData);\r\n                        }\r\n                    }\r\n                } else {\r\n                    invData.totalIGSTAmt = invoice.gstAmount;\r\n                    let count = 1;\r\n                    for (let product of orderedProduct.products) {\r\n                        if (!product.isRemoved) {\r\n                            let trData = {\r\n                                sno: count,\r\n                                productName: \"\",\r\n                                color: \"\",\r\n                                sizeSet: \"\",\r\n                                hsnCode: \"\",\r\n                                qty: \"\",\r\n                                rate: \"\",\r\n                                total: \"\",\r\n                                cgstPercentage: \"\",\r\n                                cgstAmount: \"\",\r\n                                sgstPercentage: \"\",\r\n                                sgstAmount: \"\",\r\n                                igstPercentage: \"\",\r\n                                igstAmount: \"\",\r\n                            };\r\n                            count += 1;\r\n                            trData.productName = product.product_id.product_name;\r\n                            trData.color = product.color.colorName;\r\n                            trData.sizeSet = product.lotSize;\r\n                            trData.hsnCode = product.hsnCode;\r\n                            trData.qty = product.qty;\r\n                            trData.rate = product.seller_price;\r\n                            trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                            trData.cgstPercentage = \"\";\r\n                            trData.cgstAmount = \"\";\r\n                            trData.sgstPercentage = \"\";\r\n                            trData.sgstAmount = \"\";\r\n                            trData.igstPercentage = product.seller_gst;\r\n                            trData.igstAmount = \"\" + ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                            invData.tableRow.push(trData);\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                if (invoice.soldBy.gst.substring(0, 2) === customerAddress.stateCode) {\r\n                    invData.totalCGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                    invData.totalSGSTAmt = \"\" + (Number(invoice.gstAmount) / 2).toFixed(2);\r\n                    let count = 1;\r\n                    for (let product of orderedProduct.products) {\r\n                        if (!product.isRemoved) {\r\n                            let trData = {\r\n                                sno: count,\r\n                                productName: \"\",\r\n                                color: \"\",\r\n                                sizeSet: \"\",\r\n                                hsnCode: \"\",\r\n                                qty: \"\",\r\n                                rate: \"\",\r\n                                total: \"\",\r\n                                cgstPercentage: \"\",\r\n                                cgstAmount: \"\",\r\n                                sgstPercentage: \"\",\r\n                                sgstAmount: \"\",\r\n                                igstPercentage: \"\",\r\n                                igstAmount: \"\",\r\n                            };\r\n                            count += 1;\r\n                            trData.productName = product.product_id.product_name;\r\n                            trData.color = product.color.colorName;\r\n                            trData.sizeSet = product.lotSize;\r\n                            trData.hsnCode = product.hsnCode;\r\n                            trData.qty = product.qty;\r\n                            trData.rate = Number(product.seller_price) + (Number(product.seller_price) * Number(product.margin)) / 100;\r\n                            trData.total = (Number(trData.rate) * Number(product.qty)).toFixed(2);\r\n                            trData.cgstPercentage = Number(product.selling_gst) / 2;\r\n                            let mrginAmt = Number(product.seller_price) * Number(product.qty) + (Number(product.seller_price) * Number(product.qty) * Number(product.margin)) / 100;\r\n                            trData.cgstAmount = ((mrginAmt * Number(product.selling_gst)) / 100).toFixed(2);\r\n                            trData.sgstPercentage = Number(product.selling_gst) / 2;\r\n                            trData.sgstAmount = ((mrginAmt * Number(product.selling_gst)) / 100).toFixed(2);\r\n                            trData.igstPercentage = \"\";\r\n                            trData.igstAmount = \"\";\r\n                            invData.tableRow.push(trData);\r\n                        }\r\n                    }\r\n                } else {\r\n                    invData.totalIGSTAmt = invoice.gstAmount;\r\n                    let count = 1;\r\n                    for (let product of orderedProduct.products) {\r\n                        if (!product.isRemoved) {\r\n                            let trData = {\r\n                                sno: count,\r\n                                productName: \"\",\r\n                                color: \"\",\r\n                                sizeSet: \"\",\r\n                                hsnCode: \"\",\r\n                                qty: \"\",\r\n                                rate: \"\",\r\n                                total: \"\",\r\n                                cgstPercentage: \"\",\r\n                                cgstAmount: \"\",\r\n                                sgstPercentage: \"\",\r\n                                sgstAmount: \"\",\r\n                                igstPercentage: \"\",\r\n                                igstAmount: \"\",\r\n                            };\r\n                            count += 1;\r\n                            trData.productName = product.product_id.product_name;\r\n                            trData.color = product.color.colorName;\r\n                            trData.sizeSet = product.lotSize;\r\n                            trData.hsnCode = product.hsnCode;\r\n                            trData.qty = product.qty;\r\n                            trData.rate = product.seller_price;\r\n                            trData.total = (Number(product.seller_price) * Number(product.qty)).toFixed(2);\r\n                            trData.cgstPercentage = \"\";\r\n                            trData.cgstAmount = \"\";\r\n                            trData.sgstPercentage = \"\";\r\n                            trData.sgstAmount = \"\";\r\n                            trData.igstPercentage = product.seller_gst;\r\n                            trData.igstAmount = \"\" + ((Number(product.seller_price) * Number(product.qty) * Number(product.seller_gst)) / 100).toFixed(2);\r\n                            invData.tableRow.push(trData);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (invoice.order_id.discounted_amount) {\r\n                invData.discountAmt = \"\" + invoice.order_id.discounted_amount;\r\n                invData.netPayableAmount = Number(invoice.gstAmount) + Number(invoice.totalAmount) - Number(invoice.order_id.discounted_amount);\r\n            } else {\r\n                invData.discountAmt = 0;\r\n                invData.netPayableAmount = invData.grossTotalAmt;\r\n            }\r\n            let pdf = await generatePdf(invData, \"factorEz.com\");\r\n\r\n            res.setHeader(\"Content-Type\", \"application/pdf\");\r\n            res.setHeader(\"Content-Disposition\", \"attachment; invoice.pdf\");\r\n            return res.send(pdf);\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { generatePurchaseInvoice, generateSaleInvoice, getAllSaleInvoice, getAllPurchaseInvoice, downoadInvoiceByInvoiceNumber };\r\n","const orderModel = require(\"../models/orderModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst customerAddressModel = require(\"../models/customerAddressModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst paymentModel = require(\"../models/paymentModel\");\r\nconst cancelledReasonModel = require(\"../models/cancelledReasonModel\");\r\n\r\nconst { generateRandomID, generateRandomAlphaNumericID } = require(\"../controllers/idGeneratorController\");\r\n\r\nconst orderedProductModel = require(\"../models/orderedProductModel\");\r\nconst orderStatusTableModel = require(\"../models/orderStatusTableModel\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\nconst couponCodeModel = require(\"../models/couponCodeModel\");\r\nconst { createPayment } = require(\"./paymentController\");\r\nconst { generatePurchaseInvoice, generateSaleInvoice } = require(\"./invoiceController\");\r\nconst { isExpiryCoupon } = require(\"../utils/couponExpireUtil\");\r\n// CREATE ORDER\r\nconst createOrder = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let data = req.body;\r\n\r\n        let { address_id, payment_mode, couponCode, paymentAmt, transaction_id } = data;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id request\" });\r\n        }\r\n        if (!isValidObjectId(address_id)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Address id request\" });\r\n        }\r\n\r\n        if (!payment_mode) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (payment_mode !== \"CUSTOM\" && payment_mode !== \"TWENTY_ADV\" && payment_mode !== \"PREPAID\" && payment_mode !== \"COD\") {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        if ((payment_mode === \"CUSTOM\" || payment_mode === \"TWENTY_ADV\" || payment_mode === \"PREPAID\") && !transaction_id) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        let customer = await customerModel.findById(customerId);\r\n        let address = await customerAddressModel.findById(address_id);\r\n        if (!customer || !address) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let cart = await cartModel.findOne({ customer_id: customerId }).populate({\r\n            path: \"products.product_id\",\r\n            model: \"Product\",\r\n        });\r\n\r\n        let demoObj = {};\r\n        let coupon = null;\r\n        if (couponCode) {\r\n            coupon = await couponCodeModel.findOne({\r\n                couponCode: couponCode,\r\n                isDeleted: false,\r\n                isExpired: false,\r\n            });\r\n            if (!coupon) {\r\n                return res.status(400).send({ status: false, message: \"Invalid Coupon Code\" });\r\n            }\r\n            if (coupon && isExpiryCoupon(coupon.validTill)) {\r\n                coupon.isExpired = true;\r\n                await coupon.save();\r\n                return res.status(400).send({ status: false, message: \"Coupon Code Expired\" });\r\n            }\r\n            if (coupon.customer_id.includes(customerId)) {\r\n                return res.status(200).send({ status: false, message: \"Coupon Already applied\" });\r\n            }\r\n        }\r\n\r\n        if (!cart) {\r\n            return res.status(400).send({ status: false, message: \"Bad Request\" });\r\n        }\r\n        let orderAmt = 0;\r\n        for (let product of cart.products) {\r\n            let mAmt = product.product_id.seller_price + (product.product_id.margin * product.product_id.seller_price) / 100;\r\n            let totalamt = mAmt + (mAmt * product.product_id.sellingGST) / 100;\r\n            orderAmt += product.qty * totalamt;\r\n            let key = product.product_id.vendor_id.toString();\r\n            if (key in demoObj) {\r\n                demoObj[key].push(product);\r\n            } else {\r\n                demoObj[key] = [product];\r\n            }\r\n        }\r\n        if (coupon && coupon.minOrderAmt > orderAmt) {\r\n            return res.status(200).send({ status: false, message: `Coupon not applied, minimum order should be ${coupon.minOrderAmt}` });\r\n        }\r\n        let orders = [];\r\n        let grandTotal = 0;\r\n        for (let vendor of Object.keys(demoObj)) {\r\n            let orderedProduct = null;\r\n            let vendorAmtInfo = {\r\n                grandTotal: 0,\r\n                gstAmt: 0,\r\n                total: 0,\r\n            };\r\n            let total = 0;\r\n            let GST_amount = 0;\r\n            for (let p of demoObj[vendor]) {\r\n                let x = {\r\n                    product_id: \"\",\r\n                    vendor_id: \"\",\r\n                    mrp: \"\",\r\n                    seller_price: \"\",\r\n                    seller_gst: \"\",\r\n                    selling_price: \"\",\r\n                    selling_gst: \"\",\r\n                    margin: \"\",\r\n                    lotSize: \"\",\r\n                    color: {\r\n                        colorName: \"\",\r\n                        colorHex: \"\",\r\n                    },\r\n                    hsnCode: \"\",\r\n                    skuCode: \"\",\r\n                    qty: \"\",\r\n                    addedAt: \"\",\r\n                };\r\n                x.product_id = p.product_id._id;\r\n                x.vendor_id = vendor;\r\n                x.mrp = p.product_id.mrp;\r\n                x.seller_price = p.product_id.seller_price;\r\n                x.seller_gst = p.product_id.gst;\r\n                let marginAmt = (Number(p.product_id.seller_price) * Number(p.product_id.margin)) / 100;\r\n                let sellingGstAmt = ((Number(p.product_id.seller_price) + marginAmt) * Number(p.product_id.sellingGST)) / 100;\r\n                x.selling_price = (Number(p.product_id.seller_price) + marginAmt + sellingGstAmt).toFixed(2);\r\n                x.selling_gst = p.product_id.sellingGST;\r\n                x.lotSize = p.lotSize;\r\n                x.color = {\r\n                    colorName: p.color.colorName,\r\n                    colorHex: p.color.colorHex,\r\n                };\r\n                x.hsnCode = p.product_id.hsn_code;\r\n                x.skuCode = p.product_id.sku_code;\r\n                x.margin = p.product_id.margin;\r\n                x.qty = p.qty;\r\n                x.lotSize = p.lotSize;\r\n                x.addedAt = p.addedAt;\r\n                let currentTotal = (Number(p.product_id.seller_price) + marginAmt) * Number(p.qty);\r\n                total += Number(currentTotal);\r\n                GST_amount += sellingGstAmt * Number(p.qty);\r\n\r\n                let vdrAmt = Number(p.product_id.seller_price) * Number(p.qty);\r\n                let vdrGstAmt = (vdrAmt * Number(p.product_id.gst)) / 100;\r\n                vendorAmtInfo.grandTotal += vdrAmt + vdrGstAmt;\r\n                vendorAmtInfo.gstAmt += vdrGstAmt;\r\n                vendorAmtInfo.total += vdrAmt;\r\n\r\n                if (orderedProduct === null) {\r\n                    orderedProduct = await orderedProductModel.create({\r\n                        products: [x],\r\n                    });\r\n                } else {\r\n                    orderedProduct.products.push(x);\r\n                }\r\n            }\r\n            await orderedProduct.save();\r\n            let odrObj = {\r\n                orderId: generateRandomID(10, \"FZ\"),\r\n                vendorId: vendor,\r\n                order_date: new Date(),\r\n                ordered_products: orderedProduct,\r\n                customer_id: customerId,\r\n                address_id: address_id,\r\n                GST_amount: GST_amount.toFixed(2),\r\n                total: total.toFixed(2),\r\n                grand_total: (Number(GST_amount) + Number(total)).toFixed(2),\r\n                vendorAmtInfo: vendorAmtInfo,\r\n            };\r\n            if (coupon !== null) {\r\n                odrObj.couponCode = coupon._id;\r\n            }\r\n            grandTotal += Number(total) + Number(GST_amount);\r\n            let addedOrder = await orderModel.create(odrObj);\r\n            let status = await orderStatusTableModel.create({\r\n                order_id: addedOrder._id,\r\n            });\r\n            addedOrder.order_status_id = status;\r\n            await addedOrder.save();\r\n            orderedProduct.order_id = addedOrder._id;\r\n            await orderedProduct.save();\r\n            orders.push(addedOrder);\r\n        }\r\n        cart.products = [];\r\n        await cart.save();\r\n        if (coupon !== null && coupon.maxDiscPrice < grandTotal) {\r\n            let maxDiscount = 0;\r\n            if (coupon.discountType === \"PERCENTAGE\") {\r\n                let discAmt = (Number(grandTotal) * Number(coupon.discountAmt)) / 100;\r\n                if (discAmt > coupon.maxDiscPrice) {\r\n                    maxDiscount = coupon.maxDiscPrice;\r\n                } else {\r\n                    maxDiscount = discAmt;\r\n                }\r\n            } else if (coupon.discountType === \"PRICE\") {\r\n                maxDiscount = coupon.discountAmt;\r\n            }\r\n\r\n            if (payment_mode === \"PREPAID\" && Number(paymentAmt) < Number(grandTotal) - Number(maxDiscount)) {\r\n                return res.status(400).send({ status: false, message: \"payment should be equal to grand total amount\" });\r\n            }\r\n\r\n            for (let singleOrder of orders) {\r\n                let percentage = Number(((Number(singleOrder.grand_total) * 100) / Number(grandTotal)).toFixed(2));\r\n                let discountAmt = Number(((Number(maxDiscount) * Number(percentage)) / 100).toFixed(2));\r\n                let partPayment = 0;\r\n                if (payment_mode === \"CUSTOM\" || payment_mode === \"TWENTY_ADV\") {\r\n                    partPayment = Number(((Number(paymentAmt) * Number(percentage)) / 100).toFixed(2));\r\n                }\r\n                if (payment_mode === \"PREPAID\") {\r\n                    partPayment = Number(singleOrder.grand_total) - Number(discountAmt);\r\n                }\r\n                singleOrder.discounted_amount = discountAmt;\r\n                let payment = await createPayment(\r\n                    singleOrder.order_status_id.status,\r\n                    payment_mode,\r\n                    singleOrder.orderId,\r\n                    singleOrder._id,\r\n                    singleOrder.grand_total,\r\n                    discountAmt,\r\n                    partPayment,\r\n                    customerId,\r\n                    transaction_id\r\n                );\r\n                if (payment.status) {\r\n                    singleOrder.payment_id = payment.paymentId;\r\n                } else {\r\n                    return res.status(400).send({ status: false, message: \"Bad request\" });\r\n                }\r\n                singleOrder.shipping_address = {\r\n                    stateCode: address.stateCode,\r\n                    state: address.state,\r\n                    address: address.address,\r\n                };\r\n                await singleOrder.save();\r\n                customer.orders.push(singleOrder._id);\r\n            }\r\n            coupon.customer_id.push(customerId);\r\n            await coupon.save();\r\n            await customer.save();\r\n        } else {\r\n            for (let singleOrder of orders) {\r\n                let percentage = Number(((Number(singleOrder.grand_total) * 100) / Number(grandTotal)).toFixed(2));\r\n                let discountAmt = 0;\r\n                let partPayment = 0;\r\n                if (payment_mode === \"CUSTOM\" || payment_mode === \"TWENTY_ADV\") {\r\n                    partPayment = Number(((paymentAmt * percentage) / 100).toFixed(2));\r\n                }\r\n                if (payment_mode === \"PREPAID\") {\r\n                    partPayment = Number(singleOrder.grand_total) - Number(discountAmt);\r\n                }\r\n                let payment = await createPayment(\r\n                    singleOrder.order_status_id.status,\r\n                    payment_mode,\r\n                    singleOrder.orderId,\r\n                    singleOrder._id,\r\n                    singleOrder.grand_total,\r\n                    discountAmt,\r\n                    partPayment,\r\n                    customerId,\r\n                    transaction_id\r\n                );\r\n                if (payment.status) {\r\n                    singleOrder.payment_id = payment.paymentId;\r\n                } else {\r\n                    return res.status(400).send({ status: false, message: \"Bad request\" });\r\n                }\r\n                singleOrder.shipping_address = {\r\n                    stateCode: address.stateCode,\r\n                    state: address.state,\r\n                    address: address.address,\r\n                };\r\n                await singleOrder.save();\r\n                customer.orders.push(singleOrder._id);\r\n            }\r\n            await customer.save();\r\n        }\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Order Created Successfully\",\r\n            data: \"orders\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL ORDERS\r\nconst getAllOrders = async (req, res) => {\r\n    try {\r\n        let orders = null;\r\n        if (req.userModel === \"VENDOR\") {\r\n            orders = await orderModel\r\n                .find({ vendorId: req.userId })\r\n                .populate([\"vendorId\", \"order_status_id\", \"ordered_products\", \"purchaseInvoice\"])\r\n                .select([\"-shipping_address\", \"-couponCode\", \"-customer_id\"])\r\n                .sort({ createdAt: -1 });\r\n            // .populate({ path: \"ordered_products\", model: \"Ordered_Product\", populate: { path: \"products.product_id\", model: \"Product\" } });\r\n        } else {\r\n            orders = await orderModel\r\n                .find()\r\n                .populate([\r\n                    \"vendorId\",\r\n                    \"payment_id\",\r\n                    \"order_status_id\",\r\n                    \"ordered_products\",\r\n                    \"purchaseInvoice\",\r\n                    \"saleInvoice\",\r\n                    { path: \"CouponCode\", strictPopulate: false },\r\n                    { path: \"customer_id\", model: \"Customer\", populate: { path: \"defaultAddress\", model: \"CustomerAddress\" } },\r\n                ])\r\n                .sort({ createdAt: -1 });\r\n            // .select(\"-vendorAmtInfo\")\r\n            // .populate({\r\n            //     path: \"ordered_products\",\r\n            //     model: \"Ordered_Product\",\r\n            //     populate: { path: \"products.product_id\", model: \"Product\", populate: { path: \"product_id.brandId\", model: \"Brand\" } },\r\n            // });\r\n        }\r\n        return res.status(200).send({ status: true, data: orders });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ORDER BY ORDER ID\r\nconst getOrderByOrderId = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        let customerId = req.params.customerId;\r\n        if (!isValidObjectId(customerId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Customer id\" });\r\n        }\r\n        let order = await orderModel\r\n            .findOne({ customer_id: customerId, orderId: orderId })\r\n            .populate([\r\n                \"payment_id\",\r\n                \"order_status_id\",\r\n                { path: \"ordered_products\", model: \"Ordered_Product\", populate: { path: \"products.product_id\", model: \"Product\" } },\r\n                \"saleInvoice\",\r\n                { path: \"CouponCode\", strictPopulate: false },\r\n            ])\r\n            .select(\"-purchaseInvoice\");\r\n        if (!order) {\r\n            return res.status(404).send({ status: false, message: \"Order not found\" });\r\n        }\r\n        return res.status(200).send({ status: true, data: order });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL ORDERS OF A CUSTOMER\r\nconst getOrdersByCustomerId = async (req, res) => {\r\n    try {\r\n        let customerId = req.params.customerId;\r\n        let customerOrders = await orderModel.find({ customer_id: customerId }).populate([\"vendorId\", \"customer_id\", \"payment_id\", \"order_status_id\", \"ordered_products\"]);\r\n\r\n        return res.status(200).send({ status: true, data: customerOrders });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// CANCEL ORDER BY ORDER ID\r\nconst cancelOrderByOrderId = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        if (!isValidObjectId(orderId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Order Id\" });\r\n        }\r\n\r\n        let order = await orderModel.findOne({ _id: orderId });\r\n\r\n        if (!order) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order not found with this order id\",\r\n            });\r\n        }\r\n\r\n        let data = req.body;\r\n\r\n        let { Status } = data;\r\n\r\n        if (order.Status === \"Cancelled\") {\r\n            return res.status(400).send({ status: false, message: \"Order is already cancelled\" });\r\n        }\r\n\r\n        let orderStatus = await orderModel.findOneAndUpdate({ _id: orderId }, { $set: { Status: \"Cancelled\" } }, { new: true });\r\n\r\n        await order.save();\r\n\r\n        return res.status(202).send({ status: true, message: \"Order Cancelled Successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE ORDER BY ORDER ID\r\nconst updateOrderByOrderId = async (req, res) => {\r\n    try {\r\n        //CONFIRM, PARTIAL, CANCEL\r\n        let orderId = req.params.orderId;\r\n        let { orderType, cancelMessage, questionId, removedProductIds } = req.body;\r\n        if (!orderType || !orderId) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let order = await orderModel.findOne({ orderId: orderId }).populate([\"ordered_products\", \"order_status_id\"]);\r\n        if (!order) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        if (order.order_status_id.status !== \"PENDING\" && req.userModel === \"VENDOR\") {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        let payment = await paymentModel.findById(order.payment_id._id);\r\n        if (!payment) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n\r\n        if (orderType === \"PARTIAL_CONFIRMED\") {\r\n            let orderedProduct = order.ordered_products;\r\n            let partialCanceledAmt = 0;\r\n            let partialCanceledGstAmt = 0;\r\n            let orderedProductAmtInfo = {\r\n                productQty: 0,\r\n                total: 0,\r\n                GST_amount: 0,\r\n                grand_total: 0,\r\n            };\r\n            let orderedAmtInfo = {\r\n                grand_total: 0,\r\n                total: 0,\r\n                GST_amount: 0,\r\n                discounted_amount: 0,\r\n            };\r\n            for (let s_product of orderedProduct.products) {\r\n                if (s_product.isRemoved === false && removedProductIds.includes(s_product._id.toString())) {\r\n                    s_product.isRemoved = true;\r\n                    let canceledAmt = Number(s_product.seller_price) * Number(s_product.qty);\r\n                    partialCanceledAmt += canceledAmt;\r\n                    partialCanceledGstAmt += Number(((canceledAmt * Number(s_product.seller_gst)) / 100).toFixed(2));\r\n                    let adminCancelledAmt = canceledAmt + (canceledAmt * s_product.margin) / 100;\r\n                    orderedProductAmtInfo.productQty += 1;\r\n                    orderedProductAmtInfo.total += Number(adminCancelledAmt.toFixed(2));\r\n                    orderedProductAmtInfo.GST_amount += Number(((adminCancelledAmt * s_product.selling_gst) / 100).toFixed(2));\r\n                    orderedProductAmtInfo.grand_total += adminCancelledAmt + Number(((adminCancelledAmt * s_product.selling_gst) / 100).toFixed(2));\r\n                }\r\n            }\r\n            order.order_status_id.status = orderType;\r\n            payment.order_status = \"PARTIAL_CONFIRMED\";\r\n            let updatedByObj = {};\r\n            if (req.userModel === \"VENDOR\") {\r\n                updatedByObj.vendor = req.userId;\r\n            } else if (req.userModel === \"ADMIN\") {\r\n                updatedByObj.admin = req.userId;\r\n            }\r\n            let statusObj = {\r\n                status: orderType,\r\n                updatedBy: updatedByObj,\r\n                updatedAt: new Date(),\r\n                description: cancelMessage,\r\n            };\r\n            order.order_status_id.statusList.push(statusObj);\r\n            order.vendorAmtInfo.gstAmt -= partialCanceledGstAmt;\r\n            order.vendorAmtInfo.total -= partialCanceledAmt;\r\n            order.vendorAmtInfo.grandTotal -= partialCanceledGstAmt + partialCanceledAmt;\r\n            orderedAmtInfo.GST_amount = order.GST_amount;\r\n            orderedAmtInfo.total = order.total;\r\n            orderedAmtInfo.grand_total = order.grand_total;\r\n            order.GST_amount -= orderedProductAmtInfo.GST_amount;\r\n            order.total -= orderedProductAmtInfo.total;\r\n            order.grand_total -= orderedProductAmtInfo.grand_total;\r\n            order.partialCancelOrderInfo = {\r\n                orderedAmtInfo,\r\n                orderedProductAmtInfo,\r\n            };\r\n            await orderedProduct.save();\r\n            await order.order_status_id.save();\r\n            let purchaseGstAmount = 0;\r\n            let purchaseTotalAmount = 0;\r\n            for (let singleOrderProduct of order.ordered_products.products) {\r\n                purchaseGstAmount += (singleOrderProduct.seller_price * singleOrderProduct.qty * singleOrderProduct.seller_gst) / 100;\r\n                purchaseTotalAmount += singleOrderProduct.seller_price * singleOrderProduct.qty;\r\n            }\r\n\r\n            let invDataPurchase = {\r\n                vendor_id: order.vendorId,\r\n                order_id: order._id,\r\n                gstAmount: purchaseGstAmount,\r\n                totalAmount: purchaseTotalAmount,\r\n            };\r\n            let invDataSale = {\r\n                customer_id: order.customer_id,\r\n                order_id: order._id,\r\n                gstAmount: order.GST_amount,\r\n                totalAmount: order.total,\r\n                address: order.shipping_address,\r\n            };\r\n            if ((payment.payment_mode === \"CUSTOM\" || payment.payment_mode === \"TWENTY_ADV\") && payment.partial_payment.payment_amount >= Number(order.grand_total) - Number(order.discounted_amount)) {\r\n                payment.return_amount = (Number(payment.partial_payment.payment_amount) - (Number(order.grand_total) - Number(order.discounted_amount))).toFixed(2);\r\n                payment.balance_amount = 0;\r\n            } else if ((payment.payment_mode === \"CUSTOM\" || payment.payment_mode === \"TWENTY_ADV\") && payment.partial_payment.payment_amount < order.grand_total) {\r\n                payment.return_amount = 0;\r\n                let x = Number(order.grand_total) - Number(order.discounted_amount);\r\n                payment.balance_amount = x - Number(payment.partial_payment.payment_amount).toFixed(2);\r\n            } else if (payment.payment_mode === \"PREPAID\" && payment.payment_amount >= Number(order.grand_total) - Number(order.discounted_amount)) {\r\n                payment.return_amount = (Number(payment.payment_amount) - (Number(order.grand_total) - Number(order.discounted_amount))).toFixed(2);\r\n                payment.balance_amount = 0;\r\n            } else if (payment.payment_mode === \"COD\") {\r\n                payment.return_amount = 0;\r\n                payment.balance_amount = Number(order.grand_total) - Number(order.discounted_amount);\r\n            }\r\n            payment.order_amount = order.grand_total;\r\n            let resData = await generatePurchaseInvoice(invDataPurchase);\r\n            let resData2 = await generateSaleInvoice(invDataSale);\r\n            if (resData.status) {\r\n                order.purchaseInvoice = resData.invoice._id;\r\n            }\r\n            if (resData2.status) {\r\n                order.saleInvoice = resData2.invoice._id;\r\n            }\r\n        }\r\n        if (orderType === \"CANCEL\") {\r\n            order.order_status_id.status = \"CANCELLED\";\r\n            payment.order_status = \"CANCELLED\";\r\n            let updatedByObj = {};\r\n            if (req.userModel === \"VENDOR\") {\r\n                updatedByObj.vendor = req.userId;\r\n            } else if (req.userModel === \"ADMIN\") {\r\n                updatedByObj.admin = req.userId;\r\n            } else {\r\n                updatedByObj.customer = req.userId;\r\n            }\r\n            order.order_status_id.cancelled.userId = updatedByObj;\r\n            order.order_status_id.cancelled.question = questionId;\r\n            order.order_status_id.cancelled.description = cancelMessage;\r\n            order.order_status_id.cancelledStatus = \"CANCELLED\";\r\n            let objOfCancelledStatusList = {\r\n                status: \"CANCELLED\",\r\n                updatedBy: updatedByObj,\r\n                updatedAt: new Date(),\r\n            };\r\n            order.order_status_id.cancelledStatusList.push(objOfCancelledStatusList);\r\n            if (payment.payment_mode === \"CUSTOM\" || payment.payment_mode === \"PREPAID\" || payment.payment_mode === \"TWENTY_ADV\") {\r\n                if (payment.payment_mode === \"CUSTOM\") {\r\n                    payment.return_amount = Number(payment.partial_payment.payment_amount) + Number(payment.cod_received);\r\n                    payment.balance_amount = 0;\r\n                } else if (payment.payment_mode === \"PREPAID\") {\r\n                    payment.return_amount = payment.payment_amount;\r\n                    payment.balance_amount = 0;\r\n                } else if (payment.payment_mode === \"TWENTY_ADV\") {\r\n                    payment.return_amount = payment.partial_payment.payment_amount + Number(payment.cod_received);\r\n                    payment.balance_amount = 0;\r\n                }\r\n            } else if (payment.payment_mode === \"COD\") {\r\n                payment.return_amount = Number(payment.cod_received);\r\n                payment.balance_amount = 0;\r\n            }\r\n            await order.order_status_id.save();\r\n        }\r\n        if (orderType === \"CONFIRMED\") {\r\n            order.order_status_id.status = orderType;\r\n            payment.order_status = \"CONFIRMED\";\r\n            let updatedByObj = {};\r\n            if (req.userModel === \"VENDOR\") {\r\n                updatedByObj.vendor = req.userId;\r\n            } else if (req.userModel === \"ADMIN\") {\r\n                updatedByObj.admin = req.userId;\r\n            }\r\n            let statusObj = {\r\n                status: orderType,\r\n                updatedBy: updatedByObj,\r\n                updatedAt: new Date(),\r\n            };\r\n            order.order_status_id.statusList.push(statusObj);\r\n            await order.order_status_id.save();\r\n            let purchaseGstAmount = 0;\r\n            let purchaseTotalAmount = 0;\r\n            for (let singleOrderProduct of order.ordered_products.products) {\r\n                purchaseGstAmount += (singleOrderProduct.seller_price * singleOrderProduct.qty * singleOrderProduct.seller_gst) / 100;\r\n                purchaseTotalAmount += singleOrderProduct.seller_price * singleOrderProduct.qty;\r\n            }\r\n\r\n            let invDataPurchase = {\r\n                vendor_id: order.vendorId,\r\n                order_id: order._id,\r\n                gstAmount: purchaseGstAmount,\r\n                totalAmount: purchaseTotalAmount,\r\n            };\r\n            let invDataSale = {\r\n                customer_id: order.customer_id,\r\n                order_id: order._id,\r\n                gstAmount: order.GST_amount,\r\n                totalAmount: order.total,\r\n                address: order.shipping_address,\r\n            };\r\n            let resData = await generatePurchaseInvoice(invDataPurchase);\r\n            let resData2 = await generateSaleInvoice(invDataSale);\r\n            if (resData.status) {\r\n                order.purchaseInvoice = resData.invoice._id;\r\n            } else {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: resData.err,\r\n                });\r\n            }\r\n            if (resData2.status) {\r\n                order.saleInvoice = resData2.invoice._id;\r\n            } else {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: resData2.err,\r\n                });\r\n            }\r\n        }\r\n        await payment.save();\r\n        await order.save();\r\n        return res.status(202).send({\r\n            status: true,\r\n            message: \"Order updated successfully\",\r\n            data: order,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getOrderedProduct = async (req, res) => {\r\n    try {\r\n        let id = req.params.orderedproductid;\r\n        let obj = await orderedProductModel.findById(id).populate(\"products.product_id\");\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"details fetched successfully...\",\r\n            data: obj,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst patchTrackingIdByOrderId = async (req, res) => {\r\n    try {\r\n        let id = req.params.orderId;\r\n        let { t_id } = req.body;\r\n        if (!id || !t_id) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let obj = await orderModel.findOne({ orderId: id }).populate(\"order_status_id\");\r\n        if (!obj) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        if (obj.order_status_id.status === \"PENDING\") {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        obj.tracking_id = t_id;\r\n        await obj.save();\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Tracking ID Updated successfully...\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllCancelledOrder = async (req, res) => {\r\n    try {\r\n        let userModel = req.userModel;\r\n        let userId = req.userId;\r\n        let orders = null;\r\n        if (userModel === \"VENDOR\") {\r\n            orders = await orderModel\r\n                .find({ vendorId: req.userId })\r\n                .populate([\"vendorId\", \"order_status_id\", \"ordered_products\"])\r\n                .select([\"-shipping_address\", \"-couponCode\", \"-customer_id\"])\r\n                .sort({ createdAt: -1 });\r\n        } else {\r\n            orders = await orderModel.find().populate([\"vendorId\", \"customer_id\", \"payment_id\", \"order_status_id\", \"ordered_products\"]).sort({ createdAt: -1 });\r\n        }\r\n\r\n        if (!orders) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        let cancelledOrders = [];\r\n        for (let order of orders) {\r\n            if (order.order_status_id.status === \"CANCELLED\") {\r\n                cancelledOrders.push(order);\r\n            }\r\n        }\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Cancelled orders fetched...\",\r\n            data: cancelledOrders,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    createOrder,\r\n    getAllOrders,\r\n    getOrderByOrderId,\r\n    getOrdersByCustomerId,\r\n    cancelOrderByOrderId,\r\n    updateOrderByOrderId,\r\n    getOrderedProduct,\r\n    patchTrackingIdByOrderId,\r\n    getAllCancelledOrder,\r\n};\r\n","const orderStatusTableModel = require(\"../models/orderStatusTableModel\");\r\nconst orderModel = require(\"../models/orderModel\");\r\nconst cancelledReasonModel = require(\"../models/cancelledReasonModel\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\n\r\n// CREATE ORDER STATUS TABLE\r\nconst createOrderStatusTable = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        if (!isValidObjectId(orderId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid Order Id\" });\r\n        }\r\n\r\n        let order = await orderModel.findOne({ _id: orderId });\r\n\r\n        if (!order) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order not found with this order id\",\r\n            });\r\n        }\r\n\r\n        let data = req.body;\r\n\r\n        let { questions, customerAnswer } = data;\r\n\r\n        let orderStatus = await orderModel.findOneAndUpdate({ _id: orderId }, { $set: { Status: \"Cancelled\" } }, { new: true });\r\n\r\n        await order.save();\r\n\r\n        let cancelledReasonData = {\r\n            questions,\r\n            customerAnswer,\r\n        };\r\n\r\n        let newCancelledReason = await cancelledReasonModel.create(cancelledReasonData);\r\n\r\n        let cancelledObj = {\r\n            cancelledBy: req.body.cancelledBy,\r\n            userId: req.body.userId,\r\n            reason: newCancelledReason._id,\r\n        };\r\n\r\n        let orderStatusTableData = await orderStatusTableModel.create({\r\n            order_id: order._id,\r\n            status: \"Cancelled\",\r\n            isCompleted: false,\r\n            cancelled: cancelledObj,\r\n        });\r\n\r\n        return res.status(201).send({\r\n            status: true,\r\n            message: \"Success\",\r\n            data: {\r\n                OrderStatusTableData: orderStatusTableData,\r\n                cancelledReasonData: newCancelledReason,\r\n            },\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL ORDER STATUS TABLES\r\nconst getAllOrderStatusTables = async (req, res) => {\r\n    try {\r\n        let allOrderStatusTables = await orderStatusTableModel.find();\r\n        return res.status(200).send({ status: true, data: allOrderStatusTables });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ORDER STATUS TABLE BY ID\r\nconst getOrderStatusTableById = async (req, res) => {\r\n    try {\r\n        let orderStatusTableId = req.params.orderStatusTableId;\r\n\r\n        if (!isValidObjectId(orderStatusTableId)) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Invalid order status table id\",\r\n            });\r\n        }\r\n\r\n        let orderStatusTable = await orderStatusTableModel.findOne({\r\n            _id: orderStatusTableId,\r\n        });\r\n\r\n        if (!orderStatusTable) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order Status Table not found\",\r\n            });\r\n        }\r\n\r\n        return res.status(200).send({ status: true, data: orderStatusTable });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE ORDER STATUS TABLE BY ORDER ID\r\nconst updateOrderStatusByOrderId = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        let { status } = req.body;\r\n        if (!isValidObjectId(orderId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid order id\" });\r\n        }\r\n\r\n        let orderStatusTable = await orderStatusTableModel.findOne({\r\n            order_id: orderId,\r\n        });\r\n\r\n        if (!orderStatusTable) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order status table not found\",\r\n            });\r\n        }\r\n        if (!status) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        orderStatusTable.status = status;\r\n\r\n        let updatedByObj = {};\r\n        if (req.userModel === \"VENDOR\") {\r\n            updatedByObj.vendor = req.userId;\r\n        } else if (req.userModel === \"ADMIN\") {\r\n            updatedByObj.admin = req.userId;\r\n        }\r\n        let statusObj = {\r\n            status: status,\r\n            updatedBy: updatedByObj,\r\n            updatedAt: new Date(),\r\n        };\r\n        orderStatusTable.statusList.push(statusObj);\r\n        await orderStatusTable.save();\r\n        return res.status(202).send({ status: true, message: \"Success\", data: orderStatusTable });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst bulkOrderProcess = async (req, res) => {\r\n    try {\r\n        let { status, orderIds } = req.body;\r\n        // let const records = await Model.find({ '_id': { $in: ids } });\r\n\r\n        let orderStatusTables = await orderStatusTableModel.find({ order_id: { $in: orderIds } });\r\n        let updatedByObj = {};\r\n        if (req.userModel === \"VENDOR\") {\r\n            updatedByObj.vendor = req.userId;\r\n        } else if (req.userModel === \"ADMIN\") {\r\n            updatedByObj.admin = req.userId;\r\n        }\r\n        let statusObj = {\r\n            status: status,\r\n            updatedBy: updatedByObj,\r\n            updatedAt: new Date(),\r\n        };\r\n        for await (let orderStatusTable of orderStatusTables) {\r\n            if (orderStatusTable.status !== \"CANCELLED\" && orderStatusTable.status !== \"PENDING\") {\r\n                orderStatusTable.status = status;\r\n                orderStatusTable.statusList.push(statusObj);\r\n                await orderStatusTable.save();\r\n            }\r\n        }\r\n        return res.status(202).send({ status: true, message: \"Orders Processed\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst cancelOrderReturnById = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        let { status } = req.body;\r\n        if (!isValidObjectId(orderId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid order id\" });\r\n        }\r\n\r\n        let orderStatusTable = await orderStatusTableModel.findOne({\r\n            order_id: orderId,\r\n        });\r\n\r\n        if (!orderStatusTable) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Order status table not found\",\r\n            });\r\n        }\r\n        if (!status) {\r\n            return res.status(400).send({ status: false, message: \"Bad request\" });\r\n        }\r\n        orderStatusTable.cancelledStatus = status;\r\n        let updatedByObj = {};\r\n        if (req.userModel === \"VENDOR\") {\r\n            updatedByObj.vendor = req.userId;\r\n        } else if (req.userModel === \"ADMIN\") {\r\n            updatedByObj.admin = req.userId;\r\n        } else {\r\n            updatedByObj.customer = req.userId;\r\n        }\r\n        let objOfCancelledStatusList = {\r\n            status: status,\r\n            updatedBy: updatedByObj,\r\n            updatedAt: new Date(),\r\n        };\r\n        orderStatusTable.cancelledStatusList.push(objOfCancelledStatusList);\r\n        await orderStatusTable.save();\r\n        return res.status(202).send({ status: true, message: \"Return Status Updated\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    createOrderStatusTable,\r\n    getAllOrderStatusTables,\r\n    getOrderStatusTableById,\r\n    updateOrderStatusByOrderId,\r\n    bulkOrderProcess,\r\n    cancelOrderReturnById\r\n};\r\n","const jwt = require(\"jsonwebtoken\");\r\nconst { twilioAccSID, twilioAuthToken, twilioVerifySID, tokenSecretKey, customerTokenSecretKey } = require(\"../middlewares/config\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst accountSid = twilioAccSID;\r\nconst authToken = twilioAuthToken;\r\nconst verifySid = twilioVerifySID;\r\nconst client = require(\"twilio\")(accountSid, authToken);\r\n\r\nconst sendOTP = async (req, res) => {\r\n    try {\r\n        let phone = req.params.phone;\r\n        // console.log(req.params);\r\n        if (!phone) {\r\n            return res.status(400).send({ status: false, message: \"phone number are required\" });\r\n        }\r\n        // console.log(phone);\r\n        let isSent = false;\r\n        await client.verify.v2\r\n            .services(verifySid)\r\n            .verifications.create({ to: `+91${phone}`, channel: \"sms\" })\r\n            .then((verification) => {\r\n                isSent = true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(err);\r\n            });\r\n        if (isSent) {\r\n            return res.status(200).send({ status: true, message: \"OTP send successfully\" });\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"Otp not send\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst createAccountAndToken = async (phone) => {\r\n    try {\r\n        let customer = await customerModel.findOne({ phone: phone, isDeleted: false });\r\n\r\n        if (!customer) {\r\n            customer = await customerModel.create({ phone });\r\n        }\r\n        if (customer.isBlocked) {\r\n            return { statusCode: 403, status: false, message: \"This account has been blocked\" };\r\n        }\r\n        if (!customer.isActivated) {\r\n            return { statusCode: 200, status: true, isActivated: false, data: { customerId: customer._id }, message: \"Account is not active, Please fill your information\" };\r\n        }\r\n        let data = {\r\n            name: customer.name,\r\n            email: customer.email,\r\n            userType: \"CUSTOMER\",\r\n            customerId: customer._id.toString(),\r\n            phone: customer.phone,\r\n            isActivated: customer.isActivated,\r\n        };\r\n        if (customer.profileUrl) data.photo = customer.profileUrl;\r\n        if (customer.alternate_phone) data.altMobileNo = customer.alternate_phone;\r\n\r\n        let date = Date.now();\r\n        let issueTime = Math.floor(date / 1000);\r\n        let token = jwt.sign(\r\n            {\r\n                userId: customer._id.toString(),\r\n                phone: customer.phone,\r\n                userModel: \"CUSTOMER\",\r\n                iat: issueTime,\r\n            },\r\n            customerTokenSecretKey,\r\n            { expiresIn: \"24h\" }\r\n        );\r\n        data.token = token;\r\n        return { statusCode: 200, status: true, message: \"Login successfully\", data: data };\r\n    } catch (error) {\r\n        return { statusCode: 500, status: false, message: \"something went wrong\" };\r\n    }\r\n};\r\n\r\nconst updatePassword = async (phone, password) => {\r\n    try {\r\n        let customer = await customerModel.findOne({ phone: phone, isDeleted: false });\r\n        if (!customer) {\r\n            customer = await customerModel.create({ phone });\r\n        }\r\n        if (customer.isBlocked) {\r\n            return { statusCode: 403, status: false, message: \"This account has been blocked\" };\r\n        }\r\n        if (!customer.isActivated) {\r\n            return { statusCode: 200, status: true, isActivated: false, data: { customerId: customer._id }, message: \"Account is not active, Please fill your information\" };\r\n        }\r\n        let hashedPassword = await bcrypt.hash(password, 10);\r\n        customer.password = hashedPassword;\r\n\r\n        await customer.save();\r\n        return { statusCode: 200, status: true, message: \"Password updated successfully\" };\r\n    } catch (error) {\r\n        return { statusCode: 500, status: false, message: \"something went wrong\" };\r\n    }\r\n};\r\n\r\nconst verityOTP = async (req, res) => {\r\n    try {\r\n        let phone = req.params.phone;\r\n        let otpCode = req.params.otpCode;\r\n        if (!phone || !otpCode) {\r\n            return res.status(400).send({ status: false, message: \"phone number and otp are required\" });\r\n        }\r\n        let isValid = false;\r\n        await client.verify.v2\r\n            .services(verifySid)\r\n            .verificationChecks.create({ to: `+91${phone}`, code: otpCode })\r\n            .then((verification_check) => {\r\n                // console.log(\"verification_check.status\", verification_check.status);\r\n                // console.log(\"verification_check\", verification_check);\r\n                if (verification_check.status === \"approved\" || verification_check.valid === true) {\r\n                    isValid = true;\r\n                }\r\n            })\r\n            .catch((err) => {});\r\n        if (isValid) {\r\n            let resAcc = await createAccountAndToken(phone);\r\n            // console.log(resAcc);\r\n            if (resAcc.statusCode === 403) {\r\n                return res.status(403).send({ status: false, message: resAcc.message });\r\n            } else if (resAcc.statusCode === 200 && resAcc.isActivated) {\r\n                res.setHeader(\"Authorization\", \"Bearer \" + resAcc.data.token);\r\n                return res.status(200).send({ status: true, isActivated: true, message: resAcc.message, data: resAcc.data });\r\n            } else if (resAcc.statusCode === 200 && !resAcc.isActivated) {\r\n                return res.status(200).send({ status: true, isActivated: false, message: resAcc.message, data: resAcc.data });\r\n            } else if (resAcc.statusCode === 500) {\r\n                return res.status(500).send({ status: false, message: resAcc.message });\r\n            } else {\r\n                return res.status(400).send({ status: false, message: \"Something went wrong...\" });\r\n            }\r\n        } else {\r\n            return res.status(403).send({ status: false, message: \"otp not verified\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst forgetPasswordUsingOtp = async (req, res) => {\r\n    try {\r\n        let phone = req.params.phone;\r\n        let otpCode = req.params.otpCode;\r\n        let { password } = req.body;\r\n\r\n        if (!phone || !otpCode || !password) {\r\n            return res.status(400).send({ status: false, message: \"Phone number, password and otp are required\" });\r\n        }\r\n\r\n        let isValid = false;\r\n        await client.verify.v2\r\n            .services(verifySid)\r\n            .verificationChecks.create({ to: `+91${phone}`, code: otpCode })\r\n            .then((verification_check) => {\r\n                if (verification_check.status === \"approved\" || verification_check.valid === true) {\r\n                    isValid = true;\r\n                }\r\n            })\r\n            .catch((err) => {});\r\n        if (isValid) {\r\n            let resAcc = await updatePassword(phone, password);\r\n            return res.status(resAcc.statusCode).send({ status: resAcc.status, message: resAcc.message });\r\n        } else {\r\n            return res.status(403).send({ status: false, message: \"OTP not verified\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { sendOTP, verityOTP, forgetPasswordUsingOtp };\r\n","const paymentModel = require(\"../models/paymentModel\");\r\nconst orderModel = require(\"../models/orderModel\");\r\nconst cartModel = require(\"../models/cartModel\");\r\nconst customerModel = require(\"../models/customerAddressModel\");\r\nconst { generateRandomID } = require(\"./idGeneratorController\");\r\n\r\n// CREATE PAYMENT\r\nconst createPayment = async (order_status, payment_mode, order_sortId, order_id, orderAmt, discountAmt, paymentAmt, customer_id, transaction_id) => {\r\n    try {\r\n        // let orderId = req.params.orderId;\r\n        // let { payment_mode, paymentAmt, customer_id, transaction_id } = req.body;\r\n\r\n        if (!payment_mode || !customer_id) {\r\n            return { status: false };\r\n        }\r\n        let paymentData = {\r\n            order_status,\r\n            paymentId: generateRandomID(20),\r\n            customer_id,\r\n            payment_status: \"\",\r\n            payment_mode,\r\n            order_amount: orderAmt,\r\n            discount_amt: discountAmt,\r\n            balance_amount: 0,\r\n            order_id: {\r\n                orderId: order_id,\r\n                order_custom_id: order_sortId,\r\n            },\r\n        };\r\n        if (payment_mode === \"CUSTOM\" || payment_mode === \"TWENTY_ADV\") {\r\n            paymentData.partial_payment = {\r\n                payment_amount: paymentAmt.toFixed(2),\r\n                date: new Date(),\r\n                transactionId: transaction_id,\r\n            };\r\n            paymentData.payment_status = \"PARTIAL_PAID\";\r\n            if (orderAmt > paymentAmt) {\r\n                paymentData.balance_amount = (orderAmt - paymentAmt - discountAmt).toFixed(2);\r\n            }\r\n        } else if (payment_mode === \"PREPAID\") {\r\n            paymentData.transactionId = transaction_id;\r\n            paymentData.payment_amount = paymentAmt.toFixed(2);\r\n            paymentData.payment_status = \"RECEIVED\";\r\n            paymentData.payment_date = new Date();\r\n            paymentData.balance_amount = 0;\r\n        } else if (payment_mode === \"COD\") {\r\n            paymentData.payment_status = \"PENDING\";\r\n            paymentData.balance_amount = (orderAmt - paymentAmt - discountAmt).toFixed(2);\r\n        }\r\n\r\n        let paymentObj = await paymentModel.create(paymentData);\r\n        return { status: true, paymentId: paymentObj._id };\r\n    } catch (error) {\r\n        return { status: false };\r\n    }\r\n};\r\n\r\n// UPDATE PAYMENT API\r\nconst updatePaymentStatus = async (req, res) => {\r\n    try {\r\n        let paymentId = req.params.paymentId;\r\n        let { payment_date, payment_amount, payment_status } = req.body;\r\n        console.log(req.body);\r\n        // console.log(paymentId);\r\n        let payment = await paymentModel.findById(paymentId);\r\n        // console.log(payment);\r\n        if (!payment) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Payment not found with this payment id\",\r\n            });\r\n        }\r\n\r\n        if (!payment_date || !payment_amount || !payment_status) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"All fields are required\",\r\n            });\r\n        }\r\n\r\n        payment.payment_date = new Date(payment_date);\r\n        switch (payment_status) {\r\n            case \"RECEIVED\": {\r\n                if (Number(payment.balance_amount) !== Number(payment_amount)) {\r\n                    return res.status(400).send({\r\n                        status: false,\r\n                        message: \"Received amount should be equal to balance amount\",\r\n                    });\r\n                } else {\r\n                    payment.payment_amount += Number(payment_amount);\r\n                    payment.cod_received = Number(payment_amount);\r\n                    payment.payment_status = payment_status;\r\n                    payment.balance_amount = 0;\r\n                }\r\n                break;\r\n            }\r\n            case \"REFUNDED\": {\r\n                if (Number(payment.return_amount) !== Number(payment_amount)) {\r\n                    return res.status(400).send({\r\n                        status: false,\r\n                        message: \"Cancelled amount should be equal to refund amount\",\r\n                    });\r\n                } else if (payment.order_status === \"CANCELLED\") {\r\n                    payment.payment_status = \"REFUNDED\";\r\n                    payment.return_amount = Number(payment_amount);\r\n                    payment.balance_amount = 0;\r\n                } else if (payment.order_status === \"PARTIAL_CONFIRMED\") {\r\n                    payment.payment_status = \"PARTIAL_REFUNDED\";\r\n                    payment.return_amount = Number(payment_amount);\r\n                    payment.balance_amount = 0;\r\n                } else {\r\n                    payment.payment_status = \"REFUNDED\";\r\n                    payment.return_amount = Number(payment_amount);\r\n                    payment.balance_amount = 0;\r\n                }\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n        await payment.save();\r\n        return res.status(202).send({\r\n            status: true,\r\n            message: \"Payment status updated successfully\",\r\n            data: payment,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// CREATE PAYMENT\r\nconst addPayment = async (req, res) => {\r\n    try {\r\n        let orderId = req.params.orderId;\r\n        let data = req.body;\r\n        let payment = 856.8;\r\n\r\n        let { payment_mode } = data;\r\n\r\n        let order = await orderModel.findOne({ _id: orderId });\r\n\r\n        if (!order) {\r\n            return res.status(404).send({ status: false, message: \"Order not found\" });\r\n        }\r\n\r\n        if (payment > order.grand_total) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Paid amount can not be greater than the Grand Total\",\r\n            });\r\n        }\r\n\r\n        let paymentDetails = {\r\n            paymentId: generateRandomID(10),\r\n            order_id: order._id,\r\n            customer_id: order.customer_id,\r\n            payment_status: \"Pending\",\r\n            payment_mode,\r\n            transactionId: generateRandomID(25),\r\n            payment_amount: payment,\r\n            payment_date: new Date().toLocaleString(),\r\n            partial_mode: null,\r\n        };\r\n\r\n        if (payment_mode === \"TEN_ADV\") {\r\n            let ten_percent_amount = order.grand_total * 0.1;\r\n            let partialPaymentDetails = {\r\n                payment_mode: \"TEN_ADV\",\r\n                amount: ten_percent_amount,\r\n                date: new Date(),\r\n                transactionId: generateRandomID(25),\r\n            };\r\n\r\n            // paymentDetailsData.push(partialPaymentDetails);\r\n\r\n            let firstPartialPayment = await partialPaymentModel.findOne({});\r\n\r\n            if (firstPartialPayment) {\r\n                let partialPaymentDetails = {\r\n                    payment_mode: \"TEN_ADV\",\r\n                    amount: order.grand_total - ten_percent_amount,\r\n                    date: new Date(),\r\n                    transactionId: generateRandomID(25),\r\n                };\r\n                firstPartialPayment.paymentDetails.push(partialPaymentDetails);\r\n\r\n                await firstPartialPayment.save();\r\n            }\r\n\r\n            let partialPaymentData = {\r\n                paymentDetails: partialPaymentDetails,\r\n                remaining_amount: order.grand_total - partialPaymentDetails.amount,\r\n            };\r\n\r\n            newPartialPayment = await partialPaymentModel.create(partialPaymentData);\r\n\r\n            paymentDetails.partial_mode = newPartialPayment._id;\r\n\r\n            paymentDetails.payment_status = \"Pending\";\r\n            paymentDetails.payment_amount = ten_percent_amount;\r\n\r\n            paymentDetails.paymentDetails = [partialPaymentDetails];\r\n\r\n            let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n            return res.status(200).send({\r\n                status: true,\r\n                message: \"Success\",\r\n                data: {\r\n                    partialPaymentData: newPartialPayment,\r\n                    paymentData: newPayment,\r\n                },\r\n            });\r\n        } else if (payment_mode === \"TWENTY_ADV\") {\r\n            let twenty_percent_amount = order.grand_total * 0.2;\r\n            let partialPaymentDetails = {\r\n                payment_mode: \"TWENTY_ADV\",\r\n                amount: twenty_percent_amount,\r\n                date: new Date(),\r\n                transactionId: generateRandomID(25),\r\n            };\r\n\r\n            let firstPartialPayment = await partialPaymentModel.findOne({\r\n                payment_mode: \"TWENTY_ADV\",\r\n            });\r\n\r\n            if (firstPartialPayment) {\r\n                let partialPaymentDetails = {\r\n                    payment_mode: \"TWENTY_ADV\",\r\n                    amount: order.grand_total - twenty_percent_amount,\r\n                    date: new Date(),\r\n                    transactionId: generateRandomID(25),\r\n                };\r\n                firstPartialPayment.paymentDetails.push(partialPaymentDetails);\r\n\r\n                await firstPartialPayment.save();\r\n            }\r\n\r\n            let partialPaymentData = {\r\n                paymentDetails: partialPaymentDetails,\r\n                remaining_amount: order.grand_total - partialPaymentDetails.amount,\r\n            };\r\n\r\n            newPartialPayment = await partialPaymentModel.create(partialPaymentData);\r\n\r\n            paymentDetails.partial_mode = newPartialPayment._id;\r\n            paymentDetails.payment_status = \"PENDING\";\r\n            paymentDetails.payment_amount = twenty_percent_amount;\r\n\r\n            paymentDetails.paymentDetails = [partialPaymentDetails];\r\n\r\n            let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n            return res.status(200).send({\r\n                status: true,\r\n                message: \"Success\",\r\n                data: {\r\n                    partialPaymentData: newPartialPayment,\r\n                    paymentData: newPayment,\r\n                },\r\n            });\r\n        } else if (payment_mode === \"COD\") {\r\n            if (payment < order.grand_total) {\r\n                let partialPaymentDetails = {\r\n                    payment_mode: \"COD\",\r\n                    amount: payment,\r\n                    date: new Date(),\r\n                    transactionId: generateRandomID(25),\r\n                };\r\n\r\n                // Update the existing Partial_Payment or create a new one\r\n                let partialPaymentData = await partialPaymentModel.findOne({\r\n                    payment_mode: \"COD\",\r\n                });\r\n\r\n                if (partialPaymentData) {\r\n                    partialPaymentData.paymentDetails.push(partialPaymentDetails);\r\n                    partialPaymentData.remaining_amount = order.grand_total - payment - partialPaymentData.paymentDetails.reduce((sum, item) => sum + item.amount, 0);\r\n\r\n                    await partialPaymentData.save();\r\n\r\n                    paymentDetails.partial_mode = partialPaymentData._id;\r\n                } else {\r\n                    partialPaymentData = await partialPaymentModel.create({\r\n                        paymentDetails: [partialPaymentDetails],\r\n                        remaining_amount: order.grand_total - payment,\r\n                        payment_mode: \"COD\",\r\n                    });\r\n\r\n                    const newPartialPayment = await partialPaymentData.save();\r\n                    paymentDetails.partial_mode = newPartialPayment._id;\r\n                }\r\n\r\n                // let partialPaymentData = {\r\n                //   paymentDetails: partialPaymentDetails,\r\n                //   remaining_amount: order.grand_total - partialPaymentDetails.amount,\r\n                // };\r\n\r\n                newPartialPayment = await partialPaymentModel.create(partialPaymentData);\r\n\r\n                paymentDetails.partial_mode = newPartialPayment._id;\r\n                paymentDetails.payment_status = \"PENDING\";\r\n                let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n                return res.status(200).send({\r\n                    status: true,\r\n                    message: \"Success\",\r\n                    data: {\r\n                        partialPaymentData: newPartialPayment,\r\n                        paymentData: newPayment,\r\n                    },\r\n                });\r\n            } else {\r\n                paymentDetails.payment_status = \"RECEIVED\";\r\n                let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n                return res.status(200).send({\r\n                    status: true,\r\n                    message: \"Success\",\r\n                    data: {\r\n                        paymentData: newPayment,\r\n                    },\r\n                });\r\n            }\r\n        } else {\r\n            if (payment === order.grand_total) {\r\n                paymentDetails.payment_status = \"RECEIVED\";\r\n                let newPayment = await paymentModel.create(paymentDetails);\r\n\r\n                return res.status(200).send({ status: true, message: \"Success\", data: newPayment });\r\n            } else {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Paid amount should be equal to Grand Total\",\r\n                });\r\n            }\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { createPayment, updatePaymentStatus, addPayment };\r\n","const { isValidObjectId } = require(\"mongoose\");\r\nconst request = require(\"request\");\r\nconst productModel = require(\"../models/productModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst brandModel = require(\"../models/brandModel\");\r\nconst categoryModel = require(\"../models/categoryModel\");\r\nconst subCategoryModel = require(\"../models/subcategoryModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\nconst { uploadFile } = require(\"./imageController\");\r\nconst { calculateMarginAndSelling } = require(\"../utils/percentage\");\r\n\r\nconst uploadMultipleImage = async (blob) => {\r\n    let imageFile = await uploadFile(blob);\r\n    return imageFile;\r\n};\r\n\r\n// ADD PRODUCT\r\nconst addProduct = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let {\r\n            product_name,\r\n            sku_code,\r\n            hsn_code,\r\n            brandId,\r\n            color,\r\n            categoryId,\r\n            subCatId,\r\n            stockStatus,\r\n            lotSizeQty,\r\n            mrp,\r\n            seller_price,\r\n            gst,\r\n            sellingGST,\r\n            margin,\r\n            qty_in_hand,\r\n            min_order_qty,\r\n            sole,\r\n            material,\r\n            packing_type,\r\n            made_in,\r\n            weight,\r\n            description,\r\n            meta,\r\n            vendor_id,\r\n        } = data;\r\n\r\n        if (!isValid(product_name)) {\r\n            return res.status(400).send({ status: false, message: \"Product name is required\" });\r\n        }\r\n\r\n        if (!isValid(sku_code)) {\r\n            return res.status(400).send({ status: false, message: \"SKU code is required\" });\r\n        }\r\n        if (!isValid(hsn_code)) {\r\n            return res.status(400).send({ status: false, message: \"HSN code is required\" });\r\n        }\r\n\r\n        if (!isValid(mrp)) {\r\n            return res.status(400).send({ status: false, message: \"Product MRP is required\" });\r\n        }\r\n        if (!isValid(gst)) {\r\n            return res.status(400).send({ status: false, message: \"GST is required\" });\r\n        }\r\n        if (!isValid(brandId)) {\r\n            return res.status(400).send({ status: false, message: \"Brand ID is required\" });\r\n        }\r\n\r\n        if (!isValid(seller_price)) {\r\n            return res.status(400).send({ status: false, message: \"Seller price is required\" });\r\n        }\r\n\r\n        if (!isValid(categoryId)) {\r\n            return res.status(400).send({ status: false, message: \"Category ID is required\" });\r\n        }\r\n\r\n        if (!isValid(subCatId)) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Sub category ID is required\",\r\n            });\r\n        }\r\n\r\n        if (!isValid(stockStatus)) {\r\n            return res.status(400).send({ status: false, message: \"Stock status is required\" });\r\n        }\r\n        if (!isValid(lotSizeQty)) {\r\n            return res.status(400).send({ status: false, message: \"Lot size is required\" });\r\n        }\r\n\r\n        if (!isValid(qty_in_hand)) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Quantity in hand is required\",\r\n            });\r\n        }\r\n\r\n        if (!isValid(min_order_qty)) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Minimum order quantity is required\",\r\n            });\r\n        }\r\n\r\n        if (!isValid(color)) {\r\n            return res.status(400).send({ status: false, message: \"Product color is required\" });\r\n        }\r\n\r\n        if (req.userModel === \"ADMIN\") {\r\n            if (!isValid(sellingGST)) {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Selling GST is required\",\r\n                });\r\n            }\r\n            if (!isValid(margin)) {\r\n                return res.status(400).send({ status: false, message: \"Margin is required\" });\r\n            }\r\n            if (!isValid(vendor_id)) {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Vendor id is required\",\r\n                });\r\n            }\r\n        }\r\n\r\n        if (meta !== undefined) {\r\n            meta = JSON.parse(meta);\r\n        }\r\n        let productData = {\r\n            product_name,\r\n            sku_code,\r\n            brandId,\r\n            gst,\r\n            hsn_code,\r\n            color_id: JSON.parse(color),\r\n            categoryId,\r\n            subCatId,\r\n            stockStatus,\r\n            lotSizeQty: JSON.parse(lotSizeQty),\r\n            mrp,\r\n            seller_price,\r\n            qty_in_hand,\r\n            min_order_qty,\r\n            sole,\r\n            material,\r\n            packing_type,\r\n            made_in,\r\n            weight,\r\n            description,\r\n        };\r\n        if (req.userModel === \"ADMIN\") {\r\n            productData.sellingGST = sellingGST;\r\n            productData.margin = margin;\r\n            productData.status = \"Approved\";\r\n        }\r\n        if (meta !== undefined) {\r\n            productData.meta_title = meta.metaTitle;\r\n            productData.meta_keywords = meta.metaKeyword;\r\n            productData.meta_description = meta.metaDescription;\r\n        }\r\n        if (req.body.vendorId !== undefined) {\r\n            productData.vendor_id = req.body.vendorId;\r\n        } else {\r\n            productData.vendor_id = req.userId;\r\n        }\r\n\r\n        let multipleImage = [];\r\n        if (req.files && req.files.thumbnail) {\r\n            productData.thumbnail_pic = await uploadFile(req.files.thumbnail);\r\n        } else if (data.thumbnail !== undefined) {\r\n            productData.thumbnail_pic = data.thumbnail;\r\n        }\r\n        if (req.files && req.files.mulImg) {\r\n            multipleImage = req.files.mulImg;\r\n            let images = [];\r\n            if (Array.isArray(multipleImage)) {\r\n                for (let val of multipleImage) {\r\n                    let img = await uploadMultipleImage(val);\r\n                    images.push(img);\r\n                }\r\n            } else {\r\n                let img = await uploadMultipleImage(multipleImage);\r\n                images.push(img);\r\n            }\r\n            productData.multiple_pics = images;\r\n            // console.log(images);\r\n        } else if (data.mulImg !== undefined) {\r\n            productData.multiple_pics = data.mulImg;\r\n        }\r\n        // console.log(data);\r\n        let brandObj = await brandModel.findById(brandId);\r\n        let categoryObj = await categoryModel.findById(categoryId);\r\n        let subCatObj = await subCategoryModel.findById(subCatId);\r\n\r\n        if (!brandObj || !categoryObj || !subCatObj) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Brand, aritcle, category or subcategory id had some error\",\r\n            });\r\n        }\r\n        brandId = brandObj;\r\n        categoryId = categoryObj;\r\n        subCatId = subCatObj;\r\n\r\n        let product = await productModel.create(productData);\r\n        let vendor = null;\r\n        if (req.userModel === \"ADMIN\") {\r\n            vendor = await vendorModel.findById(vendor_id);\r\n            product.vendor_id = vendor._id;\r\n        } else {\r\n            vendor = await vendorModel.findById(req.userId);\r\n            product.vendor_id = vendor._id;\r\n        }\r\n        vendor.products.push(product);\r\n        await vendor.save();\r\n        await product.save();\r\n        return res.status(201).send({ status: true, message: \"Success\", data: product });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET ALL PRODUCTS\r\nconst getAllProducts = async (req, res) => {\r\n    try {\r\n        let data = [];\r\n        if (req.userModel === \"VENDOR\") {\r\n            let products = await productModel.find({ isDeleted: false, vendor_id: req.userId }).populate([\"color_id\", \"categoryId\", \"subCatId\", \"brandId\"]);\r\n            data = products;\r\n        } else {\r\n            let products = await productModel.find({ isDeleted: false }).populate([\"color_id\", \"categoryId\", \"subCatId\", \"brandId\", \"vendor_id\"]);\r\n            for (let x of products) {\r\n                if (x.vendor_id.status === \"Approved\") {\r\n                    data.push(x);\r\n                }\r\n            }\r\n        }\r\n        return res.status(200).send({ status: true, data: data });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllProductsForDashboard = async (req, res) => {\r\n    try {\r\n        let products = await productModel\r\n            .find({\r\n                isDeleted: false,\r\n                stockStatus: \"In_stock\",\r\n                status: \"Approved\",\r\n            })\r\n            .populate([\"color_id\", \"categoryId\", \"subCatId\", \"brandId\", \"vendor_id\"]);\r\n\r\n        let data = [];\r\n        for (let x of products) {\r\n            if (x.vendor_id.status === \"Approved\") {\r\n                data.push(x);\r\n            }\r\n        }\r\n        return res.status(200).send({ status: true, data: data });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst getAllProductsForFilter = async (req, res) => {\r\n    try {\r\n        products = await productModel\r\n            .find({\r\n                isDeleted: false,\r\n                stockStatus: \"In_stock\",\r\n                status: \"Approved\",\r\n            })\r\n            .populate([\"color_id\", \"categoryId\", \"subCatId\", \"brandId\", \"vendor_id\"]);\r\n        return res.status(200).send({ status: true, data: products });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// GET PRODUCT BY PRODUCT ID\r\nconst getProductById = async (req, res) => {\r\n    try {\r\n        let productId = req.params.productId;\r\n        let product = null;\r\n        if (req.userModel === \"VENDOR\") {\r\n            product = await productModel.findOne({\r\n                _id: productId,\r\n                isDeleted: false,\r\n                vendor_id: req.userId,\r\n            });\r\n        } else {\r\n            product = await productModel.findOne({\r\n                _id: productId,\r\n                isDeleted: false,\r\n            });\r\n        }\r\n        return res.status(200).send({ status: true, data: product });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// UPDATE PRODUCT BY PRODUCT ID\r\nconst updateProductByProductId = async (req, res) => {\r\n    try {\r\n        let productId = req.params.productId;\r\n        if (!isValidObjectId(productId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid product id\" });\r\n        }\r\n\r\n        let product = await productModel.findOne({\r\n            _id: productId,\r\n            isDeleted: false,\r\n        });\r\n\r\n        if (!product) {\r\n            return res.status(404).send({ status: false, message: \"Product not found\" });\r\n        }\r\n\r\n        let body = req.body;\r\n\r\n        if (\"product_name\" in body) {\r\n            product.product_name = body.product_name;\r\n        }\r\n\r\n        if (\"sku_code\" in body) {\r\n            product.sku_code = body.sku_code;\r\n        }\r\n\r\n        if (\"description\" in body) {\r\n            product.description = body.description;\r\n        }\r\n\r\n        if (\"mrp\" in body) {\r\n            product.mrp = body.mrp;\r\n        }\r\n\r\n        if (\"seller_price\" in body) {\r\n            product.seller_price = body.seller_price;\r\n        }\r\n\r\n        if (\"selling_price\" in body) {\r\n            product.selling_price = body.selling_price;\r\n        }\r\n\r\n        if (\"gst_amount\" in body) {\r\n            product.gst_amount = body.gst_amount;\r\n        }\r\n\r\n        if (\"stock_status\" in body) {\r\n            product.stockStatus = body.stock_status;\r\n        }\r\n\r\n        if (\"qty_in_hand\" in body) {\r\n            product.qty_in_hand = body.qty_in_hand;\r\n        }\r\n\r\n        if (\"min_order_qty\" in body) {\r\n            product.min_order_qty = body.min_order_qty;\r\n        }\r\n\r\n        if (\"size_qty\" in body) {\r\n            product.size_qty = body.size_qty;\r\n        }\r\n\r\n        if (\"color\" in body) {\r\n            product.color = body.color;\r\n        }\r\n\r\n        if (\"style\" in body) {\r\n            product.style = body.style;\r\n        }\r\n\r\n        if (\"sole\" in body) {\r\n            product.sole = body.sole;\r\n        }\r\n\r\n        if (\"material\" in body) {\r\n            product.material = body.material;\r\n        }\r\n\r\n        if (\"packing_type\" in body) {\r\n            product.packing_type = body.packing_type;\r\n        }\r\n\r\n        if (\"made_in\" in body) {\r\n            product.made_in = body.made_in;\r\n        }\r\n\r\n        if (\"primary_category\" in body) {\r\n            product.primary_category = body.primary_category;\r\n        }\r\n\r\n        if (\"weight\" in body) {\r\n            product.weight = body.weight;\r\n        }\r\n\r\n        if (\"category\" in body) {\r\n            product.categoryId = body.category;\r\n        }\r\n\r\n        if (\"meta_title\" in body) {\r\n            product.meta_title = body.meta_title;\r\n        }\r\n\r\n        if (\"meta_description\" in body) {\r\n            product.meta_description = body.meta_description;\r\n        }\r\n\r\n        if (\"status\" in body) {\r\n            product.status = body.status;\r\n        }\r\n\r\n        await product.save();\r\n\r\n        return res.status(200).send({ status: true, message: \"success\", data: product });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// DELETE PRODUCT BY PRODUCT ID\r\nconst deleteProductByProductId = async (req, res) => {\r\n    try {\r\n        let productId = req.params.productId;\r\n        if (!isValidObjectId) {\r\n            return res.status(400).send({ status: false, message: \"Invalid product id\" });\r\n        }\r\n\r\n        let product = await productModel.findOne({\r\n            _id: productId,\r\n            isDeleted: false,\r\n        });\r\n\r\n        if (!product) {\r\n            return res.status(404).send({ status: false, message: \"Product not found\" });\r\n        }\r\n\r\n        let deleteProduct = await productModel.findOneAndUpdate(\r\n            {\r\n                _id: productId,\r\n                isDeleted: false,\r\n            },\r\n            {\r\n                isDeleted: true,\r\n                deletedAt: new Date(),\r\n            },\r\n            { new: true }\r\n        );\r\n\r\n        if (!deleteProduct) {\r\n            return res.status(404).send({\r\n                status: false,\r\n                message: \"Product not found or already deleted\",\r\n            });\r\n        }\r\n\r\n        return res.status(200).send({ status: true, message: \"Product deleted successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst changeProductStatus = async (req, res) => {\r\n    try {\r\n        let { newStatus, margin, sellingGST } = req.body;\r\n        let productId = req.params.productId;\r\n        let product = await productModel.findById(productId);\r\n        if (!product) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Bad request\",\r\n            });\r\n        }\r\n        product.status = newStatus;\r\n        if (newStatus === \"Approved\") {\r\n            if (!margin || !sellingGST) {\r\n                return res.status(400).send({\r\n                    status: false,\r\n                    message: \"Bad request\",\r\n                });\r\n            }\r\n            product.margin = margin;\r\n            product.sellingGST = sellingGST;\r\n            product.selling_price = product.seller_price;\r\n        } else {\r\n            product.margin = undefined;\r\n            product.sellingGST = undefined;\r\n            product.selling_price = undefined;\r\n        }\r\n        await product.save();\r\n        return res.status(200).send({ status: true, message: \"Product updated successfully\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst changeProductStockStatus = async (req, res) => {\r\n    try {\r\n        let { newStockStatus } = req.body;\r\n        let productId = req.params.productId;\r\n        let product = await productModel.findById(productId);\r\n        if (!product) {\r\n            return res.status(400).send({\r\n                status: false,\r\n                message: \"Bad request\",\r\n            });\r\n        }\r\n        product.stockStatus = newStockStatus;\r\n        await product.save();\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Product Stock Status updated successfully\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst csvProduct = async (req, res) => {\r\n    try {\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Product Stock Status updated successfully\",\r\n            data: \"xlsxUrl\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst updateProduct = async (req, res) => {\r\n    try {\r\n        let productId = req.params.productId;\r\n        let {\r\n            product_name,\r\n            sku_code,\r\n            hsn_code,\r\n            description,\r\n            mrp,\r\n            gst,\r\n            seller_price,\r\n            sellingGST,\r\n            margin,\r\n            qty_in_hand,\r\n            min_order_qty,\r\n            lotSizeQty,\r\n            color_id,\r\n            sole,\r\n            material,\r\n            packing_type,\r\n            made_in,\r\n            weight,\r\n            categoryId,\r\n            subCatId,\r\n        } = req.body;\r\n\r\n        let product = await productModel.findById(productId);\r\n        if (product_name) {\r\n            product.product_name = product_name;\r\n        }\r\n        if (sku_code) {\r\n            product.sku_code = sku_code;\r\n        }\r\n        if (hsn_code) {\r\n            product.hsn_code = hsn_code;\r\n        }\r\n        if (description) {\r\n            product.description = description;\r\n        }\r\n        if (mrp) {\r\n            product.mrp = mrp;\r\n        }\r\n        if (gst) {\r\n            product.gst = gst;\r\n        }\r\n        if (seller_price) {\r\n            product.seller_price = seller_price;\r\n        }\r\n        if (sellingGST) {\r\n            product.sellingGST = sellingGST;\r\n        }\r\n        if (margin) {\r\n            product.margin = margin;\r\n        }\r\n        if (qty_in_hand) {\r\n            product.qty_in_hand = qty_in_hand;\r\n        }\r\n        if (min_order_qty) {\r\n            product.min_order_qty = min_order_qty;\r\n        }\r\n        if (lotSizeQty) {\r\n            product.lotSizeQty = lotSizeQty.split(\",\");\r\n        }\r\n        if (color_id) {\r\n            console.log(color_id);\r\n            product.color_id = color_id;\r\n        }\r\n        if (sole) {\r\n            product.sole = sole;\r\n        }\r\n        if (material) {\r\n            product.material = material;\r\n        }\r\n        if (packing_type) {\r\n            product.packing_type = packing_type;\r\n        }\r\n        if (made_in) {\r\n            product.made_in = made_in;\r\n        }\r\n        if (weight) {\r\n            product.weight = weight;\r\n        }\r\n        if (categoryId) {\r\n            product.categoryId = categoryId;\r\n        }\r\n        if (subCatId) {\r\n            product.subCatId = subCatId;\r\n        }\r\n        if (req.files) {\r\n            let { thumbnail_pic, multiple_pics } = req.files;\r\n            if (thumbnail_pic) {\r\n                product.thumbnail_pic = await uploadFile(thumbnail_pic);\r\n            }\r\n            if (multiple_pics) {\r\n                if (multiple_pics.length) {\r\n                    let images = [];\r\n                    for (let singleFile of multiple_pics) {\r\n                        let x = await uploadMultipleImage(singleFile);\r\n                        images.push(x);\r\n                    }\r\n                    product.multiple_pics = images;\r\n                } else {\r\n                    let x = await uploadFile(multiple_pics);\r\n                    product.multiple_pics = [x];\r\n                }\r\n            }\r\n        }\r\n        await product.save();\r\n        return res.status(201).send({\r\n            status: true,\r\n            message: \"Product updated successfully\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    addProduct,\r\n    getAllProducts,\r\n    getProductById,\r\n    updateProductByProductId,\r\n    deleteProductByProductId,\r\n    getAllProductsForDashboard,\r\n    changeProductStatus,\r\n    changeProductStockStatus,\r\n    csvProduct,\r\n    getAllProductsForFilter,\r\n    updateProduct,\r\n};\r\n","const adminModel = require(\"../models/adminModel\");\nconst vendorModel = require(\"../models/vendorModel\");\nconst { uploadFile } = require(\"./imageController\");\nconst bcrypt = require(\"bcrypt\");\n\nconst changePassword = async (req, res) => {\n    let vendor = await vendorModel.findById(req.body.userid);\n    vendor.password = await bcrypt.hash(req.body.password, 10);\n    vendor.save();\n    res.status(200).send({\n        status: true,\n        message: \"password changed successfully\",\n    });\n};\n\nconst updateProfile = async (req, res) => {\n    try {\n        let userId = req.userId;\n        let userType = req.userModel;\n        let { fullName, emailID, phone, altPhone, newPass, oldPass } = req.body;\n        if (userType === \"ADMIN\") {\n            let admin = await adminModel.findById(userId);\n            if (oldPass && newPass) {\n                bcrypt.compare(oldPass, admin.password, function (err, result) {\n                    if (err) {\n                    }\n                    hasAccess(result, admin);\n                });\n                async function hasAccess(result, admin) {\n                    if (result) {\n                        admin.password = await bcrypt.hash(newPass, 10);\n                        if (fullName) admin.name = fullName;\n                        if (emailID) admin.email = emailID;\n                        if (phone && emailID) {\n                            let x = await adminModel.find({\n                                $or: [{ email: emailID }, { phone: phone }],\n                            });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message:\n                                        \"Mobile and Email number already exists\",\n                                });\n                            }\n                            admin.phone = phone;\n                            admin.email = emailID;\n                        } else if (phone) {\n                            let x = await adminModel.find({ phone: phone });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message: \"Mobile number already exists\",\n                                });\n                            }\n                            admin.phone = phone;\n                        } else if (emailID) {\n                            let x = await adminModel.find({ email: emailID });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message: \"Email id already exists\",\n                                });\n                            }\n                            admin.email = emailID;\n                        }\n\n                        if (req.files) {\n                            let { profileImg } = req.files;\n                            let imgRes = await uploadFile(profileImg);\n                            admin.profileUrl = imgRes;\n                        }\n                        let y = await admin.save();\n                        let data = {};\n                        data.name = y.name;\n                        data.email = y.email;\n                        data.userType = y.isSuperAdmin\n                            ? \"Super Admin\"\n                            : \"Admin\";\n                        data.role = y.role;\n                        data.phone = y.phone;\n                        data.photo = y.profileUrl;\n                        // console.log(vendor);\n                        return res.status(202).send({\n                            status: true,\n                            message: \"Profile updated successfully\",\n                            data: data,\n                        });\n                    } else {\n                        return res.status(401).send({\n                            status: true,\n                            message: \"Invalid Password\",\n                        });\n                    }\n                }\n            } else {\n                if (fullName) admin.name = fullName;\n                if (emailID) admin.email = emailID;\n                if (phone && emailID) {\n                    let x = await adminModel.find({\n                        $or: [{ email: emailID }, { phone: phone }],\n                    });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Mobile and Email number already exists\",\n                        });\n                    }\n                    admin.phone = phone;\n                    admin.email = emailID;\n                } else if (phone) {\n                    let x = await adminModel.find({ phone: phone });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Mobile number already exists\",\n                        });\n                    }\n                    admin.phone = phone;\n                } else if (emailID) {\n                    let x = await adminModel.find({ email: emailID });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Email id already exists\",\n                        });\n                    }\n                    admin.email = emailID;\n                }\n\n                if (req.files) {\n                    let { profileImg } = req.files;\n                    let imgRes = await uploadFile(profileImg);\n                    admin.profileUrl = imgRes;\n                }\n                let y = await admin.save();\n                let data = {};\n                data.name = y.name;\n                data.email = y.email;\n                data.userType = y.isSuperAdmin ? \"Super Admin\" : \"Admin\";\n                data.role = y.role;\n                data.phone = y.phone;\n                data.photo = y.profileUrl;\n                // console.log(vendor);\n                return res.status(202).send({\n                    status: true,\n                    message: \"Profile updated successfully\",\n                    data: data,\n                });\n            }\n        } else {\n            let vendor = await vendorModel.findById(userId);\n            if (oldPass && newPass) {\n                bcrypt.compare(\n                    oldPass,\n                    vendor.password,\n                    function (err, result) {\n                        if (err) {\n                        }\n                        hasAccess(result, vendor);\n                    }\n                );\n                async function hasAccess(result, vendor) {\n                    if (result) {\n                        console.log(result);\n                        vendor.password = await bcrypt.hash(newPass, 10);\n                        if (fullName) vendor.representativeName = fullName;\n                        if (altPhone) vendor.altMobileNo = altPhone;\n                        if (req.files) {\n                            let { profileImg } = req.files;\n                            let imgRes = await uploadFile(profileImg);\n                            vendor.profileUrl = imgRes;\n                        }\n                        if (phone && emailID) {\n                            let x = await vendorModel.find({\n                                $or: [\n                                    { emailId: emailID },\n                                    { mobileNo: phone },\n                                ],\n                            });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message:\n                                        \"Mobile and Email number already exists\",\n                                });\n                            }\n                            vendor.mobileNo = phone;\n                            vendor.emailId = emailID;\n                        } else if (phone) {\n                            let x = await vendorModel.find({ mobileNo: phone });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message: \"Mobile number already exists\",\n                                });\n                            }\n                            vendor.mobileNo = phone;\n                        } else if (emailID) {\n                            let x = await vendorModel.find({\n                                emailId: emailID,\n                            });\n                            if (x.length > 0) {\n                                return res.status(400).send({\n                                    status: false,\n                                    message: \"Email id already exists\",\n                                });\n                            }\n                            vendor.emailId = emailID;\n                        }\n\n                        let y = await vendor.save();\n                        let data = {};\n                        data.name = y.representativeName;\n                        data.email = y.emailId;\n                        data.userType = \"Seller\";\n                        data.role = y.role;\n                        data.altMobileNo = y.altMobileNo;\n                        data.phone = y.mobileNo;\n                        data.photo = y.profileUrl;\n                        data.vendorId = y.vendor_unique_id;\n                        return res.status(202).send({\n                            status: true,\n                            message: \"Profile updated successfully\",\n                            data: data,\n                        });\n                    } else {\n                        return res.status(401).send({\n                            status: true,\n                            message: \"Invalid Password\",\n                        });\n                    }\n                }\n            } else {\n                if (fullName) vendor.representativeName = fullName;\n                if (altPhone) vendor.altMobileNo = altPhone;\n                if (req.files) {\n                    let { profileImg } = req.files;\n                    let imgRes = await uploadFile(profileImg);\n                    vendor.profileUrl = imgRes;\n                }\n                if (phone && emailID) {\n                    let x = await vendorModel.find({\n                        $or: [{ emailId: emailID }, { mobileNo: phone }],\n                    });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Mobile and Email number already exists\",\n                        });\n                    }\n                    vendor.mobileNo = phone;\n                    vendor.emailId = emailID;\n                } else if (phone) {\n                    let x = await vendorModel.find({ mobileNo: phone });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Mobile number already exists\",\n                        });\n                    }\n                    vendor.mobileNo = phone;\n                } else if (emailID) {\n                    let x = await vendorModel.find({\n                        emailId: emailID,\n                    });\n                    if (x.length > 0) {\n                        return res.status(400).send({\n                            status: false,\n                            message: \"Email id already exists\",\n                        });\n                    }\n                    vendor.emailId = emailID;\n                }\n\n                let y = await vendor.save();\n                let data = {};\n                data.name = y.representativeName;\n                data.email = y.emailId;\n                data.userType = \"Seller\";\n                data.role = y.role;\n                data.altMobileNo = y.altMobileNo;\n                data.phone = y.mobileNo;\n                data.photo = y.profileUrl;\n                data.vendorId = y.vendor_unique_id;\n                return res.status(202).send({\n                    status: true,\n                    message: \"Profile updated successfully\",\n                    data: data,\n                });\n            }\n        }\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nmodule.exports = { updateProfile, changePassword };\n","const questionModel = require(\"../models/questionModel\");\r\nconst { isValid } = require(\"../utils/utils\");\r\n\r\n// ADD QUESTIONS\r\nconst addQuestions = async (req, res) => {\r\n    try {\r\n        let { questionFor, question } = req.body;\r\n\r\n        if (!isValid(questionFor)) {\r\n            return res.status(400).send({ status: false, message: \"QuestionFor field is required\" });\r\n        }\r\n\r\n        if (!isValid(question)) {\r\n            return res.status(400).send({ status: false, message: \"Question is required\" });\r\n        }\r\n\r\n        let questionObj = {\r\n            questionFor,\r\n            question,\r\n        };\r\n\r\n        await questionModel.create(questionObj);\r\n        let allQuestion = await questionModel.find({ questionFor: questionFor, isDeleted: false });\r\n\r\n        return res.status(201).send({\r\n            status: true,\r\n            message: \"Question added successfully\",\r\n            data: allQuestion,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllQuestionByModel = async (req, res) => {\r\n    try {\r\n        let model = req.userModel;\r\n        let questions = await questionModel.find({ questionFor: model, isDeleted: false });\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Question fetched successfully\",\r\n            data: questions,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllQuestion = async (req, res) => {\r\n    try {\r\n        let questions = await questionModel.find({ isDeleted: false });\r\n        let data = {\r\n            admin: [],\r\n            vendor: [],\r\n            customer: [],\r\n        };\r\n        for (let x of questions) {\r\n            if (x.questionFor === \"ADMIN\") {\r\n                data.admin.push(x);\r\n            }\r\n            if (x.questionFor === \"VENDOR\") {\r\n                data.vendor.push(x);\r\n            }\r\n            if (x.questionFor === \"CUSTOMER\") {\r\n                data.customer.push(x);\r\n            }\r\n        }\r\n        return res.status(200).send({\r\n            status: true,\r\n            message: \"Question fetched successfully\",\r\n            data: data,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst deleteQuestionById = async (req, res) => {\r\n    try {\r\n        let questionId = req.params.questionid;\r\n        let question = await questionModel.findById(questionId);\r\n        if (question) {\r\n            question.isDeleted = true;\r\n            await question.save();\r\n            let questions = await questionModel.find({ questionFor: question.questionFor, isDeleted: false });\r\n            return res.status(200).send({\r\n                status: true,\r\n                message: \"Question fetched successfully\",\r\n                data: questions,\r\n            });\r\n        } else {\r\n            return res.status(400).send({ status: false, message: \"question id is not valid\" });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { addQuestions, getAllQuestionByModel, getAllQuestion, deleteQuestionById };\r\n","const excelJs = require(\"exceljs\");\nconst orderModel = require(\"../models/orderModel\");\n\nconst getOrderReport = async (req, res) => {\n    try {\n        //{ saleInvoice: { $exists: true } }\n        let orders = await orderModel.find({ saleInvoice: { $exists: true } }).populate([\"payment_id\", \"order_status_id\"]);\n        return res.status(200).send({ status: true, message: \"Order Report fetched...\", data: orders });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst exportSaleReport = async (req, res) => {\n    try {\n        let { startDate, endDate } = req.body;\n        if (!startDate || !endDate) {\n            return res.status(400).send({ status: false, message: \"Start date end end date are required\" });\n        }\n        let date1 = new Date(startDate).getTime();\n        let date2 = new Date(endDate).getTime();\n        if (date1 > date2) {\n            return res.status(400).send({ status: false, message: \"Wrong date range\" });\n        }\n        var workbook = new excelJs.Workbook();\n        var worksheet = workbook.addWorksheet(\"Add Bulk Product\");\n\n        let columnData = [\n            { header: \"Order ID\", key: \"order_id\" },\n            { header: \"Order Date and Time\", key: \"order_date\" },\n            { header: \"Invoice No\", key: \"invoice_no\" },\n            { header: \"Invoice Date\", key: \"invoice_date\" },\n            { header: \"Order value\", key: \"order_value\" },\n            { header: \"Order Qty\", key: \"order_qty\" },\n            { header: \"Invoice value/confirmed value\", key: \"invoice_value\" },\n            { header: \"Advance\", key: \"advance\" },\n            { header: \"Discount\", key: \"discount\" },\n            { header: \"Net Amount\", key: \"net_amount\" },\n            { header: \"Refund\", key: \"refund\" },\n            { header: \"Cash on delivery\", key: \"cash_on_delivery\" },\n        ];\n        var data = {\n            order_id: \"FZ12345678\",\n            order_date: \"07-08-2023 at 18:37:00\",\n            invoice_no: \"FSIN2312345678\",\n            invoice_date: \"07-08-2023 at 18:37:00\",\n            order_qty: \"4\",\n            invoice_value: \"10000\",\n            advance: \"2000\",\n            discount: \"1200\",\n            net_amount: \"6800\",\n            refund: \"00\",\n            cash_on_delivery: \"6800\",\n        };\n        if (req.userModel === \"ADMIN\") {\n            columnData.unshift({ header: \"Buyer name\", key: \"buyer_name\" }, { header: \"Buyer No.\", key: \"buyer_no\" });\n\n            data.buyer_name = \"SANJEET KUMAR\";\n            data.buyer_no = 1234567891;\n        }\n        worksheet.columns = columnData;\n        worksheet.addRow(data);\n        worksheet.getRow(1).eachCell((cell) => {\n            cell.font = { bold: true };\n            cell.fill = {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: { argb: \"F08080\" },\n            };\n        });\n\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        res.setHeader(\"Content-Disposition\", `attachment; brandid.xlsx`);\n\n        return workbook.xlsx.write(res).then(() => {\n            res.status(200);\n        });\n        // return res.status(200).send({ status: true, message: \"Report exported\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst exportPurchaseReport = async (req, res) => {\n    try {\n        let { startDate, endDate } = req.body;\n        if (!startDate || !endDate) {\n            return res.status(400).send({ status: false, message: \"Start date end end date are required\" });\n        }\n        let date1 = new Date(startDate).getTime();\n        let date2 = new Date(endDate).getTime();\n        if (date1 > date2) {\n            return res.status(400).send({ status: false, message: \"Wrong date range\" });\n        }\n        var workbook = new excelJs.Workbook();\n        var worksheet = workbook.addWorksheet(\"Add Bulk Product\");\n        let columnData = [\n            { header: \"Order ID\", key: \"order_id\" },\n            { header: \"Order Date and Time\", key: \"order_date\" },\n            { header: \"Invoice No\", key: \"invoice_no\" },\n            { header: \"Invoice Date\", key: \"invoice_date\" },\n            { header: \"Seller name\", key: \"seller_name\" },\n            { header: \"Seller Phone No.\", key: \"seller_phone\" },\n            { header: \"Seller GST\", key: \"seller_gst\" },\n            { header: \"FactorEz GST\t\", key: \"factorez_gst\" },\n            { header: \"Purchase \", key: \"purchase\" },\n            { header: \"Invoice value/confirmed value\", key: \"invoice_value\" },\n            { header: \"GST Percentage\", key: \"gst_percentage\" },\n            { header: \"Taxable value\", key: \"taxable_value\" },\n            { header: \"Gst amount\", key: \"gst_amount\" },\n            { header: \"Quantity\", key: \"quantity\" },\n            { header: \"Order status\", key: \"order_status\" },\n        ];\n        var data = {\n            order_id: \"FZ12345678\",\n            order_date: \"07-08-2023 at 18:37:00\",\n            invoice_no: \"FSIN2312345678\",\n            invoice_date: \"07-08-2023 at 18:37:00\",\n            seller_name: \"Navnit Sekh\",\n            seller_phone: \"1234567891\",\n            seller_gst: \"09ABCDE4455R23\",\n            factorez_gst: \"09ABCDE4455R23\",\n            purchase: \"4000\",\n            invoice_value: \"5000\",\n            gst_percentage: \"18\",\n            taxable_value: \"5000\",\n            gst_amount: \"1000\",\n            quantity: \"3\",\n            order_status: \"pending\",\n        };\n        // if (req.userModel === \"ADMIN\") {\n        //     columnData.unshift({ header: \"Buyer name\", key: \"buyer_name\" }, { header: \"Buyer No.\", key: \"buyer_no\" });\n\n        //     data.buyer_name = \"SANJEET KUMAR\";\n        //     data.buyer_no = 1234567891;\n        // }\n        worksheet.columns = columnData;\n        worksheet.addRow(data);\n        worksheet.getRow(1).eachCell((cell) => {\n            cell.font = { bold: true };\n            cell.fill = {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: { argb: \"F08080\" },\n            };\n        });\n\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        res.setHeader(\"Content-Disposition\", `attachment; brandid.xlsx`);\n\n        return workbook.xlsx.write(res).then(() => {\n            res.status(200);\n        });\n        // return res.status(200).send({ status: true, message: \"Report exported\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst getPaymentReport = async (req, res) => {\n    try {\n        let orders = await orderModel.find({ saleInvoice: { $exists: true } }).populate([\"vendorId\", \"payment_id\", \"order_status_id\"]);\n        return res.status(200).send({ status: true, message: \"Payment report fetched\", data: orders });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst updatePaymentReport = async (req, res) => {\n    try {\n        let orderId = req.params.orderid;\n        let { paymentStatus, paidAmount, paymentDate, transactionId, settlementAmt, message } = req.body;\n        let data = req.body;\n        let order = await orderModel.findById(orderId);\n        if (!order) {\n            return res.status(400).send({ status: false, message: \"Order id not found\" });\n        }\n        if (paymentStatus) order.paymentReportStatus.paymentStatus = paymentStatus;\n        if (paidAmount) order.paymentReportStatus.paidAmount = paidAmount;\n        if (paymentDate) order.paymentReportStatus.paymentDate = paymentDate;\n        if (transactionId) order.paymentReportStatus.transactionId = transactionId;\n        if (settlementAmt) order.paymentReportStatus.settlementAmt = settlementAmt;\n        if (message) order.paymentReportStatus.message = message;\n        data.updateAt = new Date();\n        order.paymentReportStatus.logs.push(data);\n        await order.save();\n        let orders = await orderModel.find({ saleInvoice: { $exists: true } }).populate([\"vendorId\", \"payment_id\", \"order_status_id\"]);\n        return res.status(200).send({ status: true, message: \"Payment Report Updated\", data: orders });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nmodule.exports = { getOrderReport, exportSaleReport, exportPurchaseReport, getPaymentReport, updatePaymentReport };\n","const vendorModel = require(\"../models/vendorModel\");\r\nconst bankModel = require(\"../models/bankModel\");\r\nconst documentModel = require(\"../models/documentModel\");\r\nconst { uploadFile } = require(\"./imageController\");\r\nconst { generateRandomID, generateRandomAlphaNumericID } = require(\"../controllers/idGeneratorController\");\r\n\r\nconst { isValid, isValidEmail, isValidMoblie, isValidGST } = require(\"../utils/utils\");\r\nconst { roleEnums } = require(\"../utils/enums\");\r\nconst brandModel = require(\"../models/brandModel\");\r\nconst bcrypt = require(\"bcrypt\");\r\n\r\n// ADD VENDOR\r\nconst addVendor = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let {\r\n            firmName,\r\n            brandName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId,\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            acHolderName,\r\n            acNo,\r\n            bankName,\r\n            branch,\r\n            ifsc,\r\n            termsAndConditions,\r\n        } = data;\r\n        if (password === \"\") {\r\n            return res.status(400).send({ message: \"Password is required\", status: false });\r\n        }\r\n        password = await bcrypt.hash(password, 10);\r\n\r\n        let isVendor = await vendorModel.findOne({ emailId: emailId });\r\n        if (isVendor) {\r\n            return res.status(400).send({ message: \"Email id already exists\", status: false });\r\n        }\r\n        // console.log(data);\r\n        let gstRegDoc = await uploadFile(req.files.gstRegDoc);\r\n        let brandLogo = await uploadFile(req.files.brandLogo);\r\n        let brandRegDoc = await uploadFile(req.files.brandRegDoc);\r\n        let cancelledCheque = await uploadFile(req.files.cancelledCheque);\r\n        let documentData = {\r\n            brandRegDoc: brandRegDoc,\r\n            gstRegDoc: gstRegDoc,\r\n        };\r\n\r\n        let bankData = {\r\n            acHolderName: acHolderName,\r\n            acNo: acNo,\r\n            bankName: bankName,\r\n            branch: branch,\r\n            ifsc: ifsc,\r\n            cancelledCheque: cancelledCheque,\r\n        };\r\n\r\n        let brandData = {\r\n            brand_name: brandName,\r\n            brandLogo: brandLogo,\r\n        };\r\n        let vendorData = {\r\n            firmName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId: emailId.toLowerCase(),\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            termsAndConditions,\r\n        };\r\n\r\n        let document = await documentModel.create(documentData);\r\n        let bank = await bankModel.create(bankData);\r\n        let brand = await brandModel.create(brandData);\r\n\r\n        vendorData.bank_id = bank;\r\n        vendorData.document_id = document;\r\n        vendorData.brand_id = brand;\r\n        vendorData.vendor_unique_id = generateRandomID(10);\r\n        vendorData.auth_unique_id = generateRandomID(10);\r\n        vendorData.db_unique_id = generateRandomAlphaNumericID(20);\r\n        vendorData.sharing_unique_id = generateRandomAlphaNumericID(20);\r\n        // console.log(vendorData);\r\n        vendorData.role = [\"VENDOR\"];\r\n\r\n        let vendor = await vendorModel.create(vendorData);\r\n        brand.vendor_id = vendor;\r\n        await brand.save();\r\n        return res.status(201).send({ status: true, message: \"Success\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst createVendorByAdmin = async (req, res) => {\r\n    try {\r\n        let data = req.body;\r\n        let adminId = req.userId;\r\n        let model = req.userModel;\r\n        let {\r\n            firmName,\r\n            brandName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId,\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            acHolderName,\r\n            acNo,\r\n            bankName,\r\n            branch,\r\n            ifsc,\r\n        } = data;\r\n        if (password === \"\") {\r\n            return res.status(400).send({ message: \"Password is required\", status: false });\r\n        }\r\n        let isVendor = await vendorModel.findOne({ emailId: emailId });\r\n        if (isVendor) {\r\n            return res.status(400).send({ message: \"Email id already exists\", status: false });\r\n        }\r\n        password = await bcrypt.hash(password, 10);\r\n        // console.log(data);\r\n        let gstRegDoc = await uploadFile(req.files.gstRegDoc);\r\n        let brandLogo = await uploadFile(req.files.brandLogo);\r\n        let brandRegDoc = await uploadFile(req.files.brandRegDoc);\r\n        let cancelledCheque = await uploadFile(req.files.cancelledCheque);\r\n        let documentData = {\r\n            brandRegDoc: brandRegDoc,\r\n            gstRegDoc: gstRegDoc,\r\n            actionTakenBy: adminId,\r\n        };\r\n\r\n        let bankData = {\r\n            acHolderName: acHolderName,\r\n            acNo: acNo,\r\n            bankName: bankName,\r\n            branch: branch,\r\n            ifsc: ifsc,\r\n            cancelledCheque: cancelledCheque,\r\n            actionTakenBy: adminId,\r\n        };\r\n\r\n        let brandData = {\r\n            brand_name: brandName,\r\n            brandLogo: brandLogo,\r\n            brandStatus: \"Approved\",\r\n        };\r\n        let vendorData = {\r\n            firmName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId: emailId.toLowerCase(),\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            termsAndConditions: true,\r\n        };\r\n        let document = await documentModel.create(documentData);\r\n        let bank = await bankModel.create(bankData);\r\n        let brand = await brandModel.create(brandData);\r\n        vendorData.bank_id = bank;\r\n        vendorData.document_id = document;\r\n        vendorData.brand_id = brand;\r\n        vendorData.vendor_unique_id = generateRandomID(10);\r\n        vendorData.auth_unique_id = generateRandomID(10);\r\n        vendorData.db_unique_id = generateRandomAlphaNumericID(20);\r\n        vendorData.sharing_unique_id = generateRandomAlphaNumericID(20);\r\n        vendorData.role = [\"VENDOR\"];\r\n        vendorData.actionTakenBy = adminId;\r\n        vendorData.status = \"Approved\";\r\n        vendorData.basicInfoStatus = \"Approved\";\r\n        let vendor = await vendorModel.create(vendorData);\r\n        brand.vendor_id = vendor;\r\n        await brand.save();\r\n        return res.status(201).send({ status: true, message: \"Success\" });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst getAllVendors = async (req, res) => {\r\n    try {\r\n        let vendors = await vendorModel.find({ isDeleted: false }).populate([\"bank_id\", \"document_id\", \"actionTakenBy\", \"brand_id\"]);\r\n        return res.status(201).send({ status: true, message: \"Success\", data: vendors });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst updateVendor = async (req, res) => {\r\n    try {\r\n        let {\r\n            firmName,\r\n            gstNo,\r\n            representativeName,\r\n            emailId,\r\n            password,\r\n            mobileNo,\r\n            altMobileNo,\r\n            pickupState,\r\n            pickupCity,\r\n            pickupPincode,\r\n            invoiceAddress,\r\n            pickupAddress,\r\n            brand_id,\r\n            brand_name,\r\n            bank_id,\r\n            acHolderName,\r\n            acNo,\r\n            bankName,\r\n            branch,\r\n            ifsc,\r\n        } = req.body;\r\n        let vendorObjId = req.params.vendorId;\r\n        let vendor = await vendorModel.findById(vendorObjId).populate([\"bank_id\", \"document_id\", \"brand_id\"]);\r\n        if (firmName) {\r\n            vendor.firmName = firmName;\r\n        }\r\n        if (gstNo) {\r\n            vendor.gstNo = gstNo;\r\n        }\r\n        if (representativeName) {\r\n            vendor.representativeName = representativeName;\r\n        }\r\n        if (emailId) {\r\n            vendor.emailId = emailId.toLowerCase();\r\n        }\r\n        if (password) {\r\n            vendor.password = await bcrypt.hash(password, 10);\r\n        }\r\n        if (mobileNo) {\r\n            vendor.mobileNo = mobileNo;\r\n        }\r\n        if (altMobileNo) {\r\n            vendor.altMobileNo = altMobileNo;\r\n        }\r\n        if (pickupState) {\r\n            vendor.pickupState = pickupState;\r\n        }\r\n        if (pickupState) {\r\n            vendor.pickupState = pickupState;\r\n        }\r\n        if (pickupCity) {\r\n            vendor.pickupCity = pickupCity;\r\n        }\r\n        if (pickupPincode) {\r\n            vendor.pickupPincode = pickupPincode;\r\n        }\r\n        if (invoiceAddress) {\r\n            vendor.invoiceAddress = invoiceAddress;\r\n        }\r\n        if (pickupAddress) {\r\n            vendor.pickupAddress = pickupAddress;\r\n        }\r\n        if (brand_id) {\r\n            for (let brandX of vendor.brand_id) {\r\n                console.log(brandX);\r\n                if (brandX._id.toString() === brand_id) {\r\n                    brandX.brand_name = brand_name;\r\n                    await brandX.save();\r\n                }\r\n            }\r\n        }\r\n        if (bank_id) {\r\n            if (bankName) {\r\n                vendor.bank_id.bankName = bankName;\r\n            }\r\n            if (acHolderName) {\r\n                vendor.bank_id.acHolderName = acHolderName;\r\n            }\r\n            if (acNo) {\r\n                vendor.bank_id.acNo = acNo;\r\n            }\r\n            if (branch) {\r\n                vendor.bank_id.branch = branch;\r\n            }\r\n            if (ifsc) {\r\n                vendor.bank_id.ifsc = ifsc;\r\n            }\r\n            await vendor.bank_id.save();\r\n        }\r\n\r\n        if (req.files) {\r\n            let { cancelledCheque, gstRegDoc, brandRegDoc } = req.files;\r\n            if (cancelledCheque) {\r\n                vendor.bank_id.cancelledCheque = await uploadFile(cancelledCheque);\r\n            }\r\n            if (gstRegDoc) {\r\n                vendor.document_id.gstRegDoc = await uploadFile(gstRegDoc);\r\n            }\r\n            if (brandRegDoc) {\r\n                vendor.document_id.brandRegDoc = await uploadFile(brandRegDoc);\r\n            }\r\n            await vendor.document_id.save();\r\n        }\r\n        await vendor.save();\r\n        res.status(201).send({ status: true, message: \"successfully\", data: vendor });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { getAllVendors, addVendor, createVendorByAdmin, updateVendor };\r\n","const { isValidObjectId } = require(\"mongoose\");\nconst productModel = require(\"../models/productModel\");\nconst wishlistModel = require(\"../models/wishlistModel\");\nconst customerModel = require(\"../models/customerModel\");\n\nconst addToWishlist = async (req, res) => {\n    try {\n        let { productId } = req.body;\n        if (!productId) {\n            return res.status(400).send({ status: false, message: \"bad request\" });\n        }\n        if (!isValidObjectId(productId)) {\n            return res.status(400).send({ status: false, message: \"invalid product id\" });\n        }\n        let product = await productModel.findById(productId);\n        if (!product) {\n            return res.status(400).send({ status: false, message: \"product not found\" });\n        }\n        let wishlistObj = await wishlistModel.findOne({ productId: productId, userId: req.userId });\n        if (wishlistObj) {\n            return res.status(200).send({ status: false, message: \"Already in wishlist\" });\n        }\n        let customer = await customerModel.findById(req.userId).populate(\"cart_id\");\n        await wishlistModel.create({ productId: productId, userId: customer._id });\n        let wishlist = await wishlistModel.find({ userId: customer._id });\n        let dataX = {\n            name: customer.name,\n            email: customer.email,\n            customerId: customer._id.toString(),\n            userType: \"CUSTOMER\",\n            isActivated: customer.isActivated,\n            phone: customer.phone,\n            cartLength: customer.cart_id.products.length,\n            wishlistLength: wishlist.length,\n        };\n        res.status(201).send({ status: true, data: dataX, message: \"Added to wishlist\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nconst removeFromWishlist = async (req, res) => {\n    try {\n        let wishlistId = req.params.wishlistId;\n        if (!wishlistId) {\n            return res.status(400).send({ status: false, message: \"bad request\" });\n        }\n        if (!isValidObjectId(wishlistId)) {\n            return res.status(400).send({ status: false, message: \"invalid wishlist id\" });\n        }\n        let wishlist = await wishlistModel.findOneAndDelete({ userId: req.userId, productId: wishlistId });\n        if (wishlist) {\n            res.status(200).send({ status: true, message: \"Removed from wishlist\" });\n        } else {\n            return res.status(400).send({ status: false, message: \"Bad request\" });\n        }\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\nconst getWishlistProduct = async (req, res) => {\n    try {\n        let data = await wishlistModel.find({ userId: req.userId }).populate(\"productId\");\n        res.status(200).send({ status: true, data: data, message: \"Wishlist fetched\" });\n    } catch (error) {\n        return res.status(500).send({ status: false, message: error.message });\n    }\n};\n\nmodule.exports = { addToWishlist, removeFromWishlist, getWishlistProduct };\n","const adminModel = require(\"../models/adminModel\");\r\nconst vendorModel = require(\"../models/vendorModel\");\r\nconst customerModel = require(\"../models/customerModel\");\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst { tokenSecretKey, customerTokenSecretKey } = require(\"../middlewares/config\");\r\nconst { isValidObjectId } = require(\"mongoose\");\r\n\r\n// AUTHENTICATION\r\nconst Authentication = async (req, res, next) => {\r\n    try {\r\n        let tokenWithBearer = req.headers.authorization;\r\n\r\n        if (!tokenWithBearer) {\r\n            return res.status(400).send({ status: false, message: \"token is required\" });\r\n        }\r\n\r\n        let tokenArray = tokenWithBearer.split(\" \");\r\n\r\n        let token = tokenArray[1];\r\n\r\n        if (!token) {\r\n            return res.status(401).send({ status: false, message: \"Invalid token\" });\r\n        }\r\n\r\n        jwt.verify(token, tokenSecretKey, function (err, decode) {\r\n            if (err) {\r\n                return res.status(400).send({ status: false, message: err.message });\r\n            } else {\r\n                req.userId = decode.userId;\r\n                req.userModel = decode.userModel;\r\n                req.userPhone = decode.phone ? decode.phone : \"\"; //'ADMIN': 'VENDOR'\r\n                next();\r\n            }\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst AuthenticationCustomer = async (req, res, next) => {\r\n    try {\r\n        let tokenWithBearer = req.headers.authorization;\r\n        \r\n        if (!tokenWithBearer) {\r\n            return res.status(400).send({ status: false, message: \"token is required\" });\r\n        }\r\n\r\n        let tokenArray = tokenWithBearer.split(\" \");\r\n\r\n        let token = tokenArray[1];\r\n\r\n        if (!token) {\r\n            return res.status(401).send({ status: false, message: \"Invalid token\" });\r\n        }\r\n\r\n        jwt.verify(token, customerTokenSecretKey, function (err, decode) {\r\n            if (err) {\r\n                return res.status(400).send({ status: false, message: err.message });\r\n            } else {\r\n                req.userId = decode.userId;\r\n                req.userModel = decode.userModel;\r\n                req.userPhone = decode.phone ? decode.phone : \"\"; //'ADMIN': 'VENDOR':\"CUSTOMER\"\r\n                next();\r\n            }\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// AUTHORIZATION\r\nconst Authorization = async (req, res, next) => {\r\n    try {\r\n        let tokenId = req.userId;\r\n        let UserId = req.params.userId;\r\n\r\n        if (!isValidObjectId(UserId)) {\r\n            return res.status(400).send({ status: false, message: \"Invalid admin id\" });\r\n        }\r\n\r\n        let admin = await adminModel.findById(UserId);\r\n\r\n        if (!admin) {\r\n            return res.status(404).send({ status: false, message: \"Admin not found\" });\r\n        }\r\n\r\n        let adminId = admin._id;\r\n\r\n        if (adminId.toString() !== tokenId.toString()) {\r\n            return res.status(403).send({ status: false, message: \"authorization failed\" });\r\n        }\r\n        next();\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = { Authentication, Authorization, AuthenticationCustomer };\r\n","const dotenv = require(\"dotenv\");\r\n\r\n// getting all ENV variables before starting another processes\r\ndotenv.config();\r\n\r\nmodule.exports = {\r\n    mongoDbUrl: process.env.MONGO_DB_URL,\r\n    tokenSecretKey: process.env.TOKEN_SECRET_KEY,\r\n    customerTokenSecretKey: process.env.CUSTOMER_TOKEN_SECRET_KEY,\r\n    port: process.env.PORT,\r\n    apiKey: process.env.FIREBASE_API_KEY,\r\n    authDomain: process.env.FIREBASE_AUTH_DOMAIN,\r\n    projectId: process.env.FIREBASE_PROJECT_ID,\r\n    storageBucket: process.env.FIREBASE_STORAGE_BUCKET,\r\n    messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID,\r\n    appId: process.env.FIREBASE_APP_ID,\r\n    measurementId: process.env.FIREBASE_MEASUREMENT_ID,\r\n    adminSecretKey: process.env.ADMIN_SECRET_KEY,\r\n    twilioAuthToken: process.env.TWILIO_AUTH_TOKEN,\r\n    twilioAccSID: process.env.TWILIO_ACCOUNT_SID,\r\n    twilioVerifySID: process.env.TWILIO_VERIFY_SID,\r\n    awsAccessKey: process.env.AWS_ACCESS_KEY_ID,\r\n    awsSecretKey: process.env.AWS_SECRET_ACCESS_KEY,\r\n    awsS3Region: process.env.S3_REGION,\r\n    awsS3Bucket: process.env.S3_BUCKET,\r\n};\r\n","const dotenv = require(\"dotenv\");\r\nconst {\r\n  apiKey,\r\n  authDomain,\r\n  projectId,\r\n  storageBucket,\r\n  messagingSenderId,\r\n  appId,\r\n  measurementId,\r\n} = require(\"../middlewares/config\");\r\n\r\ndotenv.config();\r\n\r\nconst firebaseConfig = {\r\n  apiKey: apiKey,\r\n  authDomain: authDomain,\r\n  projectId: projectId,\r\n  storageBucket: storageBucket,\r\n  messagingSenderId: messagingSenderId,\r\n  appId: appId,\r\n  measurementId: measurementId,\r\n};\r\n\r\nmodule.exports = { firebaseConfig };","const adminModel = require(\"../models/adminModel\");\r\nlet customerModel = require(\"../models/customerModel\");\r\nlet vendorModel = require(\"../models/vendorModel\");\r\nconst { roleEnums, accessControls } = require(\"../utils/enums\");\r\n\r\nconst checkUser = async (req, accessEnum) => {\r\n    let user = null;\r\n    if (req.userModel === \"ADMIN\") {\r\n        user = await adminModel.findOne({ _id: req.userId });\r\n    } else if (req.userModel === \"VENDOR\") {\r\n        user = await vendorModel.findOne({ _id: req.userId });\r\n    }\r\n    if (!user) {\r\n        return false;\r\n    }\r\n    req.userData = user;\r\n    for (let x of user.role) {\r\n        if (accessEnum.includes(x)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n};\r\n\r\n// ADD PRODUCT ROLE\r\nconst AddProductRole = async (req, res, next) => {\r\n    try {\r\n        // roleEnums.MANAGE_PRODUCT.ADD_PRODUCT\r\n        req.userId;\r\n        const admin = await adminModel.findOne({ _id: req.userId });\r\n        next();\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// ALL PRODUCT ROLE\r\nconst AllProductRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [\r\n            accessControls.PRODUCT.PRODUCT_ALL_PRODUCT,\r\n            accessControls.PRODUCT.ACCESS.PRODUCT_DOWNLOAD,\r\n            accessControls.PRODUCT.ACCESS.PRODUCT_EDIT,\r\n            accessControls.PRODUCT.ACCESS.PRODUCT_VIEW,\r\n            accessControls.PRODUCT.PRODUCT_ADD_PRODUCT,\r\n            \"ADMIN\",\r\n        ];\r\n        if (req.userModel === \"VENDOR\") {\r\n            next();\r\n            return;\r\n        }\r\n        let flag = await checkUser(req, accessEnum);\r\n        if (flag) {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n        // admin.role.includes\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// ALL PRODUCT ROLE\r\nconst AllMenuRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [accessControls.PRODUCT.ACCESS.PRODUCT_DOWNLOAD, \"ADMIN\"];\r\n\r\n        let user;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        } else if (req.userModel === \"vendor\") {\r\n            user = await vendorModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n        // admin.role.includes\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE VENDORS\r\nconst AllVendorRoles = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [\r\n            accessControls.VENDOR.ACCESS.VENDOR_DOWNLOAD,\r\n            accessControls.VENDOR.ACCESS.VENDOR_EDIT,\r\n            accessControls.VENDOR.ACCESS.VENDOR_VIEW,\r\n            accessControls.VENDOR.VENDOR_ADD_VENDOR,\r\n            accessControls.VENDOR.VENDOR_ALL_VENDOR,\r\n            accessControls.VENDOR.VENDOR_VENDOR_MOV,\r\n            accessControls.VENDOR.VENDOR_VENDOR_PAYMENT,\r\n            \"ADMIN\",\r\n        ];\r\n        let user;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE VENDORS\r\nconst AddProductColorRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.PRODUCT_COLOR, \"ADMIN\"];\r\n        let user;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE VENDORS\r\nconst AddProductBrandRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.BRAND, \"ADMIN\"];\r\n        let user;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        } else if (req.userModel === \"vendor\") {\r\n            user = await vendorModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE ORDER ROLE\r\nconst ManageOrderRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [\r\n            accessControls.ORDERS.ORDERS_ABANDONED_ORDERS,\r\n            accessControls.ORDERS.ORDERS_ALL_ORDERS,\r\n            accessControls.ORDERS.ORDERS_CHANGE_ORDER_STATUS,\r\n            accessControls.ORDERS.ACCESS.ORDERS_DOWNLOAD,\r\n            accessControls.ORDERS.ACCESS.ORDERS_EDIT,\r\n            accessControls.ORDERS.ACCESS.ORDERS_VIEW,\r\n            \"ADMIN\",\r\n        ];\r\n        let user = null;\r\n        if (req.userModel === \"admin\") {\r\n            user = await adminModel.findOne({ _id: req.userId });\r\n        } else if (req.userModel === \"vendor\") {\r\n            user = await vendorModel.findOne({ _id: req.userId });\r\n        }\r\n\r\n        req.userData = user;\r\n        for (let x of user.role) {\r\n            if (accessEnum.includes(x)) {\r\n                next();\r\n                return;\r\n            }\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\n// MANAGE HOMEPAGE ROLE\r\nconst ManageHomePage = async (req, res) => {\r\n    try {\r\n        let accessEnum = [roleEnums.HOMEPAGE_MANAGE, \"ADMIN\"];\r\n\r\n        let flag = await checkUser(req, accessEnum);\r\n\r\n        if (flag) {\r\n            next;\r\n            return;\r\n        }\r\n\r\n        return res.status(401).send({\r\n            status: false,\r\n            message: \"you don't have permission for this action\",\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst colorRole = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.PRODUCT_COLOR, \"ADMIN\"];\r\n        let flag = await checkUser(req, accessEnum);\r\n        if (flag) {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst verifyProudct = async (req, res, next) => {\r\n    try {\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.PRODUCT_REVIEW, \"ADMIN\"];\r\n        let flag = await checkUser(req, accessEnum);\r\n        if (flag) {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\nconst outOfStockProduct = async (req, res, next) => {\r\n    try {\r\n        console.log(req.userModel);\r\n        if (req.userModel === \"VENDOR\") {\r\n            next();\r\n            return;\r\n        }\r\n        let accessEnum = [roleEnums.MANAGE_PRODUCT.PRODUCT_REVIEW, \"ADMIN\"];\r\n        let flag = await checkUser(req, accessEnum);\r\n        if (flag) {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nconst abandonedOrderRole = async (req, res, next) => {\r\n    try {\r\n        if (req.userModel === \"ADMIN\") {\r\n            next();\r\n            return;\r\n        }\r\n        return res.status(401).send({\r\n            message: \"You don't have permission for this action\",\r\n            status: false,\r\n        });\r\n    } catch (error) {\r\n        return res.status(500).send({ status: false, message: error.message });\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    AddProductRole,\r\n    AllProductRole,\r\n    AllMenuRole,\r\n    AllVendorRoles,\r\n    AddProductColorRole,\r\n    AddProductBrandRole,\r\n    ManageOrderRole,\r\n    colorRole,\r\n    verifyProudct,\r\n    outOfStockProduct,\r\n    abandonedOrderRole,\r\n};\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst homepageSchema = new mongoose.Schema(\r\n    {\r\n        featuredProduct: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Product\",\r\n            },\r\n        ],\r\n        newArrival: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Product\",\r\n            },\r\n        ],\r\n        bestSelling: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Product\",\r\n            },\r\n        ],\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Homepage\", homepageSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst { listOfRoleEnums, listOfAccessControll } = require(\"../utils/enums\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst adminSchema = new mongoose.Schema(\r\n    {\r\n        name: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n        email: {\r\n            type: String,\r\n            required: true,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n        phone: {\r\n            type: String,\r\n            required: true,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n        password: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n        role: [\r\n            {\r\n                type: String,\r\n                enum: listOfAccessControll(),\r\n            },\r\n        ],\r\n        profileUrl: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        isSuperAdmin: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\nmodule.exports = mongoose.model(\"Admin\", adminSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst bankSchema = new mongoose.Schema(\r\n    {\r\n        acHolderName: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n\r\n        acNo: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n\r\n        bankName: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n\r\n        branch: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n\r\n        ifsc: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        cancelledCheque: {\r\n            type: String,\r\n        },\r\n        actionTakenBy: {\r\n            type: ObjectId,\r\n            ref: \"Admin\",\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Bank\", bankSchema);\r\n","const mongoose = require(\"mongoose\");\nconst ObjectId = mongoose.Schema.Types.ObjectId;\n\nconst bannerSchema = new mongoose.Schema(\n    {\n        bannerUrl: {\n            type: String,\n            required: true,\n        },\n        type: {\n            type: String,\n            enum: [\"SINGLE\", \"MULTIPLE\"],\n            required: true,\n        },\n    },\n    { timestamps: true }\n);\n\nmodule.exports = mongoose.model(\"Banner\", bannerSchema);\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst brandSchema = new mongoose.Schema(\r\n    {\r\n        brand_name: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        brandLogo: {\r\n            type: String,\r\n        },\r\n        vendor_id: {\r\n            type:ObjectId,\r\n            ref:\"Vendor\"\r\n        },\r\n        brandStatus:{\r\n            type: String,\r\n            enum: [\"Approved\", \"Rejected\", \"Pending\"],\r\n            default:\"Pending\",\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n\r\n        deletedAt: {\r\n            type: Date,\r\n            default: null,\r\n        },\r\n    },\r\n    {timestamps: true}\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Brand\", brandSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst businessSchema = new mongoose.Schema(\r\n    {\r\n        business_name: {\r\n            type: String,\r\n        },\r\n        business_Logo: {\r\n            type: String,\r\n        },\r\n        invoiceLogo: {\r\n            type: String,\r\n        },\r\n        contactNo: {\r\n            type: String,\r\n        },\r\n        contactEmail: {\r\n            type: String,\r\n        },\r\n        socialMedia: {\r\n            facebook: {\r\n                type: String,\r\n            },\r\n            instagram: {\r\n                type: String,\r\n            },\r\n            twitter: {\r\n                type: String,\r\n            },\r\n            linkedin: {\r\n                type: String,\r\n            },\r\n            youtube: {\r\n                type: String,\r\n            },\r\n        },\r\n        privacyPolicy: {\r\n            type: String,\r\n        },\r\n        iAgree: {\r\n            type: String,\r\n        },\r\n        gsts: [\r\n            {\r\n                gstNo: {\r\n                    type: String,\r\n                },\r\n                pickupAddress: {\r\n                    type: String,\r\n                },\r\n                stateCode: {\r\n                    type: String,\r\n                },\r\n            },\r\n        ],\r\n        defaultGST: {\r\n            gstNo: {\r\n                type: String,\r\n            },\r\n            pickupAddress: {\r\n                type: String,\r\n            },\r\n            stateCode: {\r\n                type: String,\r\n            },\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Business\", businessSchema);\r\n","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\n\r\nconst cancelledReasonSchema = new mongoose.Schema({\r\n    questions: {\r\n        type: ObjectId,\r\n        ref: 'Question',\r\n    },\r\n\r\n    customerAnswer: {\r\n        type: String,\r\n    }\r\n}, {timestamps: true});\r\n\r\nmodule.exports = mongoose.model('Cancelled_Reason', cancelledReasonSchema);","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst cartSchema = new mongoose.Schema(\r\n    {\r\n        products: [\r\n            {\r\n                product_id: {\r\n                    type: ObjectId,\r\n                    ref: \"Product\",\r\n                },\r\n                qty: {\r\n                    type: Number,\r\n                },\r\n                lotSize: {\r\n                    type: String,\r\n                },\r\n                color: {\r\n                    colorName: { type: String },\r\n                    colorHex: { type: String },\r\n                },\r\n                addedAt: {\r\n                    type: String,\r\n                },\r\n            },\r\n        ],\r\n        customer_id: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Cart\", cartSchema);\r\n","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst categorySchema = new mongoose.Schema({\r\n    category_name: {\r\n        type: String,\r\n        required: true,\r\n    },\r\n\r\n    sub_category: [{type:ObjectId, ref: 'Subcategory'}],\r\n\r\n    isDeleted: {\r\n        type: Boolean,\r\n        default: false\r\n    },\r\n\r\n    deletedAt: {\r\n        type: Date,\r\n        default: null,\r\n    }\r\n\r\n}, { timestamps: true });\r\n\r\nmodule.exports = mongoose.model('Category', categorySchema);","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst colorSchema = new mongoose.Schema({\r\n    colorName:{\r\n        type: String,\r\n        trim:true,\r\n        unique:true\r\n    },\r\n    colorHex: {\r\n        type: String,\r\n        trim:true,\r\n        unique:true\r\n    },\r\n    products:[\r\n        {\r\n            type:ObjectId,\r\n            ref:'Product'\r\n        }\r\n    ],\r\n    isDeleted:{\r\n        type:Boolean,\r\n        default:false,\r\n    }\r\n}, {timestamps: true});\r\n\r\nmodule.exports = mongoose.model('Color', colorSchema);","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst couponCodeSchema = new mongoose.Schema(\r\n    {\r\n        customer_id: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Customer\",\r\n            },\r\n        ],\r\n        couponCode: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        validTill: {\r\n            type: Date,\r\n            required: true,\r\n        },\r\n        maxUsers: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        minOrderAmt: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        isUsed: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        isExpired: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        generatedBy: {\r\n            type: ObjectId,\r\n            ref: \"Admin\",\r\n        },\r\n        maxDiscPrice: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        discountType: {\r\n            type: String,\r\n            enum: [\"PRICE\", \"PERCENTAGE\"],\r\n            required: true,\r\n        },\r\n        discountAmt: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"CouponCode\", couponCodeSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst customerAddressSchema = new mongoose.Schema(\r\n    {\r\n        customerId: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n\r\n        address: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n\r\n        state: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        city: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        pincode: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        stateCode: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n\r\n        deletedAt: {\r\n            type: Date,\r\n            default: null,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"CustomerAddress\", customerAddressSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst customerSchema = new mongoose.Schema(\r\n    {\r\n        name: {\r\n            type: String,\r\n        },\r\n        defaultAddress: {\r\n            type: ObjectId,\r\n            ref: \"CustomerAddress\",\r\n        },\r\n        gstNo: {\r\n            type: String,\r\n        },\r\n        phone: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        alternate_phone: {\r\n            type: String,\r\n        },\r\n        email: {\r\n            type: String,\r\n        },\r\n        profileUrl: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        password: {\r\n            type: String,\r\n        },\r\n\r\n        isActivated: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        isBlocked: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        cart_id: {\r\n            type: ObjectId,\r\n            ref: \"Cart\",\r\n        },\r\n        orders: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order\",\r\n            },\r\n        ],\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        deletedAt: {\r\n            type: Date,\r\n            default: null,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Customer\", customerSchema);\r\n","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst documentSchema = new mongoose.Schema({\r\n    brandRegDoc: {\r\n        type: String,\r\n    },\r\n\r\n    gstRegDoc: {\r\n        type: String,\r\n    },\r\n    actionTakenBy:{\r\n        type:ObjectId,\r\n        ref:'Admin'\r\n    }\r\n},\r\n{timestamps: true})\r\n\r\nmodule.exports = mongoose.model('Document', documentSchema);","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst invoiceSchema = new mongoose.Schema(\r\n    {\r\n        invoiceNo: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        invoiceDate: {\r\n            type: Date,\r\n            required: true,\r\n        },\r\n        invoiceType: {\r\n            type: String,\r\n            enum: [\"PURCHASE\", \"SALE\"],\r\n            required: true,\r\n        },\r\n        customer_id: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n        vendor_id: {\r\n            type: ObjectId,\r\n            ref: \"Vendor\",\r\n        },\r\n        order_id: {\r\n            type: ObjectId,\r\n            ref: \"Order\",\r\n        },\r\n        gstAmount: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        gstType: {\r\n            type: String,\r\n            enum: [\"CGST_SGST\", \"IGST\"],\r\n            required: true,\r\n        },\r\n        totalAmount: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        invoiceStatus: {\r\n            type: String,\r\n            enum: [\"PAID\", \"UNPAID\", \"OVERDUE\"],\r\n            default: \"UNPAID\",\r\n        },\r\n        soldBy: {\r\n            name: { type: String },\r\n            address: { type: String },\r\n            phone: { type: String },\r\n            gst: { type: String },\r\n        },\r\n        shippingAddress: {\r\n            name: {\r\n                type: String,\r\n            },\r\n            address: {\r\n                type: String,\r\n                required: true,\r\n            },\r\n            phone: {\r\n                type: String,\r\n            },\r\n            gst: {\r\n                type: String,\r\n            },\r\n        },\r\n        billingAddress: {\r\n            name: {\r\n                type: String,\r\n            },\r\n            address: {\r\n                type: String,\r\n                required: true,\r\n            },\r\n            phone: {\r\n                type: String,\r\n            },\r\n            gst: {\r\n                type: String,\r\n            },\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Invoice\", invoiceSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst invoiceNoSchema = new mongoose.Schema(\r\n    {\r\n        invoiceNo: {\r\n            type: Number,\r\n            default: 0,\r\n            required: true,\r\n        },\r\n        invoiceYear: {\r\n            type: Number,\r\n            default: 23,\r\n            required: true,\r\n        },\r\n        invoiceNoLength: {\r\n            type: Number,\r\n            default: 9,\r\n            required: true,\r\n        },\r\n        invoiceNoType:{\r\n            type: String,\r\n            enum: [\"PURCHASE\", \"SALE\"],\r\n            required: true,\r\n        }\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"InvoiceNo\", invoiceNoSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst orderSchema = new mongoose.Schema(\r\n    {\r\n        orderId: {\r\n            type: String,\r\n        },\r\n\r\n        vendorId: {\r\n            type: ObjectId,\r\n            ref: \"Vendor\",\r\n        },\r\n        vendorAmtInfo: {\r\n            grandTotal: { type: Number },\r\n            gstAmt: { type: Number },\r\n            total: { type: Number },\r\n        },\r\n\r\n        transaction_id: {\r\n            type: String,\r\n        },\r\n\r\n        shipping_charges: {\r\n            type: Number,\r\n        },\r\n\r\n        grand_total: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n\r\n        total: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n\r\n        total_pairs: {\r\n            type: Number,\r\n        },\r\n\r\n        GST_amount: {\r\n            type: Number,\r\n        },\r\n        discounted_amount: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        order_date: {\r\n            type: Date,\r\n        },\r\n\r\n        tracking_id: {\r\n            type: String,\r\n        },\r\n\r\n        transport_bilty: {\r\n            type: String,\r\n        },\r\n\r\n        ordered_products: {\r\n            type: ObjectId,\r\n            ref: \"Ordered_Product\",\r\n        },\r\n\r\n        order_status_id: {\r\n            type: ObjectId,\r\n            ref: \"Order_Status_Table\",\r\n        },\r\n\r\n        payment_id: {\r\n            type: ObjectId,\r\n            ref: \"Payment\",\r\n        },\r\n\r\n        customer_id: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n\r\n        shipping_address: {\r\n            stateCode: { type: String },\r\n            state: { type: String },\r\n            address: { type: String },\r\n        },\r\n        couponCode: {\r\n            type: ObjectId,\r\n            ref: \"CouponCode\",\r\n        },\r\n        saleInvoice: {\r\n            type: ObjectId,\r\n            ref: \"Invoice\",\r\n        },\r\n        purchaseInvoice: {\r\n            type: ObjectId,\r\n            ref: \"Invoice\",\r\n        },\r\n        paymentReportStatus: {\r\n            paymentStatus: {\r\n                type: String,\r\n                enum: [\"PENDING\", \"DUE\", \"PARTIAL_PAID\", \"FULL_PAID\", \"SETTLED_PAID\"],\r\n                default: \"PENDING\",\r\n            },\r\n            paidAmount: {\r\n                type: Number,\r\n            },\r\n            paymentDate: {\r\n                type: Date,\r\n            },\r\n            transactionId: {\r\n                type: String,\r\n            },\r\n            settlementAmt: {\r\n                type: Number,\r\n            },\r\n            message: {\r\n                type: String,\r\n            },\r\n            logs: [],\r\n        },\r\n        partialCancelOrderInfo: {\r\n            orderedAmtInfo: {\r\n                grand_total: {\r\n                    type: Number,\r\n                },\r\n\r\n                total: {\r\n                    type: Number,\r\n                },\r\n\r\n                GST_amount: {\r\n                    type: Number,\r\n                },\r\n            },\r\n            orderedProductAmtInfo: {\r\n                productQty: {\r\n                    type: Number,\r\n                },\r\n                grand_total: {\r\n                    type: Number,\r\n                },\r\n                total: {\r\n                    type: Number,\r\n                },\r\n                GST_amount: {\r\n                    type: Number,\r\n                },\r\n            },\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Order\", orderSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst orderStatusTableSchema = new mongoose.Schema(\r\n    {\r\n        order_id: {\r\n            type: ObjectId,\r\n            ref: \"Order\",\r\n            required: true,\r\n        },\r\n\r\n        status: {\r\n            type: String,\r\n            enum: [\r\n                \"PENDING\",\r\n                \"CONFIRMED\",\r\n                \"PARTIAL_CONFIRMED\",\r\n                \"READY_TO_DISPATCH\",\r\n                \"PICKUP_ALIGNED\",\r\n                \"PICKUP_DONE\",\r\n                \"RETURNED\",\r\n                \"RETURNED_RTO\",\r\n                \"RETURNED_RTO_DELIVERED\",\r\n                \"DELIVERED\",\r\n                \"CANCELLED\",\r\n                \"OUT_FOR_DELIVERY\",\r\n            ],\r\n            default: \"PENDING\",\r\n        },\r\n\r\n        isCompleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n\r\n        statusList: [\r\n            {\r\n                status: {\r\n                    type: String,\r\n                    enum: [\r\n                        \"CONFIRMED\",\r\n                        \"PARTIAL_CONFIRMED\",\r\n                        \"READY_TO_DISPATCH\",\r\n                        \"PICKUP_ALIGNED\",\r\n                        \"PICKUP_DONE\",\r\n                        \"RETURNED\",\r\n                        \"RETURNED_RTO\",\r\n                        \"RETURNED_RTO_DELIVERED\",\r\n                        \"DELIVERED\",\r\n                        \"OUT_FOR_DELIVERY\",\r\n                    ],\r\n                },\r\n                updatedBy: {\r\n                    vendor: { type: ObjectId, ref: \"Vendor\" },\r\n                    admin: { type: ObjectId, ref: \"Admin\" },\r\n                },\r\n                updatedAt: {\r\n                    type: Date,\r\n                },\r\n            },\r\n        ],\r\n        cancelled: {\r\n            cancelledBy: {\r\n                type: String,\r\n                enum: [\"Super_Admin\", \"Vendor\", \"Customer\"],\r\n            },\r\n\r\n            userId: {\r\n                vendor: { type: ObjectId, ref: \"Vendor\" },\r\n                admin: { type: ObjectId, ref: \"Admin\" },\r\n                customer: { type: ObjectId, ref: \"Customer\" },\r\n            },\r\n\r\n            question: {\r\n                type: ObjectId,\r\n                ref: \"Question\",\r\n            },\r\n            description: {\r\n                type: String,\r\n            },\r\n        },\r\n        cancelledStatus: {\r\n            type: String,\r\n            enum: [\"PICKUP_ALIGNED\", \"PICKUP_DONE\", \"RETURNED\", \"RETURNED_RTO\", \"RETURNED_RTO_DELIVERED\", \"CANCELLED\"],\r\n        },\r\n        cancelledStatusList: [\r\n            {\r\n                status: {\r\n                    type: String,\r\n                    enum: [\"PICKUP_ALIGNED\", \"PICKUP_DONE\", \"RETURNED\", \"RETURNED_RTO\", \"RETURNED_RTO_DELIVERED\", \"CANCELLED\"],\r\n                },\r\n                updatedBy: {\r\n                    vendor: { type: ObjectId, ref: \"Vendor\" },\r\n                    admin: { type: ObjectId, ref: \"Admin\" },\r\n                    customer: { type: ObjectId, ref: \"Customer\" },\r\n                },\r\n                updatedAt: {\r\n                    type: Date,\r\n                },\r\n            },\r\n        ],\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Order_Status_Table\", orderStatusTableSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst orderedProductSchema = new mongoose.Schema(\r\n    {\r\n        products: [\r\n            {\r\n                product_id: {\r\n                    type: ObjectId,\r\n                    ref: \"Product\",\r\n                    required: true,\r\n                },\r\n                vendor_id: {\r\n                    type: ObjectId,\r\n                    ref: \"Vendor\",\r\n                    required: true,\r\n                },\r\n                mrp: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                seller_price: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                seller_gst: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                selling_price: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                selling_gst: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                margin: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                lotSize: {\r\n                    type: String,\r\n                },\r\n                color: {\r\n                    colorName: { type: String },\r\n                    colorHex: { type: String },\r\n                },\r\n                hsnCode: {\r\n                    type: String,\r\n                },\r\n                skuCode: {\r\n                    type: String,\r\n                },\r\n                qty: {\r\n                    type: Number,\r\n                    required: true,\r\n                },\r\n                addedAt: {\r\n                    type: String,\r\n                },\r\n                isRemoved: {\r\n                    type: Boolean,\r\n                    default: false,\r\n                },\r\n            },\r\n        ],\r\n        order_id: {\r\n            type: ObjectId,\r\n            ref: \"Order\",\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Ordered_Product\", orderedProductSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst otpSchema = new mongoose.Schema(\r\n  {\r\n    mobile: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n\r\n    otp: {\r\n      type: String,\r\n    },\r\n\r\n    createdAt: {\r\n      type: Date,\r\n      default: Date.now(),\r\n      index: { expires: 300 },\r\n    },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"OTP\", otpSchema);","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst paymentSchema = new mongoose.Schema(\r\n    {\r\n        paymentId: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n        order_id: {\r\n            orderId: {\r\n                type: ObjectId,\r\n                ref: \"Order\",\r\n            },\r\n            order_custom_id: {\r\n                type: String,\r\n            },\r\n        },\r\n        customer_id: {\r\n            type: ObjectId,\r\n            ref: \"Customer\",\r\n        },\r\n        order_status: {\r\n            type: String,\r\n            enum: [\r\n                \"PENDING\",\r\n                \"CONFIRMED\",\r\n                \"PARTIAL_CONFIRMED\",\r\n                \"READY_TO_DISPATCH\",\r\n                \"PICKUP_ALIGNED\",\r\n                \"PICKUP_DONE\",\r\n                \"RETURNED\",\r\n                \"RETURNED_RTO\",\r\n                \"RETURNED_RTO_DELIVERED\",\r\n                \"DELIVERED\",\r\n                \"CANCELLED\",\r\n                \"OUT_FOR_DELIVERY\",\r\n            ],\r\n            default: \"PENDING\",\r\n        },\r\n        payment_status: {\r\n            type: String,\r\n            enum: [\"PENDING\", \"PARTIAL_PAID\", \"RECEIVED\", \"FAILED\", \"PARTIAL_REFUNDED\", \"REFUNDED\"],\r\n        },\r\n\r\n        payment_mode: {\r\n            type: String,\r\n            enum: [\"COD\", \"CUSTOM\", \"TWENTY_ADV\", \"PREPAID\"],\r\n        },\r\n\r\n        transactionId: {\r\n            type: String,\r\n        },\r\n\r\n        payment_amount: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        return_amount: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        cod_received: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        payment_date: {\r\n            type: Date, // when final payment will received, we'll put payment date\r\n        },\r\n        partial_payment: {\r\n            payment_amount: {\r\n                type: Number,\r\n            },\r\n            date: {\r\n                type: Date,\r\n            },\r\n            transactionId: {\r\n                type: String,\r\n            },\r\n        },\r\n        order_amount: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        discount_amt: {\r\n            type: Number,\r\n            default: 0,\r\n        },\r\n        balance_amount: {\r\n            type: Number,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Payment\", paymentSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst slugify = require(\"slugify\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst productSchema = new mongoose.Schema(\r\n    {\r\n        product_name: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n\r\n        sku_code: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n        hsn_code: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n\r\n        description: {\r\n            type: String,\r\n            required: true,\r\n        },\r\n\r\n        mrp: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n        gst: {\r\n            type: Number,\r\n            required: true,\r\n        },\r\n\r\n        seller_price: {\r\n            type: Number,\r\n        },\r\n        sellingGST: {\r\n            type: Number,\r\n        },\r\n        margin: {\r\n            type: Number,\r\n        },\r\n\r\n        stockStatus: {\r\n            type: String,\r\n            enum: [\"In_stock\", \"Out_of_stock\"],\r\n            default: \"In_stock\",\r\n        },\r\n\r\n        qty_in_hand: {\r\n            type: Number,\r\n        },\r\n\r\n        min_order_qty: {\r\n            type: Number,\r\n        },\r\n        lotSizeQty: [\r\n            {\r\n                type: String,\r\n                required: true,\r\n                trim: true,\r\n            },\r\n        ],\r\n        color_id: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Color\",\r\n            },\r\n        ],\r\n        sole: {\r\n            type: String,\r\n            trim: true,\r\n            default:\"\"\r\n        },\r\n\r\n        material: {\r\n            type: String,\r\n            trim: true,\r\n            default:\"\"\r\n        },\r\n        packing_type: {\r\n            type: String,\r\n            trim: true,\r\n            default:\"\"\r\n        },\r\n\r\n        made_in: {\r\n            type: String,\r\n            trim: true,\r\n            default:\"India\"\r\n        },\r\n\r\n        weight: {\r\n            type: Number,\r\n        },\r\n\r\n        categoryId: {\r\n            type: ObjectId,\r\n            ref: \"Category\",\r\n            required: true,\r\n        },\r\n        subCatId: {\r\n            type: ObjectId,\r\n            ref: \"Subcategory\",\r\n            required: true,\r\n        },\r\n\r\n        thumbnail_pic: {\r\n            type: String,\r\n        },\r\n\r\n        multiple_pics: [\r\n            {\r\n                type: String,\r\n            },\r\n        ],\r\n\r\n        meta_title: {\r\n            type: String,\r\n        },\r\n\r\n        meta_keywords: {\r\n            type: String,\r\n        },\r\n\r\n        meta_description: {\r\n            type: String,\r\n        },\r\n\r\n        slug: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n\r\n        status: {\r\n            type: String,\r\n            enum: [\"Approved\", \"Pending\", \"Rejected\"],\r\n            default: \"Pending\",\r\n        },\r\n\r\n        brandId: {\r\n            type: ObjectId,\r\n            ref: \"Brand\",\r\n        },\r\n\r\n        vendor_id: {\r\n            type: ObjectId,\r\n            ref: \"Vendor\",\r\n        },\r\n\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n\r\n        deletedAt: {\r\n            type: Date,\r\n            default: null,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nproductSchema.pre(\"validate\", function (next) {\r\n    if (this.product_name) {\r\n        let product = this.product_name + \" \" + this.sku_code;\r\n        this.slug = slugify(product, { lower: true, strict: true });\r\n    }\r\n    next();\r\n});\r\n\r\nmodule.exports = mongoose.model(\"Product\", productSchema);\r\n","const mongoose = require(\"mongoose\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst questionSchema = new mongoose.Schema(\r\n    {\r\n        questionFor: {\r\n            type: String,\r\n            enum: [\"ADMIN\", \"CUSTOMER\", \"VENDOR\"],\r\n        },\r\n\r\n        question: {\r\n            type: String,\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Question\", questionSchema);\r\n","const mongoose = require('mongoose');\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst subcategorySchema = new mongoose.Schema({\r\n            subcategory_name: {\r\n                type: String, required: true,\r\n            },\r\n            productId: [{\r\n                type: ObjectId, ref: 'Product',\r\n            }],\r\n            isDeleted: {\r\n                type: Boolean,\r\n                default:\r\n                    false\r\n            },\r\n\r\n            deletedAt: {\r\n                type: Date,\r\n                default:\r\n                    null,\r\n            }\r\n\r\n        },\r\n        {\r\n            timestamps: true\r\n        }\r\n    )\r\n;\r\n\r\nmodule.exports = mongoose.model('Subcategory', subcategorySchema);","const mongoose = require(\"mongoose\");\r\nconst { listOfRoleEnums, listOfAccessControll } = require(\"../utils/enums\");\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nconst vendorSchema = new mongoose.Schema(\r\n    {\r\n        firmName: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n\r\n        gstNo: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        representativeName: {\r\n            type: String,\r\n            required: true,\r\n            trim: true,\r\n        },\r\n        profileUrl: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        emailId: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        password: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        mobileNo: {\r\n            type: String,\r\n            required: true,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        altMobileNo: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        pickupState: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        pickupCity: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        pickupPincode: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        invoiceAddress: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        pickupAddress: {\r\n            type: String,\r\n            trim: true,\r\n        },\r\n        termsAndConditions: {\r\n            type: Boolean,\r\n            required: true,\r\n        },\r\n        bank_id: {\r\n            type: ObjectId,\r\n            ref: \"Bank\",\r\n        },\r\n        document_id: {\r\n            type: ObjectId,\r\n            ref: \"Document\",\r\n        },\r\n\r\n        brand_id: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Brand\",\r\n            },\r\n        ],\r\n\r\n        vendor_unique_id: {\r\n            type: String,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        auth_unique_id: {\r\n            type: String,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        db_unique_id: {\r\n            type: String,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        sharing_unique_id: {\r\n            type: String,\r\n            unique: true,\r\n            trim: true,\r\n        },\r\n\r\n        basicInfoStatus: {\r\n            type: String,\r\n            enum: [\"Approved\", \"Rejected\", \"Pending\"],\r\n            default: \"Pending\",\r\n        },\r\n        products: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Product\",\r\n            },\r\n        ],\r\n\r\n        orders: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order\",\r\n            },\r\n        ],\r\n\r\n        order_success: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order_Success\",\r\n            },\r\n        ],\r\n\r\n        order_canclled: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order_Cancelled\",\r\n            },\r\n        ],\r\n\r\n        order_pending: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order_Pending\",\r\n            },\r\n        ],\r\n\r\n        order_inprogress: [\r\n            {\r\n                type: ObjectId,\r\n                ref: \"Order_Inprogress\",\r\n            },\r\n        ],\r\n\r\n        logistics_id: {\r\n            type: ObjectId,\r\n            ref: \"Logistics\",\r\n        },\r\n\r\n        business_id: {\r\n            type: ObjectId,\r\n            ref: \"Business\",\r\n        },\r\n        status: {\r\n            type: String,\r\n            enum: [\"Pending\", \"Rejected\", \"Inprogress\", \"Approved\"],\r\n            default: \"Pending\",\r\n        },\r\n        isActive: {\r\n            type: String,\r\n            enum: [\"Active\", \"Inactive\", \"Blocked\"],\r\n            default: \"Active\",\r\n        },\r\n        actionTakenBy: {\r\n            type: ObjectId,\r\n            ref: \"Admin\",\r\n        },\r\n        marginInPercentage: {\r\n            type: Number,\r\n        },\r\n        isDeleted: {\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n        role: [\r\n            {\r\n                type: String,\r\n                enum: \"VENDOR\",\r\n            },\r\n        ],\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nmodule.exports = mongoose.model(\"Vendor\", vendorSchema);\r\n","const mongoose = require(\"mongoose\");\nconst ObjectId = mongoose.Schema.Types.ObjectId;\n\nconst wishlistSchema = new mongoose.Schema(\n    {\n        productId: {\n            type: ObjectId,\n            ref: \"Product\",\n            required: true,\n        },\n        userId: {\n            type: ObjectId,\n            ref: \"Customer\",\n            required: true,\n        },\n    },\n    { timestamps: true }\n);\n\nmodule.exports = mongoose.model(\"Wishlist\", wishlistSchema);\n","const express = require(\"express\");\nconst { Authentication } = require(\"../middlewares/auth\");\nconst { getDashboardData } = require(\"../controllers/adminDashboard\");\nconst router = express.Router();\n\nrouter.get(\"/admin-dashboard\", Authentication, getDashboardData);\n\nmodule.exports = router;\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst adminController = require(\"../controllers/adminController\");\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\nconst { AddProductRole } = require(\"../middlewares/roleAuth\");\r\nconst { uploadFile } = require(\"../controllers/imageController\");\r\n\r\nrouter.post(\"/addadmin\", Authentication, adminController.addAdmin);\r\nrouter.get(\"/getadmin\", Authentication, adminController.getAllAdmin);\r\nrouter.put(\"/update-admin/:adminid\", Authentication, adminController.updateAdminInfo);\r\nrouter.delete(\"/delete-admin/:adminid\", Authentication, adminController.deleteAdminById);\r\nrouter.post(\"/adminlogin\", adminController.adminLogin);\r\nrouter.post(\"/createsuperadmin/:secretKey\", adminController.createSuperAdmin);\r\nrouter.get(\"/alladminenums\", Authentication, adminController.getAllSubadminEnums);\r\nrouter.put(\"/verifyvendor/:vendorId\", Authentication, adminController.verifyVendor);\r\nrouter.put(\"/changevendorpassword\", adminController.changeVendorPassword);\r\nrouter.delete(\"/deleteVendor\", Authentication, adminController.deleteVendor);\r\n\r\nmodule.exports = router;\r\n","const express = require('express');\r\nconst router = express.Router();\r\nconst brandController = require('../controllers/brandController');\r\nconst {Authentication} = require(\"../middlewares/auth\");\r\n\r\n\r\nrouter.post(\"/brand\", Authentication, brandController.addBrand);\r\nrouter.get('/brands', Authentication,  brandController.getAllBrands);\r\nrouter.get(\"/brands/:vendorId\", Authentication, brandController.getAllBrandByVendor);\r\nrouter.patch(\"/verifybrand/:brandId\", Authentication, brandController.verifyBrandById);\r\n\r\nmodule.exports = router;","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst {\r\n    addBusinessInfo,\r\n    saveSocialMedia,\r\n    addBusinessGST,\r\n    getBusinessInfo,\r\n    addBusinessFiles,\r\n    setDefaultGst,\r\n    bannerForClientPage,\r\n    getBannerForClientPage,\r\n    bannerDeleteById,\r\n} = require(\"../controllers/businessController\");\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/addbusinessinfo\", Authentication, addBusinessInfo);\r\nrouter.post(\"/addbusinessgst\", Authentication, addBusinessGST);\r\nrouter.get(\"/getbusinessinfo\", Authentication, getBusinessInfo);\r\nrouter.post(\"/addbusinessfiles\", Authentication, addBusinessFiles);\r\nrouter.patch(\"/updatedefgst\", Authentication, setDefaultGst);\r\nrouter.post(\"/savesocialmedia\", Authentication, saveSocialMedia);\r\nrouter.post(\"/bannerupload\", Authentication, bannerForClientPage);\r\nrouter.get(\"/bannerimages\", Authentication, getBannerForClientPage);\r\nrouter.get(\"/bannerimagesforclient\", AuthenticationCustomer, getBannerForClientPage);\r\nrouter.delete(\"/deletebanner/:bannerId\", Authentication, bannerDeleteById);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst { addToCart, getAllAbandentCarts, getCartByCustomerId, removeFromCart, qtyIncreaseDecrease } = require(\"../controllers/cartController\");\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\nconst { abandonedOrderRole } = require(\"../middlewares/roleAuth\");\r\n\r\nrouter.post(\"/addtocart/:customerId\", AuthenticationCustomer, addToCart);\r\nrouter.get(\"/cart/:customerId\", getCartByCustomerId);\r\nrouter.get(\"/abandonedcarts\", Authentication, abandonedOrderRole, getAllAbandentCarts);\r\nrouter.put(\"/removefromcart/:customerId/:index\", AuthenticationCustomer, removeFromCart);\r\nrouter.put(\"/qty-increase-decrease/:customerId/:index/:qty\", AuthenticationCustomer, qtyIncreaseDecrease);\r\n\r\nmodule.exports = router;\r\n","const express = require('express');\r\nconst router = express.Router();\r\n\r\nconst categoryController = require('../controllers/categoryController');\r\n\r\n\r\n\r\nrouter.post(\"/category\", categoryController.addCategory);\r\nrouter.get('/categories', categoryController.getAllCategories);\r\n// router.get('/category/:categoryId', productController.getProductById);\r\nrouter.put('/category/:categoryId', categoryController.updateCategoryById);\r\n// router.delete('/category/:categoryId', productController.addProduct);\r\n\r\n\r\nmodule.exports = router;","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\nconst { colorRole } = require(\"../middlewares/roleAuth\");\r\nconst { getAllColor, addNewColor, deleteColorById } = require(\"../controllers/colorController\");\r\n\r\nrouter.get(\"/getallcolors\", getAllColor);\r\nrouter.post(\"/addnewcolor\", Authentication, colorRole, addNewColor);\r\nrouter.delete(\"/deletecolorbyid/:colorId\", Authentication, colorRole, deleteColorById);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst { getAllCoupons, generateCoupon, applyCoupon, deleteCoupon } = require(\"../controllers/couponCodeController\");\r\nconst router = express.Router();\r\n\r\nrouter.get(\"/allcoupon\", getAllCoupons);\r\nrouter.post(\"/generatecoupon\", generateCoupon);\r\nrouter.post(\"/applycoupon/:customerid\", applyCoupon);\r\nrouter.patch(\"/deletecoupon/:couponid\", deleteCoupon);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst customerController = require(\"../controllers/customerController\");\r\nconst customerAddressController = require(\"../controllers/customerAddressController\");\r\n\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/login-customer\", customerController.loginUser);\r\nrouter.get(\"/customers\", Authentication, customerController.getAllCustomer);\r\nrouter.get(\"/customer/:customerId\", Authentication, customerController.getCustomerById);\r\nrouter.put(\"/updatecustomer/:customerId\", AuthenticationCustomer, customerController.updateCustomerById);\r\nrouter.delete(\"/customer/:customerId\", Authentication, customerController.deleteCustomerById);\r\nrouter.post(\"/addcustomrinformation/:customerid\", customerAddressController.addCustomerInformation);\r\nrouter.delete(\"/address/:customerId/:addressId\", AuthenticationCustomer, customerAddressController.deleteAddressById);\r\nrouter.patch(\"/blockcustomer/:customerId\", Authentication, customerController.blockCustomerById);\r\nrouter.post(\"/getordersbycustomerphone\", Authentication, customerController.findOrdersByPhone);\r\nrouter.post(\"/addaddress/:customerId\", AuthenticationCustomer, customerAddressController.addAddress);\r\nrouter.get(\"/getalladdress/:customerId\", AuthenticationCustomer, customerAddressController.getAllAddresses);\r\nrouter.put(\"/setdefaultaddress/:customerId/:addressId\", AuthenticationCustomer, customerController.setDefaultAddress);\r\nrouter.post(\"/change-password/:customerId\", Authentication, customerController.changePassword);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\nconst { AuthenticationCustomer } = require(\"../middlewares/auth\");\nconst { getDashboardData, getProductBySlug } = require(\"../controllers/dashboardController\");\nconst router = express.Router();\n\nrouter.get(\"/get-store-info\", getDashboardData);\nrouter.get(\"/get-product-info-by-id/:slug\", getProductBySlug);\n\nmodule.exports = router;\n","const express = require(\"express\");\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\nconst { addFeaturedProducts, removeFeaturedProduct, getFeaturedProduct } = require(\"../controllers/homepageController\");\r\nconst router = express.Router();\r\n\r\nrouter.post(\"/bestsellingproducts\", Authentication, addFeaturedProducts);\r\nrouter.post(\"/removebestsellingproduct\", Authentication, removeFeaturedProduct);\r\nrouter.get(\"/allbestsellingproduct\", Authentication, getFeaturedProduct);\r\n\r\nmodule.exports = router;","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\nconst { getAllPurchaseInvoice, getAllSaleInvoice, downoadInvoiceByInvoiceNumber } = require(\"../controllers/invoiceController\");\r\n\r\nrouter.get(\"/purchaseinvoice\", Authentication, getAllPurchaseInvoice);\r\nrouter.get(\"/saleinvoice\", Authentication, getAllSaleInvoice);\r\nrouter.get(\"/downloadpdf/:invoicenumber/:invoicetype\", Authentication, downoadInvoiceByInvoiceNumber);\r\nrouter.get(\"/customer-downloadpdf/:invoicenumber/:invoicetype\", AuthenticationCustomer, downoadInvoiceByInvoiceNumber);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst orderController = require(\"../controllers/orderController\");\r\nconst orderStatusTableController = require(\"../controllers/orderStatusTableController\");\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\nconst orderedProductModel = require(\"../models/orderedProductModel\");\r\nconst { exportOrderReport } = require(\"../controllers/excelFileController\");\r\n\r\nrouter.get(\"/orders\", Authentication, orderController.getAllOrders);\r\nrouter.get(\"/order/:customerId/:orderId\", AuthenticationCustomer, orderController.getOrderByOrderId);\r\nrouter.get(\"/orders/:customerId\", AuthenticationCustomer, orderController.getOrdersByCustomerId);\r\nrouter.get(\"/orderedproduct/:orderedproductid\", orderController.getOrderedProduct);\r\nrouter.post(\"/createorder/:customerId\", orderController.createOrder);\r\nrouter.put(\"/cancelorder/:orderId\", orderController.cancelOrderByOrderId);\r\nrouter.put(\"/updateorder/:orderId\", Authentication, orderController.updateOrderByOrderId);\r\nrouter.patch(\"/patchtrackingid/:orderId\", orderController.patchTrackingIdByOrderId);\r\nrouter.get(\"/getcancelledorders\", Authentication, orderController.getAllCancelledOrder);\r\n\r\nrouter.post(\"/order-report\", Authentication, exportOrderReport);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst orderStatusTableController = require(\"../controllers/orderStatusTableController\");\r\n\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/change-order-status/:orderId\", Authentication, orderStatusTableController.updateOrderStatusByOrderId);\r\nrouter.post(\"/change-bulk-order-status\", Authentication, orderStatusTableController.bulkOrderProcess);\r\nrouter.post(\"/return-order-status/:orderId\", Authentication, orderStatusTableController.cancelOrderReturnById);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst { sendOTP, verityOTP, forgetPasswordUsingOtp } = require(\"../controllers/otpController\");\r\nconst { sentOTP, verifyOTP } = require('../controllers/OTP');\r\nconst router = express.Router();\r\n\r\nrouter.get(\"/sendotp/:phone\", sendOTP);\r\nrouter.get(\"/verifyotp/:phone/:otpCode\", verityOTP);\r\nrouter.post(\"/forget-password/:phone/:otpCode\", forgetPasswordUsingOtp);\r\n\r\n// router.post(\"/messages\", sendSMS);\r\nrouter.post(\"/sendOTP\", sentOTP);\r\nrouter.post(\"/verifyOTP\", verifyOTP);\r\n\r\nmodule.exports = router;\r\n","const express = require('express');\r\nconst router = express.Router();\r\nconst paymentController = require('../controllers/paymentController');\r\n\r\nconst { Authentication } = require('../middlewares/auth');\r\n\r\n\r\nrouter.post(\"/addpayment/:orderId\", paymentController.createPayment);\r\nrouter.put(\"/updatepaymentstatus/:paymentId\", paymentController.updatePaymentStatus);\r\nrouter.post(\"/createpayment/:orderId\", paymentController.addPayment);\r\n\r\n\r\nmodule.exports = router;","const express = require(\"express\");\r\nconst app = express();\r\nconst router = express.Router();\r\n\r\nconst productController = require(\"../controllers/productController\");\r\nconst { Authentication, AuthenticationCustomer } = require(\"../middlewares/auth\");\r\nconst { AddProductRole, AllProductRole, verifyProudct, outOfStockProduct } = require(\"../middlewares/roleAuth\");\r\nconst { exportIDs, exportProductAddDemoSheet, csvToJson } = require(\"../controllers/excelFileController\");\r\n\r\n// PRODUCT ROUTES\r\nrouter.post(\"/product\", Authentication, productController.addProduct);\r\nrouter.get(\"/products\", Authentication, productController.getAllProducts);\r\nrouter.get(\"/allproducts\", Authentication, productController.getAllProductsForFilter);\r\nrouter.get(\"/dashboardproduct\", AuthenticationCustomer, productController.getAllProductsForDashboard);\r\nrouter.get(\"/product/:productId\", productController.getProductById);\r\nrouter.patch(\"/changeproductstatus/:productId\", Authentication, productController.changeProductStatus);\r\nrouter.patch(\"/changeproductstockstatus/:productId\", Authentication, productController.changeProductStockStatus);\r\nrouter.put(\"/updateproduct/:productId\", Authentication, productController.updateProduct);\r\n\r\n// router.post(\"/csvupload\", productController.csvProduct);\r\nrouter.get(\"/downloadDependencies\", Authentication, exportIDs);\r\nrouter.get(\"/downloadprodctxlsx\", Authentication, exportProductAddDemoSheet);\r\nrouter.post(\"/bulkproductupload\", Authentication, csvToJson);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\nconst router = express.Router();\nconst { Authentication } = require(\"../middlewares/auth\");\nconst { updateProfile, changePassword } = require(\"../controllers/profileController\");\n\nrouter.put(\"/update-userprofile\", Authentication, updateProfile);\nrouter.post(\"/changePassword\", changePassword);\n\nmodule.exports = router;\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst questionController = require(\"../controllers/questionController\");\r\nconst cancelledReasonController = require(\"../controllers/cancelReasonController\");\r\n\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/addquestion\", Authentication, questionController.addQuestions);\r\nrouter.get(\"/getallquestion\", Authentication, questionController.getAllQuestion);\r\nrouter.get(\"/getallquestionbyuser\", Authentication, questionController.getAllQuestionByModel);\r\nrouter.delete(\"/delete-question-byid/:questionid\", Authentication, questionController.deleteQuestionById);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\nconst { getOrderReport, exportSaleReport, exportPurchaseReport, getPaymentReport, updatePaymentReport } = require(\"../controllers/reportController\");\nconst { Authentication } = require(\"../middlewares/auth\");\nconst router = express.Router();\n\nrouter.get(\"/order-report\", Authentication, getOrderReport);\nrouter.post(\"/export-sale-report\", Authentication, exportSaleReport);\nrouter.post(\"/export-purchase-report\", Authentication, exportPurchaseReport);\nrouter.get(\"/payment-report\", Authentication, getPaymentReport);\nrouter.put(\"/update-payment-report/:orderid\", Authentication, updatePaymentReport)\n\nmodule.exports = router;\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst vendorController = require(\"../controllers/vendorController\");\r\nconst { Authentication } = require(\"../middlewares/auth\");\r\n\r\nrouter.post(\"/addvendor\", vendorController.addVendor);\r\nrouter.get(\"/allvendors\", vendorController.getAllVendors);\r\nrouter.post(\"/create-vendor-by-admin\", Authentication, vendorController.createVendorByAdmin);\r\nrouter.put(\"/update-vendor-by-admin/:vendorId\", Authentication, vendorController.updateVendor);\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\nconst { addToWishlist, removeFromWishlist, getWishlistProduct } = require(\"../controllers/wishlistController\");\nconst { AuthenticationCustomer } = require(\"../middlewares/auth\");\nconst router = express.Router();\n\nrouter.post(\"/add-to-wishlist\", AuthenticationCustomer, addToWishlist);\nrouter.delete(\"/remove-from-wishlist/:wishlistId\", AuthenticationCustomer, removeFromWishlist);\nrouter.get(\"/get-wishlist\", AuthenticationCustomer, getWishlistProduct);\nmodule.exports = router;\n","const isExpiryCoupon = (validTill) => {\n    let day = validTill.getDate();\n    let month = validTill.getMonth() + 1;\n    let year = validTill.getFullYear();\n    let expiryDateMS = new Date(`${year}-${month < 10 ? \"0\" + month : month}-${day < 10 ? \"0\" + day : day}`).getTime() / 1000;\n\n    let now = Date.now();\n    // let date = new Date(now + (5.5 * (3600 * 1000))); // Deployment time cases for +5:30 GMT\n    let date = new Date();\n    let dateStr = `${date.getFullYear()}-${date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1) : date.getMonth() + 1}-${date.getDate() < 10 ? \"0\" + date.getDate() : date.getDate()}`;\n    let currentDateMS = new Date(dateStr).getTime() / 1000;\n\n    return currentDateMS <= expiryDateMS ? false : true;\n};\n\nmodule.exports = { isExpiryCoupon };\n","const dateToLocalDate = (date) => {\n    let day = date.getDate();\n    let month = date.getMonth() + 1;\n    let year = date.getFullYear();\n    day = day < 10 ? \"0\" + day : day;\n    month = month < 10 ? \"0\" + month : month;\n    return `${day}/${month}/${year}`;\n};\n\nconst dateToLocalDateTime = (date) => {\n    let day = date.getDate();\n    let month = date.getMonth() + 1;\n    let year = date.getFullYear();\n    let hr = date.getHours();\n    let min = date.getMinutes();\n    let ampm = hr < 12 ? \"AM\" : \"PM\";\n    hr = hr % 12;\n    hr = hr ? hr : 12;\n    hr = hr < 10 ? \"0\" + hr : hr;\n    min = min < 10 ? \"0\" + min : min;\n    day = day < 10 ? \"0\" + day : day;\n    month = month < 10 ? \"0\" + month : month;\n    return `${day}/${month}/${year} ${hr}:${min} ${ampm}`;\n};\n\nmodule.exports = { dateToLocalDate, dateToLocalDateTime };\n","let roleEnums = {\r\n    MANAGE_MENU: {\r\n        ADD_CATEGORY: \"ADD_CATEGORY\",\r\n        ADD_SUBCATEGORY: \"ADD_SUBCATEGORY\",\r\n    },\r\n    MANAGE_PRODUCT: {\r\n        ADD_PRODUCT: \"ADD_PRODUCT\",\r\n        ALL_PRODUCT: \"ALL_PRODUCT\",\r\n        PRODUCT_COLOR: \"PRODUCT_COLOR\",\r\n        PRODUCT_SIZE: \"PRODUCT_SIZE\",\r\n        BRAND: \"BRAND\",\r\n        OUT_OF_STOCK_PRODUCTS: \"OUT_OF_STOCK_PRODUCTS\",\r\n        PRODUCT_REVIEW: \"PRODUCT_REVIEW\",\r\n    },\r\n    MANAGE_ORDERS: {\r\n        ALL_ORDERS: \"ALL_ORDERS\",\r\n        CONFIRM_ORDERS: \"CONFIRM_ORDERS\",\r\n        SHIPPED_ORDER: \"SHIPPED_ORDER\",\r\n        PICKUP_PENDING: \"PICKUP_PENDING\",\r\n        DELIVERED_ORDER: \"DELIVERED_ORDER\",\r\n        RTO_ORDER: \"RTO_ORDER\",\r\n        RTO_DELIVERED: \"RTO_DELIVERED\",\r\n        CANCEL_ORDER: \"CANCEL_ORDER\",\r\n        PARTIAL_DELIVERED: \"PARTIAL_DELIVERED\",\r\n        HOLD: \"HOLD\",\r\n        PICKUP_INITIATE: \"PICKUP_INITIATE\",\r\n    },\r\n    IMPORT_PINCODE: \"IMPORT_PINCODE\",\r\n    MANAGE_RETURN: {\r\n        RETURN_REQUEST: \"RETURN_REQUEST\",\r\n        SETTLEMENT_REQUEST: \"SETTLEMENT_REQUEST\",\r\n        REFUNDED: \"REFUNDED\",\r\n        SETTLEMENT_REQUEST_CANCEL: \"SETTLEMENT_REQUEST_CANCEL\",\r\n    },\r\n    ALL_USERS: \"ALL_USERS\",\r\n    MANAGE_COUPONS: {\r\n        ADD_COUPON: \"ADD_COUPON\",\r\n        ALL_COUPON: \"ALL_COUPON\",\r\n    },\r\n    MANAGE_SALES: \"MANAGE_SALES\",\r\n    HOMEPAGE_MANAGE: \"HOMEPAGE_MANAGE\",\r\n    MANAGE_VENDOR: {\r\n        ADD_VENDOR: \"ADD_VENDOR\",\r\n        ALL_VENDOR: \"ALL_VENDOR\",\r\n        ALL_OUTSTANDING: \"ALL_OUTSTANDING\",\r\n        ALL_SETTLED: \"ALL_SETTLED\",\r\n    },\r\n    ADD_EMPLOYEE: \"ADD_EMPLOYEE\",\r\n    EXPORT_INFORMATION: \"EXPORT_INFORMATION\",\r\n};\r\nlet accessControls = {\r\n    ORDERS: {\r\n        ACCESS: {\r\n            ORDERS_VIEW: false,\r\n            ORDERS_EDIT: false,\r\n            ORDERS_DOWNLOAD: false,\r\n        },\r\n        ORDERS_ALL_ORDERS: \"ALL_ORDERS\",\r\n        ORDERS_CHANGE_ORDER_STATUS: \"CHANGE_ORDER_STATUS\",\r\n        ORDERS_ABANDONED_ORDERS: \"ABANDONED_ORDERS\",\r\n    },\r\n    COUPON: {\r\n        ACCESS: {\r\n            COUPON_VIEW: false,\r\n            COUPON_EDIT: false,\r\n            COUPON_DOWNLOAD: false,\r\n        },\r\n        COUPON_ALL_COUPON: \"ALL_COUPON\",\r\n        COUPON_ADD_NEW_COUPON: \"ADD_NEW_COUPON\",\r\n    },\r\n    PRODUCT: {\r\n        ACCESS: {\r\n            PRODUCT_VIEW: false,\r\n            PRODUCT_EDIT: false,\r\n            PRODUCT_DOWNLOAD: false,\r\n        },\r\n        PRODUCT_ALL_PRODUCT: \"ALL_PRODUCT\",\r\n        PRODUCT_ADD_PRODUCT: \"ADD_PRODUCT\",\r\n    },\r\n    VENDOR: {\r\n        ACCESS: {\r\n            VENDOR_VIEW: false,\r\n            VENDOR_EDIT: false,\r\n            VENDOR_DOWNLOAD: false,\r\n        },\r\n        VENDOR_ALL_VENDOR: \"ALL_VENDOR\",\r\n        VENDOR_ADD_VENDOR: \"ADD_VENDOR\",\r\n        VENDOR_VENDOR_PAYMENT: \"VENDOR_PAYMENT\",\r\n        VENDOR_VENDOR_MOV: \"VENDOR_MOV\",\r\n    },\r\n    CUSTOMER: {\r\n        ACCESS: {\r\n            CUSTOMER_VIEW: false,\r\n            CUSTOMER_EDIT: false,\r\n            CUSTOMER_DOWNLOAD: false,\r\n        },\r\n        CUSTOMER_ALL_CUSTOMER: \"ALL_CUSTOMER\",\r\n        CUSTOMER_CUSTOMER_ORDER_BY_PHONE: \"CUSTOMER_ORDER_BY_PHONE\",\r\n    },\r\n    SETTING: {\r\n        SETTING_BUSINESS_INFO_SETTING: \"BUSINESS_INFO_SETTING\",\r\n        SETTING_HOMEPAGE_SETTING: \"HOMEPAGE_SETTING\",\r\n    },\r\n    REPORT: {\r\n        ACCESS: { REPORT_VIEW: false, REPORT_DOWNLOAD: false },\r\n    },\r\n    SUB_ADMIN: {\r\n        ACCESS: { SUBADMIN_VIEW: false, SUBADMIN_DOWNLOAD: false },\r\n        SUB_ADMIN_ALL_ADMIN: \"ALL_ADMIN\",\r\n        SUB_ADMIN_ADD_ADMIN: \"ADD_ADMIN\",\r\n    },\r\n};\r\nconst listOfRoleEnums = () => {\r\n    let arr = [\"ADMIN\"];\r\n\r\n    for (let keys in roleEnums) {\r\n        if (typeof roleEnums[keys] === \"string\") {\r\n            arr.push(roleEnums[keys]);\r\n        } else {\r\n            arr = [...arr, ...Object.values(roleEnums[keys]).flat()];\r\n        }\r\n    }\r\n    return arr;\r\n};\r\n\r\nconst listOfAccessControll = () => {\r\n    let arr = [\"ADMIN\"];\r\n    for (let x of Object.keys(accessControls)) {\r\n        if (typeof accessControls[x] !== \"string\") {\r\n            for (let y of Object.keys(accessControls[x])) {\r\n                if (typeof accessControls[x][y] !== \"string\") {\r\n                    for (let z of Object.keys(accessControls[x][y])) {\r\n                        arr.push(z);\r\n                    }\r\n                } else {\r\n                    arr.push(y);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return arr;\r\n};\r\n\r\nmodule.exports = {\r\n    roleEnums,\r\n    listOfRoleEnums,\r\n    accessControls,\r\n    listOfAccessControll,\r\n};\r\n","const Puppeteer = require(\"puppeteer\");\r\nvar hbs = require(\"handlebars\");\r\nvar fs = require(\"fs\");\r\nconst path = require(\"path\");\r\n\r\nconst generatePdf = async (invData, footerText) => {\r\n    const templatePath = path.resolve(\"invoice.hbs\");\r\n    const content = fs.readFileSync(templatePath, \"utf8\");\r\n    const template = hbs.compile(content);\r\n    let html = template(invData);\r\n    const browser = await Puppeteer.launch({ headless: \"new\" });\r\n    const page = await browser.newPage();\r\n    await page.setContent(html);\r\n\r\n    await page.addStyleTag({ content: \".pageNumbers { content: counter(page) }\" })\r\n    let pdf = await page.pdf({\r\n        format:'A4',\r\n        printBackground: true,\r\n        displayHeaderFooter: true,\r\n        footerTemplate: `<div style='width:100%; font-size:10px; text-align: end; font-weight: 600; padding-right:20px'>${footerText}<span style=\"margin-left:5px;\"><span class='pageNumber'></span><span>/</span><span class='totalPages'></span></span></div>`,\r\n    });\r\n    await browser.close();\r\n    return pdf;\r\n};\r\n\r\nmodule.exports = { generatePdf };\r\n\r\n\r\n// const data = {\r\n//     logo: \"\",\r\n//     brandName: \"\",\r\n//     soldBy: \"\",\r\n//     soldByAddress: \"\",\r\n//     soldByGst: \"\",\r\n//     invoiceNo: \"\",\r\n//     orderId: \"\",\r\n//     orderDate: \"\",\r\n//     invoiceDate: \"\",\r\n//     billToName: \"\",\r\n//     billToAddress: \"\",\r\n//     billToPhone: \"\",\r\n//     billToGST: \"\",\r\n//     shipToName: \"\",\r\n//     shipToAddress: \"\",\r\n//     shipToPhone: \"\",\r\n//     shipToGST: \"\",\r\n//     tableRow: [],\r\n//     totalAmt: \"\",\r\n//     totalCGSTAmt: \"\",\r\n//     totalSGSTAmt: \"\",\r\n//     totalIGSTAmt: \"\",\r\n//     taxableAmt: \"\",\r\n//     totalTaxAmt: \"\",\r\n//     grossTotalAmt: \"\",\r\n//     discountAmt: \"\",\r\n//     netPayableAmount: \"\",\r\n// };","const financialYear = () => {\n    let date = new Date();\n    let currentYear = date.getFullYear();\n    let currentMonth = date.getMonth() + 1;\n    let year = \"\";\n    if (currentMonth < 4) {\n        year = currentYear - 1;\n    } else {\n        year = currentYear;\n    }\n    return year.toString().slice(2);\n};\n\nmodule.exports = { financialYear };\n","const percentage = (num, per) => {\r\n    return (Number(num)*Number(per))/100;\r\n}\r\n\r\nconst calculateMarginAndSelling = (sellerAmount, margin, sellingGst) => {\r\n    if(Number(sellerAmount) === 0){\r\n        return 0;\r\n    }\r\n  \r\n    let baseAmount = Number(sellerAmount);\r\n    if(Number(margin) === 0){\r\n        return Number(baseAmount.toFixed(2));\r\n    }else{\r\n        let basePlusMarginAmt = percentage(baseAmount, margin) + baseAmount;\r\n        let totalAmt = percentage(basePlusMarginAmt, sellingGst) + Number(basePlusMarginAmt);\r\n        return Number(totalAmt.toFixed(2));\r\n    }\r\n}\r\nmodule.exports = {percentage,calculateMarginAndSelling};","const stateAndCode = {\r\n    \"Himachal Pradesh\": \"02\",\r\n    Punjab: \"03\",\r\n    Chandigarh: \"04\",\r\n    Uttarakhand: \"05\",\r\n    Haryana: \"06\",\r\n    Delhi: \"07\",\r\n    Rajasthan: \"08\",\r\n    \"Uttar Pradesh\": \"09\",\r\n    Bihar: \"10\",\r\n    Sikkim: \"11\",\r\n    \"Arunanchal Pradesh\": \"12\",\r\n    Nagaland: \"13\",\r\n    Manipur: \"14\",\r\n    Mizoram: \"15\",\r\n    Tripura: \"16\",\r\n    Meghalaya: \"17\",\r\n    Assam: \"18\",\r\n    \"West Bengal\": \"19\",\r\n    Jharkhand: \"20\",\r\n    Odisha: \"21\",\r\n    Chattisgarh: \"22\",\r\n    \"Madhya Pradesh\": \"23\",\r\n    Gujarat: \"24\",\r\n    \"Dadra And Nagar Haveli And Daman And  Diu\": \"26\",\r\n    Maharashtra: \"27\",\r\n    Karnataka: \"29\",\r\n    Goa: \"30\",\r\n    Lakshadweep: \"31\",\r\n    Kerela: \"32\",\r\n    \"Tamil Nadu\": \"33\",\r\n    Puducherry: \"34\",\r\n    \"Andaman and Nicobar Islands\": \"35\",\r\n    Telangana: \"36\",\r\n    \"Andhra Pradesh\": \"37\",\r\n    Ladakh: \"38\",\r\n    \"Other Territory\": \"97\",\r\n};\r\n\r\nmodule.exports = {stateAndCode}","const ObjectId = require(\"mongoose\").Types.ObjectId;\r\n\r\nconst isValidRequestBody = (requestBody) => {\r\n  return Object.keys(requestBody).length > 0;\r\n};\r\n\r\nconst isValidObjectId = (objectId) => {\r\n  if (!ObjectId.isValid(objectId)) return false;\r\n  return true;\r\n};\r\n\r\nconst isValid = (value) => {\r\n  if (typeof value === \"undefined\" || typeof value === null) return false;\r\n  if (typeof value === \"string\" && value.trim().length == 0) return false;\r\n  return true;\r\n};\r\n\r\nlet isValidName = function (name) {\r\n  let nameRegex = /^[A-Za-z\\s]{1,}[A-Za-z\\s]{0,}$/;\r\n  return nameRegex.test(name);\r\n};\r\n\r\nconst isValidEmail = function (gmail) {\r\n  let regex = /^\\w+([\\.-]?\\w+)@\\w+([\\.-]?\\w+)(\\.\\w{2,6})+$/;\r\n  return regex.test(gmail);\r\n};\r\n\r\nlet isValidPassword = function (password) {\r\n  let regexPassword =\r\n    /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,15}$/;\r\n  return regexPassword.test(password);\r\n};\r\n\r\nconst isValidMoblie = function (mobile) {\r\n  let regex =\r\n    /^(?:(?:\\+|0{0,2})91(\\s*|[\\-])?|[0]?)?([6789]\\d{2}([-]?)\\d{3}([-]?)\\d{4})$/;\r\n  return regex.test(mobile);\r\n};\r\n\r\nconst isValidGST = function (GST) {\r\n  let regex = /\\d{2}[A-Z]{5}\\d{4}[A-Z]{1}[A-Z\\d]{1}[Z]{1}[A-Z\\d]{1}/;\r\n  return regex.test(GST);\r\n};\r\n\r\nconst isValidPrice = function (price) {\r\n  let regex = /^\\d+(?:[.,]\\d+)*$/;\r\n  return regex.test(price);\r\n};\r\n\r\nconst isValidImg = (img) => {\r\n  const reg = /image\\/png|image\\/jpeg|image\\/jpg/;\r\n  return reg.test(img);\r\n};\r\n\r\nfunction isValidStatus(value) {\r\n  if( [\"pending\", \"completed\", \"cancled\"].indexOf(value) == -1) {return false}\r\n  else return true\r\n};\r\n\r\nfunction isValidPin(pin) {\r\n  const regex = /^[1-9]{1}[0-9]{2}\\\\s{0, 1}[0-9]{3}$/;\r\n  return regex.test(pin);\r\n}\r\n\r\nmodule.exports = {\r\n  isValidRequestBody,\r\n  isValidObjectId,\r\n  isValid,\r\n  isValidName,\r\n  isValidEmail,\r\n  isValidImg,\r\n  isValidPassword,\r\n  isValidMoblie,\r\n  isValidGST,\r\n  isValidPrice,\r\n  isValidStatus,\r\n  isValidPin\r\n};","module.exports = require(\"aws-sdk\");","module.exports = require(\"aws-sdk/lib/maintenance_mode_message\");","module.exports = require(\"axios\");","module.exports = require(\"bcrypt\");","module.exports = require(\"body-parser\");","module.exports = require(\"convert-csv-to-json\");","module.exports = require(\"cors\");","module.exports = require(\"csvtojson\");","module.exports = require(\"dotenv\");","module.exports = require(\"exceljs\");","module.exports = require(\"express\");","module.exports = require(\"express-fileupload\");","module.exports = require(\"firebase/app\");","module.exports = require(\"firebase/storage\");","module.exports = require(\"handlebars\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"lodash\");","module.exports = require(\"mongoose\");","module.exports = require(\"puppeteer\");","module.exports = require(\"request\");","module.exports = require(\"slugify\");","module.exports = require(\"twilio\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const express = require(\"express\");\r\nconst mongoose = require(\"mongoose\");\r\nconst bodyParser = require(\"body-parser\");\r\nconst fileUpload = require(\"express-fileupload\");\r\nconst path = require(\"path\");\r\nconst cors = require(\"cors\");\r\nconst app = express();\r\nrequire(\"dotenv\").config();\r\n\r\nconst productRoutes = require(\"./src/routes/productRoutes\");\r\nconst categoryRoutes = require(\"./src/routes/categoryRoutes\");\r\nconst brandRoutes = require(\"./src/routes/brandRoutes\");\r\nconst vendorRoutes = require(\"./src/routes/vendorRoutes\");\r\nconst adminRoutes = require(\"./src/routes/adminRoutes\");\r\nconst colorRoutes = require(\"./src/routes/colorRoutes\");\r\nconst customerRoutes = require(\"./src/routes/customerRoutes\");\r\nconst orderRoutes = require(\"./src/routes/orderRoutes\");\r\nconst paymentRoutes = require(\"./src/routes/paymentRoutes\");\r\nconst cartRoutes = require(\"./src/routes/cartRoutes\");\r\nconst questionRoutes = require(\"./src/routes/questionsRoutes\");\r\nconst couponRoutes = require(\"./src/routes/couponCodeRoutes\");\r\nconst businessRoutes = require(\"./src/routes/businessRoutes\");\r\nconst homepageRoutes = require(\"./src/routes/homepageRoutes\");\r\nconst invoiceRoutes = require(\"./src/routes/invoiceRoutes\");\r\nconst optRoutes = require(\"./src/routes/otpRoutes\");\r\nconst orderStatusRoute = require(\"./src/routes/orderStatusTableRoutes\");\r\nconst profileRoutes = require(\"./src/routes/profileRoutes\");\r\nconst reportRoutes = require(\"./src/routes/reportRoutes\");\r\nconst dashboardRoutes = require(\"./src/routes/dashboardRoutes\");\r\nconst wishlistRoutes = require(\"./src/routes/wishlistRoutes\");\r\nconst adminDashboardRoute = require(\"./src/routes/adminDashboardRoute\");\r\nconst { mongoDbUrl, port } = require(\"./src/middlewares/config\");\r\n\r\napp.use(express.json());\r\napp.use(fileUpload());\r\napp.use(express.urlencoded({ extended: true }));\r\napp.use(bodyParser.json());\r\napp.use(cors());\r\n\r\nmongoose\r\n    .connect(mongoDbUrl, { useNewUrlParser: true })\r\n    .then(() => console.log(\"Connected with Database\"))\r\n    .catch((err) => console.log(err));\r\n\r\napp.use(\"/\", productRoutes);\r\napp.use(\"/\", categoryRoutes);\r\napp.use(\"/\", brandRoutes);\r\napp.use(\"/\", vendorRoutes);\r\napp.use(\"/\", adminRoutes);\r\napp.use(\"/\", colorRoutes);\r\napp.use(\"/\", customerRoutes);\r\napp.use(\"/\", orderRoutes);\r\napp.use(\"/\", paymentRoutes);\r\napp.use(\"/\", cartRoutes);\r\napp.use(\"/\", questionRoutes);\r\napp.use(\"/\", couponRoutes);\r\napp.use(\"/\", businessRoutes);\r\napp.use(\"/\", homepageRoutes);\r\napp.use(\"/\", invoiceRoutes);\r\napp.use(\"/\", optRoutes);\r\napp.use(\"/\", orderStatusRoute);\r\napp.use(\"/\", profileRoutes);\r\napp.use(\"/\", reportRoutes);\r\napp.use(\"/\", dashboardRoutes);\r\napp.use(\"/\", wishlistRoutes);\r\napp.use(\"/\", adminDashboardRoute);\r\n\r\napp.get(\"/\", (req, res) => {\r\n    res.send(\"<h1>factorez.com backend deployed successfully</h1>\");\r\n});\r\n\r\napp.listen(port, () => console.log(`Server is up and running on port: ${port}`));\r\n"],"names":["axios","bcrypt","otpModel","module","exports","sentOTP","async","req","res","apiKey","sid","type","senderId","to","OTP","length","id","i","Math","floor","digits","random","generateRandomID","smsData","method","url","headers","data","response","hash","otp","mobile","save","status","send","message","error","console","log","verifyOTP","body","otpHolder","find","validOTP","validUser","compare","deleteMany","adminModel","jwt","listOfRoleEnums","roleEnums","adminSecretKey","tokenSecretKey","vendorModel","isValid","isValidEmail","productModel","addAdmin","name","email","phone","password","role","$or","toLowerCase","isDeleted","admin","create","undefined","isSuperAdmin","getAllAdmin","select","createSuperAdmin","params","secretKey","superAdmin","adminLogin","includes","user","findOne","emailId","vendor_unique_id","err","result","date","Date","now","userFlag","userType","photo","profileUrl","vendorId","representativeName","altMobileNo","mobileNo","issueTime","token","sign","userId","_id","toString","userModel","iat","expiresIn","setHeader","hasAccess","getAllSubadminEnums","verifyVendor","vendorMargin","vendorStatus","vendorObj","findById","marginInPercentage","actionTakenBy","updateMany","vendor_id","$set","margin","deleteVendor","vendor","changeVendorPassword","newPassword","hashedPassword","updateAdminInfo","adminId","adminid","deleteAdminById","customerModel","orderModel","getDateStrToMS","dateStr","setHours","getTime","getCurrentYear","firstMonth","getFullYear","lastMonth","getCurrentMonth","firstDay","getMonth","lastDay","getCurrentWeek","curr","first","getDate","getDay","last","setDate","getDashboardData","products","populate","productCount","customerCount","vendorCount","orderCount","todayOrderCount","thisWeakOrderCount","thisMonthOrderCount","thisYearOrderCount","thisYearSale","thisMonthSale","thisWeekSale","overAllSale","todaySale","x","isActive","todayMS","orders","order_date","order_status_id","grand_total","overallOrder","brandModel","isValidObjectId","uploadFile","addBrand","brand_name","brandLogo","logoUrl","files","brandData","newBrand","brand_id","push","getAllBrands","brands","getAllBrandByVendor","verifyBrandById","brandId","brandStatus","brand","businessModel","uploadImage","bannerModel","addBusinessInfo","bName","bEmail","bNumber","businessData","business_name","contactNo","contactEmail","businessExists","addBusinessGST","gsts","defaultGST","getBusinessInfo","business","addBusinessFiles","bLogo","bInvLogo","bPolicy","bTC","business_Logo","invoiceLogo","privacyPolicy","iAgree","setDefaultGst","gst","gstd","gstNo","pickupAddress","stateCode","saveSocialMedia","facebook","instagram","twitter","youtube","linkedin","socialMedia","bannerForClientPage","images","imageURL","bannerUrl","getBannerForClientPage","bannerDeleteById","bannerId","findByIdAndDelete","cancelledReasonModel","addCancelledReason","questions","customerAnswer","cancelledReasonData","newCancelledReason","cartModel","colorModel","addToCart","customerId","product_id","qty","lotSize","colorId","cart","customer_id","customer","color","Number","colorName","colorHex","addedAt","toLocaleString","dataX","isActivated","cartLength","getAllAbandentCarts","carts","$gte","$size","path","model","getCartByCustomerId","customerData","removeFromCart","index","arr","splice","json","qtyIncreaseDecrease","cartAmt_current","totalPrice","forEach","element","seller_price","sellingGST","price","marginAmt","toFixed","priceCal","totalPriceCalc","currentCoupon","minOrderAmt","categoryModel","subcategoryModel","addCategory","category_name","subCategory","categoryData","sub_category","insertMany","newCategory","getAllCategories","categories","getCategoryById","categoryId","category","updateCategoryById","el","isFound","innerEl","hasOwnProperty","toHexString","findOneAndUpdate","deletedAt","new","subCategoryCreated","objs","xId","deleteCategoryById","addNewColor","deleteColorById","getAllColor","colors","couponCodeModel","isExpiryCoupon","generateCoupon","couponCode","validTill","maxUsers","maxDiscPrice","discountType","discountAmt","createData","createdCoupon","applyCoupon","customerid","orderAmount","coupon","isExpired","isUsed","day","month","year","expiryDateMS","getAllCoupons","coupons","sort","createdAt","deleteCoupon","couponId","couponid","customerAddressModel","isValidRequestBody","stateAndCode","addCustomerInformation","alternate_phone","pincode","address","state","city","addressData","Object","keys","isBlocked","cart_id","newAddress","defaultAddress","getAllAddresses","updateAddressByCustomerId","deleteAddressById","addressId","defaultAddressId","addAddress","isValidMoblie","isValidPassword","customerTokenSecretKey","wishlistModel","loginUser","wishlist","wishlistLength","getAllCustomer","customers","getCustomerById","updateCustomerById","deleteCustomerById","blockCustomerById","findOrdersByPhone","userPhone","setDefaultAddress","changePassword","HomepageModel","recommendedProduct","storeInfo","getProductBySlug","slug","product","stockStatus","excelJs","csv2json","request","dateToLocalDateTime","checkProductIds","categoryIds","colorIds","vednorIdForx","x1","color_id","subCatId","exportProductAddDemoSheet","workbook","Workbook","worksheet","addWorksheet","columnData","header","key","product_name","skucode","hsncode","category_id","subcategory_id","lotsize","mrp","in_hand_qty","min_order_qty","sole","material","packing_type","made_in","weight","description","thumbnail_url","multiple_images","unshift","newColumnData","slice","columns","addRow","getRow","eachCell","cell","font","bold","fill","pattern","fgColor","argb","xlsx","write","then","exportIDs","worksheet2","cat","subcategory_name","vendors","singleVendor","firmName","lastRow","obj","column","lengths","values","map","v","maxLength","max","filter","width","csvToJson","vendorIds","csvUrl","csv","resJson","fromStream","get","subscribe","productData","sku_code","hsn_code","lotSizeQty","qty_in_hand","productDataArr","vendorArr","Obj","split","flatMap","trim","thumbnail_pic","multiple_pics","statusX","indexOf","newProductObj","vdr","prdct","e","exportOrderReport","$in","strictPopulate","ordersArr","orderData","productLength","order","orderId","saleInvoice","invoiceNo","invoiceDate","ordered_products","skuCode","selling_gst","seller_gst","soldBy","discounted_amount","total","gstType","GST_amount","pickupCity","pickupState","pickupPincode","vendorAmtInfo","grandTotal","purchaseInvoice","gstAmt","orderStatusList","statusList","updatedDate","updatedAt","updatedBy","orderCol","buyerCol","saleCol","sellerCol","purchaseCol","orderJourney","m","saleSkuCol","purchaseSkuCol","saleGstCol","purchaseGstCol","saleLotSizeCol","purchaseLotSizeCol","orderLen","buyerLen","saleLen","sellerLen","purchaseLen","height","colNum","border","top","style","right","bottom","left","addFeaturedProducts","newArrival","featuredProduct","bestSelling","home","getFeaturedProduct","removeFeaturedProduct","idx","findIndex","preFix","generateRandomAlphaNumericID","characters","initializeApp","getStorage","ref","getDownloadURL","uploadBytesResumable","aws","config","awsS3Bucket","awsAccessKey","awsSecretKey","awsS3Region","firebaseConfig","storage","giveCurrentDateTime","today","getHours","getMinutes","getSeconds","update","accessKeyId","secretAccessKey","region","blobFile","dateTime","storageRef","replace","metadata","contentType","mimetype","snapshot","downloadURL","image","Promise","resolve","reject","s3","S3","uploadParams","Bucket","Key","Body","ContentType","upload","Location","invoiceModel","invoiceNoModel","orderedProductModel","generatePdf","financialYear","generatePurchaseInvoice","order_id","gstAmount","totalAmount","invNo","invoiceNoType","fY","invoiceYear","invoiceNoLength","strInvNumber","invNumber","substring","invData","invoiceType","invoiceAddress","shippingAddress","billingAddress","invRes","invoice","generateSaleInvoice","getAllSaleInvoice","invoices","getAllPurchaseInvoice","downoadInvoiceByInvoiceNumber","invoiceNumber","invoicenumber","invoicetype","orderedProduct","logo","brandName","soldByAddress","soldByPhone","soldByGst","orderDate","billToName","billToAddress","billToPhone","billToGST","shipToName","shipToAddress","shipToPhone","shipToGST","tableRow","totalAmt","totalCGSTAmt","totalSGSTAmt","totalIGSTAmt","taxableAmt","totalTaxAmt","grossTotalAmt","netPayableAmount","count","isRemoved","trData","sno","productName","sizeSet","hsnCode","rate","cgstPercentage","cgstAmount","sgstPercentage","sgstAmount","igstPercentage","igstAmount","pdf","customerAddress","mrginAmt","paymentModel","orderStatusTableModel","createPayment","createOrder","address_id","payment_mode","paymentAmt","transaction_id","demoObj","orderAmt","mAmt","totalamt","p","selling_price","sellingGstAmt","currentTotal","vdrAmt","vdrGstAmt","odrObj","addedOrder","maxDiscount","discAmt","singleOrder","percentage","partPayment","payment","payment_id","paymentId","shipping_address","getAllOrders","getOrderByOrderId","getOrdersByCustomerId","customerOrders","cancelOrderByOrderId","Status","updateOrderByOrderId","orderType","cancelMessage","questionId","removedProductIds","partialCanceledAmt","partialCanceledGstAmt","orderedProductAmtInfo","productQty","orderedAmtInfo","s_product","canceledAmt","adminCancelledAmt","order_status","updatedByObj","statusObj","partialCancelOrderInfo","purchaseGstAmount","purchaseTotalAmount","singleOrderProduct","invDataPurchase","invDataSale","partial_payment","payment_amount","return_amount","balance_amount","order_amount","resData","resData2","cancelled","question","cancelledStatus","objOfCancelledStatusList","cancelledStatusList","cod_received","getOrderedProduct","orderedproductid","patchTrackingIdByOrderId","t_id","tracking_id","getAllCancelledOrder","cancelledOrders","createOrderStatusTable","cancelledObj","cancelledBy","reason","orderStatusTableData","isCompleted","OrderStatusTableData","getAllOrderStatusTables","allOrderStatusTables","getOrderStatusTableById","orderStatusTableId","orderStatusTable","updateOrderStatusByOrderId","bulkOrderProcess","orderIds","orderStatusTables","cancelOrderReturnById","twilioAccSID","twilioAuthToken","twilioVerifySID","accountSid","authToken","verifySid","client","sendOTP","isSent","verify","v2","services","verifications","channel","verification","catch","verityOTP","otpCode","verificationChecks","code","verification_check","valid","resAcc","statusCode","createAccountAndToken","forgetPasswordUsingOtp","updatePassword","order_sortId","paymentData","payment_status","discount_amt","order_custom_id","transactionId","payment_date","updatePaymentStatus","addPayment","paymentDetails","partial_mode","ten_percent_amount","partialPaymentDetails","amount","firstPartialPayment","partialPaymentModel","partialPaymentData","remaining_amount","newPartialPayment","newPayment","twenty_percent_amount","reduce","sum","item","subCategoryModel","calculateMarginAndSelling","uploadMultipleImage","blob","addProduct","meta","JSON","parse","meta_title","metaTitle","meta_keywords","metaKeyword","meta_description","metaDescription","multipleImage","thumbnail","mulImg","Array","isArray","val","img","brandObj","categoryObj","subCatObj","getAllProducts","getProductById","productId","updateProductByProductId","gst_amount","stock_status","size_qty","primary_category","deleteProductByProductId","getAllProductsForDashboard","changeProductStatus","newStatus","changeProductStockStatus","newStockStatus","csvProduct","getAllProductsForFilter","updateProduct","singleFile","updateProfile","fullName","emailID","altPhone","newPass","oldPass","profileImg","imgRes","y","userid","questionModel","addQuestions","questionFor","questionObj","allQuestion","getAllQuestionByModel","getAllQuestion","deleteQuestionById","questionid","getOrderReport","$exists","exportSaleReport","startDate","endDate","invoice_no","invoice_date","order_qty","invoice_value","advance","discount","net_amount","refund","cash_on_delivery","buyer_name","buyer_no","exportPurchaseReport","seller_name","seller_phone","factorez_gst","purchase","gst_percentage","taxable_value","quantity","getPaymentReport","updatePaymentReport","orderid","paymentStatus","paidAmount","paymentDate","settlementAmt","paymentReportStatus","updateAt","logs","bankModel","documentModel","isValidGST","getAllVendors","addVendor","acHolderName","acNo","bankName","branch","ifsc","termsAndConditions","gstRegDoc","brandRegDoc","cancelledCheque","documentData","bankData","vendorData","document","bank","bank_id","document_id","auth_unique_id","db_unique_id","sharing_unique_id","createVendorByAdmin","basicInfoStatus","updateVendor","vendorObjId","brandX","addToWishlist","removeFromWishlist","wishlistId","findOneAndDelete","getWishlistProduct","Authentication","next","tokenWithBearer","authorization","decode","Authorization","tokenId","UserId","AuthenticationCustomer","mongoDbUrl","process","env","MONGO_DB_URL","TOKEN_SECRET_KEY","CUSTOMER_TOKEN_SECRET_KEY","port","PORT","FIREBASE_API_KEY","authDomain","FIREBASE_AUTH_DOMAIN","projectId","FIREBASE_PROJECT_ID","storageBucket","FIREBASE_STORAGE_BUCKET","messagingSenderId","FIREBASE_MESSAGING_SENDER_ID","appId","FIREBASE_APP_ID","measurementId","FIREBASE_MEASUREMENT_ID","ADMIN_SECRET_KEY","TWILIO_AUTH_TOKEN","TWILIO_ACCOUNT_SID","TWILIO_VERIFY_SID","AWS_ACCESS_KEY_ID","AWS_SECRET_ACCESS_KEY","S3_REGION","S3_BUCKET","dotenv","accessControls","checkUser","accessEnum","userData","AddProductRole","AllProductRole","PRODUCT","PRODUCT_ALL_PRODUCT","ACCESS","PRODUCT_DOWNLOAD","PRODUCT_EDIT","PRODUCT_VIEW","PRODUCT_ADD_PRODUCT","AllMenuRole","AllVendorRoles","VENDOR","VENDOR_DOWNLOAD","VENDOR_EDIT","VENDOR_VIEW","VENDOR_ADD_VENDOR","VENDOR_ALL_VENDOR","VENDOR_VENDOR_MOV","VENDOR_VENDOR_PAYMENT","AddProductColorRole","MANAGE_PRODUCT","PRODUCT_COLOR","AddProductBrandRole","BRAND","ManageOrderRole","ORDERS","ORDERS_ABANDONED_ORDERS","ORDERS_ALL_ORDERS","ORDERS_CHANGE_ORDER_STATUS","ORDERS_DOWNLOAD","ORDERS_EDIT","ORDERS_VIEW","colorRole","verifyProudct","PRODUCT_REVIEW","outOfStockProduct","abandonedOrderRole","mongoose","ObjectId","Schema","Types","homepageSchema","timestamps","listOfAccessControll","adminSchema","String","required","unique","enum","Boolean","default","bankSchema","bannerSchema","brandSchema","businessSchema","cancelledReasonSchema","cartSchema","categorySchema","colorSchema","couponCodeSchema","generatedBy","customerAddressSchema","customerSchema","documentSchema","invoiceSchema","invoiceStatus","invoiceNoSchema","orderSchema","shipping_charges","total_pairs","transport_bilty","orderStatusTableSchema","orderedProductSchema","otpSchema","expires","paymentSchema","slugify","productSchema","pre","this","lower","strict","questionSchema","subcategorySchema","vendorSchema","order_success","order_canclled","order_pending","order_inprogress","logistics_id","business_id","wishlistSchema","express","router","Router","adminController","post","put","delete","brandController","patch","categoryController","customerController","customerAddressController","orderController","orderStatusTableController","paymentController","productController","questionController","vendorController","dateToLocalDate","hr","min","ampm","MANAGE_MENU","ADD_CATEGORY","ADD_SUBCATEGORY","ADD_PRODUCT","ALL_PRODUCT","PRODUCT_SIZE","OUT_OF_STOCK_PRODUCTS","MANAGE_ORDERS","ALL_ORDERS","CONFIRM_ORDERS","SHIPPED_ORDER","PICKUP_PENDING","DELIVERED_ORDER","RTO_ORDER","RTO_DELIVERED","CANCEL_ORDER","PARTIAL_DELIVERED","HOLD","PICKUP_INITIATE","IMPORT_PINCODE","MANAGE_RETURN","RETURN_REQUEST","SETTLEMENT_REQUEST","REFUNDED","SETTLEMENT_REQUEST_CANCEL","ALL_USERS","MANAGE_COUPONS","ADD_COUPON","ALL_COUPON","MANAGE_SALES","HOMEPAGE_MANAGE","MANAGE_VENDOR","ADD_VENDOR","ALL_VENDOR","ALL_OUTSTANDING","ALL_SETTLED","ADD_EMPLOYEE","EXPORT_INFORMATION","COUPON","COUPON_VIEW","COUPON_EDIT","COUPON_DOWNLOAD","COUPON_ALL_COUPON","COUPON_ADD_NEW_COUPON","CUSTOMER","CUSTOMER_VIEW","CUSTOMER_EDIT","CUSTOMER_DOWNLOAD","CUSTOMER_ALL_CUSTOMER","CUSTOMER_CUSTOMER_ORDER_BY_PHONE","SETTING","SETTING_BUSINESS_INFO_SETTING","SETTING_HOMEPAGE_SETTING","REPORT","REPORT_VIEW","REPORT_DOWNLOAD","SUB_ADMIN","SUBADMIN_VIEW","SUBADMIN_DOWNLOAD","SUB_ADMIN_ALL_ADMIN","SUB_ADMIN_ADD_ADMIN","flat","z","Puppeteer","hbs","fs","footerText","templatePath","content","readFileSync","html","compile","template","browser","launch","headless","page","newPage","setContent","addStyleTag","format","printBackground","displayHeaderFooter","footerTemplate","close","currentYear","num","per","sellerAmount","sellingGst","baseAmount","basePlusMarginAmt","Punjab","Chandigarh","Uttarakhand","Haryana","Delhi","Rajasthan","Bihar","Sikkim","Nagaland","Manipur","Mizoram","Tripura","Meghalaya","Assam","Jharkhand","Odisha","Chattisgarh","Gujarat","Maharashtra","Karnataka","Goa","Lakshadweep","Kerela","Puducherry","Telangana","Ladakh","requestBody","objectId","value","isValidName","test","gmail","isValidImg","GST","isValidPrice","isValidStatus","isValidPin","pin","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","bodyParser","fileUpload","cors","app","productRoutes","categoryRoutes","brandRoutes","vendorRoutes","adminRoutes","colorRoutes","customerRoutes","orderRoutes","paymentRoutes","cartRoutes","questionRoutes","couponRoutes","businessRoutes","homepageRoutes","invoiceRoutes","optRoutes","orderStatusRoute","profileRoutes","reportRoutes","dashboardRoutes","wishlistRoutes","adminDashboardRoute","use","urlencoded","extended","connect","useNewUrlParser","listen"],"sourceRoot":""}